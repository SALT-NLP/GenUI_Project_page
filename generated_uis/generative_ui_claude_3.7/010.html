<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Piano Learning Journey</title>
    <style>
        :root {
            --primary-color: #3a86ff;
            --secondary-color: #8338ec;
            --accent-color: #ff006e;
            --text-color: #333333;
            --light-text: #777777;
            --background: #ffffff;
            --light-bg: #f8f9fa;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--light-bg);
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--box-shadow);
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
        }

        .logo svg {
            margin-right: 10px;
        }

        .nav-links {
            display: flex;
            list-style: none;
        }

        .nav-links li {
            margin-left: 1.5rem;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            padding: 0.5rem 0.75rem;
            border-radius: var(--border-radius);
        }

        .nav-links a:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .hero {
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://placehold.co/1200x600?text=Piano+Learning');
            background-size: cover;
            background-position: center;
            height: 500px;
            display: flex;
            align-items: center;
            color: white;
            text-align: center;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
        }

        .btn {
            display: inline-block;
            background-color: var(--accent-color);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: bold;
            transition: var(--transition);
            border: none;
            cursor: pointer;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        section {
            padding: 4rem 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-title h2 {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .section-title p {
            color: var(--light-text);
            max-width: 700px;
            margin: 0 auto;
        }

        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
        }

        .card {
            background-color: var(--background);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .card-img {
            height: 200px;
            overflow: hidden;
        }

        .card-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .card:hover .card-img img {
            transform: scale(1.1);
        }

        .card-content {
            padding: 1.5rem;
        }

        .card-content h3 {
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .card-content p {
            margin-bottom: 1.5rem;
            color: var(--light-text);
        }

        .progress-section {
            background-color: var(--light-bg);
        }

        .steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .step {
            text-align: center;
            padding: 2rem;
            background-color: var(--background);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .step-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            background-color: var(--primary-color);
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 50%;
            margin: 0 auto 1.5rem;
        }

        .step h3 {
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .piano-keyboard {
            display: flex;
            justify-content: center;
            margin: 3rem 0;
            position: relative;
            height: 200px;
            max-width: 90%;
            overflow-x: auto;
            padding: 0 20px;
            box-sizing: content-box;
            margin-left: auto;
            margin-right: auto;
        }

        .white-key {
            width: 40px;
            height: 200px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 0 0 5px 5px;
            position: relative;
            z-index: 1;
            transition: background-color 0.2s;
            cursor: pointer;
            margin: 0 1px;
        }

        .white-key:hover {
            background-color: #f0f0f0;
        }

        .white-key.active {
            background-color: #e6e6e6;
        }

        .black-key {
            width: 24px;
            height: 120px;
            background-color: #333;
            position: absolute;
            z-index: 2;
            border-radius: 0 0 3px 3px;
            transition: background-color 0.2s;
            cursor: pointer;
            margin-left: -12px;
        }

        .black-key:hover {
            background-color: #555;
        }

        .black-key.active {
            background-color: #666;
        }

        .testimonials {
            background-color: var(--background);
        }

        .testimonial-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .testimonial {
            background-color: var(--light-bg);
            padding: 2rem;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .testimonial-header {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .testimonial-img {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            overflow: hidden;
            margin-right: 1rem;
        }

        .testimonial-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .testimonial-author h4 {
            margin-bottom: 0.25rem;
            color: var(--primary-color);
        }

        .testimonial-author p {
            color: var(--light-text);
            font-size: 0.9rem;
        }

        .testimonial-content p {
            font-style: italic;
            color: var(--text-color);
        }

        .resources {
            background-color: var(--light-bg);
        }

        .resource-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .resource-item {
            background-color: var(--background);
            padding: 2rem;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }

        .resource-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        .resource-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .resource-item h3 {
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .resource-item p {
            color: var(--light-text);
            margin-bottom: 1.5rem;
        }

        .faq {
            background-color: var(--background);
        }

        .accordion {
            max-width: 800px;
            margin: 0 auto;
        }

        .accordion-item {
            margin-bottom: 1rem;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
        }

        .accordion-header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .accordion-header h3 {
            font-size: 1.1rem;
            font-weight: 500;
        }

        .accordion-content {
            background-color: var(--background);
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

        .accordion-content.active {
            padding: 1.5rem;
            max-height: 500px;
        }

        footer {
            background-color: #333;
            color: white;
            padding: 3rem 0 1.5rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-column h3 {
            margin-bottom: 1.5rem;
            color: var(--accent-color);
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.75rem;
        }

        .footer-links a {
            color: #ddd;
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: white;
            text-decoration: underline;
        }

        .copyright {
            text-align: center;
            padding-top: 1.5rem;
            border-top: 1px solid #555;
            color: #aaa;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }

            .nav-links {
                display: none;
            }

            .mobile-menu-btn {
                display: block;
            }
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: var(--background);
            width: 90%;
            max-width: 600px;
            border-radius: var(--border-radius);
            padding: 2rem;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--light-text);
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--accent-color);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        input,
        select,
        textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-family: inherit;
            font-size: 1rem;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(58, 134, 255, 0.2);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }
    </style>
</head>

<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="2" y="4" width="20" height="16" rx="2" stroke="white" stroke-width="2" />
                        <rect x="5" y="4" width="2" height="10" fill="white" />
                        <rect x="9" y="4" width="2" height="10" fill="white" />
                        <rect x="13" y="4" width="2" height="10" fill="white" />
                        <rect x="17" y="4" width="2" height="10" fill="white" />
                    </svg>
                    Piano Journey
                </div>
                <ul class="nav-links">
                    <li><a href="#beginner">Beginner</a></li>
                    <li><a href="#progress">Learning Path</a></li>
                    <li><a href="#practice">Practice</a></li>
                    <li><a href="#resources">Resources</a></li>
                    <li><a href="#faq">FAQ</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1>Master the Piano at Your Own Pace</h1>
                <p>Discover effective learning strategies, personalized practice plans, and expert guidance to help you
                    achieve your musical goals.</p>
                <button class="btn" id="start-journey-btn">Start Your Piano Journey</button>
            </div>
        </div>
    </section>

    <section id="beginner" class="beginner">
        <div class="container">
            <div class="section-title">
                <h2>Beginner Essentials</h2>
                <p>Everything you need to know to get started on your piano journey</p>
            </div>
            <div class="cards">
                <div class="card">
                    <div class="card-img">
                        <img src="https://placehold.co/600x400?text=Piano+Basics" alt="Piano Basics">
                    </div>
                    <div class="card-content">
                        <h3>Piano Basics</h3>
                        <p>Learn about piano keys, proper posture, hand positioning, and finger numbering to establish a
                            solid foundation.</p>
                        <button class="btn" data-modal="basics-modal">Learn More</button>
                    </div>
                </div>
                <div class="card">
                    <div class="card-img">
                        <img src="https://placehold.co/600x400?text=Reading+Music" alt="Reading Music">
                    </div>
                    <div class="card-content">
                        <h3>Reading Music</h3>
                        <p>Master the fundamentals of music notation, including notes, rhythms, and basic symbols to
                            start reading sheet music.</p>
                        <button class="btn" data-modal="reading-modal">Learn More</button>
                    </div>
                </div>
                <div class="card">
                    <div class="card-img">
                        <img src="https://placehold.co/600x400?text=First+Songs" alt="First Songs">
                    </div>
                    <div class="card-content">
                        <h3>First Songs</h3>
                        <p>Start playing simple melodies and progressions designed specifically for beginners to build
                            confidence and skill.</p>
                        <button class="btn" data-modal="songs-modal">Learn More</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="progress" class="progress-section">
        <div class="container">
            <div class="section-title">
                <h2>Your Learning Path</h2>
                <p>A structured approach to mastering the piano effectively</p>
            </div>
            <div class="steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <h3>Build Foundation</h3>
                    <p>Master basic techniques, hand positions, and simple exercises to develop proper form and finger
                        strength.</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h3>Develop Skills</h3>
                    <p>Learn scales, chords, and arpeggios while gradually increasing the complexity of the pieces you
                        play.</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h3>Regular Practice</h3>
                    <p>Establish a consistent practice routine with focused exercises and deliberate practice
                        techniques.</p>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <h3>Musical Expression</h3>
                    <p>Develop dynamics, phrasing, and interpretation to bring emotion and personality to your playing.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <section id="practice" class="practice">
        <div class="container">
            <div class="section-title">
                <h2>Interactive Practice Tools</h2>
                <p>Enhance your learning with these interactive tools</p>
            </div>
            <div class="piano-keyboard" id="piano-keyboard">
                <!-- Piano keys will be generated by JavaScript -->
            </div>
            <div style="text-align: center; margin-top: 2rem;">
                <button class="btn" id="play-demo">Play Demo Melody</button>
                <button class="btn" id="stop-playback"
                    style="background-color: #ff006e; margin-left: 10px; display: none;">Stop Playback</button>
            </div>

            <div style="text-align: center; margin-top: 2rem;">
                <div class="melody-selector">
                    <h3>Try These Famous Melodies</h3>
                    <div class="melody-buttons"
                        style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-top: 1rem;">
                        <button class="btn melody-btn" data-melody="twinkle">Twinkle Little Star</button>
                        <button class="btn melody-btn" data-melody="joyful">Ode to Joy</button>
                        <button class="btn melody-btn" data-melody="fur-elise">Für Elise (Intro)</button>
                        <button class="btn melody-btn" data-melody="jingle">Jingle Bells</button>
                        <button class="btn melody-btn" data-melody="canon">Pachelbel's Canon</button>
                    </div>
                    <button class="btn" id="stop-all-melodies"
                        style="background-color: #ff006e; margin-top: 15px; display: none;">Stop Music</button>
                </div>
            </div>
        </div>
    </section>

    <section class="testimonials">
        <div class="container">
            <div class="section-title">
                <h2>Success Stories</h2>
                <p>Hear from students who have transformed their piano skills</p>
            </div>
            <div class="testimonial-grid">
                <div class="testimonial">
                    <div class="testimonial-header">
                        <div class="testimonial-img">
                            <img src="https://placehold.co/200x200?text=Sarah" alt="Sarah">
                        </div>
                        <div class="testimonial-author">
                            <h4>Sarah Johnson</h4>
                            <p>Learning for 1 year</p>
                        </div>
                    </div>
                    <div class="testimonial-content">
                        <p>"I started as a complete beginner with no musical background. Following this structured
                            approach, I can now play several intermediate pieces and even compose my own music!"</p>
                    </div>
                </div>
                <div class="testimonial">
                    <div class="testimonial-header">
                        <div class="testimonial-img">
                            <img src="https://placehold.co/200x200?text=Michael" alt="Michael">
                        </div>
                        <div class="testimonial-author">
                            <h4>Michael Chen</h4>
                            <p>Learning for 2 years</p>
                        </div>
                    </div>
                    <div class="testimonial-content">
                        <p>"The practice techniques and progressive learning path helped me overcome plateaus I
                            experienced with other methods. Now I'm playing pieces I never thought I could master!"</p>
                    </div>
                </div>
                <div class="testimonial">
                    <div class="testimonial-header">
                        <div class="testimonial-img">
                            <img src="https://placehold.co/200x200?text=Emma" alt="Emma">
                        </div>
                        <div class="testimonial-author">
                            <h4>Emma Rodriguez</h4>
                            <p>Learning for 6 months</p>
                        </div>
                    </div>
                    <div class="testimonial-content">
                        <p>"As an adult learner, I was worried it would be too difficult to start. The step-by-step
                            approach and interactive tools made it accessible and enjoyable. I practice every day now!"
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="resources" class="resources">
        <div class="container">
            <div class="section-title">
                <h2>Essential Resources</h2>
                <p>Tools and materials to support your piano journey</p>
            </div>
            <div class="resource-list">
                <div class="resource-item">
                    <div class="resource-icon">📚</div>
                    <h3>Recommended Books</h3>
                    <p>Curated collection of method books, theory guides, and repertoire collections for all skill
                        levels.</p>
                    <button class="btn" data-modal="books-modal">View List</button>
                </div>
                <div class="resource-item">
                    <div class="resource-icon">🎵</div>
                    <h3>Sheet Music</h3>
                    <p>Access to beginner-friendly sheet music with progressive difficulty to match your development.
                    </p>
                    <button class="btn" data-modal="sheet-modal">Browse Music</button>
                </div>
                <div class="resource-item">
                    <div class="resource-icon">🎹</div>
                    <h3>Practice Techniques</h3>
                    <p>Effective practice strategies to maximize your progress and overcome common challenges.</p>
                    <button class="btn" data-modal="practice-modal">Learn Techniques</button>
                </div>
                <div class="resource-item">
                    <div class="resource-icon">⏱️</div>
                    <h3>Practice Planner</h3>
                    <p>Customizable practice schedules and tracking tools to maintain consistency and focus.</p>
                    <button class="btn" data-modal="planner-modal">Create Plan</button>
                </div>
            </div>
        </div>
    </section>

    <section id="faq" class="faq">
        <div class="container">
            <div class="section-title">
                <h2>Frequently Asked Questions</h2>
                <p>Answers to common questions about learning piano</p>
            </div>
            <div class="accordion">
                <div class="accordion-item">
                    <div class="accordion-header">
                        <h3>How much should I practice each day?</h3>
                        <span class="accordion-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p>For beginners, consistent daily practice of 20-30 minutes is more effective than longer,
                            irregular sessions. As you advance, gradually increase to 45-60 minutes or more. The quality
                            of focused practice matters more than quantity. Break your practice into segments focusing
                            on different skills: technique, sight-reading, repertoire, and theory.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <div class="accordion-header">
                        <h3>Do I need a teacher or can I learn on my own?</h3>
                        <span class="accordion-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p>While self-learning is possible with online resources, a qualified teacher provides
                            personalized feedback, corrects technique issues before they become habits, and creates a
                            structured learning path. Consider starting with a teacher for the first 6-12 months to
                            establish proper fundamentals, then supplement with self-directed learning. If a teacher
                            isn't possible, use video lessons that emphasize proper technique and seek occasional
                            feedback from experienced pianists.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <div class="accordion-header">
                        <h3>What kind of piano or keyboard should I get as a beginner?</h3>
                        <span class="accordion-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p>For beginners, look for a keyboard with at least 61 full-sized keys, touch sensitivity (to
                            develop proper dynamics), and weighted keys if possible. As you progress, aim for an 88-key
                            digital piano with fully-weighted keys that simulate the feel of an acoustic piano. Key
                            features to consider include: weighted or semi-weighted keys, touch sensitivity, polyphony
                            of at least 64 notes, built-in speakers, headphone output, and sustain pedal compatibility.
                        </p>
                    </div>
                </div>
                <div class="accordion-item">
                    <div class="accordion-header">
                        <h3>How long does it take to get good at piano?</h3>
                        <span class="accordion-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p>Progress varies greatly depending on practice consistency, quality of instruction, and
                            natural aptitude. With regular practice (30 minutes daily), most beginners can play simple
                            pieces within 3-6 months, intermediate pieces within 1-2 years, and advanced pieces within
                            3-5 years. Remember that learning piano is a lifelong journey. Set specific, achievable
                            goals rather than aiming for an abstract concept of being "good." Celebrate small
                            improvements and enjoy the process.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <div class="accordion-header">
                        <h3>Do I need to learn music theory to play piano?</h3>
                        <span class="accordion-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <p>While you can learn to play specific pieces without theory, understanding basic theory
                            dramatically accelerates your progress and musical comprehension. Theory helps you recognize
                            patterns, understand chord progressions, memorize music more easily, and eventually
                            improvise or compose. Start with basic concepts like note names, intervals, key signatures,
                            and scales, then gradually incorporate more advanced concepts as you progress. Even 10
                            minutes of theory study during each practice session will yield significant benefits.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Piano Journey</h3>
                    <p>Your guide to mastering the piano through structured learning and effective practice techniques.
                    </p>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#beginner">Beginner Essentials</a></li>
                        <li><a href="#progress">Learning Path</a></li>
                        <li><a href="#practice">Practice Tools</a></li>
                        <li><a href="#resources">Resources</a></li>
                        <li><a href="#faq">FAQ</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Resources</h3>
                    <ul class="footer-links">
                        <li><a href="#" data-modal="sheet-modal">Sheet Music</a></li>
                        <li><a href="#" data-modal="books-modal">Recommended Books</a></li>
                        <li><a href="#" data-modal="practice-modal">Practice Techniques</a></li>
                        <li><a href="#" data-modal="planner-modal">Practice Planner</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Connect</h3>
                    <ul class="footer-links">
                        <li><a href="#" data-modal="contact-modal">Contact Us</a></li>
                        <li><a href="#" data-modal="newsletter-modal">Newsletter</a></li>
                        <li><a href="#" data-modal="community-modal">Community</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 Piano Journey. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Modals -->
    <div class="modal" id="basics-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Piano Basics</h2>
            <div style="margin-top: 1.5rem;">
                <h3>Proper Posture</h3>
                <p>Sit at the middle of the keyboard with your back straight, feet flat on the floor. Your elbows should
                    be slightly higher than the keyboard, with arms forming a 90-degree angle.</p>

                <h3 style="margin-top: 1.5rem;">Hand Position</h3>
                <p>Keep your hands curved naturally, as if holding a small ball. Your fingers should rest lightly on the
                    keys with fingertips, not flat fingers.</p>

                <h3 style="margin-top: 1.5rem;">Finger Numbering</h3>
                <p>Fingers are numbered 1-5 on each hand, with the thumb being 1 and the pinky being 5. This numbering
                    is used in sheet music to indicate which finger to use.</p>

                <h3 style="margin-top: 1.5rem;">Key Names</h3>
                <p>White keys follow the pattern C-D-E-F-G-A-B, repeating across the keyboard. Black keys are sharps (#)
                    or flats (♭) of the white keys (e.g., the black key between C and D is both C# and D♭).</p>

                <h3 style="margin-top: 1.5rem;">Middle C</h3>
                <p>This is the central reference point on the piano, located near the middle of the keyboard. It's the C
                    closest to the center of the piano.</p>
            </div>
        </div>
    </div>

    <div class="modal" id="reading-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Reading Music</h2>
            <div style="margin-top: 1.5rem;">
                <h3>The Staff</h3>
                <p>Music is written on a staff with five lines and four spaces. Each line and space represents a
                    different note.</p>

                <h3 style="margin-top: 1.5rem;">Clefs</h3>
                <p>Piano music uses two clefs: Treble clef (right hand) and Bass clef (left hand). The treble clef
                    circles the G line, while the bass clef marks the F line.</p>

                <h3 style="margin-top: 1.5rem;">Note Values</h3>
                <p>Different note shapes indicate how long to hold a note:</p>
                <ul style="margin-left: 1.5rem;">
                    <li>Whole note (o): Hold for 4 beats</li>
                    <li>Half note (d): Hold for 2 beats</li>
                    <li>Quarter note (♩): Hold for 1 beat</li>
                    <li>Eighth note (♪): Hold for 1/2 beat</li>
                </ul>

                <h3 style="margin-top: 1.5rem;">Time Signatures</h3>
                <p>The top number indicates how many beats per measure, while the bottom number shows what note value
                    gets one beat. For example, 4/4 means four quarter notes per measure.</p>

                <h3 style="margin-top: 1.5rem;">Key Signatures</h3>
                <p>Sharps or flats at the beginning of a piece indicate which notes are consistently sharp or flat
                    throughout the music.</p>
            </div>
        </div>
    </div>

    <div class="modal" id="songs-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>First Songs for Beginners</h2>
            <div style="margin-top: 1.5rem;">
                <h3>One-Hand Melodies</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>Mary Had a Little Lamb</li>
                    <li>Twinkle Twinkle Little Star</li>
                    <li>Hot Cross Buns</li>
                    <li>Jingle Bells (melody only)</li>
                </ul>

                <h3 style="margin-top: 1.5rem;">Simple Two-Hand Pieces</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>Ode to Joy (simplified)</li>
                    <li>Heart and Soul (basic version)</li>
                    <li>Chopsticks</li>
                    <li>London Bridge</li>
                </ul>

                <h3 style="margin-top: 1.5rem;">Easy Classical Pieces</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>Bach: Minuet in G (simplified)</li>
                    <li>Mozart: A Little Night Music (adapted)</li>
                    <li>Beethoven: Für Elise (first section)</li>
                    <li>Schumann: The Wild Horseman</li>
                </ul>

                <h3 style="margin-top: 1.5rem;">Learning Tips</h3>
                <p>Start by learning each hand separately before combining them. Practice slowly and gradually increase
                    the tempo. Focus on accuracy rather than speed.</p>
            </div>
        </div>
    </div>

    <div class="modal" id="books-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Recommended Books</h2>
            <div style="margin-top: 1.5rem;">
                <h3>Method Books</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>Alfred's Basic Adult Piano Course</li>
                    <li>Faber Piano Adventures</li>
                    <li>Bastien Piano Basics</li>
                    <li>John Thompson's Modern Course for the Piano</li>
                </ul>

                <h3 style="margin-top: 1.5rem;">Theory Books</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>The Complete Book of Scales, Chords, Arpeggios & Cadences</li>
                    <li>Music Theory for Pianists</li>
                    <li>The AB Guide to Music Theory</li>
                    <li>Harmony and Theory: A Comprehensive Source for All Musicians</li>
                </ul>

                <h3 style="margin-top: 1.5rem;">Technique Books</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>Hanon: The Virtuoso Pianist</li>
                    <li>Czerny: Practical Method for Beginners</li>
                    <li>Fundamentals of Piano Practice by Chuan C. Chang</li>
                    <li>The Pianist's Problems by William S. Newman</li>
                </ul>

                <h3 style="margin-top: 1.5rem;">Repertoire Collections</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>First Lessons in Bach</li>
                    <li>Notebook for Anna Magdalena Bach</li>
                    <li>Schumann's Album for the Young</li>
                    <li>Burgmüller: 25 Progressive Pieces, Op. 100</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="modal" id="sheet-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Sheet Music Resources</h2>
            <div style="margin-top: 1.5rem;">
                <h3>Beginner Level (Grades 1-2)</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>C.L. Hanon - The Virtuoso Pianist (first exercises)</li>
                    <li>Burgmüller - 25 Easy and Progressive Studies</li>
                    <li>Kabalevsky - 24 Pieces for Children, Op. 39</li>
                    <li>Schumann - Album for the Young (simpler pieces)</li>
                </ul>

                <h3 style="margin-top: 1.5rem;">Intermediate Level (Grades 3-5)</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>Bach - Two-Part Inventions</li>
                    <li>Clementi - Sonatinas</li>
                    <li>Chopin - Preludes (easier ones)</li>
                    <li>Debussy - Children's Corner</li>
                </ul>

                <h3 style="margin-top: 1.5rem;">Advanced Level (Grades 6-8)</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>Bach - Well-Tempered Clavier</li>
                    <li>Beethoven - Sonatas</li>
                    <li>Chopin - Nocturnes and Waltzes</li>
                    <li>Debussy - Arabesques</li>
                </ul>

                <h3 style="margin-top: 1.5rem;">Popular & Contemporary</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>Einaudi - Collection of simplified arrangements</li>
                    <li>Movie themes (arranged for piano)</li>
                    <li>Pop song arrangements (various difficulty levels)</li>
                    <li>Jazz standards with simplified chord progressions</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="modal" id="practice-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Effective Practice Techniques</h2>
            <div style="margin-top: 1.5rem;">
                <h3>Structured Practice Session</h3>
                <ol style="margin-left: 1.5rem;">
                    <li>Warm-up (5 min): Scales, arpeggios, or simple exercises</li>
                    <li>Technique (10 min): Focused exercises for specific skills</li>
                    <li>Repertoire (15-20 min): Working on pieces</li>
                    <li>Sight-reading (5 min): Reading new, simpler material</li>
                    <li>Theory/ear training (5 min): Analyzing music or training your ear</li>
                </ol>

                <h3 style="margin-top: 1.5rem;">Problem-Solving Techniques</h3>
                <ul style="margin-left: 1.5rem;">
                    <li><strong>Chunking</strong>: Break difficult passages into small, manageable sections</li>
                    <li><strong>Slow practice</strong>: Master at slow tempo before increasing speed</li>
                    <li><strong>Hands separate</strong>: Practice each hand individually before combining</li>
                    <li><strong>Rhythmic variations</strong>: Practice with different rhythms to build coordination</li>
                    <li><strong>Mental practice</strong>: Visualize playing without the instrument</li>
                </ul>

                <h3 style="margin-top: 1.5rem;">Deliberate Practice</h3>
                <p>Focus on specific problems rather than mindlessly repeating entire pieces. Set clear goals for each
                    practice session. Record yourself and critically analyze your playing.</p>

                <h3 style="margin-top: 1.5rem;">Effective Learning Strategies</h3>
                <ul style="margin-left: 1.5rem;">
                    <li>Practice in short, focused sessions rather than one long session</li>
                    <li>Interleave different types of practice rather than blocking</li>
                    <li>Use spaced repetition to review material</li>
                    <li>End practice sessions with something enjoyable</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="modal" id="planner-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Practice Planner</h2>
            <div style="margin-top: 1.5rem;">
                <form id="practice-plan-form">
                    <div class="form-group">
                        <label for="practice-days">How many days per week can you practice?</label>
                        <select id="practice-days" required>
                            <option value="">Select</option>
                            <option value="3">3 days</option>
                            <option value="4">4 days</option>
                            <option value="5">5 days</option>
                            <option value="6">6 days</option>
                            <option value="7">7 days</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="practice-time">How much time can you dedicate per session?</label>
                        <select id="practice-time" required>
                            <option value="">Select</option>
                            <option value="15">15 minutes</option>
                            <option value="30">30 minutes</option>
                            <option value="45">45 minutes</option>
                            <option value="60">60 minutes</option>
                            <option value="90">90 minutes</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="skill-level">Your current skill level:</label>
                        <select id="skill-level" required>
                            <option value="">Select</option>
                            <option value="beginner">Complete Beginner</option>
                            <option value="early">Early Beginner (0-6 months)</option>
                            <option value="late">Late Beginner (6-12 months)</option>
                            <option value="intermediate">Intermediate (1-3 years)</option>
                            <option value="advanced">Advanced (3+ years)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="goals">Your piano goals:</label>
                        <textarea id="goals"
                            placeholder="What do you want to achieve with piano? Specific pieces you want to learn?"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="challenges">Current challenges:</label>
                        <textarea id="challenges"
                            placeholder="What aspects of playing are you finding difficult?"></textarea>
                    </div>
                    <button type="submit" class="btn" style="width: 100%;">Generate Practice Plan</button>
                </form>
                <div id="plan-result" style="margin-top: 2rem; display: none;">
                    <h3>Your Personalized Practice Plan</h3>
                    <div id="plan-content"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="contact-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Contact Us</h2>
            <div style="margin-top: 1.5rem;">
                <form id="contact-form">
                    <div class="form-group">
                        <label for="name">Name</label>
                        <input type="text" id="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" required>
                    </div>
                    <div class="form-group">
                        <label for="subject">Subject</label>
                        <select id="subject" required>
                            <option value="">Select a subject</option>
                            <option value="question">Question about learning</option>
                            <option value="feedback">Feedback</option>
                            <option value="suggestion">Suggestion</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="message">Message</label>
                        <textarea id="message" required></textarea>
                    </div>
                    <button type="submit" class="btn" style="width: 100%;">Send Message</button>
                </form>
            </div>
        </div>
    </div>

    <div class="modal" id="newsletter-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Subscribe to Our Newsletter</h2>
            <div style="margin-top: 1.5rem;">
                <p>Get weekly piano tips, practice ideas, and exclusive resources delivered to your inbox.</p>
                <form id="newsletter-form" style="margin-top: 1.5rem;">
                    <div class="form-group">
                        <label for="newsletter-name">Name</label>
                        <input type="text" id="newsletter-name" required>
                    </div>
                    <div class="form-group">
                        <label for="newsletter-email">Email</label>
                        <input type="email" id="newsletter-email" required>
                    </div>
                    <div class="form-group">
                        <label for="interests">Piano Interests (select all that apply)</label>
                        <div style="margin-top: 0.5rem;">
                            <input type="checkbox" id="interest-classical" value="classical">
                            <label for="interest-classical"
                                style="display: inline; margin-left: 0.5rem;">Classical</label>
                        </div>
                        <div style="margin-top: 0.5rem;">
                            <input type="checkbox" id="interest-jazz" value="jazz">
                            <label for="interest-jazz" style="display: inline; margin-left: 0.5rem;">Jazz</label>
                        </div>
                        <div style="margin-top: 0.5rem;">
                            <input type="checkbox" id="interest-pop" value="pop">
                            <label for="interest-pop"
                                style="display: inline; margin-left: 0.5rem;">Pop/Contemporary</label>
                        </div>
                        <div style="margin-top: 0.5rem;">
                            <input type="checkbox" id="interest-theory" value="theory">
                            <label for="interest-theory" style="display: inline; margin-left: 0.5rem;">Music
                                Theory</label>
                        </div>
                    </div>
                    <button type="submit" class="btn" style="width: 100%;">Subscribe</button>
                </form>
            </div>
        </div>
    </div>

    <div class="modal" id="community-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Join Our Piano Community</h2>
            <div style="margin-top: 1.5rem;">
                <p>Connect with fellow piano learners, share your progress, get feedback, and participate in challenges
                    and events.</p>
                <div style="margin-top: 2rem;">
                    <h3>Community Features</h3>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Weekly practice challenges</li>
                        <li>Monthly virtual recitals</li>
                        <li>Progress sharing and feedback</li>
                        <li>Discussion forums by skill level</li>
                        <li>Live Q&A sessions with teachers</li>
                    </ul>
                </div>
                <form id="community-form" style="margin-top: 2rem;">
                    <div class="form-group">
                        <label for="community-name">Name</label>
                        <input type="text" id="community-name" required>
                    </div>
                    <div class="form-group">
                        <label for="community-email">Email</label>
                        <input type="email" id="community-email" required>
                    </div>
                    <div class="form-group">
                        <label for="experience">Piano Experience</label>
                        <select id="experience" required>
                            <option value="">Select your experience level</option>
                            <option value="beginner">Beginner (0-1 year)</option>
                            <option value="intermediate">Intermediate (1-3 years)</option>
                            <option value="advanced">Advanced (3+ years)</option>
                        </select>
                    </div>
                    <button type="submit" class="btn" style="width: 100%;">Join Community</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Piano Keyboard Generator
        function createPianoKeyboard() {
            const pianoKeyboard = document.getElementById('piano-keyboard');
            const whiteKeyNames = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];
            const blackKeyNames = ['C#', 'D#', 'F#', 'G#', 'A#'];
            const blackKeyIndices = [1, 3, 6, 8, 10]; // Indices of black keys in 12-tone scale

            // Create 3 octaves (C3-B5)
            for (let octave = 3; octave <= 5; octave++) {
                for (let i = 0; i < 7; i++) {
                    const note = whiteKeyNames[i];

                    // Create white key
                    const whiteKey = document.createElement('div');
                    whiteKey.className = 'white-key';
                    whiteKey.dataset.note = `${note}${octave}`;
                    whiteKey.dataset.index = (octave - 3) * 7 + i;
                    whiteKey.addEventListener('click', playNote);
                    pianoKeyboard.appendChild(whiteKey);

                    // Determine if a black key follows this white key
                    const noteIndex = whiteKeyNames.indexOf(note);
                    if (noteIndex !== 2 && noteIndex !== 6) { // No black key after E and B
                        // Create black key
                        const blackKeyIndex = (noteIndex === 0) ? 1 : // C# = 1
                            (noteIndex === 1) ? 3 : // D# = 3
                                (noteIndex === 3) ? 6 : // F# = 6
                                    (noteIndex === 4) ? 8 : // G# = 8
                                        10; // A# = 10

                        const blackKeyNoteName = blackKeyNames[
                            (noteIndex === 0) ? 0 : // C# after C
                                (noteIndex === 1) ? 1 : // D# after D
                                    (noteIndex === 3) ? 2 : // F# after F
                                        (noteIndex === 4) ? 3 : // G# after G
                                            4  // A# after A
                        ];

                        const blackKey = document.createElement('div');
                        blackKey.className = 'black-key';
                        blackKey.dataset.note = `${blackKeyNoteName}${octave}`;
                        blackKey.dataset.index = (octave - 3) * 7 + i + 0.5;
                        blackKey.addEventListener('click', playNote);
                        pianoKeyboard.appendChild(blackKey);

                        // Position the black key
                        const offset = whiteKey.offsetLeft + whiteKey.offsetWidth - 12;
                        blackKey.style.left = `${offset}px`;
                    }
                }
            }

            // Once all keys are added, fix the positioning of black keys
            setTimeout(positionBlackKeys, 0);

            // Create audio context for piano sounds
            try {
                window.AudioContext = window.AudioContext || window.webkitAudioContext;
                window.audioContext = new AudioContext();
            } catch (e) {
                console.error("Web Audio API is not supported in this browser");
            }

            // Load piano sounds
            loadPianoSounds();
        }

        // Position black keys correctly after DOM is fully rendered
        function positionBlackKeys() {
            const whiteKeys = document.querySelectorAll('.white-key');
            const blackKeys = document.querySelectorAll('.black-key');

            blackKeys.forEach(blackKey => {
                const index = parseFloat(blackKey.dataset.index);
                const whiteKeyIndex = Math.floor(index);
                const whiteKey = document.querySelector(`.white-key[data-index="${whiteKeyIndex}"]`);

                if (whiteKey) {
                    blackKey.style.left = `${whiteKey.offsetLeft + whiteKey.offsetWidth - 14}px`;
                }
            });
        }

        // Load piano sounds
        function loadPianoSounds() {
            window.pianoSamples = {};
            window.loadedSamples = 0;
            window.totalSamples = 0;

            const notes = ['C', 'Db', 'D', 'Eb', 'E', 'F', 'Gb', 'G', 'Ab', 'A', 'Bb', 'B'];
            const octaves = [3, 4, 5];

            // Map sharp notation to flat notation for the sample library
            const sharpToFlat = {
                'C#': 'Db',
                'D#': 'Eb',
                'F#': 'Gb',
                'G#': 'Ab',
                'A#': 'Bb'
            };

            // Count total samples
            octaves.forEach(octave => {
                notes.forEach(note => {
                    window.totalSamples++;
                });
            });

            // Load audio samples
            octaves.forEach(octave => {
                notes.forEach(note => {
                    const noteWithOctave = `${note}${octave}`;

                    // Use direct MP3 URLs from the soundfont library
                    const sampleUrl = `https://gleitz.github.io/midi-js-soundfonts/FatBoy/acoustic_grand_piano-mp3/${note.toLowerCase()}${octave}.mp3`;

                    // Create audio element and set up event handlers
                    const audio = new Audio();

                    // Set up error handling
                    audio.onerror = () => {
                        console.error(`Failed to load sample: ${noteWithOctave}`);
                        // Create fallback audio for this note
                        window.pianoSamples[noteWithOctave] = null;
                        window.loadedSamples++;

                        // Try to preemptively use the fallback sound generation
                        const syntheticAudio = createSyntheticAudio(noteWithOctave);
                        if (syntheticAudio) {
                            window.pianoSamples[noteWithOctave] = syntheticAudio;
                        }
                    };

                    // Set up load success handler
                    audio.oncanplaythrough = () => {
                        // Store both flat and sharp versions
                        window.pianoSamples[noteWithOctave] = audio;

                        // If this is a flat note, also store its sharp equivalent
                        const flatToSharp = Object.fromEntries(
                            Object.entries(sharpToFlat).map(([sharp, flat]) => [flat, sharp])
                        );

                        if (flatToSharp[note]) {
                            window.pianoSamples[`${flatToSharp[note]}${octave}`] = audio;
                        }

                        window.loadedSamples++;

                        // Initialize keyboard once all samples are loaded
                        if (window.loadedSamples === window.totalSamples) {
                            console.log('All piano samples loaded successfully');
                        }
                    };

                    // Set the source and begin loading
                    audio.src = sampleUrl;
                    audio.preload = 'auto';
                });
            });
        }

        // Create a synthetic audio using Web Audio API as backup
        function createSyntheticAudio(note) {
            try {
                if (!window.audioContext) {
                    window.AudioContext = window.AudioContext || window.webkitAudioContext;
                    window.audioContext = new AudioContext();
                }

                // Get the frequency for this note
                const noteFreq = getNoteFrequency(note);

                // Create an audio buffer for this note
                const sampleRate = window.audioContext.sampleRate;
                const buffer = window.audioContext.createBuffer(1, sampleRate, sampleRate);
                const data = buffer.getChannelData(0);

                // Generate a piano-like tone
                for (let i = 0; i < sampleRate; i++) {
                    // Base sine wave
                    const t = i / sampleRate;
                    // Fundamental frequency
                    const fundamental = Math.sin(2 * Math.PI * noteFreq * t);
                    // Second harmonic (octave)
                    const harmonic1 = 0.5 * Math.sin(4 * Math.PI * noteFreq * t);
                    // Third harmonic 
                    const harmonic2 = 0.25 * Math.sin(6 * Math.PI * noteFreq * t);

                    // Combine harmonics with exponential decay
                    const decay = Math.exp(-5 * t);
                    data[i] = decay * (fundamental + harmonic1 + harmonic2);
                }

                // Convert to audio element for consistent API with loaded samples
                const audioBlob = bufferToWave(buffer, buffer.length);
                const audio = new Audio(URL.createObjectURL(audioBlob));
                audio.preload = 'auto';

                return audio;
            } catch (e) {
                console.error("Failed to create synthetic audio:", e);
                return null;
            }
        }

        // Convert audio buffer to WAV format for Audio element
        function bufferToWave(abuffer, len) {
            const numOfChan = abuffer.numberOfChannels;
            const length = len * numOfChan * 2 + 44;
            const buffer = new ArrayBuffer(length);
            const view = new DataView(buffer);
            let offset = 0;

            // RIFF identifier
            writeString(view, offset, "RIFF"); offset += 4;
            // File length
            view.setUint32(offset, length - 8, true); offset += 4;
            // RIFF type
            writeString(view, offset, "WAVE"); offset += 4;
            // Format chunk identifier
            writeString(view, offset, "fmt "); offset += 4;
            // Format chunk length
            view.setUint32(offset, 16, true); offset += 4;
            // Sample format (1 = PCM)
            view.setUint16(offset, 1, true); offset += 2;
            // Channel count
            view.setUint16(offset, numOfChan, true); offset += 2;
            // Sample rate
            view.setUint32(offset, abuffer.sampleRate, true); offset += 4;
            // Byte rate
            view.setUint32(offset, abuffer.sampleRate * numOfChan * 2, true); offset += 4;
            // Block align
            view.setUint16(offset, numOfChan * 2, true); offset += 2;
            // Bits per sample
            view.setUint16(offset, 16, true); offset += 2;
            // Data chunk identifier
            writeString(view, offset, "data"); offset += 4;
            // Data chunk length
            view.setUint32(offset, len * numOfChan * 2, true); offset += 4;

            // Write interleaved audio data
            const channelData = [];
            for (let i = 0; i < numOfChan; i++) {
                channelData.push(abuffer.getChannelData(i));
            }

            let sample = 0;
            while (sample < len) {
                for (let i = 0; i < numOfChan; i++) {
                    // Convert float to int16
                    let val = Math.max(-1, Math.min(1, channelData[i][sample]));
                    val = val < 0 ? val * 0x8000 : val * 0x7FFF;
                    view.setInt16(offset, val, true); offset += 2;
                }
                sample++;
            }

            return new Blob([buffer], { type: "audio/wav" });
        }

        // Write a string to a DataView
        function writeString(view, offset, string) {
            for (let i = 0; i < string.length; i++) {
                view.setUint8(offset + i, string.charCodeAt(i));
            }
        }

        // Play note with actual sound
        function playNote(e) {
            const key = e.target;
            const note = key.dataset.note;

            // Visual feedback
            key.classList.add('active');
            setTimeout(() => {
                key.classList.remove('active');
            }, 300);

            // Check if this is a black key with sharp notation
            let normalizedNote = note;
            if (note.includes('#')) {
                const noteName = note.slice(0, -1);
                const octave = note.slice(-1);
                const flatEquivalents = {
                    'C#': 'Db',
                    'D#': 'Eb',
                    'F#': 'Gb',
                    'G#': 'Ab',
                    'A#': 'Bb'
                };
                normalizedNote = flatEquivalents[noteName] + octave;
            }

            // Try to play the sample if available
            if (window.pianoSamples && window.pianoSamples[normalizedNote]) {
                const sample = window.pianoSamples[normalizedNote];
                if (sample) {
                    try {
                        // Ensure we're ready to play
                        if (window.audioContext && window.audioContext.state === 'suspended') {
                            window.audioContext.resume();
                        }

                        // Reset audio to beginning
                        sample.currentTime = 0;

                        // Play with error handling
                        sample.play().catch(err => {
                            console.warn("Error playing sample, using fallback:", err);
                            playBasicSound(note);
                        });
                    } catch (err) {
                        console.warn("Exception playing sample:", err);
                        playBasicSound(note);
                    }
                } else {
                    playBasicSound(note);
                }
            } else {
                // Fallback to basic sound synthesis
                playBasicSound(note);
            }
        }

        // Fallback sound generation using Web Audio API
        function playBasicSound(note) {
            if (!window.audioContext) {
                // Try to create audio context on user gesture if it wasn't created earlier
                try {
                    window.AudioContext = window.AudioContext || window.webkitAudioContext;
                    window.audioContext = new AudioContext();
                } catch (e) {
                    console.error("Web Audio API is not supported in this browser");
                    return;
                }
            }

            try {
                const oscillator = window.audioContext.createOscillator();
                const gainNode = window.audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(window.audioContext.destination);

                // Get frequency from note name
                const noteFreq = getNoteFrequency(note);
                oscillator.type = 'sine';
                oscillator.frequency.value = noteFreq;

                gainNode.gain.setValueAtTime(0.3, window.audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, window.audioContext.currentTime + 1);

                oscillator.start();
                oscillator.stop(window.audioContext.currentTime + 1);

                console.log(`Played synthetic note: ${note} (${noteFreq} Hz)`);
            } catch (e) {
                console.error("Error playing synthetic sound:", e);
            }
        }

        // Calculate frequency for a given note
        function getNoteFrequency(note) {
            // Handle both sharp and flat notations
            const noteMapping = {
                'C': 0, 'C#': 1, 'Db': 1,
                'D': 2, 'D#': 3, 'Eb': 3,
                'E': 4,
                'F': 5, 'F#': 6, 'Gb': 6,
                'G': 7, 'G#': 8, 'Ab': 8,
                'A': 9, 'A#': 10, 'Bb': 10,
                'B': 11
            };

            let noteName = note.slice(0, -1);
            const octave = parseInt(note.slice(-1));

            // A4 is 440Hz
            const A4 = 440;
            const A4Position = 9 + (4 * 12);
            const notePosition = noteMapping[noteName] + (octave * 12);

            return A4 * Math.pow(2, (notePosition - A4Position) / 12);
        }

        // Play demo melody
        function playDemoMelody() {
            const notes = ['C4', 'D4', 'E4', 'F4', 'G4', 'G4', 'A4', 'A4', 'G4'];
            const durations = [500, 500, 500, 500, 1000, 500, 500, 500, 1000];

            // Stop any currently playing melody
            stopAllPlayback();

            // Make sure audio context is resumed on user interaction
            if (window.audioContext && window.audioContext.state === 'suspended') {
                window.audioContext.resume();
            }

            // Show stop button, hide play button
            document.getElementById('play-demo').style.display = 'none';
            document.getElementById('stop-playback').style.display = 'inline-block';

            // Store timeouts so they can be cancelled
            window.activeTimeouts = [];

            notes.forEach((note, index) => {
                const timeout = setTimeout(() => {
                    // Check if playback has been stopped
                    if (!window.activeTimeouts) return;

                    // Find the key with this note
                    const key = document.querySelector(`.white-key[data-note="${note}"], .black-key[data-note="${note}"]`);
                    if (key) {
                        // Trigger a click event to play the note
                        key.dispatchEvent(new MouseEvent('click'));
                    }

                    // If this is the last note, reset the buttons
                    if (index === notes.length - 1) {
                        setTimeout(() => {
                            resetPlaybackButtons();
                        }, 500);
                    }
                }, durations.slice(0, index).reduce((a, b) => a + b, 0));

                window.activeTimeouts.push(timeout);
            });
        }

        // Library of demo melodies
        const demoMelodies = {
            'twinkle': {
                name: 'Twinkle Twinkle Little Star',
                notes: ['C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4',
                    'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4', 'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
                    'C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4'],
                durations: [400, 400, 400, 400, 400, 400, 800, 400, 400, 400, 400, 400, 400, 800,
                    400, 400, 400, 400, 400, 400, 800, 400, 400, 400, 400, 400, 400, 800,
                    400, 400, 400, 400, 400, 400, 800, 400, 400, 400, 400, 400, 400, 800]
            },
            'joyful': {
                name: 'Ode to Joy (Beethoven)',
                notes: ['E4', 'E4', 'F4', 'G4', 'G4', 'F4', 'E4', 'D4', 'C4', 'C4', 'D4', 'E4', 'E4', 'D4', 'D4',
                    'E4', 'E4', 'F4', 'G4', 'G4', 'F4', 'E4', 'D4', 'C4', 'C4', 'D4', 'E4', 'D4', 'C4', 'C4',
                    'D4', 'D4', 'E4', 'C4', 'D4', 'E4', 'F4', 'E4', 'C4', 'D4', 'E4', 'F4', 'E4', 'D4', 'C4', 'D4', 'G3',
                    'E4', 'E4', 'F4', 'G4', 'G4', 'F4', 'E4', 'D4', 'C4', 'C4', 'D4', 'E4', 'D4', 'C4', 'C4'],
                durations: [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 600, 200, 800,
                    400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 600, 200, 800,
                    400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 800,
                    400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 600, 200, 800]
            },
            'fur-elise': {
                name: 'Für Elise (Beethoven)',
                notes: ['E5', 'D#5', 'E5', 'D#5', 'E5', 'B4', 'D5', 'C5', 'A4',
                    'C4', 'E4', 'A4', 'B4', 'E4', 'G#4', 'B4', 'C5',
                    'E4', 'E5', 'D#5', 'E5', 'D#5', 'E5', 'B4', 'D5', 'C5', 'A4',
                    'C4', 'E4', 'A4', 'B4', 'E4', 'C5', 'B4', 'A4',
                    'B4', 'C5', 'D5', 'E5', 'G4', 'F5', 'E5', 'D5',
                    'F4', 'E5', 'D5', 'C5', 'E4', 'D5', 'C5', 'B4',
                    'E4', 'E5', 'D#5', 'E5', 'D#5', 'E5', 'B4', 'D5', 'C5', 'A4',
                    'C4', 'E4', 'A4', 'B4', 'E4', 'C5', 'B4', 'A4'],
                durations: [300, 300, 300, 300, 300, 300, 300, 300, 900,
                    300, 300, 300, 900, 300, 300, 300, 900,
                    300, 300, 300, 300, 300, 300, 300, 300, 300, 900,
                    300, 300, 300, 900, 300, 300, 300, 900,
                    300, 300, 300, 900, 300, 300, 300, 900,
                    300, 300, 300, 900, 300, 300, 300, 900,
                    300, 300, 300, 300, 300, 300, 300, 300, 300, 900,
                    300, 300, 300, 900, 300, 300, 300, 900]
            },
            'jingle': {
                name: 'Jingle Bells',
                notes: ['E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'G4', 'C4', 'D4', 'E4',
                    'F4', 'F4', 'F4', 'F4', 'F4', 'E4', 'E4', 'E4', 'E4', 'E4', 'D4', 'D4', 'E4', 'D4', 'G4',
                    'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'G4', 'C4', 'D4', 'E4',
                    'F4', 'F4', 'F4', 'F4', 'F4', 'E4', 'E4', 'E4', 'E4', 'G4', 'G4', 'F4', 'D4', 'C4',
                    'G4', 'E4', 'D4', 'C4', 'A4', 'G4', 'A4', 'B4', 'B4', 'A4', 'G4', 'E4',
                    'G4', 'E4', 'D4', 'C4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4', 'G4',
                    'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'G4', 'C4', 'D4', 'E4',
                    'F4', 'F4', 'F4', 'F4', 'F4', 'E4', 'E4', 'E4', 'E4', 'G4', 'G4', 'F4', 'D4', 'C4'],
                durations: [300, 300, 600, 300, 300, 600, 300, 300, 600, 300, 900,
                    300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 600, 600,
                    300, 300, 600, 300, 300, 600, 300, 300, 600, 300, 900,
                    300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 900,
                    300, 300, 300, 900, 300, 300, 300, 900, 300, 300, 300, 900,
                    300, 300, 300, 900, 300, 300, 300, 300, 300, 600, 900,
                    300, 300, 600, 300, 300, 600, 300, 300, 600, 300, 900,
                    300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 900]
            },
            'canon': {
                name: 'Pachelbel\'s Canon in D',
                notes: ['D4', 'A4', 'B4', 'F#4', 'G4', 'D4', 'G4', 'A4',
                    'D4', 'F#4', 'A4', 'A4', 'G4', 'B4', 'A4', 'G4', 'F#4', 'G4', 'A4', 'D4',
                    'F#4', 'A4', 'D5', 'C#5', 'D5', 'A4', 'B4', 'G4', 'A4', 'F#4', 'G4', 'A4',
                    'F#4', 'E4', 'D4', 'E4', 'F#4', 'G4', 'A4', 'B4', 'G4', 'B4', 'A4', 'G4',
                    'A4', 'G4', 'F#4', 'E4', 'F#4', 'D4', 'D4', 'F#4', 'A4', 'G4', 'F#4', 'D4', 'E4', 'F#4',
                    'G4', 'E4', 'G4', 'F#4', 'E4', 'D4', 'E4', 'F#4', 'E4', 'D4', 'C#4', 'D4', 'D4'],
                durations: [400, 400, 400, 400, 400, 400, 400, 400,
                    400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 800,
                    400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400,
                    400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400,
                    400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400,
                    400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 800, 800]
            }
        };

        // Play a specific melody
        function playMelody(melodyKey) {
            const melody = demoMelodies[melodyKey];

            if (!melody) return;

            // Stop any currently playing melody
            stopAllPlayback();

            // Make sure audio context is resumed on user interaction
            if (window.audioContext && window.audioContext.state === 'suspended') {
                window.audioContext.resume();
            }

            // Disable all melody buttons during playback
            const buttons = document.querySelectorAll('.melody-btn');
            buttons.forEach(btn => btn.disabled = true);

            // Show the stop button
            document.getElementById('stop-all-melodies').style.display = 'inline-block';

            // Store timeouts so they can be cancelled
            window.melodyTimeouts = [];

            let totalDuration = 0;

            melody.notes.forEach((note, index) => {
                const timeout = setTimeout(() => {
                    // Check if playback has been stopped
                    if (!window.melodyTimeouts) return;

                    // Find the key with this note
                    const key = document.querySelector(`.white-key[data-note="${note}"], .black-key[data-note="${note}"]`);
                    if (key) {
                        // Trigger a click event to play the note
                        key.dispatchEvent(new MouseEvent('click'));
                    }

                    // Re-enable buttons after the last note
                    if (index === melody.notes.length - 1) {
                        setTimeout(() => {
                            resetMelodyButtons();
                        }, 500);
                    }
                }, totalDuration);

                window.melodyTimeouts.push(timeout);
                totalDuration += melody.durations[index];
            });
        }

        // Stop playback function for main demo
        function stopPlayback() {
            // Cancel all scheduled timeouts
            if (window.activeTimeouts && window.activeTimeouts.length) {
                window.activeTimeouts.forEach(timeout => clearTimeout(timeout));
                window.activeTimeouts = null;
            }

            // Reset button states
            resetPlaybackButtons();
        }

        // Stop all melody playback
        function stopAllPlayback() {
            // Stop demo melody
            if (window.activeTimeouts && window.activeTimeouts.length) {
                window.activeTimeouts.forEach(timeout => clearTimeout(timeout));
                window.activeTimeouts = null;
                resetPlaybackButtons();
            }

            // Stop other melodies
            if (window.melodyTimeouts && window.melodyTimeouts.length) {
                window.melodyTimeouts.forEach(timeout => clearTimeout(timeout));
                window.melodyTimeouts = null;
                resetMelodyButtons();
            }
        }

        // Reset buttons after playback ends or is stopped
        function resetPlaybackButtons() {
            document.getElementById('play-demo').style.display = 'inline-block';
            document.getElementById('stop-playback').style.display = 'none';
        }

        // Reset melody buttons
        function resetMelodyButtons() {
            const buttons = document.querySelectorAll('.melody-btn');
            buttons.forEach(btn => btn.disabled = false);
            document.getElementById('stop-all-melodies').style.display = 'none';
        }

        // Accordion functionality
        function initAccordion() {
            const accordionHeaders = document.querySelectorAll('.accordion-header');

            accordionHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const content = header.nextElementSibling;
                    const icon = header.querySelector('.accordion-icon');

                    // Toggle active class
                    content.classList.toggle('active');

                    // Change icon
                    icon.textContent = content.classList.contains('active') ? '−' : '+';
                });
            });
        }

        // Modal functionality
        function initModals() {
            const modalButtons = document.querySelectorAll('[data-modal]');
            const closeButtons = document.querySelectorAll('.close-modal');
            const modals = document.querySelectorAll('.modal');

            modalButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const modalId = button.getAttribute('data-modal');
                    const modal = document.getElementById(modalId);
                    modal.style.display = 'flex';
                });
            });

            closeButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const modal = button.closest('.modal');
                    modal.style.display = 'none';
                });
            });

            // Close modal when clicking outside content
            modals.forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.style.display = 'none';
                    }
                });
            });
        }

        // Practice Plan Generator
        function initPracticePlanForm() {
            const form = document.getElementById('practice-plan-form');
            const resultDiv = document.getElementById('plan-result');
            const planContent = document.getElementById('plan-content');

            form.addEventListener('submit', (e) => {
                e.preventDefault();

                const days = document.getElementById('practice-days').value;
                const time = document.getElementById('practice-time').value;
                const level = document.getElementById('skill-level').value;
                const goals = document.getElementById('goals').value;

                // Generate personalized plan based on inputs
                let plan = `<p>Based on your input, here's a personalized practice plan:</p>`;

                // Practice frequency
                plan += `<h4 style="margin-top: 1rem;">Practice Schedule</h4>`;
                plan += `<p>${days} days per week, ${time} minutes per session</p>`;

                // Session breakdown
                plan += `<h4 style="margin-top: 1rem;">Session Breakdown</h4>`;

                if (level === 'beginner' || level === 'early') {
                    plan += `
                        <ul style="margin-left: 1.5rem;">
                            <li><strong>Warm-up (${Math.round(time * 0.1)} min):</strong> Five-finger patterns, C major scale</li>
                            <li><strong>Technique (${Math.round(time * 0.2)} min):</strong> Basic finger exercises, proper hand position practice</li>
                            <li><strong>Reading (${Math.round(time * 0.3)} min):</strong> Practice reading notes on the staff</li>
                            <li><strong>Repertoire (${Math.round(time * 0.3)} min):</strong> Work on simple pieces</li>
                            <li><strong>Fun (${Math.round(time * 0.1)} min):</strong> Play something you enjoy</li>
                        </ul>
                    `;
                } else if (level === 'late') {
                    plan += `
                        <ul style="margin-left: 1.5rem;">
                            <li><strong>Warm-up (${Math.round(time * 0.1)} min):</strong> Major scales (C, G, F) and arpeggios</li>
                            <li><strong>Technique (${Math.round(time * 0.2)} min):</strong> Hanon exercises 1-5</li>
                            <li><strong>Sight-reading (${Math.round(time * 0.15)} min):</strong> Simple pieces below your level</li>
                            <li><strong>Repertoire (${Math.round(time * 0.4)} min):</strong> Work on current pieces</li>
                            <li><strong>Theory (${Math.round(time * 0.15)} min):</strong> Chord progressions, key signatures</li>
                        </ul>
                    `;
                } else {
                    plan += `
                        <ul style="margin-left: 1.5rem;">
                            <li><strong>Warm-up (${Math.round(time * 0.1)} min):</strong> Scales, arpeggios in multiple keys</li>
                            <li><strong>Technique (${Math.round(time * 0.15)} min):</strong> Advanced exercises, focus on problem areas</li>
                            <li><strong>Sight-reading (${Math.round(time * 0.1)} min):</strong> Varied repertoire</li>
                            <li><strong>Repertoire (${Math.round(time * 0.5)} min):</strong> Detailed work on current pieces</li>
                            <li><strong>Musicality (${Math.round(time * 0.15)} min):</strong> Expression, dynamics, phrasing</li>
                        </ul>
                    `;
                }

                // Weekly focus
                plan += `<h4 style="margin-top: 1rem;">Weekly Focus</h4>`;
                plan += `<p>Based on your goals: "${goals}", focus on:</p>`;

                if (goals.toLowerCase().includes('classical')) {
                    plan += `<p>Classical technique fundamentals, reading staff notation, and developing hand independence.</p>`;
                } else if (goals.toLowerCase().includes('jazz')) {
                    plan += `<p>Chord voicings, basic improvisation, and rhythmic patterns.</p>`;
                } else if (goals.toLowerCase().includes('pop')) {
                    plan += `<p>Chord progressions, rhythmic patterns, and basic accompaniment styles.</p>`;
                } else {
                    plan += `<p>Building a strong foundation through technique exercises, reading skills, and developing musicality.</p>`;
                }

                // Show the result
                planContent.innerHTML = plan;
                resultDiv.style.display = 'block';

                // Scroll to results
                resultDiv.scrollIntoView({ behavior: 'smooth' });
            });
        }

        // Form submission handlers
        function initFormHandlers() {
            const contactForm = document.getElementById('contact-form');
            const newsletterForm = document.getElementById('newsletter-form');
            const communityForm = document.getElementById('community-form');

            // Contact form
            if (contactForm) {
                contactForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    alert('Thank you for your message! We will respond shortly.');
                    contactForm.reset();
                    document.getElementById('contact-modal').style.display = 'none';
                });
            }

            // Newsletter form
            if (newsletterForm) {
                newsletterForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    alert('Thank you for subscribing to our newsletter!');
                    newsletterForm.reset();
                    document.getElementById('newsletter-modal').style.display = 'none';
                });
            }

            // Community form
            if (communityForm) {
                communityForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    alert('Welcome to our piano community! Check your email for confirmation and next steps.');
                    communityForm.reset();
                    document.getElementById('community-modal').style.display = 'none';
                });
            }
        }

        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            createPianoKeyboard();
            initAccordion();
            initModals();
            initPracticePlanForm();
            initFormHandlers();

            // Demo melody button
            const demoButton = document.getElementById('play-demo');
            demoButton.addEventListener('click', playDemoMelody);

            // Stop playback button
            const stopButton = document.getElementById('stop-playback');
            stopButton.addEventListener('click', stopPlayback);

            // Stop all melodies button
            const stopAllButton = document.getElementById('stop-all-melodies');
            stopAllButton.addEventListener('click', stopAllPlayback);

            // Setup melody buttons
            document.querySelectorAll('.melody-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const melodyKey = e.target.dataset.melody;
                    if (melodyKey) {
                        playMelody(melodyKey);
                    }
                });
            });

            // Start journey button
            const startJourneyBtn = document.getElementById('start-journey-btn');
            startJourneyBtn.addEventListener('click', () => {
                document.getElementById('beginner').scrollIntoView({ behavior: 'smooth' });
            });

            // Ensure window resize repositions black keys properly
            window.addEventListener('resize', positionBlackKeys);
        });
    </script>
</body>

</html>