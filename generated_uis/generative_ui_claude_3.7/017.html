<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Commerce Customer Lifetime Value Analysis</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --primary-dark: #3a0ca3;
            --secondary: #f72585;
            --success: #4cc9f0;
            --warning: #ffd166;
            --danger: #ef476f;
            --light: #f8f9fa;
            --dark: #212529;
            --gray-100: #f8f9fa;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-400: #ced4da;
            --gray-500: #adb5bd;
            --gray-600: #6c757d;
            --gray-700: #495057;
            --gray-800: #343a40;
            --gray-900: #212529;
            --border-radius: 8px;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--gray-100);
            color: var(--gray-800);
            line-height: 1.6;
        }

        .app-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            grid-template-rows: 60px 1fr;
            grid-template-areas: 
                "header header"
                "sidebar main";
            height: 100vh;
        }

        .header {
            grid-area: header;
            background-color: white;
            box-shadow: var(--shadow-sm);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 10;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            font-size: 1.2rem;
            color: var(--primary);
        }

        .logo .material-symbols-rounded {
            font-size: 1.8rem;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .user-profile:hover {
            background-color: var(--gray-200);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .sidebar {
            grid-area: sidebar;
            background-color: white;
            border-right: 1px solid var(--gray-300);
            padding: 20px 0;
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 20px;
        }

        .sidebar-title {
            padding: 0 20px;
            margin-bottom: 10px;
            font-size: 0.8rem;
            text-transform: uppercase;
            color: var(--gray-600);
            font-weight: 600;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu-item {
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: var(--transition);
            color: var(--gray-700);
        }

        .sidebar-menu-item:hover {
            background-color: var(--gray-200);
            color: var(--primary);
        }

        .sidebar-menu-item.active {
            background-color: var(--primary-light);
            color: white;
            font-weight: 500;
        }

        .main-content {
            grid-area: main;
            padding: 20px;
            overflow-y: auto;
        }

        .page-title {
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--gray-800);
        }

        .workflow-steps {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .workflow-step {
            flex: 1;
            min-width: 150px;
            background-color: white;
            border-radius: var(--border-radius);
            padding: 15px;
            box-shadow: var(--shadow-sm);
            position: relative;
            cursor: pointer;
            transition: var(--transition);
        }

        .workflow-step:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        .workflow-step.active {
            border-left: 4px solid var(--primary);
        }

        .workflow-step-number {
            position: absolute;
            top: -10px;
            left: -10px;
            width: 30px;
            height: 30px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .workflow-step-title {
            font-weight: 600;
            margin-bottom: 5px;
            padding-left: 10px;
        }

        .workflow-step-description {
            font-size: 0.85rem;
            color: var(--gray-600);
        }

        .card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
            margin-bottom: 20px;
            overflow: hidden;
        }

        .card-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--gray-300);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--gray-800);
        }

        .card-actions {
            display: flex;
            gap: 10px;
        }

        .card-body {
            padding: 20px;
        }

        .tab-container {
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-300);
            margin-bottom: 15px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 2px solid transparent;
            font-weight: 500;
        }

        .tab:hover {
            color: var(--primary);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--gray-700);
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--gray-400);
            border-radius: var(--border-radius);
            font-family: inherit;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }

        .form-select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--gray-400);
            border-radius: var(--border-radius);
            font-family: inherit;
            font-size: 1rem;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%236c757d' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px 16px;
            border-radius: var(--border-radius);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-family: inherit;
            font-size: 0.95rem;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--gray-400);
            color: var(--gray-700);
        }

        .btn-outline:hover {
            background-color: var(--gray-200);
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-success:hover {
            background-color: #3ab6db;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .stat-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            display: flex;
            flex-direction: column;
        }

        .stat-title {
            font-size: 0.9rem;
            color: var(--gray-600);
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85rem;
        }

        .trend-up {
            color: #10b981;
        }

        .trend-down {
            color: #ef4444;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 20px;
        }

        .dropzone {
            border: 2px dashed var(--gray-400);
            border-radius: var(--border-radius);
            padding: 30px;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .dropzone:hover {
            border-color: var(--primary);
        }

        .dropzone-icon {
            font-size: 3rem;
            color: var(--gray-500);
            margin-bottom: 10px;
        }

        .dropzone-text {
            margin-bottom: 15px;
            color: var(--gray-700);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--gray-300);
        }

        .data-table th {
            background-color: var(--gray-100);
            font-weight: 600;
            color: var(--gray-700);
        }

        .data-table tr:hover {
            background-color: var(--gray-100);
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .badge-primary {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        .badge-success {
            background-color: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background-color: rgba(255, 209, 102, 0.1);
            color: var(--warning);
        }

        .badge-danger {
            background-color: rgba(239, 71, 111, 0.1);
            color: var(--danger);
        }

        .segment-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 15px;
            box-shadow: var(--shadow-sm);
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: var(--transition);
        }

        .segment-card:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow-md);
        }

        .segment-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .segment-info {
            flex: 1;
        }

        .segment-title {
            font-weight: 600;
            margin-bottom: 3px;
        }

        .segment-description {
            font-size: 0.85rem;
            color: var(--gray-600);
        }

        .segment-value {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--primary);
        }

        .insight-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 15px;
            box-shadow: var(--shadow-sm);
            margin-bottom: 15px;
            border-left: 4px solid var(--primary);
        }

        .insight-title {
            font-weight: 600;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .insight-description {
            font-size: 0.9rem;
            color: var(--gray-700);
            margin-bottom: 10px;
        }

        .insight-action {
            font-size: 0.85rem;
            color: var(--primary);
            font-weight: 500;
            cursor: pointer;
        }

        .insight-action:hover {
            text-decoration: underline;
        }

        .floating-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            background: white;
            padding: 10px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-md);
            z-index: 10;
            display: none;
        }

        .chart-container:hover .floating-controls {
            display: block;
        }

        .control-group {
            margin-bottom: 10px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        @media (max-width: 1024px) {
            .app-container {
                grid-template-columns: 1fr;
                grid-template-areas: 
                    "header"
                    "main";
            }

            .sidebar {
                display: none;
            }

            .grid-3 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }

            .workflow-steps {
                flex-direction: column;
                gap: 10px;
            }

            .workflow-step {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <div class="logo">
                <span class="material-symbols-rounded">insights</span>
                <span>CLV Analyzer</span>
            </div>
            <div class="user-menu">
                <div class="user-profile">
                    <div class="user-avatar">A</div>
                    <span>Admin</span>
                </div>
            </div>
        </header>

        <aside class="sidebar">
            <div class="sidebar-section">
                <h3 class="sidebar-title">Analysis</h3>
                <ul class="sidebar-menu">
                    <li class="sidebar-menu-item active">
                        <span class="material-symbols-rounded">dashboard</span>
                        <span>Dashboard</span>
                    </li>
                    <li class="sidebar-menu-item">
                        <span class="material-symbols-rounded">upload_file</span>
                        <span>Data Upload</span>
                    </li>
                    <li class="sidebar-menu-item">
                        <span class="material-symbols-rounded">table_chart</span>
                        <span>Data Explorer</span>
                    </li>
                    <li class="sidebar-menu-item">
                        <span class="material-symbols-rounded">monitoring</span>
                        <span>CLV Analysis</span>
                    </li>
                    <li class="sidebar-menu-item">
                        <span class="material-symbols-rounded">group</span>
                        <span>Segmentation</span>
                    </li>
                </ul>
            </div>

            <div class="sidebar-section">
                <h3 class="sidebar-title">Reports</h3>
                <ul class="sidebar-menu">
                    <li class="sidebar-menu-item">
                        <span class="material-symbols-rounded">insights</span>
                        <span>Insights</span>
                    </li>
                    <li class="sidebar-menu-item">
                        <span class="material-symbols-rounded">description</span>
                        <span>Reports</span>
                    </li>
                    <li class="sidebar-menu-item">
                        <span class="material-symbols-rounded">share</span>
                        <span>Export</span>
                    </li>
                </ul>
            </div>

            <div class="sidebar-section">
                <h3 class="sidebar-title">Settings</h3>
                <ul class="sidebar-menu">
                    <li class="sidebar-menu-item">
                        <span class="material-symbols-rounded">settings</span>
                        <span>Preferences</span>
                    </li>
                    <li class="sidebar-menu-item">
                        <span class="material-symbols-rounded">help</span>
                        <span>Help</span>
                    </li>
                </ul>
            </div>
        </aside>

        <main class="main-content">
            <h1 class="page-title">E-Commerce Customer Lifetime Value Analysis</h1>

            <div class="workflow-steps">
                <div class="workflow-step active">
                    <div class="workflow-step-number">1</div>
                    <h3 class="workflow-step-title">Data Upload</h3>
                    <p class="workflow-step-description">Import your customer purchase data</p>
                </div>
                <div class="workflow-step">
                    <div class="workflow-step-number">2</div>
                    <h3 class="workflow-step-title">Data Exploration</h3>
                    <p class="workflow-step-description">Review and understand your data</p>
                </div>
                <div class="workflow-step">
                    <div class="workflow-step-number">3</div>
                    <h3 class="workflow-step-title">CLV Analysis</h3>
                    <p class="workflow-step-description">Calculate and analyze customer lifetime value</p>
                </div>
                <div class="workflow-step">
                    <div class="workflow-step-number">4</div>
                    <h3 class="workflow-step-title">Segmentation</h3>
                    <p class="workflow-step-description">Group customers by behavior and value</p>
                </div>
                <div class="workflow-step">
                    <div class="workflow-step-number">5</div>
                    <h3 class="workflow-step-title">Insights</h3>
                    <p class="workflow-step-description">Generate actionable recommendations</p>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Data Upload</h2>
                    <div class="card-actions">
                        <button class="btn btn-outline btn-sm">
                            <span class="material-symbols-rounded">help</span>
                            <span>Help</span>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="tab-container">
                        <div class="tabs">
                            <div class="tab active" data-tab="upload">File Upload</div>
                            <div class="tab" data-tab="connect">Database Connection</div>
                            <div class="tab" data-tab="sample">Sample Data</div>
                        </div>
                        <div class="tab-content active" id="upload">
                            <div class="dropzone" id="dropzone">
                                <div class="dropzone-icon">
                                    <span class="material-symbols-rounded">cloud_upload</span>
                                </div>
                                <h3 class="dropzone-text">Drag and drop your CSV or Excel file here</h3>
                                <p>or</p>
                                <button class="btn btn-primary" id="fileSelectBtn">
                                    <span class="material-symbols-rounded">upload_file</span>
                                    <span>Select File</span>
                                </button>
                                <input type="file" id="fileInput" style="display: none;" accept=".csv, .xlsx, .xls">
                            </div>
                        </div>
                        <div class="tab-content" id="connect">
                            <div class="form-group">
                                <label class="form-label">Connection Type</label>
                                <select class="form-select">
                                    <option>MySQL</option>
                                    <option>PostgreSQL</option>
                                    <option>SQL Server</option>
                                    <option>MongoDB</option>
                                    <option>Google BigQuery</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Host / Server</label>
                                <input type="text" class="form-control" placeholder="e.g., localhost or db.example.com">
                            </div>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label class="form-label">Port</label>
                                    <input type="text" class="form-control" placeholder="e.g., 3306">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Database Name</label>
                                    <input type="text" class="form-control" placeholder="e.g., ecommerce_data">
                                </div>
                            </div>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label class="form-label">Username</label>
                                    <input type="text" class="form-control" placeholder="Database username">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Password</label>
                                    <input type="password" class="form-control" placeholder="Database password">
                                </div>
                            </div>
                            <button class="btn btn-primary">
                                <span class="material-symbols-rounded">link</span>
                                <span>Connect to Database</span>
                            </button>
                        </div>
                        <div class="tab-content" id="sample">
                            <p style="margin-bottom: 15px;">Use our pre-loaded sample data to explore the platform's capabilities.</p>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label class="form-label">Sample Dataset</label>
                                    <select class="form-select">
                                        <option>E-commerce - Home Goods (3 years)</option>
                                        <option>E-commerce - Fashion (2 years)</option>
                                        <option>E-commerce - Electronics (1 year)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Data Size</label>
                                    <select class="form-select">
                                        <option>Small (5,000 customers)</option>
                                        <option>Medium (25,000 customers)</option>
                                        <option>Large (100,000 customers)</option>
                                    </select>
                                </div>
                            </div>
                            <button class="btn btn-primary">
                                <span class="material-symbols-rounded">download</span>
                                <span>Load Sample Data</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Data Summary</h2>
                    <div class="card-actions">
                        <button class="btn btn-outline btn-sm">
                            <span class="material-symbols-rounded">refresh</span>
                            <span>Refresh</span>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="grid-3">
                        <div class="stat-card">
                            <div class="stat-title">Total Customers</div>
                            <div class="stat-value">24,853</div>
                            <div class="stat-trend trend-up">
                                <span class="material-symbols-rounded">trending_up</span>
                                <span>12.5% vs. previous year</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">Total Transactions</div>
                            <div class="stat-value">68,421</div>
                            <div class="stat-trend trend-up">
                                <span class="material-symbols-rounded">trending_up</span>
                                <span>8.3% vs. previous year</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">Average Order Value</div>
                            <div class="stat-value">$78.32</div>
                            <div class="stat-trend trend-up">
                                <span class="material-symbols-rounded">trending_up</span>
                                <span>3.2% vs. previous year</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">Repeat Purchase Rate</div>
                            <div class="stat-value">42.7%</div>
                            <div class="stat-trend trend-down">
                                <span class="material-symbols-rounded">trending_down</span>
                                <span>1.8% vs. previous year</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">Average CLV</div>
                            <div class="stat-value">$312.45</div>
                            <div class="stat-trend trend-up">
                                <span class="material-symbols-rounded">trending_up</span>
                                <span>5.7% vs. previous year</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">Time Period</div>
                            <div class="stat-value">3 Years</div>
                            <div class="stat-trend">
                                <span>Jan 2020 - Dec 2022</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid-2">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">CLV Distribution</h2>
                        <div class="card-actions">
                            <button class="btn btn-outline btn-sm">
                                <span class="material-symbols-rounded">fullscreen</span>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="clvDistributionChart"></canvas>
                            <div class="floating-controls" id="clvDistributionControls">
                                <div class="control-group">
                                    <label class="form-label">Chart Type</label>
                                    <select class="form-select" id="clvChartType">
                                        <option value="bar">Bar Chart</option>
                                        <option value="line">Line Chart</option>
                                        <option value="pie">Pie Chart</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <label class="form-label">Segment By</label>
                                    <select class="form-select" id="clvSegmentBy">
                                        <option value="all">All Customers</option>
                                        <option value="age">Age Group</option>
                                        <option value="gender">Gender</option>
                                        <option value="location">Location</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <label class="form-label">Time Period</label>
                                    <select class="form-select" id="clvTimePeriod">
                                        <option value="all">All Time</option>
                                        <option value="year">Last Year</option>
                                        <option value="6months">Last 6 Months</option>
                                        <option value="quarter">Last Quarter</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Purchase Frequency</h2>
                        <div class="card-actions">
                            <button class="btn btn-outline btn-sm">
                                <span class="material-symbols-rounded">fullscreen</span>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="purchaseFrequencyChart"></canvas>
                            <div class="floating-controls" id="purchaseFrequencyControls">
                                <div class="control-group">
                                    <label class="form-label">Chart Type</label>
                                    <select class="form-select" id="frequencyChartType">
                                        <option value="line">Line Chart</option>
                                        <option value="bar">Bar Chart</option>
                                        <option value="scatter">Scatter Plot</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <label class="form-label">Group By</label>
                                    <select class="form-select" id="frequencyGroupBy">
                                        <option value="month">Month</option>
                                        <option value="quarter">Quarter</option>
                                        <option value="year">Year</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <label class="form-label">Customer Segment</label>
                                    <select class="form-select" id="frequencyCustomerSegment">
                                        <option value="all">All Customers</option>
                                        <option value="high">High Value</option>
                                        <option value="medium">Medium Value</option>
                                        <option value="low">Low Value</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">CLV Analysis Configuration</h2>
                    <div class="card-actions">
                        <button class="btn btn-outline btn-sm">
                            <span class="material-symbols-rounded">settings</span>
                            <span>Advanced</span>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="grid-2">
                        <div>
                            <div class="form-group">
                                <label class="form-label">CLV Model</label>
                                <select class="form-select" id="clvModel">
                                    <option value="simple">Simple Historic CLV</option>
                                    <option value="predictive">Predictive CLV (RFM-based)</option>
                                    <option value="probabilistic">Probabilistic Model (BG/NBD)</option>
                                    <option value="ml">Machine Learning Model</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Time Horizon</label>
                                <select class="form-select" id="timeHorizon">
                                    <option value="1">1 Year</option>
                                    <option value="2">2 Years</option>
                                    <option value="3">3 Years</option>
                                    <option value="5">5 Years</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Discount Rate (%)</label>
                                <input type="number" class="form-control" id="discountRate" value="10" min="0" max="100">
                            </div>
                        </div>
                        <div>
                            <div class="form-group">
                                <label class="form-label">Include Features</label>
                                <div style="display: flex; flex-direction: column; gap: 8px; margin-top: 5px;">
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" checked> Transaction History
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" checked> Demographics
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" checked> Browsing Behavior
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox" checked> Survey Responses
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px;">
                                        <input type="checkbox"> Marketing Touchpoints
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button class="btn btn-primary" id="runAnalysisBtn">
                            <span class="material-symbols-rounded">play_arrow</span>
                            <span>Run Analysis</span>
                        </button>
                        <button class="btn btn-outline">
                            <span class="material-symbols-rounded">save</span>
                            <span>Save Configuration</span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Customer Segmentation</h2>
                    <div class="card-actions">
                        <button class="btn btn-outline btn-sm">
                            <span class="material-symbols-rounded">tune</span>
                            <span>Customize</span>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="grid-2">
                        <div>
                            <div class="segment-card">
                                <div class="segment-icon" style="background-color: rgba(76, 201, 240, 0.1); color: var(--success);">
                                    <span class="material-symbols-rounded">diamond</span>
                                </div>
                                <div class="segment-info">
                                    <h3 class="segment-title">High-Value Loyalists</h3>
                                    <p class="segment-description">Frequent buyers with high AOV</p>
                                </div>
                                <div class="segment-value">18%</div>
                            </div>
                            <div class="segment-card">
                                <div class="segment-icon" style="background-color: rgba(67, 97, 238, 0.1); color: var(--primary);">
                                    <span class="material-symbols-rounded">workspace_premium</span>
                                </div>
                                <div class="segment-info">
                                    <h3 class="segment-title">Potential High-Value</h3>
                                    <p class="segment-description">Recent high-value purchases</p>
                                </div>
                                <div class="segment-value">23%</div>
                            </div>
                            <div class="segment-card">
                                <div class="segment-icon" style="background-color: rgba(255, 209, 102, 0.1); color: var(--warning);">
                                    <span class="material-symbols-rounded">star_half</span>
                                </div>
                                <div class="segment-info">
                                    <h3 class="segment-title">Mid-Value Regulars</h3>
                                    <p class="segment-description">Consistent medium-value purchases</p>
                                </div>
                                <div class="segment-value">32%</div>
                            </div>
                            <div class="segment-card">
                                <div class="segment-icon" style="background-color: rgba(239, 71, 111, 0.1); color: var(--danger);">
                                    <span class="material-symbols-rounded">heart_broken</span>
                                </div>
                                <div class="segment-info">
                                    <h3 class="segment-title">At-Risk Customers</h3>
                                    <p class="segment-description">Previously active, now declining</p>
                                </div>
                                <div class="segment-value">15%</div>
                            </div>
                            <div class="segment-card">
                                <div class="segment-icon" style="background-color: rgba(108, 117, 125, 0.1); color: var(--gray-600);">
                                    <span class="material-symbols-rounded">person</span>
                                </div>
                                <div class="segment-info">
                                    <h3 class="segment-title">One-Time Buyers</h3>
                                    <p class="segment-description">Single purchase only</p>
                                </div>
                                <div class="segment-value">12%</div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="segmentationChart"></canvas>
                            <div class="floating-controls" id="segmentationControls">
                                <div class="control-group">
                                    <label class="form-label">Chart Type</label>
                                    <select class="form-select" id="segmentChartType">
                                        <option value="pie">Pie Chart</option>
                                        <option value="doughnut">Doughnut Chart</option>
                                        <option value="bar">Bar Chart</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <label class="form-label">Segmentation Method</label>
                                    <select class="form-select" id="segmentMethod">
                                        <option value="rfm">RFM Analysis</option>
                                        <option value="clv">CLV-based</option>
                                        <option value="behavior">Behavioral</option>
                                        <option value="kmeans">K-means Clustering</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <label class="form-label">Number of Segments</label>
                                    <select class="form-select" id="segmentCount">
                                        <option value="3">3 Segments</option>
                                        <option value="5" selected>5 Segments</option>
                                        <option value="7">7 Segments</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Key Insights & Recommendations</h2>
                    <div class="card-actions">
                        <button class="btn btn-success btn-sm">
                            <span class="material-symbols-rounded">download</span>
                            <span>Export Report</span>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="insight-card">
                        <h3 class="insight-title">
                            <span class="material-symbols-rounded">trending_up</span>
                            <span>Product Category Impact on CLV</span>
                        </h3>
                        <p class="insight-description">Customers who purchase from the "Kitchen & Dining" category have 2.3x higher CLV than those who only purchase from "Decorative Accessories". First-time buyers who purchase kitchen products are 68% more likely to make a second purchase within 30 days.</p>
                        <div class="insight-action">View detailed analysis</div>
                    </div>
                    <div class="insight-card">
                        <h3 class="insight-title">
                            <span class="material-symbols-rounded">schedule</span>
                            <span>Optimal Repurchase Timing</span>
                        </h3>
                        <p class="insight-description">The optimal time to target customers for repeat purchases is 45-60 days after their last purchase. Email campaigns sent during this window have shown a 34% higher conversion rate compared to campaigns sent outside this timeframe.</p>
                        <div class="insight-action">View detailed analysis</div>
                    </div>
                    <div class="insight-card">
                        <h3 class="insight-title">
                            <span class="material-symbols-rounded">group</span>
                            <span>High-Value Customer Profile</span>
                        </h3>
                        <p class="insight-description">High-value customers (top 20% by CLV) share common characteristics: they browse the site 2.8x more frequently than average, spend 4.5 minutes longer per session, and are 3.2x more likely to use the wishlist feature. They also respond positively to exclusive early-access promotions.</p>
                        <div class="insight-action">View detailed analysis</div>
                    </div>
                    <div class="insight-card">
                        <h3 class="insight-title">
                            <span class="material-symbols-rounded">heart_broken</span>
                            <span>Churn Risk Factors</span>
                        </h3>
                        <p class="insight-description">Customers who experience shipping delays on their first order are 72% more likely to churn. Additionally, customers who submit support tickets regarding product quality have a 58% lower repeat purchase rate. Implementing proactive communication about shipping and enhanced quality control could reduce churn by an estimated 23%.</p>
                        <div class="insight-action">View detailed analysis</div>
                    </div>
                    <div class="insight-card">
                        <h3 class="insight-title">
                            <span class="material-symbols-rounded">campaign</span>
                            <span>Marketing Channel Effectiveness</span>
                        </h3>
                        <p class="insight-description">Customers acquired through Instagram have 1.8x higher CLV than those from Google Ads, despite having a 15% higher CAC. Email marketing to existing customers generates the highest ROI, with targeted product recommendations based on browsing history increasing average order value by 27%.</p>
                        <div class="insight-action">View detailed analysis</div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script type="module">
        import { Chart } from "https://esm.sh/chart.js/auto";

        // Tab switching functionality
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                
                // Update active tab
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Update active content
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                document.getElementById(tabId).classList.add('active');
            });
        });

        // File upload functionality
        const dropzone = document.getElementById('dropzone');
        const fileInput = document.getElementById('fileInput');
        const fileSelectBtn = document.getElementById('fileSelectBtn');

        fileSelectBtn.addEventListener('click', () => {
            fileInput.click();
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        dropzone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropzone.style.borderColor = 'var(--primary)';
            dropzone.style.backgroundColor = 'rgba(67, 97, 238, 0.05)';
        });

        dropzone.addEventListener('dragleave', () => {
            dropzone.style.borderColor = 'var(--gray-400)';
            dropzone.style.backgroundColor = 'transparent';
        });

        dropzone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropzone.style.borderColor = 'var(--gray-400)';
            dropzone.style.backgroundColor = 'transparent';
            
            if (e.dataTransfer.files.length > 0) {
                handleFile(e.dataTransfer.files[0]);
            }
        });

        function handleFile(file) {
            // In a real application, this would process the file
            console.log(`File selected: ${file.name} (${file.type})`);
            
            // Show a success message
            dropzone.innerHTML = `
                <div style="color: var(--success); font-size: 3rem; margin-bottom: 10px;">
                    <span class="material-symbols-rounded">check_circle</span>
                </div>
                <h3 style="margin-bottom: 10px;">File uploaded successfully!</h3>
                <p style="margin-bottom: 15px;">${file.name} (${(file.size / (1024 * 1024)).toFixed(2)} MB)</p>
                <button class="btn btn-outline" id="resetUploadBtn">
                    <span class="material-symbols-rounded">refresh</span>
                    <span>Upload Another File</span>
                </button>
            `;
            
            document.getElementById('resetUploadBtn').addEventListener('click', resetUpload);
        }

        function resetUpload() {
            dropzone.innerHTML = `
                <div class="dropzone-icon">
                    <span class="material-symbols-rounded">cloud_upload</span>
                </div>
                <h3 class="dropzone-text">Drag and drop your CSV or Excel file here</h3>
                <p>or</p>
                <button class="btn btn-primary" id="fileSelectBtn">
                    <span class="material-symbols-rounded">upload_file</span>
                    <span>Select File</span>
                </button>
                <input type="file" id="fileInput" style="display: none;" accept=".csv, .xlsx, .xls">
            `;
            
            document.getElementById('fileSelectBtn').addEventListener('click', () => {
                document.getElementById('fileInput').click();
            });
            
            document.getElementById('fileInput').addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFile(e.target.files[0]);
                }
            });
        }

        // CLV Distribution Chart
        const clvDistributionCtx = document.getElementById('clvDistributionChart').getContext('2d');
        const clvDistributionChart = new Chart(clvDistributionCtx, {
            type: 'bar',
            data: {
                labels: ['$0-100', '$101-200', '$201-300', '$301-400', '$401-500', '$501-600', '$601-700', '$701+'],
                datasets: [{
                    label: 'Number of Customers',
                    data: [3250, 5420, 6780, 4320, 2540, 1320, 780, 443],
                    backgroundColor: 'rgba(67, 97, 238, 0.7)',
                    borderColor: 'rgba(67, 97, 238, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `Customers: ${context.raw.toLocaleString()}`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Number of Customers'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Customer Lifetime Value (CLV)'
                        }
                    }
                }
            }
        });

        // Purchase Frequency Chart
        const purchaseFrequencyCtx = document.getElementById('purchaseFrequencyChart').getContext('2d');
        const purchaseFrequencyChart = new Chart(purchaseFrequencyCtx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [{
                    label: 'First-time Buyers',
                    data: [820, 750, 840, 910, 980, 1050, 1120, 1080, 990, 1150, 1280, 1350],
                    borderColor: 'rgba(76, 201, 240, 1)',
                    backgroundColor: 'rgba(76, 201, 240, 0.1)',
                    tension: 0.3,
                    fill: true
                }, {
                    label: 'Repeat Customers',
                    data: [520, 580, 650, 720, 780, 850, 920, 980, 1050, 1150, 1280, 1420],
                    borderColor: 'rgba(67, 97, 238, 1)',
                    backgroundColor: 'rgba(67, 97, 238, 0.1)',
                    tension: 0.3,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Number of Purchases'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Month (2022)'
                        }
                    }
                }
            }
        });

        // Segmentation Chart
        const segmentationCtx = document.getElementById('segmentationChart').getContext('2d');
        const segmentationChart = new Chart(segmentationCtx, {
            type: 'pie',
            data: {
                labels: ['High-Value Loyalists', 'Potential High-Value', 'Mid-Value Regulars', 'At-Risk Customers', 'One-Time Buyers'],
                datasets: [{
                    data: [18, 23, 32, 15, 12],
                    backgroundColor: [
                        'rgba(76, 201, 240, 0.7)',
                        'rgba(67, 97, 238, 0.7)',
                        'rgba(255, 209, 102, 0.7)',
                        'rgba(239, 71, 111, 0.7)',
                        'rgba(108, 117, 125, 0.7)'
                    ],
                    borderColor: [
                        'rgba(76, 201, 240, 1)',
                        'rgba(67, 97, 238, 1)',
                        'rgba(255, 209, 102, 1)',
                        'rgba(239, 71, 111, 1)',
                        'rgba(108, 117, 125, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right',
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.label}: ${context.raw}% of customers`;
                            }
                        }
                    }
                }
            }
        });

        // Chart controls functionality
        document.getElementById('clvChartType').addEventListener('change', (e) => {
            clvDistributionChart.config.type = e.target.value;
            clvDistributionChart.update();
        });

        document.getElementById('frequencyChartType').addEventListener('change', (e) => {
            purchaseFrequencyChart.config.type = e.target.value;
            purchaseFrequencyChart.update();
        });

        document.getElementById('segmentChartType').addEventListener('change', (e) => {
            segmentationChart.config.type = e.target.value;
            segmentationChart.update();
        });

        // Run Analysis button functionality
        document.getElementById('runAnalysisBtn').addEventListener('click', () => {
            const btn = document.getElementById('runAnalysisBtn');
            const originalText = btn.innerHTML;
            
            // Show loading state
            btn.innerHTML = `
                <span class="material-symbols-rounded">hourglass_top</span>
                <span>Running Analysis...</span>
            `;
            btn.disabled = true;
            
            // Simulate analysis running
            setTimeout(() => {
                btn.innerHTML = `
                    <span class="material-symbols-rounded">check_circle</span>
                    <span>Analysis Complete</span>
                `;
                
                // Reset button after a delay
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 2000);
            }, 3000);
        });
    </script>
</body>
</html>