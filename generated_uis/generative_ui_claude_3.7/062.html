<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mixed-Methods Research Dashboard</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0">
    <style>
        :root {
            --primary: #2E7D32;
            --primary-light: #4CAF50;
            --primary-dark: #1B5E20;
            --secondary: #546E7A;
            --accent: #FF7043;
            --background: #FFFFFF;
            --surface: #F5F5F5;
            --error: #D32F2F;
            --text-primary: #212121;
            --text-secondary: #757575;
            --border: #E0E0E0;
            --shadow: rgba(0, 0, 0, 0.1);
            --radius: 8px;
            --spacing: 16px;
            --transition: 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--surface);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--spacing);
        }

        header {
            background-color: var(--primary);
            color: white;
            padding: 20px var(--spacing);
            box-shadow: 0 2px 4px var(--shadow);
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            font-size: 1.5rem;
        }

        .logo-icon {
            font-size: 2rem;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 24px;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            padding: 8px 0;
            position: relative;
            transition: color var(--transition);
        }

        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background-color: white;
            transform: scaleX(0);
            transition: transform var(--transition);
        }

        nav a:hover {
            color: rgba(255, 255, 255, 0.9);
        }

        nav a:hover::after {
            transform: scaleX(1);
        }

        nav a.active::after {
            transform: scaleX(1);
        }

        .dashboard {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: var(--spacing);
            margin-top: var(--spacing);
        }

        .sidebar {
            background-color: var(--background);
            border-radius: var(--radius);
            padding: var(--spacing);
            box-shadow: 0 2px 4px var(--shadow);
            height: calc(100vh - 140px);
            overflow-y: auto;
            position: sticky;
            top: var(--spacing);
        }

        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }

        .data-sources {
            margin-bottom: 24px;
        }

        .data-source {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: var(--radius);
            cursor: pointer;
            transition: background-color var(--transition);
        }

        .data-source:hover {
            background-color: var(--surface);
        }

        .data-source.active {
            background-color: rgba(46, 125, 50, 0.1);
            border-left: 3px solid var(--primary);
        }

        .data-source-icon {
            font-size: 1.5rem;
            color: var(--secondary);
        }

        .data-source.active .data-source-icon {
            color: var(--primary);
        }

        .data-source-info {
            flex: 1;
        }

        .data-source-title {
            font-weight: 500;
            margin-bottom: 2px;
        }

        .data-source-meta {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .filters-section {
            margin-top: 24px;
        }

        .filter-group {
            margin-bottom: 16px;
        }

        .filter-label {
            font-weight: 500;
            margin-bottom: 8px;
            display: block;
        }

        .filter-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background-color: var(--background);
            font-family: 'Inter', sans-serif;
            transition: border-color var(--transition);
        }

        .filter-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(46, 125, 50, 0.1);
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            accent-color: var(--primary);
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-item label {
            cursor: pointer;
        }

        .content {
            display: grid;
            grid-template-rows: auto 1fr;
            gap: var(--spacing);
        }

        .tabs {
            display: flex;
            background-color: var(--background);
            border-radius: var(--radius);
            box-shadow: 0 2px 4px var(--shadow);
            overflow: hidden;
        }

        .tab {
            padding: 16px 24px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition);
            border-bottom: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .tab::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary);
            transform: scaleX(0);
            transition: transform var(--transition);
            transform-origin: left;
        }

        .tab:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .tab.active {
            color: var(--primary);
        }

        .tab.active::after {
            transform: scaleX(1);
        }

        .panels {
            display: grid;
            grid-template-columns: 1fr;
            grid-template-rows: 1fr;
        }

        .panel {
            background-color: var(--background);
            border-radius: var(--radius);
            padding: var(--spacing);
            box-shadow: 0 2px 4px var(--shadow);
            overflow: auto;
            display: none;
            height: calc(100vh - 220px);
        }

        .panel.active {
            display: block;
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }

        .panel-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .panel-actions {
            display: flex;
            gap: 8px;
        }

        .btn {
            padding: 8px 16px;
            border-radius: var(--radius);
            font-weight: 500;
            cursor: pointer;
            transition: background-color var(--transition);
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background-color: #455A64;
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--border);
            color: var(--text-primary);
        }

        .btn-outline:hover {
            background-color: var(--surface);
        }

        .map-container {
            height: 100%;
            border-radius: var(--radius);
            overflow: hidden;
            position: relative;
        }

        .map-legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 10px;
            border-radius: var(--radius);
            box-shadow: 0 2px 8px var(--shadow);
            z-index: 1000;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            margin-right: 8px;
            border-radius: 3px;
        }

        .quantitative-data {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing);
        }

        .chart-container {
            background-color: var(--background);
            border-radius: var(--radius);
            padding: var(--spacing);
            box-shadow: 0 1px 3px var(--shadow);
            position: relative;
            height: 300px;
            transition: box-shadow var(--transition);
        }

        .chart-container:hover {
            box-shadow: 0 4px 8px var(--shadow);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .chart-title {
            font-weight: 600;
        }

        .chart-controls {
            display: flex;
            gap: 8px;
        }

        .qualitative-data {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--spacing);
        }

        .interview-card {
            background-color: var(--background);
            border-radius: var(--radius);
            padding: var(--spacing);
            box-shadow: 0 1px 3px var(--shadow);
            margin-bottom: 16px;
            transition: box-shadow var(--transition), transform var(--transition);
        }

        .interview-card:hover {
            box-shadow: 0 4px 8px var(--shadow);
            transform: translateY(-2px);
        }

        .interview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }

        .interview-title {
            font-weight: 600;
        }

        .interview-meta {
            display: flex;
            gap: 16px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .interview-meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .interview-content {
            margin-bottom: 16px;
        }

        .interview-content p {
            margin-bottom: 10px;
        }

        .tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 16px;
            background-color: rgba(46, 125, 50, 0.1);
            color: var(--primary);
            font-size: 0.8rem;
            margin-right: 8px;
            margin-bottom: 8px;
            transition: background-color var(--transition);
            cursor: pointer;
        }

        .tag:hover {
            background-color: rgba(46, 125, 50, 0.2);
        }

        .integration-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing);
        }

        .integration-card {
            background-color: var(--background);
            border-radius: var(--radius);
            padding: var(--spacing);
            box-shadow: 0 1px 3px var(--shadow);
            transition: box-shadow var(--transition);
        }

        .integration-card:hover {
            box-shadow: 0 4px 8px var(--shadow);
        }

        .integration-header {
            font-weight: 600;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }

        .connection-line {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            transition: transform var(--transition);
        }

        .connection-line:hover {
            transform: scale(1.02);
        }

        .connection-source {
            width: 45%;
            padding: 8px;
            background-color: rgba(46, 125, 50, 0.1);
            border-radius: var(--radius);
        }

        .connection-arrow {
            width: 10%;
            text-align: center;
            color: var(--secondary);
        }

        .connection-target {
            width: 45%;
            padding: 8px;
            background-color: rgba(84, 110, 122, 0.1);
            border-radius: var(--radius);
        }

        .floating-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            background: white;
            border-radius: var(--radius);
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            display: none;
            z-index: 100;
            min-width: 200px;
            animation: fadeIn 0.2s ease-in-out;
        }

        .floating-controls.active {
            display: block;
        }

        .control-group {
            margin-bottom: 8px;
        }

        .control-label {
            font-size: 0.8rem;
            margin-bottom: 4px;
            display: block;
        }

        .tooltip {
            position: absolute;
            background-color: white;
            border-radius: var(--radius);
            padding: 8px 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            font-size: 0.9rem;
            z-index: 100;
            display: none;
            max-width: 250px;
        }

        .tooltip.active {
            display: block;
            animation: fadeIn 0.2s ease-in-out;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            font-size: 0.8rem;
            font-weight: 600;
            transition: transform var(--transition);
        }

        .badge:hover {
            transform: scale(1.1);
        }

        .environmental-justice-insights {
            background-color: rgba(255, 112, 67, 0.1);
            border-left: 3px solid var(--accent);
            padding: 12px;
            margin-top: 16px;
            border-radius: 0 var(--radius) var(--radius) 0;
            transition: transform var(--transition);
        }

        .environmental-justice-insights:hover {
            transform: translateX(5px);
        }

        .insight-title {
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #map-controls {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 1000;
            background: white;
            padding: 10px;
            border-radius: var(--radius);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .map-control-group {
            margin-bottom: 8px;
        }

        .map-control-label {
            font-size: 0.8rem;
            margin-bottom: 4px;
            display: block;
            font-weight: 500;
        }

        .methodology-tooltip {
            display: inline-block;
            position: relative;
            cursor: help;
        }

        .methodology-tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .methodology-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .search-box {
            position: relative;
            margin-bottom: 16px;
        }

        .search-input {
            width: 100%;
            padding: 8px 12px 8px 36px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background-color: var(--background);
            font-family: 'Inter', sans-serif;
        }

        .search-icon {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 1.2rem;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(46, 125, 50, 0.1);
        }

        .data-export-options {
            display: none;
            position: absolute;
            right: 0;
            top: 40px;
            background: white;
            border-radius: var(--radius);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            z-index: 100;
        }

        .data-export-options.active {
            display: block;
            animation: fadeIn 0.2s ease-in-out;
        }

        .export-option {
            padding: 8px 16px;
            cursor: pointer;
            transition: background-color var(--transition);
        }

        .export-option:hover {
            background-color: var(--surface);
        }

        .export-option:first-child {
            border-radius: var(--radius) var(--radius) 0 0;
        }

        .export-option:last-child {
            border-radius: 0 0 var(--radius) var(--radius);
        }

        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: 250px 1fr;
            }
        }

        @media (max-width: 992px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            .sidebar {
                height: auto;
                position: static;
            }
            .panel {
                height: auto;
                max-height: 800px;
            }
            .quantitative-data {
                grid-template-columns: 1fr;
            }
            .integration-panel {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 16px;
            }
            nav ul {
                gap: 16px;
            }
            .tabs {
                flex-wrap: wrap;
            }
            .tab {
                flex-grow: 1;
                text-align: center;
            }
        }

        /* Accessibility focus styles */
        a:focus, button:focus, input:focus, select:focus, textarea:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        /* Keyboard navigation styles */
        .keyboard-focus {
            box-shadow: 0 0 0 2px var(--primary);
        }
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet/dist/leaflet.css" />
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <span class="material-symbols-rounded logo-icon">park</span>
                <span>GreenSpace & Wellbeing</span>
            </div>
            <nav>
                <ul>
                    <li><a href="#" class="active">Dashboard</a></li>
                    <li><a href="#">Methodology</a></li>
                    <li><a href="#">Reports</a></li>
                    <li><a href="#">Help</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="container">
        <div class="dashboard">
            <aside class="sidebar">
                <div class="search-box">
                    <span class="material-symbols-rounded search-icon">search</span>
                    <input type="text" class="search-input" placeholder="Search data sources..." aria-label="Search data sources">
                </div>
                
                <div class="sidebar-title">Data Sources</div>
                <div class="data-sources">
                    <div class="data-source active" tabindex="0" role="button" aria-pressed="true">
                        <span class="material-symbols-rounded data-source-icon">map</span>
                        <div class="data-source-info">
                            <div class="data-source-title">GIS Spatial Data</div>
                            <div class="data-source-meta">12 layers, Last updated: Today</div>
                        </div>
                        <div class="badge" title="4 new updates">4</div>
                    </div>
                    <div class="data-source" tabindex="0" role="button" aria-pressed="false">
                        <span class="material-symbols-rounded data-source-icon">monitoring</span>
                        <div class="data-source-info">
                            <div class="data-source-title">Health Outcomes</div>
                            <div class="data-source-meta">8 metrics, Last updated: Yesterday</div>
                        </div>
                        <div class="badge" title="3 new updates">3</div>
                    </div>
                    <div class="data-source" tabindex="0" role="button" aria-pressed="false">
                        <span class="material-symbols-rounded data-source-icon">group</span>
                        <div class="data-source-info">
                            <div class="data-source-title">Demographic Data</div>
                            <div class="data-source-meta">5 datasets, Last updated: 3 days ago</div>
                        </div>
                        <div class="badge" title="2 new updates">2</div>
                    </div>
                    <div class="data-source" tabindex="0" role="button" aria-pressed="false">
                        <span class="material-symbols-rounded data-source-icon">record_voice_over</span>
                        <div class="data-source-info">
                            <div class="data-source-title">Qualitative Interviews</div>
                            <div class="data-source-meta">24 interviews, Last updated: 1 week ago</div>
                        </div>
                        <div class="badge" title="5 new updates">5</div>
                    </div>
                    <div class="data-source" tabindex="0" role="button" aria-pressed="false">
                        <span class="material-symbols-rounded data-source-icon">edit_note</span>
                        <div class="data-source-info">
                            <div class="data-source-title">Workshop Notes</div>
                            <div class="data-source-meta">6 workshops, Last updated: 2 weeks ago</div>
                        </div>
                        <div class="badge" title="1 new update">1</div>
                    </div>
                </div>

                <div class="filters-section">
                    <div class="sidebar-title">Filters</div>
                    <div class="filter-group">
                        <label for="neighborhood-filter" class="filter-label">Neighborhood</label>
                        <select id="neighborhood-filter" class="filter-control">
                            <option value="all">All Neighborhoods</option>
                            <option value="downtown">Downtown</option>
                            <option value="eastside">Eastside</option>
                            <option value="westside">Westside</option>
                            <option value="northside">Northside</option>
                            <option value="southside">Southside</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="income-filter" class="filter-label">Income Level</label>
                        <select id="income-filter" class="filter-control">
                            <option value="all">All Income Levels</option>
                            <option value="low">Low Income</option>
                            <option value="medium">Medium Income</option>
                            <option value="high">High Income</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Green Space Type</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="parks" checked>
                                <label for="parks">Parks</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="community-gardens" checked>
                                <label for="community-gardens">Community Gardens</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="trails" checked>
                                <label for="trails">Trails & Greenways</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="schoolyards">
                                <label for="schoolyards">Schoolyards</label>
                            </div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Health Outcomes</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="mental-health" checked>
                                <label for="mental-health">Mental Health</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="physical-health" checked>
                                <label for="physical-health">Physical Health</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="social-wellbeing">
                                <label for="social-wellbeing">Social Wellbeing</label>
                            </div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label for="date-range" class="filter-label">Date Range</label>
                        <input type="date" id="date-from" class="filter-control" style="margin-bottom: 8px;" aria-label="From date">
                        <input type="date" id="date-to" class="filter-control" aria-label="To date">
                    </div>
                </div>
            </aside>

            <main class="content">
                <div class="tabs" role="tablist">
                    <div class="tab active" data-tab="spatial" role="tab" tabindex="0" aria-selected="true">Spatial Analysis</div>
                    <div class="tab" data-tab="quantitative" role="tab" tabindex="0" aria-selected="false">Quantitative Data</div>
                    <div class="tab" data-tab="qualitative" role="tab" tabindex="0" aria-selected="false">Qualitative Data</div>
                    <div class="tab" data-tab="integration" role="tab" tabindex="0" aria-selected="false">Data Integration</div>
                </div>

                <div class="panels">
                    <div class="panel active" id="spatial-panel" role="tabpanel" aria-labelledby="spatial-tab">
                        <div class="panel-header">
                            <h2 class="panel-title">GIS Spatial Analysis</h2>
                            <div class="panel-actions">
                                <button class="btn btn-outline" id="toggleMapControls" aria-label="Manage map layers">
                                    <span class="material-symbols-rounded">layers</span>
                                    Manage Layers
                                </button>
                                <div style="position: relative;">
                                    <button class="btn btn-outline" id="exportMapData" aria-label="Export map data">
                                        <span class="material-symbols-rounded">download</span>
                                        Export
                                    </button>
                                    <div class="data-export-options" id="mapExportOptions">
                                        <div class="export-option" data-format="shapefile">Shapefile (.shp)</div>
                                        <div class="export-option" data-format="geojson">GeoJSON (.json)</div>
                                        <div class="export-option" data-format="kml">KML (.kml)</div>
                                        <div class="export-option" data-format="csv">CSV (.csv)</div>
                                    </div>
                                </div>
                                <button class="btn btn-primary" aria-label="Save current map view">
                                    <span class="material-symbols-rounded">save</span>
                                    Save View
                                </button>
                            </div>
                        </div>
                        <div id="map" class="map-container">
                            <div id="map-controls">
                                <div class="map-control-group">
                                    <label class="map-control-label">Layer Visibility</label>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="layer-green-space" checked>
                                        <label for="layer-green-space">Green Spaces</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="layer-income" checked>
                                        <label for="layer-income">Income Levels</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="layer-health" checked>
                                        <label for="layer-health">Health Outcomes</label>
                                    </div>
                                </div>
                                <div class="map-control-group">
                                    <label class="map-control-label">Analysis Type</label>
                                    <select class="filter-control" id="analysis-type">
                                        <option value="access">Accessibility Analysis</option>
                                        <option value="density">Green Space Density</option>
                                        <option value="quality">Quality Assessment</option>
                                        <option value="equity">Equity Index</option>
                                    </select>
                                </div>
                                <div class="map-control-group">
                                    <label class="map-control-label">Buffer Distance</label>
                                    <input type="range" min="100" max="1000" value="500" class="filter-control" id="buffer-distance">
                                    <div style="display: flex; justify-content: space-between; font-size: 0.8rem;">
                                        <span>100m</span>
                                        <span>1000m</span>
                                    </div>
                                </div>
                            </div>
                            <div class="map-legend">
                                <div style="font-weight: 600; margin-bottom: 8px;">Legend</div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #4CAF50;"></div>
                                    <div>Green Spaces</div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #FF5722;"></div>
                                    <div>Low Income Areas</div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #2196F3;"></div>
                                    <div>High Income Areas</div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #9C27B0; opacity: 0.7;"></div>
                                    <div>Health Concerns</div>
                                </div>
                            </div>
                        </div>
                        <div class="environmental-justice-insights">
                            <div class="insight-title">
                                <span class="material-symbols-rounded">lightbulb</span>
                                Environmental Justice Insight
                            </div>
                            <p>Analysis shows a 47% lower green space access in low-income neighborhoods compared to high-income areas, with corresponding higher rates of respiratory issues and mental health concerns.</p>
                        </div>
                    </div>

                    <div class="panel" id="quantitative-panel" role="tabpanel" aria-labelledby="quantitative-tab">
                        <div class="panel-header">
                            <h2 class="panel-title">Quantitative Health & Demographic Data</h2>
                            <div class="panel-actions">
                                <button class="btn btn-outline" id="importDataBtn" aria-label="Import quantitative data">
                                    <span class="material-symbols-rounded">file_upload</span>
                                    Import Data
                                </button>
                                <div style="position: relative;">
                                    <button class="btn btn-primary" id="exportDataBtn" aria-label="Export results">
                                        <span class="material-symbols-rounded">download</span>
                                        Export Results
                                    </button>
                                    <div class="data-export-options" id="dataExportOptions">
                                        <div class="export-option" data-format="csv">CSV (.csv)</div>
                                        <div class="export-option" data-format="xlsx">Excel (.xlsx)</div>
                                        <div class="export-option" data-format="json">JSON (.json)</div>
                                        <div class="export-option" data-format="pdf">PDF Report (.pdf)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="quantitative-data">
                            <div class="chart-container">
                                <div class="chart-header">
                                    <div class="chart-title">Green Space Access by Income Level</div>
                                    <div class="chart-controls">
                                        <button class="btn btn-outline" id="toggleChart1Controls" aria-label="Chart settings">
                                            <span class="material-symbols-rounded">tune</span>
                                        </button>
                                    </div>
                                </div>
                                <canvas id="accessChart"></canvas>
                                <div class="floating-controls" id="chart1Controls">
                                    <div class="control-group">
                                        <label class="control-label" for="chart1Type">Chart Type</label>
                                        <select class="filter-control" id="chart1Type">
                                            <option value="bar">Bar Chart</option>
                                            <option value="line">Line Chart</option>
                                            <option value="pie">Pie Chart</option>
                                        </select>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label" for="chart1Color">Color Scheme</label>
                                        <select class="filter-control" id="chart1Color">
                                            <option value="green">Green</option>
                                            <option value="blue">Blue</option>
                                            <option value="purple">Purple</option>
                                        </select>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label" for="chart1Normalize">Normalize Data</label>
                                        <input type="checkbox" id="chart1Normalize">
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label" for="chart1Labels">Show Data Labels</label>
                                        <input type="checkbox" id="chart1Labels" checked>
                                    </div>
                                </div>
                            </div>
                            <div class="chart-container">
                                <div class="chart-header">
                                    <div class="chart-title">Health Outcomes Correlation</div>
                                    <div class="chart-controls">
                                        <button class="btn btn-outline" id="toggleChart2Controls" aria-label="Chart settings">
                                            <span class="material-symbols-rounded">tune</span>
                                        </button>
                                    </div>
                                </div>
                                <canvas id="healthChart"></canvas>
                                <div class="floating-controls" id="chart2Controls">
                                    <div class="control-group">
                                        <label class="control-label" for="healthIndicator">Health Indicator</label>
                                        <select class="filter-control" id="healthIndicator">
                                            <option value="mental">Mental Health</option>
                                            <option value="physical">Physical Health</option>
                                            <option value="social">Social Wellbeing</option>
                                        </select>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label" for="chart2Type">Display Type</label>
                                        <select class="filter-control" id="chart2Type">
                                            <option value="scatter">Scatter Plot</option>
                                            <option value="line">Line Chart</option>
                                        </select>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label" for="chart2Regression">Show Regression Line</label>
                                        <input type="checkbox" id="chart2Regression" checked>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label" for="chart2Confidence">Show Confidence Interval</label>
                                        <input type="checkbox" id="chart2Confidence">
                                    </div>
                                </div>
                            </div>
                            <div class="chart-container">
                                <div class="chart-header">
                                    <div class="chart-title">Demographic Distribution</div>
                                    <div class="chart-controls">
                                        <button class="btn btn-outline" id="toggleChart3Controls" aria-label="Chart settings">
                                            <span class="material-symbols-rounded">tune</span>
                                        </button>
                                    </div>
                                </div>
                                <canvas id="demographicChart"></canvas>
                                <div class="floating-controls" id="chart3Controls">
                                    <div class="control-group">
                                        <label class="control-label" for="demographicFactor">Demographic Factor</label>
                                        <select class="filter-control" id="demographicFactor">
                                            <option value="age">Age Distribution</option>
                                            <option value="race">Racial Demographics</option>
                                            <option value="education">Education Level</option>
                                        </select>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label" for="chart3Type">Chart Type</label>
                                        <select class="filter-control" id="chart3Type">
                                            <option value="pie">Pie Chart</option>
                                            <option value="doughnut">Doughnut Chart</option>
                                            <option value="bar">Bar Chart</option>
                                        </select>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label" for="chart3Legend">Legend Position</label>
                                        <select class="filter-control" id="chart3Legend">
                                            <option value="right">Right</option>
                                            <option value="bottom">Bottom</option>
                                            <option value="top">Top</option>
                                            <option value="left">Left</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="chart-container">
                                <div class="chart-header">
                                    <div class="chart-title">Environmental Quality Metrics</div>
                                    <div class="chart-controls">
                                        <button class="btn btn-outline" id="toggleChart4Controls" aria-label="Chart settings">
                                            <span class="material-symbols-rounded">tune</span>
                                        </button>
                                    </div>
                                </div>
                                <canvas id="environmentalChart"></canvas>
                                <div class="floating-controls" id="chart4Controls">
                                    <div class="control-group">
                                        <label class="control-label" for="environmentalMetric">Environmental Metric</label>
                                        <select class="filter-control" id="environmentalMetric">
                                            <option value="airQuality">Air Quality</option>
                                            <option value="noise">Noise Pollution</option>
                                            <option value="temperature">Urban Heat</option>
                                        </select>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label" for="chart4Type">Chart Type</label>
                                        <select class="filter-control" id="chart4Type">
                                            <option value="bar">Bar Chart</option>
                                            <option value="line">Line Chart</option>
                                            <option value="radar">Radar Chart</option>
                                        </select>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label" for="chart4Threshold">Show Threshold Line</label>
                                        <input type="checkbox" id="chart4Threshold" checked>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label" for="chart4ThresholdValue">Threshold Value</label>
                                        <input type="range" id="chart4ThresholdValue" min="50" max="150" value="100" class="filter-control">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="environmental-justice-insights">
                            <div class="insight-title">
                                <span class="material-symbols-rounded">lightbulb</span>
                                Environmental Justice Insight
                            </div>
                            <p>Quantitative analysis reveals that neighborhoods with >75% minority populations have 62% higher rates of asthma and 38% higher rates of depression, correlating with lower green space access and higher pollution levels.</p>
                        </div>
                    </div>

                    <div class="panel" id="qualitative-panel" role="tabpanel" aria-labelledby="qualitative-tab">
                        <div class="panel-header">
                            <h2 class="panel-title">Qualitative Interview & Workshop Data</h2>
                            <div class="panel-actions">
                                <button class="btn btn-outline" id="addInterviewBtn" aria-label="Add new interview">
                                    <span class="material-symbols-rounded">add</span>
                                    Add Interview
                                </button>
                                <button class="btn btn-outline" id="tagManagerBtn" aria-label="Manage tags">
                                    <span class="material-symbols-rounded">sell</span>
                                    Manage Tags
                                </button>
                                <button class="btn btn-primary" id="searchTranscriptsBtn" aria-label="Search transcripts">
                                    <span class="material-symbols-rounded">search</span>
                                    Search Transcripts
                                </button>
                            </div>
                        </div>
                        <div class="search-box" style="margin-top: 8px;">
                            <span class="material-symbols-rounded search-icon">search</span>
                            <input type="text" class="search-input" placeholder="Search interviews and workshops..." aria-label="Search interviews and workshops">
                        </div>
                        <div class="qualitative-data">
                            <div class="interview-card">
                                <div class="interview-header">
                                    <div class="interview-title">Interview: Eastside Resident (Emma J.)</div>
                                    <div class="interview-meta">
                                        <div class="interview-meta-item">
                                            <span class="material-symbols-rounded">calendar_month</span>
                                            May 12, 2023
                                        </div>
                                        <div class="interview-meta-item">
                                            <span class="material-symbols-rounded">location_on</span>
                                            Eastside Community Center
                                        </div>
                                    </div>
                                </div>
                                <div class="interview-content">
                                    <p>"I've lived in this neighborhood for over 20 years, and we've always struggled with access to parks. The nearest green space is about a 25-minute walk, which is difficult for me with my arthritis and impossible for many of our elderly residents. When my grandchildren visit, I have nowhere nearby to take them to play outdoors."</p>
                                    <p>"The community has been asking for a small park on that vacant lot on Oak Street for years, but the city keeps saying there's no funding. Meanwhile, the westside neighborhoods seem to get new park improvements every year."</p>
                                </div>
                                <div class="interview-tags">
                                    <span class="tag" data-tag="access-barriers">Access Barriers</span>
                                    <span class="tag" data-tag="equity-concerns">Equity Concerns</span>
                                    <span class="tag" data-tag="physical-health">Physical Health</span>
                                    <span class="tag" data-tag="community-advocacy">Community Advocacy</span>
                                </div>
                                <div style="margin-top: 12px; display: flex; gap: 8px; justify-content: flex-end;">
                                    <button class="btn btn-outline" style="padding: 4px 8px;">
                                        <span class="material-symbols-rounded">edit</span>
                                        Edit
                                    </button>
                                    <button class="btn btn-outline" style="padding: 4px 8px;">
                                        <span class="material-symbols-rounded">pin_drop</span>
                                        Map Location
                                    </button>
                                    <button class="btn btn-outline" style="padding: 4px 8px;">
                                        <span class="material-symbols-rounded">link</span>
                                        Link to Data
                                    </button>
                                </div>
                            </div>
                            <div class="interview-card">
                                <div class="interview-header">
                                    <div class="interview-title">Workshop: Northside Community Planning</div>
                                    <div class="interview-meta">
                                        <div class="interview-meta-item">
                                            <span class="material-symbols-rounded">calendar_month</span>
                                            June 3, 2023
                                        </div>
                                        <div class="interview-meta-item">
                                            <span class="material-symbols-rounded">location_on</span>
                                            Northside Public Library
                                        </div>
                                    </div>
                                </div>
                                <div class="interview-content">
                                    <p>Workshop participants created maps highlighting areas where they feel unsafe in existing green spaces. Key concerns included poor lighting, lack of maintenance, and concerns about illicit activities in more isolated areas of larger parks. Many participants expressed that they would use green spaces more frequently if these safety issues were addressed.</p>
                                    <p>Participants also identified potential locations for new pocket parks and community gardens, with particular emphasis on areas with high density housing and limited yard space.</p>
                                </div>
                                <div class="interview-tags">
                                    <span class="tag" data-tag="safety-concerns">Safety Concerns</span>
                                    <span class="tag" data-tag="participatory-mapping">Participatory Mapping</span>
                                    <span class="tag" data-tag="community-gardens">Community Gardens</span>
                                    <span class="tag" data-tag="urban-planning">Urban Planning</span>
                                </div>
                                <div style="margin-top: 12px; display: flex; gap: 8px; justify-content: flex-end;">
                                    <button class="btn btn-outline" style="padding: 4px 8px;">
                                        <span class="material-symbols-rounded">edit</span>
                                        Edit
                                    </button>
                                    <button class="btn btn-outline" style="padding: 4px 8px;">
                                        <span class="material-symbols-rounded">pin_drop</span>
                                        Map Location
                                    </button>
                                    <button class="btn btn-outline" style="padding: 4px 8px;">
                                        <span class="material-symbols-rounded">link</span>
                                        Link to Data
                                    </button>
                                </div>
                            </div>
                            <div class="interview-card">
                                <div class="interview-header">
                                    <div class="interview-title">Interview: Public Health Official (Dr. Marcus T.)</div>
                                    <div class="interview-meta">
                                        <div class="interview-meta-item">
                                            <span class="material-symbols-rounded">calendar_month</span>
                                            April 28, 2023
                                        </div>
                                        <div class="interview-meta-item">
                                            <span class="material-symbols-rounded">location_on</span>
                                            City Health Department
                                        </div>
                                    </div>
                                </div>
                                <div class="interview-content">
                                    <p>"We've been tracking health disparities across neighborhoods for the past decade, and there's a clear correlation between green space access and health outcomes. The areas with the least green space access also have the highest rates of obesity, diabetes, and reported mental health issues."</p>
                                    <p>"What's particularly concerning is that these same neighborhoods also have the highest concentration of environmental hazards - from industrial pollution to traffic emissions. Green spaces could help mitigate some of these environmental justice issues, but they're precisely the neighborhoods that lack them."</p>
                                </div>
                                <div class="interview-tags">
                                    <span class="tag" data-tag="health-disparities">Health Disparities</span>
                                    <span class="tag" data-tag="environmental-justice">Environmental Justice</span>
                                    <span class="tag" data-tag="policy-implications">Policy Implications</span>
                                    <span class="tag" data-tag="public-health">Public Health</span>
                                </div>
                                <div style="margin-top: 12px; display: flex; gap: 8px; justify-content: flex-end;">
                                    <button class="btn btn-outline" style="padding: 4px 8px;">
                                        <span class="material-symbols-rounded">edit</span>
                                        Edit
                                    </button>
                                    <button class="btn btn-outline" style="padding: 4px 8px;">
                                        <span class="material-symbols-rounded">pin_drop</span>
                                        Map Location
                                    </button>
                                    <button class="btn btn-outline" style="padding: 4px 8px;">
                                        <span class="material-symbols-rounded">link</span>
                                        Link to Data
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="environmental-justice-insights">
                            <div class="insight-title">
                                <span class="material-symbols-rounded">lightbulb</span>
                                Environmental Justice Insight
                            </div>
                            <p>Qualitative interviews reveal consistent concerns about "green gentrification" where new green space investments have led to rising property values and displacement of long-term residents in historically disinvested neighborhoods.</p>
                        </div>
                    </div>

                    <div class="panel" id="integration-panel" role="tabpanel" aria-labelledby="integration-tab">
                        <div class="panel-header">
                            <h2 class="panel-title">Mixed-Methods Data Integration</h2>
                            <div class="panel-actions">
                                <button class="btn btn-outline" id="createConnectionBtn" aria-label="Create new data connection">
                                    <span class="material-symbols-rounded">add_link</span>
                                    Create New Connection
                                </button>
                                <div style="position: relative;">
                                    <button class="btn btn-primary" id="generateReportBtn" aria-label="Generate report">
                                        <span class="material-symbols-rounded">description</span>
                                        Generate Report
                                    </button>
                                    <div class="data-export-options" id="reportExportOptions">
                                        <div class="export-option" data-format="pdf">PDF Report (.pdf)</div>
                                        <div class="export-option" data-format="docx">Word Document (.docx)</div>
                                        <div class="export-option" data-format="pptx">PowerPoint (.pptx)</div>
                                        <div class="export-option" data-format="html">Web Page (.html)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="integration-panel">
                            <div class="integration-card">
                                <div class="integration-header">Data Connections & Insights</div>
                                <div class="connection-line">
                                    <div class="connection-source">GIS: Green Space Access (Eastside)</div>
                                    <div class="connection-arrow"></div>
                                    <div class="connection-target">Interview: Emma J. (Access Barriers)</div>
                                </div>
                                <div class="connection-line">
                                    <div class="connection-source">Health Data: Mental Health Metrics</div>
                                    <div class="connection-arrow"></div>
                                    <div class="connection-target">Workshop: Northside (Safety Concerns)</div>
                                </div>
                                <div class="connection-line">
                                    <div class="connection-source">Demographics: Income Distribution</div>
                                    <div class="connection-arrow"></div>
                                    <div class="connection-target">Interview: Dr. Marcus T. (Health Disparities)</div>
                                </div>
                                <div class="connection-line">
                                    <div class="connection-source">Environmental: Air Quality Index</div>
                                    <div class="connection-arrow"></div>
                                    <div class="connection-target">Health Data: Respiratory Issues</div>
                                </div>
                                <div style="margin-top: 16px;">
                                    <button class="btn btn-outline" style="width: 100%;">
                                        <span class="material-symbols-rounded">add</span>
                                        Add New Connection
                                    </button>
                                </div>
                            </div>
                            <div class="integration-card">
                                <div class="integration-header">Methodological Framework</div>
                                <p>The current integration follows a <strong>Convergent Parallel Mixed Methods Design</strong>, where quantitative and qualitative data are collected and analyzed simultaneously, then merged to develop a comprehensive understanding of the research questions.</p>
                                <p>This approach allows for triangulation of findings across different data sources and methods, strengthening the validity of conclusions about environmental justice issues related to green space access.</p>
                                <div class="methodology-tooltip">
                                    <p><strong>Alternative Framework Options:</strong> <span class="material-symbols-rounded" style="font-size: 16px; vertical-align: middle;">help_outline</span></p>
                                    <span class="tooltip-text">Click to explore other methodological options</span>
                                </div>
                                <div style="margin-top: 10px; padding: 10px; background-color: #f5f5f5; border-radius: var(--radius);">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                        <input type="radio" id="convergent" name="framework" checked>
                                        <label for="convergent"><strong>Convergent Parallel</strong></label>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                        <input type="radio" id="explanatory" name="framework">
                                        <label for="explanatory"><strong>Explanatory Sequential</strong></label>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                        <input type="radio" id="exploratory" name="framework">
                                        <label for="exploratory"><strong>Exploratory Sequential</strong></label>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <input type="radio" id="embedded" name="framework">
                                        <label for="embedded"><strong>Embedded Design</strong></label>
                                    </div>
                                </div>
                                <p style="margin-top: 16px;"><strong>Key integration points:</strong></p>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li>Spatial analysis of green space distribution overlaid with socioeconomic variables</li>
                                    <li>Qualitative themes mapped to specific geographic locations</li>
                                    <li>Health outcome correlations informed by both statistical analysis and lived experiences</li>
                                    <li>Environmental justice implications derived from multiple data sources</li>
                                </ul>
                            </div>
                            <div class="integration-card">
                                <div class="integration-header">Emerging Patterns</div>
                                <p><strong>Pattern 1:</strong> Access Inequity - Both spatial analysis and qualitative interviews consistently show disparities in green space access correlated with neighborhood income levels.</p>
                                <p><strong>Pattern 2:</strong> Health Correlations - Statistical health data showing higher rates of stress-related conditions in areas with less green space is supported by interview narratives about mental wellbeing.</p>
                                <p><strong>Pattern 3:</strong> Safety & Utilization - Quantitative usage data showing lower park utilization in certain areas is explained by qualitative insights about safety concerns and maintenance issues.</p>
                                <p><strong>Pattern 4:</strong> Environmental Burden - Areas with fewer green spaces also experience higher environmental burdens (air pollution, urban heat), creating compounding disadvantages for vulnerable populations.</p>
                                <div style="margin-top: 16px; display: flex; justify-content: flex-end;">
                                    <button class="btn btn-outline">
                                        <span class="material-symbols-rounded">add_chart</span>
                                        Visualize Patterns
                                    </button>
                                </div>
                            </div>
                            <div class="integration-card">
                                <div class="integration-header">Environmental Justice Analysis</div>
                                <p>The integrated analysis reveals a clear environmental justice dimension to green space access in the study area:</p>
                                <p><strong>Distributive Justice:</strong> Significant disparities in the spatial distribution of quality green spaces across socioeconomic lines.</p>
                                <p><strong>Procedural Justice:</strong> Historical patterns of exclusion from decision-making processes about green space development, as revealed in community interviews.</p>
                                <p><strong>Recognition Justice:</strong> Failure to recognize and accommodate diverse cultural needs and uses of green spaces in planning processes.</p>
                                <p><strong>Capabilities Approach:</strong> Limited ability of vulnerable populations to benefit from existing green spaces due to access barriers, safety concerns, and competing time demands.</p>
                                <div style="margin-top: 16px; display: flex; justify-content: space-between;">
                                    <button class="btn btn-outline">
                                        <span class="material-symbols-rounded">share</span>
                                        Share Analysis
                                    </button>
                                    <button class="btn btn-outline">
                                        <span class="material-symbols-rounded">edit_note</span>
                                        Add Notes
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script type="module">
        import * as L from "https://esm.sh/leaflet";
        import { Chart } from "https://esm.sh/chart.js/auto";

        // Initialize tabs
        const tabs = document.querySelectorAll('.tab');
        const panels = document.querySelectorAll('.panel');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs and panels
                tabs.forEach(t => {
                    t.classList.remove('active');
                    t.setAttribute('aria-selected', 'false');
                });
                panels.forEach(p => p.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding panel
                tab.classList.add('active');
                tab.setAttribute('aria-selected', 'true');
                const panel = document.getElementById(`${tab.dataset.tab}-panel`);
                panel.classList.add('active');
            });

            // Add keyboard navigation for tabs
            tab.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    tab.click();
                }
            });
        });

        // Initialize map
        const map = L.map('map').setView([40.7128, -74.0060], 12);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: ' OpenStreetMap contributors'
        }).addTo(map);

        // Add some sample data layers to the map
        const greenSpaceLayer = L.circle([40.7128, -74.0060], {
            color: '#4CAF50',
            fillColor: '#4CAF50',
            fillOpacity: 0.5,
            radius: 1000
        }).addTo(map).bindPopup("<strong>Central Park</strong><br>Size: 843 acres<br>Facilities: Playgrounds, Sports Fields, Walking Paths<br><br><button class='btn btn-outline' style='padding: 4px 8px; margin-top: 5px;'>View Details</button>");

        const lowIncomeLayer = L.circle([40.7328, -73.9860], {
            color: '#FF5722',
            fillColor: '#FF5722',
            fillOpacity: 0.3,
            radius: 800
        }).addTo(map).bindPopup("<strong>Lower East Side</strong><br>Income level: Low<br>Green space access: Limited<br>Health concerns: Higher rates of asthma<br><br><button class='btn btn-outline' style='padding: 4px 8px; margin-top: 5px;'>View Demographics</button>");

        const highIncomeLayer = L.circle([40.6928, -74.0260], {
            color: '#2196F3',
            fillColor: '#2196F3',
            fillOpacity: 0.3,
            radius: 800
        }).addTo(map).bindPopup("<strong>Battery Park City</strong><br>Income level: High<br>Green space access: Abundant<br>Health outcomes: Better overall wellbeing<br><br><button class='btn btn-outline' style='padding: 4px 8px; margin-top: 5px;'>View Demographics</button>");

        const healthConcernLayer = L.circle([40.7528, -73.9660], {
            color: '#9C27B0',
            fillColor: '#9C27B0',
            fillOpacity: 0.3,
            radius: 600
        }).addTo(map).bindPopup("<strong>East Harlem</strong><br>Health concern hotspot<br>Mental health issues: 28%<br>Respiratory issues: 32%<br><br><button class='btn btn-outline' style='padding: 4px 8px; margin-top: 5px;'>View Health Data</button>");

        // Add a GeoJSON polygon for a neighborhood
        const neighborhoodBoundary = L.geoJSON({
            "type": "Feature",
            "properties": {"name": "Eastside Neighborhood"},
            "geometry": {
                "type": "Polygon",
                "coordinates": [[
                    [-73.9760, 40.7328],
                    [-73.9760, 40.7428],
                    [-73.9660, 40.7428],
                    [-73.9660, 40.7328],
                    [-73.9760, 40.7328]
                ]]
            }
        }, {
            style: {
                color: "#333",
                weight: 2,
                opacity: 0.7,
                fillOpacity: 0.1
            }
        }).addTo(map).bindPopup("Eastside Neighborhood<br>Area highlighted in interview with Emma J.");

        // Add markers for interview locations
        const interviewMarker = L.marker([40.7328, -73.9710])
            .addTo(map)
            .bindPopup("<strong>Interview Location: Emma J.</strong><br>Eastside Community Center<br>Date: May 12, 2023<br><br><button class='btn btn-outline' style='padding: 4px 8px; margin-top: 5px;'>View Interview Transcript</button>");

        // Map controls functionality
        document.getElementById('toggleMapControls').addEventListener('click', () => {
            const mapControls = document.getElementById('map-controls');
            mapControls.style.display = mapControls.style.display === 'none' ? 'block' : 'none';
        });

        document.getElementById('layer-green-space').addEventListener('change', (e) => {
            if (e.target.checked) {
                map.addLayer(greenSpaceLayer);
            } else {
                map.removeLayer(greenSpaceLayer);
            }
        });

        document.getElementById('layer-income').addEventListener('change', (e) => {
            if (e.target.checked) {
                map.addLayer(lowIncomeLayer);
                map.addLayer(highIncomeLayer);
            } else {
                map.removeLayer(lowIncomeLayer);
                map.removeLayer(highIncomeLayer);
            }
        });

        document.getElementById('layer-health').addEventListener('change', (e) => {
            if (e.target.checked) {
                map.addLayer(healthConcernLayer);
            } else {
                map.removeLayer(healthConcernLayer);
            }
        });

        document.getElementById('buffer-distance').addEventListener('input', (e) => {
            const bufferDistance = parseInt(e.target.value);
            greenSpaceLayer.setRadius(bufferDistance);
            lowIncomeLayer.setRadius(bufferDistance * 0.8);
            highIncomeLayer.setRadius(bufferDistance * 0.8);
            healthConcernLayer.setRadius(bufferDistance * 0.6);
        });

        document.getElementById('analysis-type').addEventListener('change', (e) => {
            // This would change the analysis type shown on the map
            console.log(`Changed analysis type to: ${e.target.value}`);
            // In a real implementation, this would update the map layers and legend
        });

        // Export options functionality
        document.getElementById('exportMapData').addEventListener('click', () => {
            document.getElementById('mapExportOptions').classList.toggle('active');
        });

        document.getElementById('exportDataBtn').addEventListener('click', () => {
            document.getElementById('dataExportOptions').classList.toggle('active');
        });

        document.getElementById('generateReportBtn').addEventListener('click', () => {
            document.getElementById('reportExportOptions').classList.toggle('active');
        });

        // Close export options when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.matches('#exportMapData') && !e.target.closest('#mapExportOptions')) {
                document.getElementById('mapExportOptions').classList.remove('active');
            }
            if (!e.target.matches('#exportDataBtn') && !e.target.closest('#dataExportOptions')) {
                document.getElementById('dataExportOptions').classList.remove('active');
            }
            if (!e.target.matches('#generateReportBtn') && !e.target.closest('#reportExportOptions')) {
                document.getElementById('reportExportOptions').classList.remove('active');
            }
        });

        // Export option click handlers
        document.querySelectorAll('.export-option').forEach(option => {
            option.addEventListener('click', () => {
                const format = option.dataset.format;
                alert(`Exporting data in ${format} format...`);
                // This would trigger the actual export functionality
                option.closest('.data-export-options').classList.remove('active');
            });
        });

        // Initialize charts
        const accessChartCtx = document.getElementById('accessChart').getContext('2d');
        const accessChart = new Chart(accessChartCtx, {
            type: 'bar',
            data: {
                labels: ['Low Income', 'Medium Income', 'High Income'],
                datasets: [{
                    label: 'Green Space Access (acres per 1000 residents)',
                    data: [1.2, 3.5, 7.8],
                    backgroundColor: [
                        'rgba(46, 125, 50, 0.7)',
                        'rgba(46, 125, 50, 0.7)',
                        'rgba(46, 125, 50, 0.7)'
                    ],
                    borderColor: [
                        'rgba(46, 125, 50, 1)',
                        'rgba(46, 125, 50, 1)',
                        'rgba(46, 125, 50, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    tooltip: {
                        callbacks: {
                            afterLabel: function(context) {
                                const neighborhoodNames = [
                                    ['Eastside', 'Southside Industrial', 'Downtown East'],
                                    ['Midtown', 'University District', 'Harbor View'],
                                    ['Westside Heights', 'North Hills', 'Riverview']
                                ];
                                return 'Neighborhoods: ' + neighborhoodNames[context.dataIndex].join(', ');
                            }
                        }
                    },
                    legend: {
                        position: 'top',
                    },
                    datalabels: {
                        display: true,
                        color: '#333',
                        anchor: 'end',
                        align: 'top',
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Acres per 1000 Residents'
                        }
                    }
                }
            }
        });

        const healthChartCtx = document.getElementById('healthChart').getContext('2d');
        const healthChart = new Chart(healthChartCtx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Mental Health & Green Space Access',
                    data: [
                        { x: 1.2, y: 28 },
                        { x: 1.8, y: 25 },
                        { x: 2.5, y: 22 },
                        { x: 3.2, y: 19 },
                        { x: 4.1, y: 17 },
                        { x: 5.3, y: 14 },
                        { x: 6.7, y: 12 },
                        { x: 7.8, y: 10 }
                    ],
                    backgroundColor: 'rgba(84, 110, 122, 0.7)',
                    borderColor: 'rgba(84, 110, 122, 1)',
                    borderWidth: 1,
                    pointRadius: 6,
                    pointHoverRadius: 8
                }, {
                    label: 'Regression Line',
                    type: 'line',
                    data: [
                        { x: 1.0, y: 28.5 },
                        { x: 8.0, y: 9.5 }
                    ],
                    borderColor: 'rgba(84, 110, 122, 0.5)',
                    borderWidth: 2,
                    borderDash: [5, 5],
                    fill: false,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const point = context.raw;
                                return `Green Space: ${point.x} acres/1000 residents, Mental Health Issues: ${point.y}%`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Green Space Access (acres per 1000 residents)'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Mental Health Issues (% reporting)'
                        }
                    }
                }
            }
        });

        const demographicChartCtx = document.getElementById('demographicChart').getContext('2d');
        const demographicChart = new Chart(demographicChartCtx, {
            type: 'pie',
            data: {
                labels: ['White', 'Black', 'Hispanic', 'Asian', 'Other'],
                datasets: [{
                    label: 'Racial Demographics',
                    data: [45, 25, 18, 10, 2],
                    backgroundColor: [
                        'rgba(33, 150, 243, 0.7)',
                        'rgba(156, 39, 176, 0.7)',
                        'rgba(255, 152, 0, 0.7)',
                        'rgba(0, 150, 136, 0.7)',
                        'rgba(158, 158, 158, 0.7)'
                    ],
                    borderColor: [
                        'rgba(33, 150, 243, 1)',
                        'rgba(156, 39, 176, 1)',
                        'rgba(255, 152, 0, 1)',
                        'rgba(0, 150, 136, 1)',
                        'rgba(158, 158, 158, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right'
                    },
                    tooltip: {
                        callbacks: {
                            afterLabel: function(context) {
                                const greenSpaceAccess = [5.6, 2.1, 2.4, 3.8, 3.2];
                                return `Avg. Green Space Access: ${greenSpaceAccess[context.dataIndex]} acres/1000`;
                            }
                        }
                    }
                }
            }
        });

        const environmentalChartCtx = document.getElementById('environmentalChart').getContext('2d');
        const environmentalChart = new Chart(environmentalChartCtx, {
            type: 'bar',
            data: {
                labels: ['Downtown', 'Eastside', 'Westside', 'Northside', 'Southside'],
                datasets: [{
                    label: 'Air Quality Index',
                    data: [135, 142, 98, 112, 128],
                    backgroundColor: 'rgba(255, 112, 67, 0.7)',
                    borderColor: 'rgba(255, 112, 67, 1)',
                    borderWidth: 1
                }, {
                    label: 'EPA Threshold',
                    type: 'line',
                    data: [100, 100, 100, 100, 100],
                    borderColor: 'rgba(255, 0, 0, 0.7)',
                    borderWidth: 2,
                    borderDash: [5, 5],
                    fill: false,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    tooltip: {
                        callbacks: {
                            afterLabel: function(context) {
                                if (context.datasetIndex === 0) {
                                    const qualityDescriptions = ['Unhealthy', 'Unhealthy', 'Moderate', 'Unhealthy for Sensitive Groups', 'Unhealthy for Sensitive Groups'];
                                    return `Air Quality: ${qualityDescriptions[context.dataIndex]}`;
                                }
                                return '';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'AQI (higher is worse)'
                        }
                    }
                }
            }
        });

        // Chart controls functionality
        document.getElementById('toggleChart1Controls').addEventListener('click', () => {
            document.getElementById('chart1Controls').classList.toggle('active');
        });

        document.getElementById('toggleChart2Controls').addEventListener('click', () => {
            document.getElementById('chart2Controls').classList.toggle('active');
        });

        document.getElementById('toggleChart3Controls').addEventListener('click', () => {
            document.getElementById('chart3Controls').classList.toggle('active');
        });

        document.getElementById('toggleChart4Controls').addEventListener('click', () => {
            document.getElementById('chart4Controls').classList.toggle('active');
        });

        // Chart type change handlers
        document.getElementById('chart1Type').addEventListener('change', (e) => {
            accessChart.config.type = e.target.value;
            accessChart.update();
        });

        document.getElementById('chart1Color').addEventListener('change', (e) => {
            const colorSchemes = {
                'green': {
                    backgroundColor: 'rgba(46, 125, 50, 0.7)',
                    borderColor: 'rgba(46, 125, 50, 1)'
                },
                'blue': {
                    backgroundColor: 'rgba(33, 150, 243, 0.7)',
                    borderColor: 'rgba(33, 150, 243, 1)'
                },
                'purple': {
                    backgroundColor: 'rgba(156, 39, 176, 0.7)',
                    borderColor: 'rgba(156, 39, 176, 1)'
                }
            };
            
            const newColors = colorSchemes[e.target.value];
            
            for (let i = 0; i < accessChart.data.datasets[0].backgroundColor.length; i++) {
                accessChart.data.datasets[0].backgroundColor[i] = newColors.backgroundColor;
                accessChart.data.datasets[0].borderColor[i] = newColors.borderColor;
            }
            
            accessChart.update();
        });

        document.getElementById('chart1Labels').addEventListener('change', (e) => {
            accessChart.options.plugins.datalabels.display = e.target.checked;
            accessChart.update();
        });

        document.getElementById('chart1Normalize').addEventListener('change', (e) => {
            if (e.target.checked) {
                // Normalize data to percentage of total
                const total = accessChart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                const normalizedData = accessChart.data.datasets[0].data.map(value => (value / total * 100).toFixed(1));
                accessChart.data.datasets[0].data = normalizedData;
                accessChart.options.scales.y.title.text = 'Percentage of Total (%)';
            } else {
                // Return to original data
                accessChart.data.datasets[0].data = [1.2, 3.5, 7.8];
                accessChart.options.scales.y.title.text = 'Acres per 1000 Residents';
            }
            accessChart.update();
        });

        document.getElementById('chart2Type').addEventListener('change', (e) => {
            healthChart.config.type = e.target.value;
            healthChart.update();
        });

        document.getElementById('chart2Regression').addEventListener('change', (e) => {
            healthChart.data.datasets[1].hidden = !e.target.checked;
            healthChart.update();
        });

        document.getElementById('chart2Confidence').addEventListener('change', (e) => {
            if (e.target.checked) {
                // Add confidence interval
                healthChart.data.datasets.push({
                    label: 'Confidence Interval',
                    type: 'line',
                    data: [
                        { x: 1.0, y: 30.5 },
                        { x: 8.0, y: 11.5 }
                    ],
                    borderColor: 'rgba(84, 110, 122, 0.2)',
                    backgroundColor: 'rgba(84, 110, 122, 0.1)',
                    borderWidth: 1,
                    fill: '+1',
                    pointRadius: 0
                });
                healthChart.data.datasets.push({
                    label: 'Confidence Interval',
                    type: 'line',
                    data: [
                        { x: 1.0, y: 26.5 },
                        { x: 8.0, y: 7.5 }
                    ],
                    borderColor: 'rgba(84, 110, 122, 0.2)',
                    backgroundColor: 'rgba(84, 110, 122, 0.1)',
                    borderWidth: 1,
                    fill: '-1',
                    pointRadius: 0
                });
            } else {
                // Remove confidence interval
                if (healthChart.data.datasets.length > 2) {
                    healthChart.data.datasets.splice(2);
                }
            }
            healthChart.update();
        });

        document.getElementById('healthIndicator').addEventListener('change', (e) => {
            const healthData = {
                'mental': {
                    label: 'Mental Health & Green Space Access',
                    data: [
                        { x: 1.2, y: 28 }, { x: 1.8, y: 25 }, { x: 2.5, y: 22 },
                        { x: 3.2, y: 19 }, { x: 4.1, y: 17 }, { x: 5.3, y: 14 },
                        { x: 6.7, y: 12 }, { x: 7.8, y: 10 }
                    ],
                    yAxisLabel: 'Mental Health Issues (% reporting)'
                },
                'physical': {
                    label: 'Physical Health & Green Space Access',
                    data: [
                        { x: 1.2, y: 32 }, { x: 1.8, y: 29 }, { x: 2.5, y: 26 },
                        { x: 3.2, y: 22 }, { x: 4.1, y: 19 }, { x: 5.3, y: 15 },
                        { x: 6.7, y: 12 }, { x: 7.8, y: 9 }
                    ],
                    yAxisLabel: 'Physical Health Issues (% reporting)'
                },
                'social': {
                    label: 'Social Wellbeing & Green Space Access',
                    data: [
                        { x: 1.2, y: 45 }, { x: 1.8, y: 42 }, { x: 2.5, y: 38 },
                        { x: 3.2, y: 35 }, { x: 4.1, y: 30 }, { x: 5.3, y: 25 },
                        { x: 6.7, y: 22 }, { x: 7.8, y: 18 }
                    ],
                    yAxisLabel: 'Social Isolation (% reporting)'
                }
            };
            
            const newData = healthData[e.target.value];
            
            healthChart.data.datasets[0].label = newData.label;
            healthChart.data.datasets[0].data = newData.data;
            healthChart.options.scales.y.title.text = newData.yAxisLabel;
            
            // Update regression line
            if (e.target.value === 'mental') {
                healthChart.data.datasets[1].data = [{ x: 1.0, y: 28.5 }, { x: 8.0, y: 9.5 }];
            } else if (e.target.value === 'physical') {
                healthChart.data.datasets[1].data = [{ x: 1.0, y: 33 }, { x: 8.0, y: 8 }];
            } else {
                healthChart.data.datasets[1].data = [{ x: 1.0, y: 46 }, { x: 8.0, y: 17 }];
            }
            
            // Remove confidence interval if present
            if (healthChart.data.datasets.length > 2) {
                healthChart.data.datasets.splice(2);
                document.getElementById('chart2Confidence').checked = false;
            }
            
            healthChart.update();
        });

        document.getElementById('demographicFactor').addEventListener('change', (e) => {
            const demographicData = {
                'age': {
                    labels: ['0-17', '18-34', '35-49', '50-64', '65+'],
                    data: [22, 28, 24, 16, 10]
                },
                'race': {
                    labels: ['White', 'Black', 'Hispanic', 'Asian', 'Other'],
                    data: [45, 25, 18, 10, 2]
                },
                'education': {
                    labels: ['Less than HS', 'High School', 'Some College', 'Bachelor\'s', 'Graduate'],
                    data: [12, 28, 22, 25, 13]
                }
            };
            
            const newData = demographicData[e.target.value];
            
            demographicChart.data.labels = newData.labels;
            demographicChart.data.datasets[0].data = newData.data;
            demographicChart.data.datasets[0].label = e.target.options[e.target.selectedIndex].text;
            
            demographicChart.update();
        });

        document.getElementById('chart3Type').addEventListener('change', (e) => {
            demographicChart.config.type = e.target.value;
            demographicChart.update();
        });

        document.getElementById('chart3Legend').addEventListener('change', (e) => {
            demographicChart.options.plugins.legend.position = e.target.value;
            demographicChart.update();
        });

        document.getElementById('environmentalMetric').addEventListener('change', (e) => {
            const environmentalData = {
                'airQuality': {
                    label: 'Air Quality Index',
                    data: [135, 142, 98, 112, 128],
                    yAxisLabel: 'AQI (higher is worse)',
                    threshold: 100
                },
                'noise': {
                    label: 'Noise Pollution',
                    data: [72, 68, 54, 61, 65],
                    yAxisLabel: 'Average dB Level',
                    threshold: 65
                },
                'temperature': {
                    label: 'Urban Heat Island Effect',
                    data: [5.2, 4.8, 2.3, 3.1, 4.2],
                    yAxisLabel: 'Temp Difference (F above rural)',
                    threshold: 3.5
                }
            };
            
            const newData = environmentalData[e.target.value];
            
            environmentalChart.data.datasets[0].label = newData.label;
            environmentalChart.data.datasets[0].data = newData.data;
            environmentalChart.options.scales.y.title.text = newData.yAxisLabel;
            
            // Update threshold line
            environmentalChart.data.datasets[1].data = Array(5).fill(newData.threshold);
            document.getElementById('chart4ThresholdValue').value = newData.threshold;
            
            environmentalChart.update();
        });

        document.getElementById('chart4Type').addEventListener('change', (e) => {
            environmentalChart.config.type = e.target.value;
            // Keep the threshold as a line
            environmentalChart.data.datasets[1].type = 'line';
            environmentalChart.update();
        });

        document.getElementById('chart4Threshold').addEventListener('change', (e) => {
            environmentalChart.data.datasets[1].hidden = !e.target.checked;
            environmentalChart.update();
        });

        document.getElementById('chart4ThresholdValue').addEventListener('input', (e) => {
            const thresholdValue = parseInt(e.target.value);
            environmentalChart.data.datasets[1].data = Array(5).fill(thresholdValue);
            environmentalChart.update();
        });

        // Close floating controls when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('#toggleChart1Controls') && 
                !e.target.closest('#chart1Controls')) {
                document.getElementById('chart1Controls').classList.remove('active');
            }
            
            if (!e.target.closest('#toggleChart2Controls') && 
                !e.target.closest('#chart2Controls')) {
                document.getElementById('chart2Controls').classList.remove('active');
            }
            
            if (!e.target.closest('#toggleChart3Controls') && 
                !e.target.closest('#chart3Controls')) {
                document.getElementById('chart3Controls').classList.remove('active');
            }
            
            if (!e.target.closest('#toggleChart4Controls') && 
                !e.target.closest('#chart4Controls')) {
                document.getElementById('chart4Controls').classList.remove('active');
            }
        });

        // Filter handlers
        document.getElementById('neighborhood-filter').addEventListener('change', (e) => {
            // This would filter data based on neighborhood selection
            console.log(`Filtering by neighborhood: ${e.target.value}`);
            
            // Simulate updating the map view based on selection
            if (e.target.value === 'eastside') {
                map.setView([40.7328, -73.9710], 14);
            } else if (e.target.value === 'downtown') {
                map.setView([40.7128, -74.0060], 14);
            } else if (e.target.value === 'westside') {
                map.setView([40.6928, -74.0260], 14);
            } else if (e.target.value === 'northside') {
                map.setView([40.7528, -73.9660], 14);
            } else if (e.target.value === 'southside') {
                map.setView([40.7028, -73.9860], 14);
            } else {
                map.setView([40.7128, -74.0060], 12);
            }
        });

        document.getElementById('income-filter').addEventListener('change', (e) => {
            // This would filter data based on income level
            console.log(`Filtering by income level: ${e.target.value}`);
            
            // Simulate updating charts based on income filter
            if (e.target.value === 'low') {
                accessChart.data.labels = ['Low Income'];
                accessChart.data.datasets[0].data = [1.2];
                accessChart.data.datasets[0].backgroundColor = ['rgba(46, 125, 50, 0.7)'];
                accessChart.data.datasets[0].borderColor = ['rgba(46, 125, 50, 1)'];
            } else if (e.target.value === 'medium') {
                accessChart.data.labels = ['Medium Income'];
                accessChart.data.datasets[0].data = [3.5];
                accessChart.data.datasets[0].backgroundColor = ['rgba(46, 125, 50, 0.7)'];
                accessChart.data.datasets[0].borderColor = ['rgba(46, 125, 50, 1)'];
            } else if (e.target.value === 'high') {
                accessChart.data.labels = ['High Income'];
                accessChart.data.datasets[0].data = [7.8];
                accessChart.data.datasets[0].backgroundColor = ['rgba(46, 125, 50, 0.7)'];
                accessChart.data.datasets[0].borderColor = ['rgba(46, 125, 50, 1)'];
            } else {
                accessChart.data.labels = ['Low Income', 'Medium Income', 'High Income'];
                accessChart.data.datasets[0].data = [1.2, 3.5, 7.8];
                accessChart.data.datasets[0].backgroundColor = ['rgba(46, 125, 50, 0.7)', 'rgba(46, 125, 50, 0.7)', 'rgba(46, 125, 50, 0.7)'];
                accessChart.data.datasets[0].borderColor = ['rgba(46, 125, 50, 1)', 'rgba(46, 125, 50, 1)', 'rgba(46, 125, 50, 1)'];
            }
            accessChart.update();
        });

        // Data source click handlers
        document.querySelectorAll('.data-source').forEach(source => {
            source.addEventListener('click', () => {
                document.querySelectorAll('.data-source').forEach(s => s.classList.remove('active'));
                source.classList.add('active');
                
                // This would update the main content based on the selected data source
                const sourceTitle = source.querySelector('.data-source-title').textContent;
                console.log(`Selected data source: ${sourceTitle}`);
            });
            
            // Add keyboard support
            source.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    source.click();
                }
            });
        });

        // Methodology framework selection
        document.querySelectorAll('input[name="framework"]').forEach(radio => {
            radio.addEventListener('change', (e) => {
                if (e.target.checked) {
                    console.log(`Selected methodological framework: ${e.target.id}`);
                    // This would update the methodology description and integration approach
                }
            });
        });

        // Tag click handlers
        document.querySelectorAll('.tag').forEach(tag => {
            tag.addEventListener('click', () => {
                const tagName = tag.textContent;
                console.log(`Filtering by tag: ${tagName}`);
                // This would filter content based on the selected tag
            });
        });

        // Search functionality
        document.querySelectorAll('.search-input').forEach(input => {
            input.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                console.log(`Searching for: ${searchTerm}`);
                // This would implement search functionality
            });
        });

        // Button handlers for interview actions
        document.querySelectorAll('.interview-card .btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const action = e.target.textContent.trim();
                console.log(`Performing action: ${action}`);
                // This would implement the specific action
            });
        });
        
        // Import data button handler
        document.getElementById('importDataBtn').addEventListener('click', () => {
            console.log('Opening import data dialog');
            // This would open a file selection dialog
        });
        
        // Add interview button handler
        document.getElementById('addInterviewBtn').addEventListener('click', () => {
            console.log('Opening add interview form');
            // This would open a form to add a new interview
        });
        
        // Tag manager button handler
        document.getElementById('tagManagerBtn').addEventListener('click', () => {
            console.log('Opening tag manager');
            // This would open a dialog to manage tags
        });
        
        // Create connection button handler
        document.getElementById('createConnectionBtn').addEventListener('click', () => {
            console.log('Opening create connection dialog');
            // This would open a dialog to create a new data connection
        });
        
        // Date range filter handlers
        document.getElementById('date-from').addEventListener('change', (e) => {
            console.log(`From date: ${e.target.value}`);
            // This would update the date range filter
        });
        
        document.getElementById('date-to').addEventListener('change', (e) => {
            console.log(`To date: ${e.target.value}`);
            // This would update the date range filter
        });
        
        // Initialize tooltips
        const tooltip = document.createElement('div');
        tooltip.className = 'tooltip';
        document.body.appendChild(tooltip);
        
        function showTooltip(text, x, y) {
            tooltip.textContent = text;
            tooltip.style.left = `${x}px`;
            tooltip.style.top = `${y}px`;
            tooltip.classList.add('active');
        }
        
        function hideTooltip() {
            tooltip.classList.remove('active');
        }
        
        // Add keyboard navigation support
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Tab') {
                // Add visual indicator for keyboard focus
                setTimeout(() => {
                    const activeElement = document.activeElement;
                    if (activeElement && 
                        (activeElement.tagName === 'BUTTON' || 
                         activeElement.tagName === 'A' || 
                         activeElement.tagName === 'INPUT' || 
                         activeElement.tagName === 'SELECT' || 
                         activeElement.hasAttribute('tabindex'))) {
                        activeElement.classList.add('keyboard-focus');
                    }
                }, 10);
            }
        });
        
        document.addEventListener('mousedown', () => {
            document.querySelectorAll('.keyboard-focus').forEach(el => {
                el.classList.remove('keyboard-focus');
            });
        });
    </script>
</body>
</html>