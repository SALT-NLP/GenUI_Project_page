<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cozy Corner Bookstore</title>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8B4513;
            --primary-dark: #6A3405;
            --primary-light: #A05C26;
            --secondary: #6B8E23;
            --secondary-dark: #556B2F;
            --secondary-light: #7FA035;
            --accent: #CD853F;
            --accent-light: #DEAA73;
            --background: #FFF8E7;
            --card-bg: #FFFFFF;
            --text: #3A3A3A;
            --light-text: #6A6A6A;
            --shadow: rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --spacing-xxl: 48px;
            --transition: all 0.3s ease;
            --font-heading: 'Merriweather', serif;
            --font-body: 'Open Sans', sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            background-color: var(--background);
            color: var(--text);
            line-height: 1.6;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-heading);
            color: var(--primary);
        }

        header {
            background-color: var(--primary);
            padding: var(--spacing-md) var(--spacing-xl);
            box-shadow: 0 2px 4px var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            transition: var(--transition);
        }

        .logo:hover {
            transform: scale(1.02);
        }

        .logo h1 {
            color: white;
            font-size: 1.8rem;
            margin-left: var(--spacing-md);
            font-weight: 700;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-weight: bold;
            font-size: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: var(--spacing-xl);
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--border-radius);
            position: relative;
        }

        nav a:hover, nav a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        nav a::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background-color: white;
            transition: var(--transition);
        }

        nav a:hover::after, nav a.active::after {
            width: 80%;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .mobile-menu-btn:hover {
            transform: scale(1.1);
        }

        .hero {
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://placehold.co/1200x600?text=Cozy+Bookstore');
            background-size: cover;
            background-position: center;
            color: white;
            text-align: center;
            padding: var(--spacing-xxl) var(--spacing-md);
            position: relative;
            animation: fadeIn 1s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .hero h2 {
            font-size: 2.8rem;
            margin-bottom: var(--spacing-md);
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            animation: slideDown 1.2s ease-in-out;
        }

        @keyframes slideDown {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .hero p {
            font-size: 1.3rem;
            margin-bottom: var(--spacing-xl);
            animation: slideUp 1.2s ease-in-out;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .btn {
            display: inline-block;
            background-color: var(--accent);
            color: white;
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .btn:hover {
            background-color: var(--accent-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .btn:focus {
            outline: 3px solid rgba(205, 133, 63, 0.4);
        }

        .btn-secondary {
            background-color: var(--secondary);
        }

        .btn-secondary:hover {
            background-color: var(--secondary-light);
        }

        .btn-secondary:focus {
            outline: 3px solid rgba(107, 142, 35, 0.4);
        }

        .section {
            padding: var(--spacing-xl) var(--spacing-md);
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-header {
            text-align: center;
            margin-bottom: var(--spacing-xl);
        }

        .section-header h2 {
            font-size: 2.2rem;
            color: var(--primary);
            margin-bottom: var(--spacing-sm);
            position: relative;
            display: inline-block;
            padding-bottom: var(--spacing-sm);
        }

        .section-header h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background-color: var(--accent);
        }

        .section-header p {
            color: var(--light-text);
            max-width: 700px;
            margin: 0 auto;
            font-size: 1.1rem;
        }

        .inventory-controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
            gap: var(--spacing-md);
            background-color: var(--card-bg);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
            box-shadow: 0 2px 8px var(--shadow);
        }

        .search-container {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .search-container input {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            padding-left: 40px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }

        .search-container input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(139, 69, 19, 0.2);
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--light-text);
        }

        .filter-container {
            display: flex;
            gap: var(--spacing-md);
            flex-wrap: wrap;
        }

        .filter-select {
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            background-color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(139, 69, 19, 0.2);
        }

        .book-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: var(--spacing-lg);
        }

        .book-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 2px 8px var(--shadow);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .book-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px var(--shadow);
        }

        .book-image {
            height: 300px;
            background-color: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .book-image::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, transparent 80%, rgba(0, 0, 0, 0.05));
        }

        .book-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .book-card:hover .book-image img {
            transform: scale(1.05);
        }

        .book-details {
            padding: var(--spacing-md);
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .book-title {
            font-size: 1.2rem;
            margin-bottom: var(--spacing-xs);
            color: var(--primary);
            font-weight: 700;
        }

        .book-author {
            color: var(--light-text);
            margin-bottom: var(--spacing-sm);
            font-style: italic;
        }

        .book-price {
            font-weight: bold;
            margin-bottom: var(--spacing-md);
            color: var(--primary-dark);
        }

        .book-tags {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-xs);
            margin-bottom: var(--spacing-md);
        }

        .book-tag {
            background-color: #f0f0f0;
            padding: 2px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            color: var(--light-text);
            transition: var(--transition);
        }

        .book-tag:hover {
            background-color: var(--accent-light);
            color: white;
        }

        .book-card .btn {
            margin-top: auto;
        }

        .pagination {
            display: flex;
            justify-content: center;
            margin-top: var(--spacing-xl);
            gap: var(--spacing-xs);
        }

        .pagination button {
            width: 40px;
            height: 40px;
            border: 1px solid #ddd;
            background-color: white;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .pagination button:hover, .pagination button.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination button:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(139, 69, 19, 0.2);
        }

        .book-club {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: var(--spacing-xl);
            margin-top: var(--spacing-xl);
            box-shadow: 0 2px 8px var(--shadow);
        }

        .book-club-header {
            display: flex;
            align-items: center;
            margin-bottom: var(--spacing-lg);
        }

        .book-club-icon {
            font-size: 2.5rem;
            margin-right: var(--spacing-md);
            color: var(--secondary);
            animation: pulse 2s infinite ease-in-out;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .book-club-info h3 {
            color: var(--primary);
            margin-bottom: var(--spacing-xs);
            font-size: 1.6rem;
        }

        .meeting-details {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-xl);
            margin-bottom: var(--spacing-xl);
            padding: var(--spacing-md);
            background-color: rgba(107, 142, 35, 0.1);
            border-radius: var(--border-radius);
        }

        .meeting-detail {
            display: flex;
            align-items: center;
        }

        .meeting-icon {
            width: 40px;
            height: 40px;
            background-color: var(--secondary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: var(--spacing-sm);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .form-container {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: var(--spacing-xl);
            box-shadow: 0 2px 8px var(--shadow);
        }

        .form-container h3 {
            margin-bottom: var(--spacing-md);
            font-size: 1.4rem;
            position: relative;
            display: inline-block;
            padding-bottom: var(--spacing-xs);
        }

        .form-container h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 2px;
            background-color: var(--accent);
        }

        .form-container p {
            margin-bottom: var(--spacing-lg);
            color: var(--light-text);
        }

        .form-group {
            margin-bottom: var(--spacing-md);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--spacing-xs);
            font-weight: 600;
            color: var(--primary-dark);
        }

        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            font-family: var(--font-body);
        }

        .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(139, 69, 19, 0.2);
        }

        .form-error {
            color: #d9534f;
            font-size: 0.9rem;
            margin-top: var(--spacing-xs);
            display: none;
        }

        .newsletter {
            background-color: var(--secondary);
            color: white;
            padding: var(--spacing-xxl) var(--spacing-md);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .newsletter::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://placehold.co/1200x600?text=Pattern') center/cover;
            opacity: 0.1;
        }

        .newsletter-content {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .newsletter h3 {
            margin-bottom: var(--spacing-md);
            font-size: 1.8rem;
            color: white;
        }

        .newsletter p {
            margin-bottom: var(--spacing-lg);
            font-size: 1.1rem;
        }

        .newsletter-form {
            display: flex;
            gap: var(--spacing-sm);
            max-width: 500px;
            margin: 0 auto;
        }

        .newsletter-form input {
            flex: 1;
            padding: var(--spacing-md);
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
        }

        .newsletter-form input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
        }

        footer {
            background-color: var(--primary);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-xl);
        }

        .footer-section h3 {
            margin-bottom: var(--spacing-md);
            border-bottom: 2px solid var(--accent);
            padding-bottom: var(--spacing-xs);
            display: inline-block;
            color: white;
            font-size: 1.3rem;
        }

        .footer-section p, .footer-section a {
            margin-bottom: var(--spacing-sm);
            display: block;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-section a:hover {
            color: white;
            transform: translateX(5px);
        }

        .social-links {
            display: flex;
            gap: var(--spacing-md);
            margin-top: var(--spacing-md);
        }

        .social-link {
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: white;
            text-decoration: none;
        }

        .social-link:hover {
            background-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-3px);
        }

        .copyright {
            text-align: center;
            padding-top: var(--spacing-lg);
            margin-top: var(--spacing-lg);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.6);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            overflow-y: auto;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.active {
            opacity: 1;
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: var(--spacing-xl);
            border-radius: var(--border-radius);
            max-width: 800px;
            position: relative;
            animation: modalFadeIn 0.3s;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .close-modal {
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-md);
            font-size: 1.5rem;
            cursor: pointer;
            background: none;
            border: none;
            color: var(--light-text);
            transition: var(--transition);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-modal:hover {
            color: var(--text);
            background-color: #f0f0f0;
        }

        .book-detail {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-xl);
        }

        .book-detail-image {
            flex: 1;
            min-width: 250px;
            max-width: 300px;
        }

        .book-detail-image img {
            width: 100%;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 15px var(--shadow);
            transition: var(--transition);
        }

        .book-detail-image img:hover {
            transform: scale(1.03);
        }

        .book-detail-info {
            flex: 2;
            min-width: 300px;
        }

        .book-detail-title {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: var(--spacing-xs);
        }

        .book-detail-author {
            color: var(--light-text);
            font-style: italic;
            margin-bottom: var(--spacing-md);
            font-size: 1.1rem;
        }

        .book-detail-meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-lg);
            border-bottom: 1px solid #eee;
        }

        .book-detail-meta-item {
            display: flex;
            flex-direction: column;
        }

        .meta-label {
            font-size: 0.9rem;
            color: var(--light-text);
            margin-bottom: 2px;
        }

        .meta-value {
            font-weight: 600;
            color: var(--primary-dark);
        }

        .book-description {
            line-height: 1.8;
            margin-bottom: var(--spacing-lg);
        }

        .book-description h3 {
            margin-bottom: var(--spacing-sm);
            font-size: 1.3rem;
        }

        .book-detail .btn {
            margin-right: var(--spacing-sm);
            margin-bottom: var(--spacing-sm);
        }

        .success-message {
            display: none;
            background-color: #DFF2BF;
            color: #4F8A10;
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
            margin-bottom: var(--spacing-md);
            text-align: center;
            animation: fadeIn 0.5s ease;
            border-left: 4px solid #4F8A10;
        }

        .loading-indicator {
            display: none;
            text-align: center;
            margin: var(--spacing-md) 0;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(139, 69, 19, 0.2);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .view-more-btn {
            text-align: center;
            margin-top: var(--spacing-xl);
        }

        .view-more-btn .btn {
            padding: var(--spacing-sm) var(--spacing-xl);
        }

        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s infinite;
            border-radius: var(--border-radius);
        }

        @keyframes skeleton-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .skeleton-book {
            height: 300px;
        }

        .skeleton-text {
            height: 15px;
            margin-bottom: 10px;
            width: 100%;
        }

        .skeleton-text.short {
            width: 60%;
        }

        .featured-book {
            position: relative;
        }

        .featured-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--accent);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 2;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .new-arrival {
            position: relative;
        }

        .new-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: var(--secondary);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 2;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            background-color: #f0f0f0;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .quantity-btn:hover {
            background-color: #e0e0e0;
        }

        .quantity-input {
            width: 40px;
            text-align: center;
            margin: 0 var(--spacing-sm);
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 4px;
        }

        /* Admin panel styles */
        .admin-panel {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: var(--spacing-xl);
            margin-top: var(--spacing-xl);
            box-shadow: 0 2px 8px var(--shadow);
        }

        .admin-tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: var(--spacing-lg);
        }

        .admin-tab {
            padding: var(--spacing-sm) var(--spacing-lg);
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: var(--transition);
            font-weight: 600;
        }

        .admin-tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
        }

        .admin-tab:hover:not(.active) {
            border-bottom-color: var(--accent-light);
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .book-import-area {
            border: 2px dashed #ddd;
            border-radius: var(--border-radius);
            padding: var(--spacing-xl);
            text-align: center;
            margin-bottom: var(--spacing-lg);
            transition: var(--transition);
        }

        .book-import-area:hover {
            border-color: var(--primary-light);
            background-color: rgba(139, 69, 19, 0.05);
        }

        .book-import-area p {
            margin-bottom: var(--spacing-md);
            color: var(--light-text);
        }

        .book-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: var(--spacing-lg);
        }

        .book-table th, .book-table td {
            padding: var(--spacing-sm);
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .book-table th {
            background-color: #f5f5f5;
            font-weight: 600;
            color: var(--primary-dark);
        }

        .book-table tr:hover {
            background-color: #f9f9f9;
        }

        .book-table .actions {
            display: flex;
            gap: var(--spacing-xs);
        }

        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--primary);
            transition: var(--transition);
        }

        .action-btn:hover {
            color: var(--accent);
        }

        .search-results-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background-color: white;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            box-shadow: 0 4px 8px var(--shadow);
            z-index: 10;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }

        .search-results-dropdown.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        .search-result-item {
            padding: var(--spacing-sm) var(--spacing-md);
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: var(--transition);
        }

        .search-result-item:hover {
            background-color: #f5f5f5;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .wishlist-toggle {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
            z-index: 2;
        }

        .wishlist-toggle:hover {
            transform: scale(1.1);
        }

        .wishlist-toggle.active {
            color: #e74c3c;
        }

        .filters-dropdown {
            position: relative;
        }

        .filters-btn {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-sm) var(--spacing-md);
            background-color: white;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }

        .filters-btn:hover {
            background-color: #f5f5f5;
        }

        .filters-content {
            position: absolute;
            top: 100%;
            right: 0;
            width: 300px;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 8px var(--shadow);
            padding: var(--spacing-md);
            z-index: 10;
            display: none;
        }

        .filters-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        .filter-group {
            margin-bottom: var(--spacing-md);
        }

        .filter-group h4 {
            margin-bottom: var(--spacing-xs);
            color: var(--primary-dark);
        }

        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-xs);
        }

        .filter-checkbox {
            display: none;
        }

        .filter-label {
            display: inline-block;
            padding: 4px 10px;
            background-color: #f0f0f0;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-checkbox:checked + .filter-label {
            background-color: var(--primary-light);
            color: white;
        }

        .theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
            z-index: 99;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                align-items: flex-start;
            }

            .logo {
                margin-bottom: var(--spacing-md);
            }

            nav {
                width: 100%;
                display: none;
            }

            nav.active {
                display: block;
                animation: slideDown 0.3s ease;
            }

            nav ul {
                flex-direction: column;
                gap: var(--spacing-sm);
            }

            nav a {
                display: block;
                padding: var(--spacing-sm);
            }

            .mobile-menu-btn {
                display: block;
                position: absolute;
                top: var(--spacing-md);
                right: var(--spacing-md);
            }

            .inventory-controls {
                flex-direction: column;
            }

            .filter-container {
                width: 100%;
            }

            .filter-select {
                flex: 1;
            }

            .newsletter-form {
                flex-direction: column;
            }

            .book-detail {
                flex-direction: column;
                align-items: center;
            }

            .book-detail-image {
                max-width: 100%;
            }

            .hero h2 {
                font-size: 2rem;
            }

            .hero p {
                font-size: 1.1rem;
            }

            .section-header h2 {
                font-size: 1.8rem;
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .book-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
        }

        /* Accessibility improvements */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Focus styles for keyboard navigation */
        a:focus, button:focus, input:focus, select:focus, textarea:focus {
            outline: 3px solid rgba(139, 69, 19, 0.4);
            outline-offset: 2px;
        }

        /* Skip to main content link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary);
            color: white;
            padding: 8px;
            z-index: 1001;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Dark mode support */
        .dark-mode {
            --background: #1a1a1a;
            --card-bg: #2a2a2a;
            --text: #f0f0f0;
            --light-text: #aaaaaa;
            --shadow: rgba(0, 0, 0, 0.3);
        }

        .dark-mode .book-tag {
            background-color: #3a3a3a;
            color: #ddd;
        }

        .dark-mode .book-table th {
            background-color: #333;
        }

        .dark-mode .book-table tr:hover {
            background-color: #333;
        }

        .dark-mode .filter-label {
            background-color: #3a3a3a;
            color: #ddd;
        }

        .dark-mode .search-container input,
        .dark-mode .filter-select,
        .dark-mode .form-group input,
        .dark-mode .form-group textarea,
        .dark-mode .form-group select {
            background-color: #333;
            border-color: #444;
            color: #f0f0f0;
        }

        .dark-mode .search-result-item:hover {
            background-color: #333;
        }

        .dark-mode .modal-content,
        .dark-mode .search-results-dropdown,
        .dark-mode .filters-content {
            background-color: #2a2a2a;
        }

        .dark-mode .close-modal:hover {
            background-color: #333;
        }

        .dark-mode .book-image {
            background-color: #333;
        }
    </style>
</head>
<body>
    <a href="#main" class="skip-link">Skip to main content</a>
    <header>
        <div class="header-container">
            <a href="#" class="logo" aria-label="Cozy Corner Bookstore Home">
                <div class="logo-icon">B</div>
                <h1>Cozy Corner Bookstore</h1>
            </a>
            <button class="mobile-menu-btn" aria-label="Toggle navigation menu" aria-expanded="false">‚ò∞</button>
            <nav aria-label="Main navigation">
                <ul>
                    <li><a href="#" class="active">Home</a></li>
                    <li><a href="#inventory">Inventory</a></li>
                    <li><a href="#book-club">Book Club</a></li>
                    <li><a href="#newsletter">Newsletter</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="hero" aria-label="Welcome banner">
        <div class="hero-content">
            <h2>Welcome to Cozy Corner Bookstore</h2>
            <p>A warm and inviting place for book lovers to discover their next favorite read. Browse our extensive collection, join our monthly book club, or sign up for our newsletter.</p>
            <a href="#inventory" class="btn">Browse Books</a>
        </div>
    </section>

    <main id="main">
        <section id="inventory" class="section" aria-label="Book inventory">
            <div class="section-header">
                <h2>Our Inventory</h2>
                <p>Explore our collection of over 5,000 titles across various genres. From bestsellers to rare finds, we have something for every reader.</p>
            </div>

            <div class="inventory-controls">
                <div class="search-container">
                    <span class="search-icon" aria-hidden="true">üîç</span>
                    <input type="text" id="search-input" placeholder="Search by title, author, or ISBN..." aria-label="Search books">
                    <div class="search-results-dropdown" id="search-results">
                        <!-- Search results will be dynamically inserted here -->
                    </div>
                </div>
                <div class="filter-container">
                    <select class="filter-select" id="genre-filter" aria-label="Filter by genre">
                        <option value="">All Genres</option>
                        <option value="fiction">Fiction</option>
                        <option value="non-fiction">Non-Fiction</option>
                        <option value="mystery">Mystery</option>
                        <option value="sci-fi">Science Fiction</option>
                        <option value="fantasy">Fantasy</option>
                        <option value="romance">Romance</option>
                        <option value="biography">Biography</option>
                        <option value="history">History</option>
                        <option value="children">Children's Books</option>
                    </select>
                    <select class="filter-select" id="sort-by" aria-label="Sort books">
                        <option value="title">Sort by Title</option>
                        <option value="author">Sort by Author</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                        <option value="newest">Newest Arrivals</option>
                    </select>
                    <div class="filters-dropdown">
                        <button class="filters-btn" aria-expanded="false" aria-label="Advanced filters">
                            <span>Filters</span>
                            <span>‚ñº</span>
                        </button>
                        <div class="filters-content" id="filters-dropdown">
                            <div class="filter-group">
                                <h4>Price Range</h4>
                                <div class="form-group">
                                    <label for="min-price">Min Price</label>
                                    <input type="number" id="min-price" min="0" step="0.01" placeholder="Min">
                                </div>
                                <div class="form-group">
                                    <label for="max-price">Max Price</label>
                                    <input type="number" id="max-price" min="0" step="0.01" placeholder="Max">
                                </div>
                            </div>
                            <div class="filter-group">
                                <h4>Availability</h4>
                                <div class="filter-options">
                                    <input type="checkbox" id="in-stock" class="filter-checkbox" checked>
                                    <label for="in-stock" class="filter-label">In Stock</label>
                                    <input type="checkbox" id="out-of-stock" class="filter-checkbox">
                                    <label for="out-of-stock" class="filter-label">Out of Stock</label>
                                </div>
                            </div>
                            <div class="filter-group">
                                <h4>Special</h4>
                                <div class="filter-options">
                                    <input type="checkbox" id="new-arrivals" class="filter-checkbox">
                                    <label for="new-arrivals" class="filter-label">New Arrivals</label>
                                    <input type="checkbox" id="featured" class="filter-checkbox">
                                    <label for="featured" class="filter-label">Featured</label>
                                </div>
                            </div>
                            <button class="btn btn-secondary" id="apply-filters">Apply Filters</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="loading-indicator" id="loading-indicator">
                <div class="loading-spinner"></div>
                <p>Loading books...</p>
            </div>

            <div class="book-grid" id="book-container">
                <!-- Book cards will be dynamically generated here -->
            </div>

            <div class="pagination" id="pagination" aria-label="Pagination">
                <!-- Pagination buttons will be dynamically generated here -->
            </div>
        </section>

        <section id="book-club" class="section" aria-label="Book club information">
            <div class="section-header">
                <h2>Monthly Book Club</h2>
                <p>Join fellow book enthusiasts in our monthly meetings where we discuss selected books, share insights, and enjoy refreshments in a cozy setting.</p>
            </div>

            <div class="book-club">
                <div class="book-club-header">
                    <div class="book-club-icon" aria-hidden="true">üìö</div>
                    <div class="book-club-info">
                        <h3>October Book Club Meeting</h3>
                        <p>This month we're reading "The Midnight Library" by Matt Haig, a thought-provoking novel about the choices that go into a life well lived.</p>
                    </div>
                </div>

                <div class="meeting-details">
                    <div class="meeting-detail">
                        <div class="meeting-icon" aria-hidden="true">üìÖ</div>
                        <div>
                            <strong>Date</strong>
                            <p>October 15, 2023</p>
                        </div>
                    </div>
                    <div class="meeting-detail">
                        <div class="meeting-icon" aria-hidden="true">üïï</div>
                        <div>
                            <strong>Time</strong>
                            <p>6:30 PM - 8:00 PM</p>
                        </div>
                    </div>
                    <div class="meeting-detail">
                        <div class="meeting-icon" aria-hidden="true">üìç</div>
                        <div>
                            <strong>Location</strong>
                            <p>Cozy Corner Bookstore, Reading Room</p>
                        </div>
                    </div>
                </div>

                <div class="form-container">
                    <h3>Register for Book Club</h3>
                    <p>Fill out the form below to reserve your spot for our upcoming book club meeting. Space is limited, so register early!</p>
                    
                    <div class="success-message" id="book-club-success" role="alert">
                        Thank you for registering! We've sent a confirmation email with all the details.
                    </div>
                    
                    <form id="book-club-form">
                        <div class="form-group">
                            <label for="name">Full Name</label>
                            <input type="text" id="name" required aria-describedby="name-error">
                            <div class="form-error" id="name-error">Please enter your name</div>
                        </div>
                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <input type="email" id="email" required aria-describedby="email-error">
                            <div class="form-error" id="email-error">Please enter a valid email address</div>
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone Number (optional)</label>
                            <input type="tel" id="phone">
                        </div>
                        <div class="form-group">
                            <label for="book-preference">Do you already have a copy of the book?</label>
                            <select id="book-preference">
                                <option value="yes">Yes, I have the book</option>
                                <option value="no">No, I need to purchase it</option>
                                <option value="ebook">I have the e-book version</option>
                                <option value="audiobook">I have the audiobook</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="comments">Comments or Questions</label>
                            <textarea id="comments" rows="3"></textarea>
                        </div>
                        <button type="submit" class="btn btn-secondary">Register Now</button>
                    </form>
                </div>
            </div>
        </section>

        <section id="newsletter" class="newsletter" aria-label="Newsletter signup">
            <div class="newsletter-content">
                <h3>Subscribe to Our Newsletter</h3>
                <p>Stay updated with new arrivals, author events, special promotions, and book club announcements delivered straight to your inbox.</p>
                
                <div class="success-message" id="newsletter-success" role="alert">
                    Thanks for subscribing! You'll receive our next newsletter soon.
                </div>
                
                <form class="newsletter-form" id="newsletter-form">
                    <input type="email" placeholder="Your email address" required aria-label="Your email address">
                    <button type="submit" class="btn">Subscribe</button>
                </form>
            </div>
        </section>
    </main>

    <footer id="contact">
        <div class="footer-container">
            <div class="footer-section">
                <h3>Visit Us</h3>
                <p>123 Book Lane</p>
                <p>Readingville, RD 12345</p>
                <p>United States</p>
            </div>
            <div class="footer-section">
                <h3>Store Hours</h3>
                <p>Monday - Friday: 9AM - 8PM</p>
                <p>Saturday: 10AM - 9PM</p>
                <p>Sunday: 11AM - 6PM</p>
            </div>
            <div class="footer-section">
                <h3>Contact Us</h3>
                <p>Phone: (555) 123-4567</p>
                <p>Email: hello@cozycornerbooks.com</p>
                <div class="social-links">
                    <a href="#" class="social-link" aria-label="Twitter">ùïè</a>
                    <a href="#" class="social-link" aria-label="Facebook">∆í</a>
                    <a href="#" class="social-link" aria-label="Instagram">üì∑</a>
                </div>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <a href="#">Home</a>
                <a href="#inventory">Browse Books</a>
                <a href="#book-club">Book Club</a>
                <a href="#newsletter">Newsletter</a>
                <a href="#">Events</a>
                <a href="#">About Us</a>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2023 Cozy Corner Bookstore. All rights reserved.</p>
        </div>
    </footer>

    <div class="modal" id="book-modal" aria-hidden="true" role="dialog" aria-labelledby="book-detail-title">
        <div class="modal-content">
            <button class="close-modal" aria-label="Close book details">&times;</button>
            <div class="book-detail" id="book-detail-content">
                <!-- Book detail content will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <div class="modal" id="admin-login-modal" aria-hidden="true" role="dialog">
        <div class="modal-content" style="max-width: 500px;">
            <button class="close-modal" aria-label="Close login form">&times;</button>
            <h2 style="margin-bottom: 20px; color: var(--primary);">Admin Login</h2>
            <form id="admin-login-form">
                <div class="form-group">
                    <label for="admin-username">Username</label>
                    <input type="text" id="admin-username" required>
                </div>
                <div class="form-group">
                    <label for="admin-password">Password</label>
                    <input type="password" id="admin-password" required>
                </div>
                <div class="form-error" id="login-error" style="display: none; margin-bottom: 15px;">
                    Invalid username or password
                </div>
                <button type="submit" class="btn" style="width: 100%;">Login</button>
            </form>
        </div>
    </div>

    <div class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
        üåì
    </div>

    <script>
        // Sample book data (would be replaced by actual database data)
        const books = [
            {
                id: 1,
                title: "The Midnight Library",
                author: "Matt Haig",
                price: 14.99,
                image: "https://placehold.co/300x450?text=The+Midnight+Library",
                genre: "fiction",
                isbn: "9780525559474",
                publishDate: "2020-09-29",
                description: "Between life and death there is a library, and within that library, the shelves go on forever. Every book provides a chance to try another life you could have lived. To see how things would be if you had made other choices... Would you have done anything different, if you had the chance to undo your regrets?",
                pages: 304,
                publisher: "Viking",
                inStock: true,
                featured: true,
                newArrival: false
            },
            {
                id: 2,
                title: "Educated",
                author: "Tara Westover",
                price: 16.99,
                image: "https://placehold.co/300x450?text=Educated",
                genre: "non-fiction",
                isbn: "9780399590504",
                publishDate: "2018-02-20",
                description: "An unforgettable memoir about a young girl who, kept out of school, leaves her survivalist family and goes on to earn a PhD from Cambridge University.",
                pages: 352,
                publisher: "Random House",
                inStock: true,
                featured: false,
                newArrival: false
            },
            {
                id: 3,
                title: "Where the Crawdads Sing",
                author: "Delia Owens",
                price: 12.99,
                image: "https://placehold.co/300x450?text=Where+the+Crawdads+Sing",
                genre: "fiction",
                isbn: "9780735219090",
                publishDate: "2018-08-14",
                description: "For years, rumors of the 'Marsh Girl' have haunted Barkley Cove, a quiet town on the North Carolina coast. So in late 1969, when handsome Chase Andrews is found dead, the locals immediately suspect Kya Clark, the so-called Marsh Girl.",
                pages: 384,
                publisher: "G.P. Putnam's Sons",
                inStock: true,
                featured: true,
                newArrival: false
            },
            {
                id: 4,
                title: "The Silent Patient",
                author: "Alex Michaelides",
                price: 13.99,
                image: "https://placehold.co/300x450?text=The+Silent+Patient",
                genre: "mystery",
                isbn: "9781250301697",
                publishDate: "2019-02-05",
                description: "Alicia Berenson's life is seemingly perfect. A famous painter married to an in-demand fashion photographer, she lives in a grand house with big windows overlooking a park in one of London's most desirable areas. One evening her husband Gabriel returns home late from a fashion shoot, and Alicia shoots him five times in the face, and then never speaks another word.",
                pages: 336,
                publisher: "Celadon Books",
                inStock: true,
                featured: false,
                newArrival: false
            },
            {
                id: 5,
                title: "Project Hail Mary",
                author: "Andy Weir",
                price: 15.99,
                image: "https://placehold.co/300x450?text=Project+Hail+Mary",
                genre: "sci-fi",
                isbn: "9780593135204",
                publishDate: "2021-05-04",
                description: "Ryland Grace is the sole survivor on a desperate, last-chance mission‚Äîand if he fails, humanity and the earth itself will perish. Except that right now, he doesn't know that. He can't even remember his own name, let alone the nature of his assignment or how to complete it.",
                pages: 496,
                publisher: "Ballantine Books",
                inStock: true,
                featured: false,
                newArrival: true
            },
            {
                id: 6,
                title: "The House in the Cerulean Sea",
                author: "TJ Klune",
                price: 17.99,
                image: "https://placehold.co/300x450?text=The+House+in+the+Cerulean+Sea",
                genre: "fantasy",
                isbn: "9781250217288",
                publishDate: "2020-03-17",
                description: "A magical island. A dangerous task. A burning secret. Linus Baker leads a quiet, solitary life. At forty, he lives in a tiny house with a devious cat and his old records. As a Case Worker at the Department in Charge Of Magical Youth, he spends his days overseeing the well-being of children in government-sanctioned orphanages.",
                pages: 400,
                publisher: "Tor Books",
                inStock: true,
                featured: false,
                newArrival: false
            },
            {
                id: 7,
                title: "Becoming",
                author: "Michelle Obama",
                price: 19.99,
                image: "https://placehold.co/300x450?text=Becoming",
                genre: "biography",
                isbn: "9781524763138",
                publishDate: "2018-11-13",
                description: "In her memoir, a work of deep reflection and mesmerizing storytelling, Michelle Obama invites readers into her world, chronicling the experiences that have shaped her‚Äîfrom her childhood on the South Side of Chicago to her years as an executive balancing the demands of motherhood and work, to her time spent at the world's most famous address.",
                pages: 448,
                publisher: "Crown",
                inStock: true,
                featured: false,
                newArrival: false
            },
            {
                id: 8,
                title: "The Four Winds",
                author: "Kristin Hannah",
                price: 14.99,
                image: "https://placehold.co/300x450?text=The+Four+Winds",
                genre: "fiction",
                isbn: "9781250178602",
                publishDate: "2021-02-02",
                description: "Texas, 1934. Millions are out of work and a drought has broken the Great Plains. Farmers are fighting to keep their land and their livelihoods as the crops are failing, the water is drying up, and dust threatens to bury them all. One of the darkest periods of the Great Depression, the Dust Bowl era, has arrived with a vengeance.",
                pages: 464,
                publisher: "St. Martin's Press",
                inStock: true,
                featured: false,
                newArrival: true
            },
            {
                id: 9,
                title: "The Vanishing Half",
                author: "Brit Bennett",
                price: 16.99,
                image: "https://placehold.co/300x450?text=The+Vanishing+Half",
                genre: "fiction",
                isbn: "9780525536291",
                publishDate: "2020-06-02",
                description: "The Vignes twin sisters will always be identical. But after growing up together in a small, southern black community and running away at age sixteen, it's not just the shape of their daily lives that is different as adults, it's everything: their families, their communities, their racial identities.",
                pages: 352,
                publisher: "Riverhead Books",
                inStock: true,
                featured: false,
                newArrival: false
            },
            {
                id: 10,
                title: "Klara and the Sun",
                author: "Kazuo Ishiguro",
                price: 15.99,
                image: "https://placehold.co/300x450?text=Klara+and+the+Sun",
                genre: "sci-fi",
                isbn: "9780571364879",
                publishDate: "2021-03-02",
                description: "From the bestselling and Booker Prize-winning author of Never Let Me Go and The Remains of the Day, a stunning new novel that asks, what does it mean to love?",
                pages: 320,
                publisher: "Faber & Faber",
                inStock: true,
                featured: false,
                newArrival: true
            },
            {
                id: 11,
                title: "The Invisible Life of Addie LaRue",
                author: "V.E. Schwab",
                price: 18.99,
                image: "https://placehold.co/300x450?text=The+Invisible+Life+of+Addie+LaRue",
                genre: "fantasy",
                isbn: "9780765387561",
                publishDate: "2020-10-06",
                description: "A Life No One Will Remember. A Story You Will Never Forget. France, 1714: in a moment of desperation, a young woman makes a Faustian bargain to live forever‚Äîand is cursed to be forgotten by everyone she meets.",
                pages: 448,
                publisher: "Tor Books",
                inStock: true,
                featured: true,
                newArrival: false
            },
            {
                id: 12,
                title: "Circe",
                author: "Madeline Miller",
                price: 13.99,
                image: "https://placehold.co/300x450?text=Circe",
                genre: "fantasy",
                isbn: "9780316556347",
                publishDate: "2018-04-10",
                description: "In the house of Helios, god of the sun and mightiest of the Titans, a daughter is born. But Circe is a strange child‚Äînot powerful, like her father, nor viciously alluring like her mother. Turning to the world of mortals for companionship, she discovers that she does possess power‚Äîthe power of witchcraft, which can transform rivals into monsters and menace the gods themselves.",
                pages: 400,
                publisher: "Little, Brown and Company",
                inStock: true,
                featured: false,
                newArrival: false
            }
        ];

        // DOM elements
        const bookContainer = document.getElementById('book-container');
        const paginationContainer = document.getElementById('pagination');
        const searchInput = document.getElementById('search-input');
        const searchResults = document.getElementById('search-results');
        const genreFilter = document.getElementById('genre-filter');
        const sortBy = document.getElementById('sort-by');
        const bookModal = document.getElementById('book-modal');
        const bookDetailContent = document.getElementById('book-detail-content');
        const closeModal = document.querySelector('.close-modal');
        const bookClubForm = document.getElementById('book-club-form');
        const bookClubSuccess = document.getElementById('book-club-success');
        const newsletterForm = document.getElementById('newsletter-form');
        const newsletterSuccess = document.getElementById('newsletter-success');
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const nav = document.querySelector('nav');
        const loadingIndicator = document.getElementById('loading-indicator');
        const filtersBtn = document.querySelector('.filters-btn');
        const filtersContent = document.getElementById('filters-dropdown');
        const applyFiltersBtn = document.getElementById('apply-filters');
        const minPriceInput = document.getElementById('min-price');
        const maxPriceInput = document.getElementById('max-price');
        const inStockCheckbox = document.getElementById('in-stock');
        const outOfStockCheckbox = document.getElementById('out-of-stock');
        const newArrivalsCheckbox = document.getElementById('new-arrivals');
        const featuredCheckbox = document.getElementById('featured');
        const themeToggle = document.getElementById('theme-toggle');
        const adminLoginModal = document.getElementById('admin-login-modal');
        const adminLoginForm = document.getElementById('admin-login-form');

        // Mobile menu toggle
        mobileMenuBtn.addEventListener('click', () => {
            nav.classList.toggle('active');
            const expanded = mobileMenuBtn.getAttribute('aria-expanded') === 'true' || false;
            mobileMenuBtn.setAttribute('aria-expanded', !expanded);
        });

        // Current state
        let currentPage = 1;
        const booksPerPage = 8;
        let filteredBooks = [...books];
        let bookCache = new Map(); // For storing book details we've already fetched
        let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];

        // Initialize the page
        showLoading();
        setTimeout(() => {
            displayBooks();
            createPagination();
            hideLoading();
        }, 800); // Simulate loading delay

        // Event listeners
        searchInput.addEventListener('input', debounce(handleSearchInput, 300));
        searchInput.addEventListener('focus', () => {
            if (searchInput.value.length > 2) {
                showSearchResults();
            }
        });
        genreFilter.addEventListener('change', filterBooks);
        sortBy.addEventListener('change', filterBooks);
        closeModal.addEventListener('click', closeBookModal);
        bookClubForm.addEventListener('submit', handleBookClubSubmit);
        newsletterForm.addEventListener('submit', handleNewsletterSubmit);
        filtersBtn.addEventListener('click', toggleFiltersDropdown);
        applyFiltersBtn.addEventListener('click', applyAdvancedFilters);
        themeToggle.addEventListener('click', toggleDarkMode);

        // Admin login (hidden in footer)
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                openAdminLogin();
            }
        });

        adminLoginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = document.getElementById('admin-username').value;
            const password = document.getElementById('admin-password').value;
            
            // In a real app, this would be a server request
            if (username === 'admin' && password === 'bookstore123') {
                // Redirect to admin panel or show admin UI
                alert('Successfully logged in as admin. In a real implementation, this would take you to the admin dashboard.');
                closeModal();
            } else {
                document.getElementById('login-error').style.display = 'block';
            }
        });

        // Close modal when clicking outside or pressing Escape
        window.addEventListener('click', (e) => {
            if (e.target === bookModal) {
                closeBookModal();
            }
            if (e.target === adminLoginModal) {
                closeAdminLoginModal();
            }
            if (!e.target.closest('.filters-dropdown') && !e.target.closest('.filters-btn')) {
                filtersContent.classList.remove('active');
                filtersBtn.setAttribute('aria-expanded', 'false');
            }
            if (!e.target.closest('.search-container')) {
                searchResults.classList.remove('active');
            }
        });

        window.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (bookModal.style.display === 'block') {
                    closeBookModal();
                }
                if (adminLoginModal.style.display === 'block') {
                    closeAdminLoginModal();
                }
                filtersContent.classList.remove('active');
                filtersBtn.setAttribute('aria-expanded', 'false');
                searchResults.classList.remove('active');
            }
        });

        // Functions
        function displayBooks() {
            const start = (currentPage - 1) * booksPerPage;
            const end = start + booksPerPage;
            const paginatedBooks = filteredBooks.slice(start, end);
            
            bookContainer.innerHTML = '';
            
            if (paginatedBooks.length === 0) {
                bookContainer.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; padding: 40px;">No books found matching your criteria. Please try a different search.</p>';
                return;
            }
            
            paginatedBooks.forEach(book => {
                const bookCard = document.createElement('div');
                bookCard.className = 'book-card';
                bookCard.setAttribute('data-book-id', book.id);
                
                if (book.featured) {
                    bookCard.classList.add('featured-book');
                }
                
                if (book.newArrival) {
                    bookCard.classList.add('new-arrival');
                }
                
                const isInWishlist = wishlist.includes(book.id);
                
                bookCard.innerHTML = `
                    ${book.featured ? '<div class="featured-badge">Featured</div>' : ''}
                    ${book.newArrival ? '<div class="new-badge">New Arrival</div>' : ''}
                    <div class="wishlist-toggle${isInWishlist ? ' active' : ''}" data-id="${book.id}" aria-label="${isInWishlist ? 'Remove from wishlist' : 'Add to wishlist'}" role="button" tabindex="0">
                        ${isInWishlist ? '‚ù§Ô∏è' : 'ü§ç'}
                    </div>
                    <div class="book-image">
                        <img src="${book.image}" alt="${book.title} book cover">
                    </div>
                    <div class="book-details">
                        <h3 class="book-title">${book.title}</h3>
                        <p class="book-author">by ${book.author}</p>
                        <p class="book-price">$${book.price.toFixed(2)}</p>
                        <div class="book-tags">
                            <span class="book-tag">${book.genre.charAt(0).toUpperCase() + book.genre.slice(1)}</span>
                            ${book.inStock ? '<span class="book-tag">In Stock</span>' : '<span class="book-tag">Out of Stock</span>'}
                        </div>
                        <button class="btn" data-id="${book.id}">View Details</button>
                    </div>
                `;
                bookContainer.appendChild(bookCard);
                
                // Add event listener to the button
                const viewButton = bookCard.querySelector('.btn');
                viewButton.addEventListener('click', () => openBookDetail(book.id));
                
                // Add event listener to wishlist toggle
                const wishlistToggle = bookCard.querySelector('.wishlist-toggle');
                wishlistToggle.addEventListener('click', () => toggleWishlist(book.id));
                wishlistToggle.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        toggleWishlist(book.id);
                    }
                });
            });
        }

        function createPagination() {
            const totalPages = Math.ceil(filteredBooks.length / booksPerPage);
            paginationContainer.innerHTML = '';
            
            if (totalPages <= 1) return;
            
            // Previous button
            const prevButton = document.createElement('button');
            prevButton.innerHTML = '&laquo;';
            prevButton.setAttribute('aria-label', 'Previous page');
            prevButton.disabled = currentPage === 1;
            prevButton.addEventListener('click', () => {
                if (currentPage > 1) {
                    changePage(currentPage - 1);
                }
            });
            paginationContainer.appendChild(prevButton);
            
            // Page numbers
            let startPage = Math.max(1, currentPage - 2);
            let endPage = Math.min(totalPages, startPage + 4);
            
            if (endPage - startPage < 4) {
                startPage = Math.max(1, endPage - 4);
            }
            
            if (startPage > 1) {
                const firstPageBtn = document.createElement('button');
                firstPageBtn.textContent = '1';
                firstPageBtn.addEventListener('click', () => changePage(1));
                paginationContainer.appendChild(firstPageBtn);
                
                if (startPage > 2) {
                    const ellipsis = document.createElement('span');
                    ellipsis.textContent = '...';
                    ellipsis.style.padding = '0 8px';
                    paginationContainer.appendChild(ellipsis);
                }
            }
            
            for (let i = startPage; i <= endPage; i++) {
                const pageButton = document.createElement('button');
                pageButton.textContent = i;
                pageButton.setAttribute('aria-label', `Page ${i}`);
                pageButton.className = currentPage === i ? 'active' : '';
                pageButton.addEventListener('click', () => changePage(i));
                paginationContainer.appendChild(pageButton);
            }
            
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    const ellipsis = document.createElement('span');
                    ellipsis.textContent = '...';
                    ellipsis.style.padding = '0 8px';
                    paginationContainer.appendChild(ellipsis);
                }
                
                const lastPageBtn = document.createElement('button');
                lastPageBtn.textContent = totalPages;
                lastPageBtn.addEventListener('click', () => changePage(totalPages));
                paginationContainer.appendChild(lastPageBtn);
            }
            
            // Next button
            const nextButton = document.createElement('button');
            nextButton.innerHTML = '&raquo;';
            nextButton.setAttribute('aria-label', 'Next page');
            nextButton.disabled = currentPage === totalPages;
            nextButton.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    changePage(currentPage + 1);
                }
            });
            paginationContainer.appendChild(nextButton);
        }

        function changePage(page) {
            currentPage = page;
            showLoading();
            setTimeout(() => {
                displayBooks();
                createPagination();
                hideLoading();
                window.scrollTo({ top: document.getElementById('inventory').offsetTop, behavior: 'smooth' });
            }, 400);
        }

        function filterBooks() {
            const searchTerm = searchInput.value.toLowerCase();
            const selectedGenre = genreFilter.value;
            const selectedSort = sortBy.value;
            
            showLoading();
            
            setTimeout(() => {
                // Filter books based on search term and genre
                filteredBooks = books.filter(book => {
                    const matchesSearch = book.title.toLowerCase().includes(searchTerm) || 
                                        book.author.toLowerCase().includes(searchTerm) || 
                                        book.isbn.includes(searchTerm);
                    const matchesGenre = selectedGenre === '' || book.genre === selectedGenre;
                    
                    return matchesSearch && matchesGenre;
                });
                
                // Sort books based on selected sort option
                filteredBooks.sort((a, b) => {
                    switch (selectedSort) {
                        case 'title':
                            return a.title.localeCompare(b.title);
                        case 'author':
                            return a.author.localeCompare(b.author);
                        case 'price-low':
                            return a.price - b.price;
                        case 'price-high':
                            return b.price - a.price;
                        case 'newest':
                            return new Date(b.publishDate) - new Date(a.publishDate);
                        default:
                            return 0;
                    }
                });
                
                // Reset to first page and update display
                currentPage = 1;
                displayBooks();
                createPagination();
                hideLoading();
            }, 500);
        }

        function handleSearchInput() {
            const searchTerm = searchInput.value.toLowerCase();
            
            if (searchTerm.length > 2) {
                // Find matching books
                const matchingBooks = books.filter(book => 
                    book.title.toLowerCase().includes(searchTerm) || 
                    book.author.toLowerCase().includes(searchTerm) ||
                    book.isbn.includes(searchTerm)
                ).slice(0, 5); // Limit to 5 results
                
                // Display results
                searchResults.innerHTML = '';
                
                if (matchingBooks.length === 0) {
                    searchResults.innerHTML = '<div class="search-result-item">No books found</div>';
                } else {
                    matchingBooks.forEach(book => {
                        const resultItem = document.createElement('div');
                        resultItem.className = 'search-result-item';
                        resultItem.innerHTML = `
                            <strong>${book.title}</strong> by ${book.author}
                        `;
                        resultItem.addEventListener('click', () => {
                            searchInput.value = book.title;
                            searchResults.classList.remove('active');
                            filterBooks();
                        });
                        searchResults.appendChild(resultItem);
                    });
                }
                
                showSearchResults();
            } else {
                searchResults.classList.remove('active');
                filterBooks();
            }
        }

        function showSearchResults() {
            searchResults.classList.add('active');
        }

        function showLoading() {
            loadingIndicator.style.display = 'block';
            bookContainer.style.opacity = '0.5';
        }

        function hideLoading() {
            loadingIndicator.style.display = 'none';
            bookContainer.style.opacity = '1';
        }

        function openBookDetail(bookId) {
            const book = books.find(b => b.id === bookId);
            if (!book) return;
            
            // If we've already fetched this book's details, use the cached version
            if (bookCache.has(bookId)) {
                bookDetailContent.innerHTML = bookCache.get(bookId);
                showBookModal();
                initializeBookDetailInteractions(book);
                return;
            }
            
            // Show a loading skeleton
            bookDetailContent.innerHTML = `
                <div class="book-detail-image">
                    <div class="skeleton" style="height: 400px; width: 100%;"></div>
                </div>
                <div class="book-detail-info">
                    <div class="skeleton skeleton-text" style="height: 30px; margin-bottom: 10px;"></div>
                    <div class="skeleton skeleton-text short" style="margin-bottom: 20px;"></div>
                    
                    <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #eee;">
                        <div class="skeleton skeleton-text short" style="width: 80px;"></div>
                        <div class="skeleton skeleton-text short" style="width: 80px;"></div>
                        <div class="skeleton skeleton-text short" style="width: 80px;"></div>
                        <div class="skeleton skeleton-text short" style="width: 80px;"></div>
                    </div>
                    
                    <div class="skeleton skeleton-text" style="margin-bottom: 10px;"></div>
                    <div class="skeleton skeleton-text"></div>
                    <div class="skeleton skeleton-text"></div>
                    <div class="skeleton skeleton-text"></div>
                    <div class="skeleton skeleton-text short" style="margin-bottom: 20px;"></div>
                    
                    <div style="display: flex; gap: 10px;">
                        <div class="skeleton" style="height: 40px; width: 120px;"></div>
                        <div class="skeleton" style="height: 40px; width: 120px;"></div>
                    </div>
                </div>
            `;
            
            showBookModal();
            
            // Simulate API call to get book details
            setTimeout(() => {
                const isInWishlist = wishlist.includes(book.id);
                const detailHTML = `
                    <div class="book-detail-image">
                        <img src="${book.image}" alt="${book.title} book cover">
                    </div>
                    <div class="book-detail-info">
                        <h2 class="book-detail-title" id="book-detail-title">${book.title}</h2>
                        <p class="book-detail-author">by ${book.author}</p>
                        
                        <div class="book-detail-meta">
                            <div class="book-detail-meta-item">
                                <span class="meta-label">Price</span>
                                <span class="meta-value">$${book.price.toFixed(2)}</span>
                            </div>
                            <div class="book-detail-meta-item">
                                <span class="meta-label">Genre</span>
                                <span class="meta-value">${book.genre.charAt(0).toUpperCase() + book.genre.slice(1)}</span>
                            </div>
                            <div class="book-detail-meta-item">
                                <span class="meta-label">ISBN</span>
                                <span class="meta-value">${book.isbn}</span>
                            </div>
                            <div class="book-detail-meta-item">
                                <span class="meta-label">Published</span>
                                <span class="meta-value">${new Date(book.publishDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</span>
                            </div>
                            <div class="book-detail-meta-item">
                                <span class="meta-label">Pages</span>
                                <span class="meta-value">${book.pages}</span>
                            </div>
                            <div class="book-detail-meta-item">
                                <span class="meta-label">Publisher</span>
                                <span class="meta-value">${book.publisher}</span>
                            </div>
                            <div class="book-detail-meta-item">
                                <span class="meta-label">Availability</span>
                                <span class="meta-value">${book.inStock ? 'In Stock' : 'Out of Stock'}</span>
                            </div>
                        </div>
                        
                        <div class="book-description">
                            <h3>Description</h3>
                            <p>${book.description}</p>
                        </div>
                        
                        <div class="quantity-selector">
                            <button class="quantity-btn" aria-label="Decrease quantity">-</button>
                            <input type="number" class="quantity-input" value="1" min="1" max="10" aria-label="Quantity">
                            <button class="quantity-btn" aria-label="Increase quantity">+</button>
                        </div>
                        
                        <button class="btn">Add to Cart</button>
                        <button class="btn btn-secondary wishlist-btn" data-id="${book.id}">${isInWishlist ? 'Remove from Wishlist' : 'Add to Wishlist'}</button>
                        <button class="btn btn-secondary">Reserve for Pickup</button>
                    </div>
                `;
                
                // Cache the detail HTML for future use
                bookCache.set(bookId, detailHTML);
                bookDetailContent.innerHTML = detailHTML;
                
                initializeBookDetailInteractions(book);
            }, 800);
        }

        function initializeBookDetailInteractions(book) {
            // Add quantity selector functionality
            const quantityBtns = bookDetailContent.querySelectorAll('.quantity-btn');
            const quantityInput = bookDetailContent.querySelector('.quantity-input');
            
            quantityBtns[0].addEventListener('click', () => {
                if (parseInt(quantityInput.value) > 1) {
                    quantityInput.value = parseInt(quantityInput.value) - 1;
                }
            });
            
            quantityBtns[1].addEventListener('click', () => {
                if (parseInt(quantityInput.value) < 10) {
                    quantityInput.value = parseInt(quantityInput.value) + 1;
                }
            });
            
            // Add wishlist functionality
            const wishlistBtn = bookDetailContent.querySelector('.wishlist-btn');
            wishlistBtn.addEventListener('click', () => {
                toggleWishlist(book.id);
                
                // Update button text
                const isInWishlist = wishlist.includes(book.id);
                wishlistBtn.textContent = isInWishlist ? 'Remove from Wishlist' : 'Add to Wishlist';
            });
        }

        function showBookModal() {
            bookModal.style.display = 'block';
            bookModal.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden'; // Prevent scrolling when modal is open
            
            // Add active class for animation
            setTimeout(() => {
                bookModal.classList.add('active');
            }, 10);
            
            // Set focus to the close button
            setTimeout(() => {
                closeModal.focus();
            }, 100);
        }

        function closeBookModal() {
            bookModal.classList.remove('active');
            
            setTimeout(() => {
                bookModal.style.display = 'none';
                bookModal.setAttribute('aria-hidden', 'true');
                document.body.style.overflow = ''; // Restore scrolling
            }, 300);
        }

        function openAdminLogin() {
            adminLoginModal.style.display = 'block';
            adminLoginModal.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden';
            
            setTimeout(() => {
                adminLoginModal.classList.add('active');
                document.getElementById('admin-username').focus();
            }, 10);
        }

        function closeAdminLoginModal() {
            adminLoginModal.classList.remove('active');
            
            setTimeout(() => {
                adminLoginModal.style.display = 'none';
                adminLoginModal.setAttribute('aria-hidden', 'true');
                document.body.style.overflow = '';
            }, 300);
        }

        function handleBookClubSubmit(e) {
            e.preventDefault();
            
            // Basic form validation
            const nameInput = document.getElementById('name');
            const emailInput = document.getElementById('email');
            const nameError = document.getElementById('name-error');
            const emailError = document.getElementById('email-error');
            let isValid = true;
            
            if (!nameInput.value.trim()) {
                nameError.style.display = 'block';
                nameInput.setAttribute('aria-invalid', 'true');
                isValid = false;
            } else {
                nameError.style.display = 'none';
                nameInput.setAttribute('aria-invalid', 'false');
            }
            
            if (!emailInput.value.trim() || !isValidEmail(emailInput.value)) {
                emailError.style.display = 'block';
                emailInput.setAttribute('aria-invalid', 'true');
                isValid = false;
            } else {
                emailError.style.display = 'none';
                emailInput.setAttribute('aria-invalid', 'false');
            }
            
            if (isValid) {
                // Show loading state on button
                const submitBtn = bookClubForm.querySelector('button[type="submit"]');
                const originalText = submitBtn.textContent;
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<span class="loading-spinner" style="width: 20px; height: 20px; display: inline-block; vertical-align: middle; margin-right: 8px;"></span> Registering...';
                
                // In a real application, this would send data to a server
                // For demo purposes, just show success message after a delay
                setTimeout(() => {
                    bookClubForm.reset();
                    bookClubSuccess.style.display = 'block';
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalText;
                    
                    // Announce to screen readers
                    bookClubSuccess.setAttribute('aria-live', 'polite');
                    
                    // Hide success message after 5 seconds
                    setTimeout(() => {
                        bookClubSuccess.style.display = 'none';
                    }, 5000);
                }, 1500);
            }
        }

        function handleNewsletterSubmit(e) {
            e.preventDefault();
            
            const emailInput = e.target.querySelector('input[type="email"]');
            
            if (!emailInput.value.trim() || !isValidEmail(emailInput.value)) {
                emailInput.focus();
                return;
            }
            
            // Show loading state on button
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="loading-spinner" style="width: 20px; height: 20px; display: inline-block; vertical-align: middle; margin-right: 8px;"></span> Subscribing...';
            
            // In a real application, this would send data to a server
            // For demo purposes, just show success message after a delay
            setTimeout(() => {
                newsletterForm.reset();
                newsletterSuccess.style.display = 'block';
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
                
                // Announce to screen readers
                newsletterSuccess.setAttribute('aria-live', 'polite');
                
                // Hide success message after 5 seconds
                setTimeout(() => {
                    newsletterSuccess.style.display = 'none';
                }, 5000);
            }, 1500);
        }

        function toggleFiltersDropdown() {
            filtersContent.classList.toggle('active');
            const expanded = filtersBtn.getAttribute('aria-expanded') === 'true' || false;
            filtersBtn.setAttribute('aria-expanded', !expanded);
        }

        function applyAdvancedFilters() {
            showLoading();
            
            setTimeout(() => {
                const minPrice = minPriceInput.value ? parseFloat(minPriceInput.value) : 0;
                const maxPrice = maxPriceInput.value ? parseFloat(maxPriceInput.value) : Infinity;
                
                filteredBooks = books.filter(book => {
                    // Apply existing filters
                    const searchTerm = searchInput.value.toLowerCase();
                    const selectedGenre = genreFilter.value;
                    
                    const matchesSearch = searchTerm === '' || 
                                        book.title.toLowerCase().includes(searchTerm) || 
                                        book.author.toLowerCase().includes(searchTerm) || 
                                        book.isbn.includes(searchTerm);
                    const matchesGenre = selectedGenre === '' || book.genre === selectedGenre;
                    
                    // Apply advanced filters
                    const matchesPrice = book.price >= minPrice && book.price <= maxPrice;
                    
                    let matchesAvailability = true;
                    if (inStockCheckbox.checked && !outOfStockCheckbox.checked) {
                        matchesAvailability = book.inStock;
                    } else if (!inStockCheckbox.checked && outOfStockCheckbox.checked) {
                        matchesAvailability = !book.inStock;
                    }
                    
                    let matchesSpecial = true;
                    if (newArrivalsCheckbox.checked && featuredCheckbox.checked) {
                        matchesSpecial = book.newArrival || book.featured;
                    } else if (newArrivalsCheckbox.checked) {
                        matchesSpecial = book.newArrival;
                    } else if (featuredCheckbox.checked) {
                        matchesSpecial = book.featured;
                    }
                    
                    return matchesSearch && matchesGenre && matchesPrice && matchesAvailability && matchesSpecial;
                });
                
                // Apply sorting
                const selectedSort = sortBy.value;
                filteredBooks.sort((a, b) => {
                    switch (selectedSort) {
                        case 'title':
                            return a.title.localeCompare(b.title);
                        case 'author':
                            return a.author.localeCompare(b.author);
                        case 'price-low':
                            return a.price - b.price;
                        case 'price-high':
                            return b.price - a.price;
                        case 'newest':
                            return new Date(b.publishDate) - new Date(a.publishDate);
                        default:
                            return 0;
                    }
                });
                
                // Reset to first page and update display
                currentPage = 1;
                displayBooks();
                createPagination();
                hideLoading();
                
                // Close the filters dropdown
                filtersContent.classList.remove('active');
                filtersBtn.setAttribute('aria-expanded', 'false');
            }, 500);
        }

        function toggleWishlist(bookId) {
            const index = wishlist.indexOf(bookId);
            
            if (index === -1) {
                // Add to wishlist
                wishlist.push(bookId);
                showNotification('Added to wishlist!');
            } else {
                // Remove from wishlist
                wishlist.splice(index, 1);
                showNotification('Removed from wishlist');
            }
            
            // Update localStorage
            localStorage.setItem('wishlist', JSON.stringify(wishlist));
            
            // Update UI
            const wishlistToggles = document.querySelectorAll(`.wishlist-toggle[data-id="${bookId}"]`);
            wishlistToggles.forEach(toggle => {
                if (index === -1) {
                    toggle.classList.add('active');
                    toggle.innerHTML = '‚ù§Ô∏è';
                    toggle.setAttribute('aria-label', 'Remove from wishlist');
                } else {
                    toggle.classList.remove('active');
                    toggle.innerHTML = 'ü§ç';
                    toggle.setAttribute('aria-label', 'Add to wishlist');
                }
            });
        }

        function showNotification(message) {
            // Create notification element if it doesn't exist
            let notification = document.getElementById('notification');
            if (!notification) {
                notification = document.createElement('div');
                notification.id = 'notification';
                notification.style.position = 'fixed';
                notification.style.bottom = '20px';
                notification.style.left = '50%';
                notification.style.transform = 'translateX(-50%)';
                notification.style.backgroundColor = 'var(--primary)';
                notification.style.color = 'white';
                notification.style.padding = '10px 20px';
                notification.style.borderRadius = 'var(--border-radius)';
                notification.style.boxShadow = '0 3px 10px rgba(0, 0, 0, 0.2)';
                notification.style.zIndex = '1000';
                notification.style.opacity = '0';
                notification.style.transition = 'opacity 0.3s ease';
                document.body.appendChild(notification);
            }
            
            // Update message and show
            notification.textContent = message;
            notification.style.opacity = '1';
            
            // Hide after 3 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
            }, 3000);
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const isDarkMode = document.body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDarkMode);
            
            // Update theme toggle icon
            themeToggle.innerHTML = isDarkMode ? '‚òÄÔ∏è' : 'üåì';
            themeToggle.setAttribute('aria-label', isDarkMode ? 'Switch to light mode' : 'Switch to dark mode');
        }

        // Load dark mode preference
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
            themeToggle.innerHTML = '‚òÄÔ∏è';
            themeToggle.setAttribute('aria-label', 'Switch to light mode');
        }

        function isValidEmail(email) {
            const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            return re.test(String(email).toLowerCase());
        }

        function debounce(func, delay) {
            let timeout;
            return function() {
                const context = this;
                const args = arguments;
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(context, args), delay);
            };
        }

        // Keyboard navigation enhancement
        document.addEventListener('keydown', function(e) {
            // Add keyboard navigation for book cards
            if (document.activeElement.closest('.book-card')) {
                const card = document.activeElement.closest('.book-card');
                const allCards = Array.from(document.querySelectorAll('.book-card'));
                const currentIndex = allCards.indexOf(card);
                
                switch (e.key) {
                    case 'ArrowRight':
                        if (currentIndex < allCards.length - 1) {
                            allCards[currentIndex + 1].querySelector('.btn').focus();
                        }
                        break;
                    case 'ArrowLeft':
                        if (currentIndex > 0) {
                            allCards[currentIndex - 1].querySelector('.btn').focus();
                        }
                        break;
                    case 'ArrowUp':
                        if (currentIndex >= 4) {
                            allCards[currentIndex - 4]?.querySelector('.btn').focus();
                        }
                        break;
                    case 'ArrowDown':
                        if (currentIndex + 4 < allCards.length) {
                            allCards[currentIndex + 4]?.querySelector('.btn').focus();
                        }
                        break;
                }
            }
        });

        // Preload next page data
        function preloadNextPageData() {
            const totalPages = Math.ceil(filteredBooks.length / booksPerPage);
            if (currentPage < totalPages) {
                const nextPageStart = currentPage * booksPerPage;
                const nextPageEnd = nextPageStart + booksPerPage;
                const nextPageBooks = filteredBooks.slice(nextPageStart, nextPageEnd);
                
                // Preload images
                nextPageBooks.forEach(book => {
                    const img = new Image();
                    img.src = book.image;
                });
            }
        }

        // Call preload after initial page load
        window.addEventListener('load', () => {
            setTimeout(preloadNextPageData, 2000);
        });

        // Lazy load images as user scrolls
        const lazyLoadImages = () => {
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        const src = img.getAttribute('data-src');
                        if (src) {
                            img.src = src;
                            img.removeAttribute('data-src');
                        }
                        observer.unobserve(img);
                    }
                });
            });

            document.querySelectorAll('img[data-src]').forEach(img => {
                imageObserver.observe(img);
            });
        };

        // Initialize lazy loading if supported
        if ('IntersectionObserver' in window) {
            lazyLoadImages();
        }

        // Save user preferences to localStorage
        function saveUserPreferences() {
            const preferences = {
                genre: genreFilter.value,
                sort: sortBy.value,
                minPrice: minPriceInput.value,
                maxPrice: maxPriceInput.value,
                inStock: inStockCheckbox.checked,
                outOfStock: outOfStockCheckbox.checked,
                newArrivals: newArrivalsCheckbox.checked,
                featured: featuredCheckbox.checked
            };
            localStorage.setItem('bookstorePreferences', JSON.stringify(preferences));
        }

        // Load user preferences from localStorage
        function loadUserPreferences() {
            const savedPreferences = localStorage.getItem('bookstorePreferences');
            if (savedPreferences) {
                const preferences = JSON.parse(savedPreferences);
                genreFilter.value = preferences.genre || '';
                sortBy.value = preferences.sort || 'title';
                minPriceInput.value = preferences.minPrice || '';
                maxPriceInput.value = preferences.maxPrice || '';
                inStockCheckbox.checked = preferences.inStock !== undefined ? preferences.inStock : true;
                outOfStockCheckbox.checked = preferences.outOfStock || false;
                newArrivalsCheckbox.checked = preferences.newArrivals || false;
                featuredCheckbox.checked = preferences.featured || false;
                
                if (preferences.genre || preferences.sort !== 'title' || 
                    preferences.minPrice || preferences.maxPrice || 
                    !preferences.inStock || preferences.outOfStock || 
                    preferences.newArrivals || preferences.featured) {
                    applyAdvancedFilters();
                }
            }
        }

        // Save preferences when changed
        genreFilter.addEventListener('change', saveUserPreferences);
        sortBy.addEventListener('change', saveUserPreferences);
        applyFiltersBtn.addEventListener('click', saveUserPreferences);

        // Load preferences on page load
        loadUserPreferences();
    </script>
</body>
</html>