<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psychology Experiment Data Organizer</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007bff;
            --primary-color-dark: #0056b3;
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --error-color: #dc3545;
            --background-color: #f8f9fa;
            --surface-color: #ffffff;
            --text-color: #343a40;
            --text-color-light: #6c757d;
            --border-color: #dee2e6;
            --hover-color: #e9ecef;
            --focus-color-ring: rgba(0, 123, 255, 0.25);
            --spacing-unit: 1rem;
            --border-radius: 0.25rem;
            --shadow-subtle: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }

        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            margin: 0;
            padding: var(--spacing-unit);
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .app-container {
            background-color: var(--surface-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-subtle);
            padding: calc(var(--spacing-unit) * 2);
            max-width: 960px;
            width: 100%;
            display: grid;
            gap: calc(var(--spacing-unit) * 2);
        }

        header {
            text-align: center;
            margin-bottom: var(--spacing-unit);
        }

        header h1 {
            margin: 0;
            color: var(--primary-color-dark);
            font-weight: 500;
        }

        section {
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: calc(var(--spacing-unit) * 1.5);
            background-color: #fff;
        }

        section h2 {
            margin-top: 0;
            color: var(--text-color);
            font-weight: 400;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: var(--spacing-unit);
            margin-bottom: var(--spacing-unit) * 1.5;
        }

        .data-input-form .form-group {
            margin-bottom: var(--spacing-unit);
            display: flex;
            flex-direction: column;
        }

        .data-input-form label {
            display: block;
            margin-bottom: calc(var(--spacing-unit) / 2);
            font-weight: 500;
            color: var(--text-color-light);
            font-size: 0.9rem;
        }

        .data-input-form input[type="text"],
        .data-input-form input[type="number"],
        .data-input-form input[type="date"],
        .data-input-form select {
            width: 100%;
            padding: calc(var(--spacing-unit) * 0.75);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            box-sizing: border-box; /* Ensure padding doesn't affect width */
        }

        .data-input-form input[type="text"]:focus,
        .data-input-form input[type="number"]:focus,
        .data-input-form input[type="date"]:focus,
        .data-input-form select:focus {
            border-color: var(--primary-color);
            box-shadow: var(--focus-color-ring);
            outline: none;
        }

        .btn-primary {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.2s ease-in-out, opacity 0.2s ease-in-out;
            font-weight: 500;
        }

        .btn-primary:hover {
            background-color: var(--primary-color-dark);
        }

        .btn-primary:active {
            background-color: var(--primary-color);
            opacity: 0.9;
        }

        .btn-primary:disabled {
            background-color: var(--secondary-color);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .feedback-area {
            margin-top: var(--spacing-unit);
            padding: calc(var(--spacing-unit) * 0.75);
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            opacity: 0;
            height: 0;
            overflow: hidden;
            transition: opacity 0.3s ease-in-out, height 0.3s ease-in-out, padding 0.3s ease-in-out;
        }

        .feedback-area.show {
            opacity: 1;
            height: auto;
            padding: calc(var(--spacing-unit) * 0.75);
            margin-bottom: var(--spacing-unit);
        }

        .feedback-area.success {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
            border: 1px solid var(--success-color);
        }

        .feedback-area.error {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--error-color);
            border: 1px solid var(--error-color);
        }

        .controls {
            display: flex;
            gap: var(--spacing-unit);
            margin-bottom: calc(var(--spacing-unit) * 1.5);
            flex-wrap: wrap;
        }

        .controls .control-group {
            display: flex;
            flex-direction: column;
            min-width: 150px; /* Give controls a minimum width */
            flex-grow: 1;
        }

        .controls label {
             display: block;
            margin-bottom: calc(var(--spacing-unit) / 2);
            font-weight: 500;
            color: var(--text-color-light);
            font-size: 0.9rem;
        }

        .controls input[type="text"],
        .controls select {
            width: 100%;
            padding: calc(var(--spacing-unit) * 0.75);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            box-sizing: border-box;
        }

         .controls input[type="text"]:focus,
        .controls select:focus {
            border-color: var(--primary-color);
            box-shadow: var(--focus-color-ring);
            outline: none;
        }

        .table-container {
            overflow-x: auto; /* Add horizontal scroll on small screens */
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: var(--spacing-unit);
        }

        .data-table th,
        .data-table td {
            padding: var(--spacing-unit);
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table th {
            background-color: var(--hover-color);
            font-weight: 500;
            color: var(--text-color);
            cursor: pointer;
            position: relative; /* Needed for sort indicator */
            transition: background-color 0.2s ease-in-out;
        }

        .data-table th:hover {
             background-color: #e2e6ea;
        }

        .data-table th .sort-indicator {
            display: inline-block;
            margin-left: 0.5rem;
            width: 0;
            height: 0;
            vertical-align: middle;
            border-style: solid;
            border-width: 0 4px 4px 4px;
            border-color: transparent transparent var(--text-color) transparent;
            transition: transform 0.2s ease-in-out;
        }

        .data-table th.sorted-asc .sort-indicator {
             transform: rotate(0deg);
        }

         .data-table th.sorted-desc .sort-indicator {
             transform: rotate(180deg);
             border-color: var(--text-color) transparent transparent transparent;
             border-width: 4px 4px 0 4px;
        }

         .data-table th:not(.sorted-asc):not(.sorted-desc) .sort-indicator {
             opacity: 0.3; /* Dim unsorted indicator */
         }


        .data-table tbody tr:nth-child(even) {
            background-color: var(--background-color);
        }

        .data-table tbody tr:hover {
            background-color: var(--hover-color);
            transition: background-color 0.2s ease-in-out;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .app-container {
                padding: var(--spacing-unit);
            }

            section {
                 padding: var(--spacing-unit);
            }

            .data-input-form .form-group {
                flex-direction: column;
            }

            .controls {
                flex-direction: column;
                gap: calc(var(--spacing-unit) * 0.75);
            }

            .controls .control-group {
                 min-width: auto;
            }

            .data-table th,
            .data-table td {
                 padding: calc(var(--spacing-unit) * 0.75);
                 font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header>
            <h1>Psychology Experiment Data</h1>
        </header>

        <section class="data-input-section">
            <h2>Add New Entry</h2>
            <form id="data-entry-form" class="data-input-form">
                <div class="form-group">
                    <label for="participant-id">Participant ID:</label>
                    <input type="text" id="participant-id" required aria-required="true">
                </div>
                <div class="form-group">
                    <label for="experiment-type">Experiment Type:</label>
                    <select id="experiment-type" required aria-required="true">
                        <option value="">--Select Type--</option>
                        <option value="Cognitive">Cognitive</option>
                        <option value="Behavioral">Behavioral</option>
                        <option value="Physiological">Physiological</option>
                        <option value="Social">Social</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="score">Score/Result:</label>
                    <input type="number" id="score" step="0.01" required aria-required="true">
                </div>
                 <div class="form-group">
                    <label for="entry-date">Date:</label>
                    <input type="date" id="entry-date" required aria-required="true">
                </div>
                <button type="submit" class="btn-primary">Add Entry</button>
            </form>
             <div id="feedback" class="feedback-area" role="alert"></div>
        </section>

        <section class="data-table-section">
            <h2>Experiment Data</h2>
            <div class="controls">
                 <div class="control-group">
                    <label for="filter-type">Filter by Type:</label>
                    <select id="filter-type">
                        <option value="">All Types</option>
                        <option value="Cognitive">Cognitive</option>
                        <option value="Behavioral">Behavioral</option>
                        <option value="Physiological">Physiological</option>
                        <option value="Social">Social</option>
                    </select>
                </div>
                 <div class="control-group">
                    <label for="search-input">Search:</label>
                    <input type="text" id="search-input" placeholder="Search by ID or Type">
                </div>
            </div>
            <div class="table-container">
                <table id="data-table" class="data-table">
                    <thead>
                        <tr>
                            <th data-sort-key="participantId" aria-sort="none">Participant ID <span class="sort-indicator"></span></th>
                            <th data-sort-key="experimentType" aria-sort="none">Experiment Type <span class="sort-indicator"></span></th>
                            <th data-sort-key="score" aria-sort="none">Score/Result <span class="sort-indicator"></span></th>
                            <th data-sort-key="date" aria-sort="none">Date <span class="sort-indicator"></span></th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data rows will be inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>
    </div>

    <script>
        const form = document.getElementById('data-entry-form');
        const dataTableBody = document.querySelector('#data-table tbody');
        const tableHeaders = document.querySelectorAll('#data-table th');
        const feedbackArea = document.getElementById('feedback');
        const filterTypeSelect = document.getElementById('filter-type');
        const searchInput = document.getElementById('search-input');

        let experimentData = []; // Array to hold all data
        let currentSort = { key: null, direction: 'none' }; // State for current sort

        // Function to show feedback messages
        function showFeedback(message, type = 'success') {
            feedbackArea.textContent = message;
            feedbackArea.className = `feedback-area show ${type}`;
            // Hide after 3 seconds
            setTimeout(() => {
                feedbackArea.classList.remove('show');
                 // Reset class after transition
                 setTimeout(() => {
                    feedbackArea.className = 'feedback-area';
                    feedbackArea.textContent = '';
                 }, 300); // Match CSS transition duration
            }, 3000);
        }

        // Function to render the table from the current filtered/sorted data
        function renderTable(dataToRender) {
            dataTableBody.innerHTML = ''; // Clear existing rows

            if (dataToRender.length === 0) {
                 const noDataRow = dataTableBody.insertRow();
                 const cell = noDataRow.insertCell(0);
                 cell.colSpan = 4; // Span across all columns
                 cell.textContent = 'No data available.';
                 cell.style.textAlign = 'center';
                 cell.style.padding = '20px';
                 return;
            }

            dataToRender.forEach(entry => {
                const row = dataTableBody.insertRow();
                row.innerHTML = `
                    <td>${entry.participantId}</td>
                    <td>${entry.experimentType}</td>
                    <td>${entry.score}</td>
                    <td>${entry.date}</td>
                `;
            });
        }

        // Function to apply current filters and sort, then render
        function applyFiltersAndSort() {
            let filteredData = [...experimentData]; // Start with a copy of all data

            // Apply Type Filter
            const selectedType = filterTypeSelect.value;
            if (selectedType) {
                filteredData = filteredData.filter(entry => entry.experimentType === selectedType);
            }

            // Apply Search Filter
            const searchTerm = searchInput.value.toLowerCase().trim();
            if (searchTerm) {
                filteredData = filteredData.filter(entry =>
                    entry.participantId.toLowerCase().includes(searchTerm) ||
                    entry.experimentType.toLowerCase().includes(searchTerm)
                );
            }

            // Apply Sorting
            if (currentSort.key) {
                filteredData.sort((a, b) => {
                    const valA = a[currentSort.key];
                    const valB = b[currentSort.key];

                    if (valA < valB) return currentSort.direction === 'asc' ? -1 : 1;
                    if (valA > valB) return currentSort.direction === 'asc' ? 1 : -1;
                    return 0;
                });
            }

            renderTable(filteredData);
        }

        // Handle form submission
        form.addEventListener('submit', (event) => {
            event.preventDefault(); // Prevent page reload

            const participantId = document.getElementById('participant-id').value.trim();
            const experimentType = document.getElementById('experiment-type').value;
            const score = document.getElementById('score').value;
            const date = document.getElementById('entry-date').value;

            // Basic validation
            if (!participantId || !experimentType || !score || !date) {
                showFeedback('Please fill in all fields.', 'error');
                return;
            }

            // Create new entry object
            const newEntry = {
                participantId: participantId,
                experimentType: experimentType,
                score: parseFloat(score), // Convert score to a number
                date: date // Keep date as string for simplicity, could parse for sorting
            };

            // Add to data array
            experimentData.push(newEntry);

            // Clear form
            form.reset();

            // Apply filters and sort, then render
            applyFiltersAndSort();

            // Show success message
            showFeedback('Entry added successfully!', 'success');
        });

        // Handle table header clicks for sorting
        tableHeaders.forEach(header => {
            header.addEventListener('click', () => {
                const sortKey = header.getAttribute('data-sort-key');
                if (!sortKey) return; // Not a sortable header

                // Determine next sort direction
                let direction = 'asc';
                if (currentSort.key === sortKey) {
                    if (currentSort.direction === 'asc') {
                        direction = 'desc';
                    } else if (currentSort.direction === 'desc') {
                        direction = 'none'; // Cycle back to no sort
                    }
                }

                // Update current sort state
                currentSort = { key: direction === 'none' ? null : sortKey, direction: direction };

                // Update ARIA attributes and visual indicators
                tableHeaders.forEach(th => {
                    const key = th.getAttribute('data-sort-key');
                    th.classList.remove('sorted-asc', 'sorted-desc');
                    th.setAttribute('aria-sort', 'none');

                    if (key === currentSort.key) {
                        th.classList.add(`sorted-${currentSort.direction}`);
                        th.setAttribute('aria-sort', `${currentSort.direction}ending`);
                    }
                });

                // Apply filters and sort, then render
                applyFiltersAndSort();
            });
        });

        // Handle filter changes
        filterTypeSelect.addEventListener('change', applyFiltersAndSort);
        searchInput.addEventListener('input', applyFiltersAndSort); // Use 'input' for real-time filtering

        // Initial render (table will be empty initially)
        renderTable(experimentData);

    </script>
</body>
</html>
