<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farmer's Market App</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap">
    <style>
        :root {
            --primary-color: #4CAF50; /* Market Green */
            --primary-color-dark: #388E3C;
            --secondary-color: #FF9800; /* Harvest Orange */
            --accent-color: #FFC107; /* Sunny Yellow */
            --background-color: #f4f4f4; /* Light Grey Background */
            --surface-color: #ffffff; /* White Surface */
            --text-color: #212121; /* Dark Grey Text */
            --text-color-light: #757575; /* Medium Grey Text */
            --border-color: #e0e0e0; /* Light Grey Border */
            --error-color: #F44336; /* Red Error */
            --success-color: #8BC34A; /* Light Green Success */

            --spacing-unit: 8px;
            --border-radius: 8px;
            --box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            --transition-speed: 0.3s ease;
        }

        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .app-container {
            display: grid;
            grid-template-columns: 250px 1fr; /* Sidebar and main content */
            min-height: 100vh;
        }

        /* Header */
        .header {
            grid-column: span 2; /* Span across both columns */
            background-color: var(--primary-color);
            color: var(--surface-color);
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 2);
            display: flex;
            align-items: center;
            box-shadow: var(--box-shadow);
            z-index: 10;
        }

        .header__title {
            margin: 0;
            font-size: 1.5em;
            font-weight: 700;
        }

        /* Sidebar Navigation */
        .sidebar {
            grid-column: 1;
            background-color: var(--surface-color);
            box-shadow: var(--box-shadow);
            padding: calc(var(--spacing-unit) * 2) 0;
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .sidebar__nav-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar__nav-item {
            margin-bottom: var(--spacing-unit);
        }

        .sidebar__nav-link {
            display: flex;
            align-items: center;
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 2);
            color: var(--text-color);
            text-decoration: none;
            font-size: 1.1em;
            transition: background-color var(--transition-speed), color var(--transition-speed);
            border-left: 4px solid transparent;
        }

        .sidebar__nav-link:hover,
        .sidebar__nav-link:focus {
            background-color: var(--background-color);
            color: var(--primary-color-dark);
        }

        .sidebar__nav-link.is-active {
            background-color: var(--primary-color);
            color: var(--surface-color);
            border-left-color: var(--secondary-color);
            font-weight: 500;
        }

        .sidebar__nav-link.is-active:hover,
        .sidebar__nav-link.is-active:focus {
             background-color: var(--primary-color-dark);
             color: var(--surface-color);
        }

        /* Main Content Area */
        .main-content {
            grid-column: 2;
            padding: calc(var(--spacing-unit) * 3);
            overflow-y: auto; /* Enable scrolling for content */
        }

        .page-title {
            font-size: 2em;
            margin-top: 0;
            margin-bottom: calc(var(--spacing-unit) * 3);
            color: var(--primary-color-dark);
        }

        /* Search Bar */
        .search-bar {
            margin-bottom: calc(var(--spacing-unit) * 3);
            display: flex;
            gap: var(--spacing-unit);
        }

        .search-bar__input {
            flex-grow: 1;
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1em;
            outline: none;
            transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
        }

        .search-bar__input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }

         .search-bar__button {
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 2);
            background-color: var(--primary-color);
            color: var(--surface-color);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1em;
            transition: background-color var(--transition-speed), box-shadow var(--transition-speed);
        }

        .search-bar__button:hover,
        .search-bar__button:focus {
            background-color: var(--primary-color-dark);
            box-shadow: var(--box-shadow);
        }

        /* Filter/Sort Controls */
        .filter-sort-controls {
            margin-bottom: calc(var(--spacing-unit) * 3);
            display: flex;
            gap: var(--spacing-unit) * 2;
            align-items: center;
        }

        .filter-sort-controls label {
            font-weight: 500;
            color: var(--text-color-light);
        }

        .filter-sort-controls select {
            padding: var(--spacing-unit);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1em;
            outline: none;
            cursor: pointer;
            transition: border-color var(--transition-speed);
        }

        .filter-sort-controls select:focus {
             border-color: var(--primary-color);
        }


        /* Card Grids */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: calc(var(--spacing-unit) * 3);
        }

        /* Vendor Card */
        .vendor-card {
            background-color: var(--surface-color);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform var(--transition-speed), box-shadow var(--transition-speed);
            cursor: pointer;
        }

        .vendor-card:hover,
        .vendor-card:focus {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            outline: none;
        }

        .vendor-card__image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            background-color: var(--background-color); /* Placeholder background */
        }

        .vendor-card__content {
            padding: calc(var(--spacing-unit) * 2);
            flex-grow: 1;
        }

        .vendor-card__name {
            margin-top: 0;
            margin-bottom: var(--spacing-unit);
            font-size: 1.2em;
            font-weight: 700;
            color: var(--primary-color-dark);
        }

        .vendor-card__status {
            font-size: 0.9em;
            color: var(--text-color-light);
            margin-bottom: var(--spacing-unit) * 1.5;
            display: flex;
            align-items: center;
        }

        .vendor-card__status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: var(--spacing-unit);
        }

        .vendor-card__status-indicator--attending {
            background-color: var(--success-color);
        }

        .vendor-card__status-indicator--not-attending {
            background-color: var(--error-color);
        }

        .vendor-card__description {
            font-size: 0.9em;
            margin-bottom: calc(var(--spacing-unit) * 2);
            color: var(--text-color);
        }

        .vendor-card__button {
            display: block; /* Make button full width */
            width: calc(100% - var(--spacing-unit) * 4); /* Adjust for padding */
            margin: 0 calc(var(--spacing-unit) * 2) calc(var(--spacing-unit) * 2); /* Add margin bottom */
            padding: var(--spacing-unit) * 1.5;
            background-color: var(--secondary-color);
            color: var(--surface-color);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            text-align: center;
            transition: background-color var(--transition-speed), box-shadow var(--transition-speed);
        }

        .vendor-card__button:hover,
        .vendor-card__button:focus {
            background-color: #F57C00; /* Darker secondary */
            box-shadow: var(--box-shadow);
        }

        /* Product Card */
         .product-card {
            background-color: var(--surface-color);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform var(--transition-speed), box-shadow var(--transition-speed);
            cursor: pointer;
        }

        .product-card:hover,
        .product-card:focus {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
             outline: none;
        }

        .product-card__image {
            width: 100%;
            height: 180px;
            object-fit: cover;
            background-color: var(--background-color); /* Placeholder background */
        }

        .product-card__content {
            padding: calc(var(--spacing-unit) * 2);
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .product-card__name {
            margin-top: 0;
            margin-bottom: var(--spacing-unit);
            font-size: 1.1em;
            font-weight: 700;
            color: var(--text-color);
        }

        .product-card__vendor {
             font-size: 0.9em;
             color: var(--text-color-light);
             margin-bottom: var(--spacing-unit);
        }

        .product-card__price {
            font-size: 1.2em;
            font-weight: 700;
            color: var(--primary-color);
            margin-top: auto; /* Push price and button to bottom */
            margin-bottom: calc(var(--spacing-unit) * 1.5);
        }

        .product-card__button {
            display: block;
            width: 100%;
            padding: var(--spacing-unit) * 1.5;
            background-color: var(--primary-color);
            color: var(--surface-color);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            text-align: center;
            transition: background-color var(--transition-speed), box-shadow var(--transition-speed);
        }

        .product-card__button:hover,
        .product-card__button:focus {
            background-color: var(--primary-color-dark);
            box-shadow: var(--box-shadow);
             outline: none;
        }

        /* Seasonal Highlights Section */
        .seasonal-highlights {
            margin-bottom: calc(var(--spacing-unit) * 4);
        }

        .seasonal-highlights__title {
            font-size: 1.8em;
            margin-top: 0;
            margin-bottom: calc(var(--spacing-unit) * 2);
            color: var(--primary-color-dark);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: var(--spacing-unit);
        }

        .seasonal-highlights__grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: calc(var(--spacing-unit) * 3);
        }

        /* Product Detail Modal */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.6); /* Semi-transparent black overlay */
            backdrop-filter: blur(5px); /* Optional blur effect */
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity var(--transition-speed);
        }

        .modal.is-visible {
            display: flex;
            opacity: 1;
        }

        .modal__content {
            background-color: var(--surface-color);
            margin: auto;
            padding: calc(var(--spacing-unit) * 4);
            border-radius: var(--border-radius);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            max-width: 700px;
            width: 90%;
            position: relative;
            transform: translateY(-20px);
            transition: transform var(--transition-speed);
        }

         .modal.is-visible .modal__content {
             transform: translateY(0);
         }

        .modal__close {
            position: absolute;
            top: var(--spacing-unit) * 2;
            right: var(--spacing-unit) * 2;
            color: var(--text-color-light);
            font-size: 1.5em;
            font-weight: bold;
            cursor: pointer;
            transition: color var(--transition-speed);
        }

        .modal__close:hover,
        .modal__close:focus {
            color: var(--text-color);
            outline: none;
        }

        .product-detail {
            display: flex;
            gap: calc(var(--spacing-unit) * 4);
        }

        .product-detail__image {
            width: 250px;
            height: 250px;
            object-fit: cover;
            border-radius: var(--border-radius);
            background-color: var(--background-color); /* Placeholder background */
        }

        .product-detail__info {
            flex-grow: 1;
        }

        .product-detail__name {
            margin-top: 0;
            margin-bottom: var(--spacing-unit);
            font-size: 1.8em;
            color: var(--primary-color-dark);
        }

        .product-detail__vendor {
            font-size: 1.1em;
            color: var(--text-color-light);
            margin-bottom: calc(var(--spacing-unit) * 2);
        }

        .product-detail__description {
            margin-bottom: calc(var(--spacing-unit) * 3);
            color: var(--text-color);
        }

        .product-detail__price {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: calc(var(--spacing-unit) * 3);
        }

        .product-detail__quantity {
            display: flex;
            align-items: center;
            margin-bottom: calc(var(--spacing-unit) * 3);
            gap: var(--spacing-unit);
        }

        .product-detail__quantity label {
            font-weight: 500;
        }

        .product-detail__quantity input[type="number"] {
            width: 60px;
            padding: var(--spacing-unit);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1em;
            text-align: center;
            outline: none;
             transition: border-color var(--transition-speed);
        }

         .product-detail__quantity input[type="number"]:focus {
             border-color: var(--primary-color);
         }

        .product-detail__actions {
            display: flex;
            gap: var(--spacing-unit) * 2;
        }

        .product-detail__button {
            padding: var(--spacing-unit) * 1.5 calc(var(--spacing-unit) * 3);
            background-color: var(--primary-color);
            color: var(--surface-color);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 500;
            transition: background-color var(--transition-speed), box-shadow var(--transition-speed);
        }

        .product-detail__button:hover,
        .product-detail__button:focus {
            background-color: var(--primary-color-dark);
            box-shadow: var(--box-shadow);
            outline: none;
        }

         .product-detail__button--secondary {
             background-color: var(--secondary-color);
         }

         .product-detail__button--secondary:hover,
         .product-detail__button--secondary:focus {
             background-color: #F57C00; /* Darker secondary */
         }


        /* Cart View */
        .cart-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .cart-item {
            display: flex;
            align-items: center;
            background-color: var(--surface-color);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: calc(var(--spacing-unit) * 2);
            margin-bottom: calc(var(--spacing-unit) * 2);
            gap: calc(var(--spacing-unit) * 2);
        }

        .cart-item__image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: var(--border-radius);
            background-color: var(--background-color); /* Placeholder background */
        }

        .cart-item__info {
            flex-grow: 1;
        }

        .cart-item__name {
            margin: 0 0 var(--spacing-unit) 0;
            font-size: 1.1em;
            font-weight: 500;
        }

        .cart-item__vendor {
            font-size: 0.9em;
            color: var(--text-color-light);
            margin-bottom: var(--spacing-unit);
        }

        .cart-item__price {
            font-size: 1em;
            font-weight: 700;
            color: var(--primary-color);
        }

        .cart-item__quantity-controls {
            display: flex;
            align-items: center;
            gap: var(--spacing-unit);
        }

        .cart-item__quantity-button {
            width: 30px;
            height: 30px;
            background-color: var(--background-color);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1em;
            font-weight: 700;
            transition: background-color var(--transition-speed);
             outline: none;
        }

         .cart-item__quantity-button:hover,
         .cart-item__quantity-button:focus {
             background-color: #e0e0e0;
         }


        .cart-item__quantity-input {
            width: 40px;
            padding: var(--spacing-unit) * 0.5;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1em;
            text-align: center;
            outline: none;
             transition: border-color var(--transition-speed);
        }

         .cart-item__quantity-input:focus {
             border-color: var(--primary-color);
         }

        .cart-item__remove-button {
            background: none;
            border: none;
            color: var(--error-color);
            cursor: pointer;
            font-size: 1em;
            transition: color var(--transition-speed);
             outline: none;
        }

        .cart-item__remove-button:hover,
        .cart-item__remove-button:focus {
            color: #D32F2F; /* Darker red */
        }

        .cart-summary {
            margin-top: calc(var(--spacing-unit) * 3);
            padding: calc(var(--spacing-unit) * 3);
            background-color: var(--surface-color);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            text-align: right;
        }

        .cart-summary__total {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--primary-color-dark);
            margin-bottom: calc(var(--spacing-unit) * 2);
        }

        .cart-summary__checkout-button {
            padding: var(--spacing-unit) * 1.5 calc(var(--spacing-unit) * 3);
            background-color: var(--secondary-color);
            color: var(--surface-color);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1.2em;
            font-weight: 500;
            transition: background-color var(--transition-speed), box-shadow var(--transition-speed);
             outline: none;
        }

         .cart-summary__checkout-button:hover,
         .cart-summary__checkout-button:focus {
             background-color: #F57C00; /* Darker secondary */
             box-shadow: var(--box-shadow);
         }

        /* Checkout Form */
        .checkout-form {
            display: grid;
            gap: calc(var(--spacing-unit) * 2);
            max-width: 600px;
            margin: 0 auto;
            padding: calc(var(--spacing-unit) * 4);
            background-color: var(--surface-color);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .checkout-form__group {
            margin-bottom: var(--spacing-unit);
        }

        .checkout-form__group label {
            display: block;
            margin-bottom: var(--spacing-unit);
            font-weight: 500;
            color: var(--text-color);
        }

        .checkout-form__group input,
        .checkout-form__group select,
        .checkout-form__group textarea {
            width: 100%;
            padding: var(--spacing-unit) * 1.5;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1em;
            outline: none;
            transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
        }

         .checkout-form__group input:focus,
         .checkout-form__group select:focus,
         .checkout-form__group textarea:focus {
             border-color: var(--primary-color);
             box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
         }

        .checkout-form__group input.is-invalid {
            border-color: var(--error-color);
        }

        .checkout-form__group .error-message {
            color: var(--error-color);
            font-size: 0.9em;
            margin-top: var(--spacing-unit) * 0.5;
        }

        .checkout-form__button {
            width: 100%;
            padding: var(--spacing-unit) * 2;
            background-color: var(--primary-color);
            color: var(--surface-color);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1.2em;
            font-weight: 500;
            margin-top: calc(var(--spacing-unit) * 2);
            transition: background-color var(--transition-speed), box-shadow var(--transition-speed);
             outline: none;
        }

         .checkout-form__button:hover,
         .checkout-form__button:focus {
             background-color: var(--primary-color-dark);
             box-shadow: var(--box-shadow);
         }

        /* Notification List */
        .notification-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .notification-item {
            background-color: var(--surface-color);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: calc(var(--spacing-unit) * 2);
            margin-bottom: calc(var(--spacing-unit) * 2);
            border-left: 4px solid var(--accent-color);
        }

        .notification-item__text {
            margin-top: 0;
            margin-bottom: var(--spacing-unit);
            font-size: 1em;
            color: var(--text-color);
        }

        .notification-item__timestamp {
            font-size: 0.8em;
            color: var(--text-color-light);
            text-align: right;
        }

         /* Utility Classes */
         .hidden {
             display: none;
         }

         .text-center {
             text-align: center;
         }

         .mb-4 {
             margin-bottom: calc(var(--spacing-unit) * 4);
         }

         .mt-4 {
             margin-top: calc(var(--spacing-unit) * 4);
         }

         .p-4 {
             padding: calc(var(--spacing-unit) * 4);
         }

         /* Accessibility */
         [tabindex="0"]:focus,
         button:focus,
         a:focus,
         input:focus,
         select:focus,
         textarea:focus {
             outline: 2px solid var(--accent-color);
             outline-offset: 2px;
         }

         /* Basic Loading Indicator */
         .loading-indicator {
             display: flex;
             justify-content: center;
             align-items: center;
             padding: calc(var(--spacing-unit) * 4);
         }

         .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--primary-color);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
         }

         @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
         }

    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <h1 class="header__title">Local Farmer's Market</h1>
        </header>

        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <nav class="sidebar__nav">
                <ul class="sidebar__nav-list">
                    <li class="sidebar__nav-item">
                        <a href="#vendors" class="sidebar__nav-link is-active" data-view="vendors">Vendors</a>
                    </li>
                    <li class="sidebar__nav-item">
                        <a href="#products" class="sidebar__nav-link" data-view="products">Products</a>
                    </li>
                     <li class="sidebar__nav-item">
                        <a href="#cart" class="sidebar__nav-link" data-view="cart">Cart (<span id="cart-count">0</span>)</a>
                    </li>
                    <li class="sidebar__nav-item">
                        <a href="#notifications" class="sidebar__nav-link" data-view="notifications">Notifications</a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">

            <!-- Vendors View -->
            <section id="vendors-view" class="view">
                <h2 class="page-title">Weekly Vendors</h2>
                 <div class="search-bar">
                    <input type="text" class="search-bar__input" id="vendor-search" placeholder="Search vendors...">
                    <button class="search-bar__button">Search</button>
                </div>
                 <div class="filter-sort-controls">
                     <label for="vendor-sort">Sort by:</label>
                     <select id="vendor-sort">
                         <option value="name-asc">Name (A-Z)</option>
                         <option value="name-desc">Name (Z-A)</option>
                         <option value="status">Status</option>
                     </select>
                 </div>
                <div class="card-grid" id="vendor-list">
                    <!-- Vendor Cards will be loaded here by JS -->
                    <div class="loading-indicator"><div class="spinner"></div></div>
                </div>
            </section>

            <!-- Products View -->
            <section id="products-view" class="view hidden">
                <h2 class="page-title">Browse Products</h2>

                 <div class="seasonal-highlights">
                     <h3 class="seasonal-highlights__title">✨ Seasonal Highlights ✨</h3>
                     <div class="seasonal-highlights__grid" id="seasonal-products-list">
                         <!-- Seasonal Product Cards loaded here -->
                         <div class="loading-indicator"><div class="spinner"></div></div>
                     </div>
                 </div>

                <div class="search-bar">
                    <input type="text" class="search-bar__input" id="product-search" placeholder="Search products...">
                    <button class="search-bar__button">Search</button>
                </div>
                 <div class="filter-sort-controls">
                     <label for="product-sort">Sort by:</label>
                     <select id="product-sort">
                         <option value="name-asc">Name (A-Z)</option>
                         <option value="name-desc">Name (Z-A)</option>
                         <option value="price-asc">Price (Low to High)</option>
                         <option value="price-desc">Price (High to Low)</option>
                         <option value="vendor">Vendor</option>
                     </select>
                 </div>
                <div class="card-grid" id="product-list">
                    <!-- Product Cards will be loaded here by JS -->
                    <div class="loading-indicator"><div class="spinner"></div></div>
                </div>
            </section>

            <!-- Cart View -->
            <section id="cart-view" class="view hidden">
                <h2 class="page-title">Shopping Cart / Pre-order</h2>
                <ul class="cart-list" id="cart-items-list">
                    <!-- Cart items loaded here by JS -->
                </ul>
                <div id="empty-cart-message" class="text-center p-4 hidden">Your cart is empty.</div>
                <div class="cart-summary hidden" id="cart-summary">
                    <div class="cart-summary__total">Total: $<span id="cart-total">0.00</span></div>
                    <button class="cart-summary__checkout-button" id="checkout-button">Proceed to Checkout</button>
                </div>
            </section>

             <!-- Checkout View -->
             <section id="checkout-view" class="view hidden">
                 <h2 class="page-title">Checkout</h2>
                 <form id="checkout-form" class="checkout-form">
                     <div class="checkout-form__group">
                         <label for="name">Full Name:</label>
                         <input type="text" id="name" required>
                         <div class="error-message hidden" id="name-error">Please enter your full name.</div>
                     </div>
                     <div class="checkout-form__group">
                         <label for="email">Email:</label>
                         <input type="email" id="email" required>
                          <div class="error-message hidden" id="email-error">Please enter a valid email address.</div>
                     </div>
                      <div class="checkout-form__group">
                         <label for="phone">Phone Number:</label>
                         <input type="tel" id="phone">
                          <div class="error-message hidden" id="phone-error">Please enter a valid phone number.</div>
                     </div>
                     <div class="checkout-form__group">
                         <label for="notes">Order Notes (e.g., pickup time):</label>
                         <textarea id="notes" rows="4"></textarea>
                     </div>
                     <div class="checkout-form__group">
                         <label for="payment">Payment Method:</label>
                         <select id="payment" required>
                             <option value="">Select Method</option>
                             <option value="cash">Cash on Pickup</option>
                             <option value="card">Card on Pickup</option>
                             <!-- Add more options if integrated payment is available -->
                         </select>
                          <div class="error-message hidden" id="payment-error">Please select a payment method.</div>
                     </div>
                     <button type="submit" class="checkout-form__button">Place Order</button>
                 </form>
             </section>

            <!-- Notifications View -->
            <section id="notifications-view" class="view hidden">
                <h2 class="page-title">Notifications</h2>
                <ul class="notification-list" id="notification-items-list">
                     <!-- Notification items loaded here by JS -->
                     <li class="notification-item">
                         <div class="notification-item__text">Market is open this Saturday from 9 AM to 1 PM!</div>
                         <div class="notification-item__timestamp">2 hours ago</div>
                     </li>
                     <li class="notification-item">
                         <div class="notification-item__text">Vendor "Sweet Treats Bakery" will be attending this week!</div>
                         <div class="notification-item__timestamp">1 day ago</div>
                     </li>
                      <li class="notification-item">
                         <div class="notification-item__text">Due to expected rain, the market will close early at 12 PM this Saturday.</div>
                         <div class="notification-item__timestamp">3 days ago</div>
                     </li>
                </ul>
                 <div id="empty-notifications-message" class="text-center p-4 hidden">No new notifications.</div>
            </section>

        </main>
    </div>

    <!-- Product Detail Modal -->
    <div id="product-detail-modal" class="modal">
        <div class="modal__content">
            <span class="modal__close">&times;</span>
            <div class="product-detail">
                <img src="https://placehold.co/250x250?text=Product+Image" alt="Product Image" class="product-detail__image" id="modal-product-image">
                <div class="product-detail__info">
                    <h3 class="product-detail__name" id="modal-product-name">Product Name</h3>
                    <p class="product-detail__vendor" id="modal-product-vendor">by Vendor Name</p>
                    <p class="product-detail__description" id="modal-product-description">Product description goes here. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                    <div class="product-detail__price" id="modal-product-price">$0.00</div>
                     <div class="product-detail__quantity">
                         <label for="modal-product-quantity">Quantity:</label>
                         <input type="number" id="modal-product-quantity" value="1" min="1">
                     </div>
                    <div class="product-detail__actions">
                        <button class="product-detail__button" id="modal-add-to-cart">Add to Cart</button>
                        <!-- Optional Pre-order button -->
                        <!-- <button class="product-detail__button product-detail__button--secondary" id="modal-pre-order">Pre-order</button> -->
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script>
        // --- State Management ---
        let state = {
            currentView: 'vendors',
            vendors: [],
            products: [],
            cart: [], // { productId, quantity }
            notifications: [], // { id, text, timestamp }
            seasonalProductIds: [],
            selectedProduct: null, // Product object for modal
        };

        // --- DOM Elements ---
        const views = document.querySelectorAll('.view');
        const sidebarLinks = document.querySelectorAll('.sidebar__nav-link');
        const vendorListEl = document.getElementById('vendor-list');
        const productListEl = document.getElementById('product-list');
        const seasonalProductsListEl = document.getElementById('seasonal-products-list');
        const cartItemsListEl = document.getElementById('cart-items-list');
        const cartCountEl = document.getElementById('cart-count');
        const cartTotalEl = document.getElementById('cart-total');
        const cartSummaryEl = document.getElementById('cart-summary');
        const emptyCartMessageEl = document.getElementById('empty-cart-message');
        const checkoutButtonEl = document.getElementById('checkout-button');
        const checkoutViewEl = document.getElementById('checkout-view');
        const cartViewEl = document.getElementById('cart-view');
        const checkoutFormEl = document.getElementById('checkout-form');
        const notificationItemsListEl = document.getElementById('notification-items-list');
        const emptyNotificationsMessageEl = document.getElementById('empty-notifications-message');

        // Modal elements
        const productDetailModalEl = document.getElementById('product-detail-modal');
        const modalCloseButton = productDetailModalEl.querySelector('.modal__close');
        const modalProductImageEl = productDetailModalEl.querySelector('#modal-product-image');
        const modalProductNameEl = productDetailModalEl.querySelector('#modal-product-name');
        const modalProductVendorEl = productDetailModalEl.querySelector('#modal-product-vendor');
        const modalProductDescriptionEl = productDetailModalEl.querySelector('#modal-product-description');
        const modalProductPriceEl = productDetailModalEl.querySelector('#modal-product-price');
        const modalProductQuantityEl = productDetailModalEl.querySelector('#modal-product-quantity');
        const modalAddToCartButton = productDetailModalEl.querySelector('#modal-add-to-cart');

        // Form validation elements
        const nameInput = document.getElementById('name');
        const emailInput = document.getElementById('email');
        const phoneInput = document.getElementById('phone');
        const paymentSelect = document.getElementById('payment');

        const nameError = document.getElementById('name-error');
        const emailError = document.getElementById('email-error');
        const phoneError = document.getElementById('phone-error');
        const paymentError = document.getElementById('payment-error');


        // --- Data Simulation (Replace with API calls in a real app) ---
        function fetchVendors() {
            return new Promise(resolve => {
                setTimeout(() => {
                    resolve([
                        { id: 'v1', name: 'Green Meadow Farm', image: 'https://placehold.co/400x250?text=Farm+Logo', status: 'attending', description: 'Fresh organic produce from our family farm.' },
                        { id: 'v2', name: 'Sweet Treats Bakery', image: 'https://placehold.co/400x250?text=Bakery+Logo', status: 'attending', description: 'Delicious homemade pies, cookies, and bread.' },
                        { id: 'v3', name: 'Crafty Creations', image: 'https://placehold.co/400x250?text=Crafts+Logo', status: 'not-attending', description: 'Handmade soaps, candles, and gifts.' },
                        { id: 'v4', name: 'Juicy Fruits Orchard', image: 'https://placehold.co/400x250?text=Orchard+Logo', status: 'attending', description: 'Seasonal fruits picked fresh from our trees.' },
                         { id: 'v5', name: 'Artisan Cheese Co.', image: 'https://placehold.co/400x250?text=Cheese+Logo', status: 'attending', description: 'Selection of local artisan cheeses.' },
                         { id: 'v6', name: 'Honeycomb Apiary', image: 'https://placehold.co/400x250?text=Honey+Logo', status: 'attending', description: 'Pure, raw honey and beeswax products.' },
                    ]);
                }, 500); // Simulate network delay
            });
        }

        function fetchProducts() {
             return new Promise(resolve => {
                setTimeout(() => {
                    resolve([
                        { id: 'p1', vendorId: 'v1', name: 'Organic Tomatoes', image: 'https://placehold.co/300x180?text=Tomatoes', price: 3.50, unit: 'lb', description: 'Vine-ripened organic tomatoes.', isSeasonal: true },
                        { id: 'p2', vendorId: 'v1', name: 'Fresh Lettuce', image: 'https://placehold.co/300x180?text=Lettuce', price: 2.00, unit: 'head', description: 'Crisp green leaf lettuce.', isSeasonal: false },
                        { id: 'p3', vendorId: 'v2', name: 'Apple Pie', image: 'https://placehold.co/300x180?text=Apple+Pie', price: 15.00, unit: 'pie', description: 'Homemade apple pie, serves 8.', isSeasonal: true },
                        { id: 'p4', vendorId: 'v2', name: 'Chocolate Chip Cookies', image: 'https://placehold.co/300x180?text=Cookies', price: 6.00, unit: 'dozen', description: 'Classic chocolate chip cookies.', isSeasonal: false },
                        { id: 'p5', vendorId: 'v4', name: 'Summer Peaches', image: 'https://placehold.co/300x180?text=Peaches', price: 4.00, unit: 'lb', description: 'Sweet and juicy summer peaches.', isSeasonal: true },
                         { id: 'p6', vendorId: 'v5', name: 'Cheddar Cheese', image: 'https://placehold.co/300x180?text=Cheddar', price: 8.50, unit: 'block', description: 'Aged sharp cheddar cheese.', isSeasonal: false },
                         { id: 'p7', vendorId: 'v6', name: 'Wildflower Honey', image: 'https://placehold.co/300x180?text=Honey', price: 12.00, unit: 'jar', description: 'Pure wildflower honey.', isSeasonal: false },
                         { id: 'p8', vendorId: 'v1', name: 'Zucchini', image: 'https://placehold.co/300x180?text=Zucchini', price: 2.50, unit: 'lb', description: 'Farm fresh zucchini.', isSeasonal: true },
                    ]);
                }, 500); // Simulate network delay
            });
        }

         function fetchNotifications() {
             return new Promise(resolve => {
                 setTimeout(() => {
                     resolve([
                         { id: 'n1', text: 'Market is open this Saturday from 9 AM to 1 PM!', timestamp: '2 hours ago' },
                         { id: 'n2', text: 'Vendor "Sweet Treats Bakery" will be attending this week!', timestamp: '1 day ago' },
                         { id: 'n3', text: 'Due to expected rain, the market will close early at 12 PM this Saturday.', timestamp: '3 days ago' },
                     ]);
                 }, 500); // Simulate network delay
             });
         }


        // --- Rendering Functions ---
        function renderVendors(vendorsToRender) {
            vendorListEl.innerHTML = ''; // Clear loading indicator or previous content
            if (vendorsToRender.length === 0) {
                 vendorListEl.innerHTML = '<p class="text-center p-4">No vendors found.</p>';
                 return;
            }
            vendorsToRender.forEach(vendor => {
                const vendorCard = document.createElement('div');
                vendorCard.classList.add('vendor-card');
                vendorCard.setAttribute('tabindex', '0'); // Make div focusable
                vendorCard.setAttribute('data-vendor-id', vendor.id);

                vendorCard.innerHTML = `
                    <img src="${vendor.image}" alt="${vendor.name} logo" class="vendor-card__image">
                    <div class="vendor-card__content">
                        <h3 class="vendor-card__name">${vendor.name}</h3>
                        <p class="vendor-card__status">
                            <span class="vendor-card__status-indicator vendor-card__status-indicator--${vendor.status === 'attending' ? 'attending' : 'not-attending'}"></span>
                            ${vendor.status === 'attending' ? 'Attending this week' : 'Not attending this week'}
                        </p>
                        <p class="vendor-card__description">${vendor.description}</p>
                    </div>
                     <button class="vendor-card__button" data-vendor-id="${vendor.id}">View Products</button>
                `;
                vendorListEl.appendChild(vendorCard);

                 // Add click/keyboard event listener to the button
                 const viewProductsButton = vendorCard.querySelector('.vendor-card__button');
                 viewProductsButton.addEventListener('click', (event) => {
                     event.stopPropagation(); // Prevent card click from triggering
                     filterProductsByVendor(vendor.id);
                 });

                 // Add click/keyboard event listener to the card itself
                 vendorCard.addEventListener('click', () => {
                     filterProductsByVendor(vendor.id);
                 });
                 vendorCard.addEventListener('keydown', (event) => {
                     if (event.key === 'Enter' || event.key === ' ') {
                         event.preventDefault();
                         filterProductsByVendor(vendor.id);
                     }
                 });
            });
        }

         function renderProducts(productsToRender, containerEl, isSeasonal = false) {
            containerEl.innerHTML = ''; // Clear loading indicator or previous content
             if (productsToRender.length === 0) {
                 containerEl.innerHTML = `<p class="text-center p-4">No ${isSeasonal ? 'seasonal ' : ''}products found.</p>`;
                 return;
            }
            productsToRender.forEach(product => {
                const productCard = document.createElement('div');
                productCard.classList.add('product-card');
                 productCard.setAttribute('tabindex', '0'); // Make div focusable
                 productCard.setAttribute('data-product-id', product.id);

                const vendor = state.vendors.find(v => v.id === product.vendorId);

                productCard.innerHTML = `
                    <img src="${product.image}" alt="${product.name}" class="product-card__image">
                    <div class="product-card__content">
                        <h3 class="product-card__name">${product.name}</h3>
                         ${vendor ? `<p class="product-card__vendor">by ${vendor.name}</p>` : ''}
                        <div class="product-card__price">$${product.price.toFixed(2)} / ${product.unit}</div>
                    </div>
                     <button class="product-card__button" data-product-id="${product.id}">Add to Cart</button>
                `;
                containerEl.appendChild(productCard);

                 // Add click/keyboard event listener to the button
                 const addToCartButton = productCard.querySelector('.product-card__button');
                 addToCartButton.addEventListener('click', (event) => {
                      event.stopPropagation(); // Prevent card click from triggering
                      addToCart(product.id, 1); // Add 1 by default
                 });

                 // Add click/keyboard event listener to the card itself to open detail modal
                 productCard.addEventListener('click', () => {
                     openProductDetailModal(product.id);
                 });
                 productCard.addEventListener('keydown', (event) => {
                     if (event.key === 'Enter' || event.key === ' ') {
                         event.preventDefault();
                         openProductDetailModal(product.id);
                     }
                 });
            });
        }

        function renderCart() {
            cartItemsListEl.innerHTML = ''; // Clear current items
            if (state.cart.length === 0) {
                emptyCartMessageEl.classList.remove('hidden');
                cartSummaryEl.classList.add('hidden');
                cartCountEl.textContent = '0';
                return;
            }

            emptyCartMessageEl.classList.add('hidden');
            cartSummaryEl.classList.remove('hidden');

            let total = 0;
            state.cart.forEach(item => {
                const product = state.products.find(p => p.id === item.productId);
                if (!product) return; // Skip if product not found

                const vendor = state.vendors.find(v => v.id === product.vendorId);
                const itemTotal = product.price * item.quantity;
                total += itemTotal;

                const cartItemEl = document.createElement('li');
                cartItemEl.classList.add('cart-item');
                cartItemEl.setAttribute('data-product-id', product.id);

                cartItemEl.innerHTML = `
                    <img src="${product.image}" alt="${product.name}" class="cart-item__image">
                    <div class="cart-item__info">
                        <h3 class="cart-item__name">${product.name}</h3>
                         ${vendor ? `<p class="cart-item__vendor">by ${vendor.name}</p>` : ''}
                        <div class="cart-item__price">$${itemTotal.toFixed(2)}</div>
                    </div>
                    <div class="cart-item__quantity-controls">
                        <button class="cart-item__quantity-button" data-action="decrease">-</button>
                        <input type="number" class="cart-item__quantity-input" value="${item.quantity}" min="1" data-product-id="${product.id}">
                        <button class="cart-item__quantity-button" data-action="increase">+</button>
                    </div>
                    <button class="cart-item__remove-button" data-product-id="${product.id}">&times;</button>
                `;
                cartItemsListEl.appendChild(cartItemEl);

                // Add event listeners for quantity controls and remove button
                cartItemEl.querySelector('[data-action="decrease"]').addEventListener('click', () => updateCartQuantity(product.id, -1));
                cartItemEl.querySelector('[data-action="increase"]').addEventListener('click', () => updateCartQuantity(product.id, 1));
                cartItemEl.querySelector('.cart-item__quantity-input').addEventListener('change', (event) => updateCartQuantity(product.id, parseInt(event.target.value) - item.quantity));
                cartItemEl.querySelector('.cart-item__remove-button').addEventListener('click', () => removeFromCart(product.id));
            });

            cartTotalEl.textContent = total.toFixed(2);
            cartCountEl.textContent = state.cart.reduce((sum, item) => sum + item.quantity, 0);
        }

         function renderNotifications(notificationsToRender) {
             notificationItemsListEl.innerHTML = ''; // Clear current items
              if (notificationsToRender.length === 0) {
                 emptyNotificationsMessageEl.classList.remove('hidden');
                 return;
             }
             emptyNotificationsMessageEl.classList.add('hidden');

             notificationsToRender.forEach(notification => {
                 const notificationItemEl = document.createElement('li');
                 notificationItemEl.classList.add('notification-item');
                 notificationItemEl.innerHTML = `
                     <div class="notification-item__text">${notification.text}</div>
                     <div class="notification-item__timestamp">${notification.timestamp}</div>
                 `;
                 notificationItemsListEl.appendChild(notificationItemEl);
             });
         }


        // --- State Update Functions ---
        function switchView(viewId) {
            state.currentView = viewId;
            views.forEach(view => {
                if (view.id === `${viewId}-view`) {
                    view.classList.remove('hidden');
                } else {
                    view.classList.add('hidden');
                }
            });

            sidebarLinks.forEach(link => {
                if (link.getAttribute('data-view') === viewId) {
                    link.classList.add('is-active');
                } else {
                    link.classList.remove('is-active');
                }
            });

             // Handle specific view rendering on switch
             if (viewId === 'cart') {
                 renderCart();
             } else if (viewId === 'notifications') {
                 renderNotifications(state.notifications);
             } else if (viewId === 'checkout') {
                 // Render cart summary in checkout if needed, or just proceed
             }
        }

        function addToCart(productId, quantity = 1) {
            const existingItemIndex = state.cart.findIndex(item => item.productId === productId);
            if (existingItemIndex > -1) {
                state.cart[existingItemIndex].quantity += quantity;
            } else {
                state.cart.push({ productId, quantity });
            }
            renderCart(); // Re-render cart view if it's active
            updateCartCount(); // Update cart count in sidebar
            console.log('Cart updated:', state.cart); // Log for debugging
        }

        function updateCartQuantity(productId, quantityChange) {
            const item = state.cart.find(item => item.productId === productId);
            if (item) {
                item.quantity += quantityChange;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                     // Update input value if it exists (e.g., in cart view)
                     const inputEl = cartItemsListEl.querySelector(`.cart-item__quantity-input[data-product-id="${productId}"]`);
                     if (inputEl) {
                         inputEl.value = item.quantity;
                     }
                    renderCart(); // Re-render cart to update totals
                }
            }
        }

        function removeFromCart(productId) {
            state.cart = state.cart.filter(item => item.productId !== productId);
            renderCart(); // Re-render cart view if active
            updateCartCount(); // Update cart count in sidebar
             console.log('Cart updated:', state.cart); // Log for debugging
        }

        function updateCartCount() {
             const totalItems = state.cart.reduce((sum, item) => sum + item.quantity, 0);
             cartCountEl.textContent = totalItems;
        }

        function openProductDetailModal(productId) {
            const product = state.products.find(p => p.id === productId);
            if (!product) return;

            const vendor = state.vendors.find(v => v.id === product.vendorId);

            state.selectedProduct = product; // Store selected product

            modalProductImageEl.src = product.image;
            modalProductImageEl.alt = product.name;
            modalProductNameEl.textContent = product.name;
            modalProductVendorEl.textContent = vendor ? `by ${vendor.name}` : '';
            modalProductDescriptionEl.textContent = product.description;
            modalProductPriceEl.textContent = `$${product.price.toFixed(2)} / ${product.unit}`;
            modalProductQuantityEl.value = 1; // Reset quantity to 1

            // Update Add to Cart button handler
            modalAddToCartButton.onclick = () => {
                const quantity = parseInt(modalProductQuantityEl.value);
                if (quantity > 0) {
                    addToCart(product.id, quantity);
                    closeProductDetailModal();
                    // Optional: Show a temporary confirmation message
                }
            };

            productDetailModalEl.classList.add('is-visible');
             // Focus on modal close button for accessibility
             modalCloseButton.focus();
        }

        function closeProductDetailModal() {
             productDetailModalEl.classList.remove('is-visible');
             state.selectedProduct = null; // Clear selected product
        }

        function filterProductsByVendor(vendorId) {
             // Filter products by vendorId
             const filteredProducts = state.products.filter(p => p.vendorId === vendorId);
             // Render filtered products in the main product list area
             renderProducts(filteredProducts, productListEl);
             // Switch to the products view
             switchView('products');
             // Optional: Update search/filter UI to reflect the vendor filter
             console.log(`Filtering products by vendor: ${vendorId}`);
        }


        // --- Event Listeners ---
        sidebarLinks.forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault();
                const viewId = event.target.getAttribute('data-view');
                switchView(viewId);
            });
        });

        // Close modal when clicking outside or on close button
        modalCloseButton.addEventListener('click', closeProductDetailModal);
        productDetailModalEl.addEventListener('click', (event) => {
            if (event.target === productDetailModalEl) {
                closeProductDetailModal();
            }
        });
         document.addEventListener('keydown', (event) => {
             if (event.key === 'Escape' && productDetailModalEl.classList.contains('is-visible')) {
                 closeProductDetailModal();
             }
         });


         // Checkout Button Listener
         checkoutButtonEl.addEventListener('click', () => {
             switchView('checkout');
         });

         // Checkout Form Validation and Submission
         checkoutFormEl.addEventListener('submit', (event) => {
             event.preventDefault();
             let isValid = true;

             // Reset errors
             nameInput.classList.remove('is-invalid');
             emailInput.classList.remove('is-invalid');
             phoneInput.classList.remove('is-invalid');
             paymentSelect.classList.remove('is-invalid');
             nameError.classList.add('hidden');
             emailError.classList.add('hidden');
             phoneError.classList.add('hidden');
             paymentError.classList.add('hidden');


             // Validate Name
             if (nameInput.value.trim() === '') {
                 nameInput.classList.add('is-invalid');
                 nameError.classList.remove('hidden');
                 isValid = false;
             }

             // Validate Email
             const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
             if (!emailPattern.test(emailInput.value.trim())) {
                 emailInput.classList.add('is-invalid');
                 emailError.classList.remove('hidden');
                 isValid = false;
             }

             // Validate Phone (optional but basic format check)
              const phonePattern = /^\d{10,}$/; // Simple check for at least 10 digits
             if (phoneInput.value.trim() !== '' && !phonePattern.test(phoneInput.value.trim().replace(/\D/g,''))) {
                 phoneInput.classList.add('is-invalid');
                 phoneError.classList.remove('hidden');
                 isValid = false;
             }


             // Validate Payment Method
             if (paymentSelect.value === '') {
                 paymentSelect.classList.add('is-invalid');
                 paymentError.classList.remove('hidden');
                 isValid = false;
             }

             if (isValid) {
                 // Process order (simulated)
                 console.log('Order placed:', {
                     name: nameInput.value.trim(),
                     email: emailInput.value.trim(),
                     phone: phoneInput.value.trim(),
                     notes: notes.value.trim(),
                     payment: paymentSelect.value,
                     items: state.cart
                 });

                 // Clear cart and form, show success message (simulated)
                 state.cart = [];
                 renderCart(); // Update cart display and count
                 checkoutFormEl.reset();
                 switchView('vendors'); // Go back to vendors view
                 alert('Order placed successfully!'); // Simple success feedback
             }
         });


        // --- Initial Data Load and Render ---
        async function initializeApp() {
            // Show loading indicators
            vendorListEl.innerHTML = '<div class="loading-indicator"><div class="spinner"></div></div>';
            productListEl.innerHTML = '<div class="loading-indicator"><div class="spinner"></div></div>';
             seasonalProductsListEl.innerHTML = '<div class="loading-indicator"><div class="spinner"></div></div>';


            // Fetch data concurrently
            const [vendors, products, notifications] = await Promise.all([
                fetchVendors(),
                fetchProducts(),
                fetchNotifications()
            ]);

            state.vendors = vendors;
            state.products = products;
            state.notifications = notifications;
             state.seasonalProductIds = state.products.filter(p => p.isSeasonal).map(p => p.id); // Identify seasonal products

            // Initial render of views
            renderVendors(state.vendors);
            renderProducts(state.products, productListEl); // Render all products initially
            renderProducts(state.products.filter(p => state.seasonalProductIds.includes(p.id)), seasonalProductsListEl, true); // Render seasonal products
            renderCart(); // Render cart (will show empty message if needed)
             renderNotifications(state.notifications); // Render notifications

            // Set initial view
            switchView('vendors');
        }

        // Initialize the app when the DOM is ready
        document.addEventListener('DOMContentLoaded', initializeApp);

    </script>
</body>
</html>
