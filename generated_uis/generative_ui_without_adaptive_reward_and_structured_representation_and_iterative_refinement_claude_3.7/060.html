<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Handbook</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007bff;
            --primary-dark: #0056b3;
            --secondary-color: #6c757d;
            --text-color: #333;
            --background-color: #f8f9fa;
            --surface-color: #ffffff;
            --border-color: #dee2e6;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --spacing-unit: 8px;
            --header-height: 60px;
            --sidebar-width: 250px;
            --border-radius: 4px;
            --box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            --transition-speed: 0.3s;
        }

        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        header {
            background-color: var(--surface-color);
            color: var(--text-color);
            padding: var(--spacing-unit) * 2;
            box-shadow: var(--box-shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: var(--header-height);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--primary-color);
        }

        .language-selector {
            position: relative;
            display: inline-block;
        }

        .language-selector button {
            background-color: var(--primary-color);
            color: white;
            padding: var(--spacing-unit) var(--spacing-unit) * 2;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1em;
            transition: background-color var(--transition-speed) ease;
        }

        .language-selector button:hover,
        .language-selector button:focus {
            background-color: var(--primary-dark);
            outline: none;
        }

        .language-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--surface-color);
            box-shadow: var(--box-shadow);
            border-radius: var(--border-radius);
            overflow: hidden;
            min-width: 120px;
            z-index: 10;
        }

        .language-dropdown button {
            display: block;
            width: 100%;
            padding: var(--spacing-unit) * 1.5;
            text-align: left;
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            transition: background-color var(--transition-speed) ease;
        }

        .language-dropdown button:hover,
        .language-dropdown button:focus {
            background-color: var(--background-color);
            outline: none;
        }

        .language-dropdown button.active {
            background-color: var(--primary-color);
            color: white;
        }

        .container {
            display: flex;
            flex: 1;
        }

        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--surface-color);
            box-shadow: var(--box-shadow);
            padding: var(--spacing-unit) * 2;
            overflow-y: auto;
            flex-shrink: 0;
        }

        .sidebar h3 {
            margin-top: 0;
            margin-bottom: var(--spacing-unit) * 2;
            color: var(--primary-color);
            font-size: 1.2em;
        }

        .sidebar nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar nav ul li {
            margin-bottom: var(--spacing-unit);
        }

        .sidebar nav ul li a {
            display: block;
            padding: var(--spacing-unit) * 1.5;
            text-decoration: none;
            color: var(--text-color);
            border-radius: var(--border-radius);
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
        }

        .sidebar nav ul li a:hover,
        .sidebar nav ul li a:focus {
            background-color: var(--background-color);
            color: var(--primary-color);
            outline: none;
        }

        .sidebar nav ul li a.active {
            background-color: var(--primary-color);
            color: white;
        }

        .main-content {
            flex: 1;
            padding: var(--spacing-unit) * 4;
            overflow-y: auto;
        }

        .search-bar {
            margin-bottom: var(--spacing-unit) * 4;
            display: flex;
            gap: var(--spacing-unit);
        }

        .search-bar input[type="text"] {
            flex: 1;
            padding: var(--spacing-unit) * 1.5;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1em;
        }

        .search-bar button {
            padding: var(--spacing-unit) * 1.5 var(--spacing-unit) * 3;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1em;
            transition: background-color var(--transition-speed) ease;
        }

        .search-bar button:hover,
        .search-bar button:focus {
            background-color: #5a6268;
            outline: none;
        }

        .search-results {
            margin-top: var(--spacing-unit) * 2;
            border-top: 1px solid var(--border-color);
            padding-top: var(--spacing-unit) * 2;
        }

        .search-results h4 {
            margin-top: 0;
            margin-bottom: var(--spacing-unit) * 2;
            color: var(--text-color);
        }

        .search-results ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .search-results ul li {
            margin-bottom: var(--spacing-unit);
        }

        .search-results ul li a {
            text-decoration: none;
            color: var(--primary-color);
            transition: color var(--transition-speed) ease;
        }

        .search-results ul li a:hover,
        .search-results ul li a:focus {
            color: var(--primary-dark);
            outline: none;
        }

        .content-section {
            margin-bottom: var(--spacing-unit) * 6;
            padding: var(--spacing-unit) * 3;
            background-color: var(--surface-color);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            opacity: 0; /* Initial state for fade-in */
            transform: translateY(20px); /* Initial state for slide-up */
            transition: opacity var(--transition-speed) ease-out, transform var(--transition-speed) ease-out;
        }

        .content-section.active {
             opacity: 1;
             transform: translateY(0);
        }


        .content-section h2 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: var(--spacing-unit) * 3;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: var(--spacing-unit);
        }

        .content-section h3 {
             color: var(--secondary-color);
             margin-top: var(--spacing-unit) * 4;
             margin-bottom: var(--spacing-unit) * 2;
        }

        .content-section p {
            margin-bottom: var(--spacing-unit) * 2;
            line-height: 1.8;
        }

        .highlighted-term {
            text-decoration: underline dotted var(--primary-color);
            cursor: help;
            position: relative;
        }

        .visual-aid {
            max-width: 100%;
            height: auto;
            display: block;
            margin: var(--spacing-unit) * 3 auto;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            cursor: pointer;
            transition: transform var(--transition-speed) ease;
        }

        .visual-aid:hover {
            transform: scale(1.02);
        }

        footer {
            background-color: var(--surface-color);
            color: var(--text-color);
            text-align: center;
            padding: var(--spacing-unit) * 2;
            margin-top: auto; /* Pushes footer to the bottom */
            box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.05);
        }

        .scroll-to-top {
            position: fixed;
            bottom: var(--spacing-unit) * 3;
            right: var(--spacing-unit) * 3;
            background-color: var(--primary-color);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: var(--box-shadow);
            transition: opacity var(--transition-speed) ease, visibility var(--transition-speed) ease;
            opacity: 0;
            visibility: hidden;
            z-index: 999;
        }

        .scroll-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        /* Tooltip/Popover Styles */
        .tooltip {
            position: absolute;
            bottom: 125%; /* Position above the element */
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--text-color);
            color: white;
            padding: var(--spacing-unit) * 1.5;
            border-radius: var(--border-radius);
            white-space: normal; /* Allow text wrapping */
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity var(--transition-speed) ease, visibility var(--transition-speed) ease;
            pointer-events: none; /* Don't interfere with clicks */
            min-width: 200px;
            max-width: 300px;
            box-shadow: var(--box-shadow);
        }

        .tooltip::after {
            content: "";
            position: absolute;
            top: 100%; /* At the bottom of the tooltip */
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--text-color) transparent transparent transparent;
        }

        .highlighted-term:hover .tooltip {
            opacity: 1;
            visibility: visible;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.6);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--surface-color);
            margin: auto;
            padding: var(--spacing-unit) * 4;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            max-width: 80%;
            max-height: 80%;
            overflow-y: auto;
            position: relative;
        }

        .modal-content img,
        .modal-content svg {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }

        .close-button {
            color: var(--text-color);
            position: absolute;
            top: var(--spacing-unit) * 2;
            right: var(--spacing-unit) * 2;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close-button:hover,
        .close-button:focus {
            color: var(--danger-color);
            text-decoration: none;
            outline: none;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                box-shadow: none;
                padding: var(--spacing-unit) * 2;
                border-bottom: 1px solid var(--border-color);
            }

            .sidebar nav ul {
                display: flex;
                flex-wrap: wrap;
                gap: var(--spacing-unit);
            }

            .sidebar nav ul li {
                margin-bottom: 0;
                flex: 1 1 auto; /* Allow items to grow and wrap */
            }

            .sidebar nav ul li a {
                 text-align: center;
                 padding: var(--spacing-unit) * 1.5 var(--spacing-unit);
            }

            .main-content {
                padding: var(--spacing-unit) * 2;
            }

            .search-bar {
                flex-direction: column;
            }

            .search-bar button {
                width: 100%;
            }

            .scroll-to-top {
                bottom: var(--spacing-unit) * 2;
                right: var(--spacing-unit) * 2;
            }

            .tooltip {
                 bottom: 110%; /* Adjust position for smaller screens */
                 left: 0;
                 transform: none;
                 min-width: 150px;
                 max-width: 250px;
                 white-space: normal;
            }

            .tooltip::after {
                left: 20px; /* Adjust arrow position */
            }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">Company Handbook</div>
        <div class="language-selector">
            <button id="language-button" aria-haspopup="true" aria-expanded="false">Language</button>
            <div class="language-dropdown" id="language-dropdown">
                <button data-lang="en" class="active">English</button>
                <button data-lang="es">Español</button>
                <button data-lang="vi">Tiếng Việt</button>
            </div>
        </div>
    </header>

    <div class="container">
        <aside class="sidebar">
            <h3>Handbook Sections</h3>
            <nav>
                <ul>
                    <li><a href="#safety" class="nav-link active" data-section="safety">Safety Procedures</a></li>
                    <li><a href="#policies" class="nav-link" data-section="policies">Company Policies</a></li>
                    <li><a href="#benefits" class="nav-link" data-section="benefits">Employee Benefits</a></li>
                </ul>
            </nav>
        </aside>

        <main class="main-content">
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="Search handbook...">
                <button id="search-button">Search</button>
            </div>

            <div class="search-results" id="search-results" style="display: none;">
                <h4>Search Results</h4>
                <ul id="results-list">
                    <!-- Search results will be inserted here -->
                </ul>
            </div>

            <section id="safety" class="content-section active" data-section="safety">
                <h2>Safety Procedures</h2>
                <p>
                    This section outlines essential safety procedures to ensure a safe working environment for all employees. Adherence to these guidelines is mandatory.
                </p>
                <h3>Emergency Evacuation</h3>
                <p>
                    In case of a fire alarm or other emergency, follow the designated evacuation routes posted throughout the facility. Assemble at the primary <span class="highlighted-term" data-term="assembly-point">assembly point</span>. Do not use elevators during an evacuation.
                    <span class="tooltip">
                        A designated location outside the building where all personnel should gather during an emergency evacuation to ensure everyone is accounted for.
                    </span>
                </p>
                <img src="https://placehold.co/600x300?text=Evacuation+Route+Diagram" alt="Diagram showing emergency evacuation routes" class="visual-aid" data-visual="evacuation-diagram">
                <h3>Hazardous Materials Handling</h3>
                <p>
                    All personnel working with hazardous materials must wear appropriate <span class="highlighted-term" data-term="ppe">Personal Protective Equipment (PPE)</span>. Refer to the <span class="highlighted-term" data-term="msds">Material Safety Data Sheet (MSDS)</span> for specific handling instructions and safety precautions for each substance.
                    <span class="tooltip">
                        <strong data-lang-key="ppe-title">Personal Protective Equipment (PPE):</strong> Gear designed to protect the wearer from injury or infection. Examples include gloves, safety glasses, and respirators.
                    </span>
                    <span class="tooltip">
                         <strong data-lang-key="msds-title">Material Safety Data Sheet (MSDS):</strong> A document providing detailed information about a hazardous substance, including its properties, potential hazards, handling, storage, and emergency measures.
                    </span>
                </p>
                <p>
                    Ensure adequate ventilation when working with chemicals. Report any spills or incidents immediately to your supervisor.
                </p>
            </section>

            <section id="policies" class="content-section" data-section="policies">
                <h2>Company Policies</h2>
                <p>
                    This section details the company's policies regarding conduct, attendance, and other important aspects of employment.
                </p>
                 <h3>Code of Conduct</h3>
                 <p>
                     Employees are expected to maintain a professional and respectful demeanor at all times. Harassment or discrimination of any kind will not be tolerated. Report any violations to Human Resources.
                 </p>
                 <h3>Attendance Policy</h3>
                 <p>
                     Regular and punctual attendance is crucial. Follow the established procedure for reporting absences or tardiness. Excessive absenteeism may lead to disciplinary action.
                 </p>
            </section>

            <section id="benefits" class="content-section" data-section="benefits">
                <h2>Employee Benefits</h2>
                <p>
                    Learn about the benefits available to eligible employees, including health insurance, retirement plans, and paid time off.
                </p>
                <h3>Health Insurance</h3>
                <p>
                    The company offers comprehensive health insurance plans. Details regarding coverage, deductibles, and enrollment periods are available from the HR department.
                </p>
                <h3>Retirement Plan</h3>
                <p>
                    Eligible employees can participate in the company's 401(k) retirement savings plan. The company offers a matching contribution up to a certain percentage of your salary.
                </p>
            </section>

        </main>
    </div>

    <footer>
        <p>&copy; 2023 Company Name. All rights reserved.</p>
    </footer>

    <div class="scroll-to-top" id="scroll-to-top">
        &#x25B2; <!-- Up arrow character -->
    </div>

    <!-- Modal for Visual Aids -->
    <div id="visual-aid-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <div id="modal-image-container">
                <!-- Image or SVG will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        const handbookContent = {
            en: {
                headerTitle: "Company Handbook",
                languageButton: "Language",
                sidebarTitle: "Handbook Sections",
                nav: {
                    safety: "Safety Procedures",
                    policies: "Company Policies",
                    benefits: "Employee Benefits"
                },
                searchPlaceholder: "Search handbook...",
                searchButton: "Search",
                searchResultsTitle: "Search Results",
                safety: {
                    title: "Safety Procedures",
                    intro: "This section outlines essential safety procedures to ensure a safe working environment for all employees. Adherence to these guidelines is mandatory.",
                    emergencyEvacuationTitle: "Emergency Evacuation",
                    emergencyEvacuationText: "In case of a fire alarm or other emergency, follow the designated evacuation routes posted throughout the facility. Assemble at the primary <span class='highlighted-term' data-term='assembly-point'>assembly point</span>. Do not use elevators during an evacuation.",
                    hazardousMaterialsTitle: "Hazardous Materials Handling",
                    hazardousMaterialsText: "All personnel working with hazardous materials must wear appropriate <span class='highlighted-term' data-term='ppe'>Personal Protective Equipment (PPE)</span>. Refer to the <span class='highlighted-term' data-term='msds'>Material Safety Data Sheet (MSDS)</span> for specific handling instructions and safety precautions for each substance.",
                    ventilationText: "Ensure adequate ventilation when working with chemicals. Report any spills or incidents immediately to your supervisor."
                },
                policies: {
                    title: "Company Policies",
                    intro: "This section details the company's policies regarding conduct, attendance, and other important aspects of employment.",
                    codeOfConductTitle: "Code of Conduct",
                    codeOfConductText: "Employees are expected to maintain a professional and respectful demeanor at all times. Harassment or discrimination of any kind will not be tolerated. Report any violations to Human Resources.",
                    attendancePolicyTitle: "Attendance Policy",
                    attendancePolicyText: "Regular and punctual attendance is crucial. Follow the established procedure for reporting absences or tardiness. Excessive absenteeism may lead to disciplinary action."
                },
                benefits: {
                    title: "Employee Benefits",
                    intro: "Learn about the benefits available to eligible employees, including health insurance, retirement plans, and paid time off.",
                    healthInsuranceTitle: "Health Insurance",
                    healthInsuranceText: "The company offers comprehensive health insurance plans. Details regarding coverage, deductibles, and enrollment periods are available from the HR department.",
                    retirementPlanTitle: "Retirement Plan",
                    retirementPlanText: "Eligible employees can participate in the company's 401(k) retirement savings plan. The company offers a matching contribution up to a certain percentage of your salary."
                },
                terms: {
                    "assembly-point": "A designated location outside the building where all personnel should gather during an emergency evacuation to ensure everyone is accounted for.",
                    "ppe": "Personal Protective Equipment (PPE): Gear designed to protect the wearer from injury or infection. Examples include gloves, safety glasses, and respirators.",
                    "msds": "Material Safety Data Sheet (MSDS): A document providing detailed information about a hazardous substance, including its properties, potential hazards, handling, storage, and emergency measures."
                },
                footer: "&copy; 2023 Company Name. All rights reserved."
            },
            es: {
                headerTitle: "Manual del Empleado",
                languageButton: "Idioma",
                sidebarTitle: "Secciones del Manual",
                nav: {
                    safety: "Procedimientos de Seguridad",
                    policies: "Políticas de la Empresa",
                    benefits: "Beneficios para Empleados"
                },
                searchPlaceholder: "Buscar en el manual...",
                searchButton: "Buscar",
                searchResultsTitle: "Resultados de búsqueda",
                safety: {
                    title: "Procedimientos de Seguridad",
                    intro: "Esta sección describe los procedimientos de seguridad esenciales para garantizar un entorno de trabajo seguro para todos los empleados. El cumplimiento de estas pautas es obligatorio.",
                    emergencyEvacuationTitle: "Evacuación de Emergencia",
                    emergencyEvacuationText: "En caso de alarma de incendio u otra emergencia, siga las rutas de evacuación designadas publicadas en toda la instalación. Reúnase en el <span class='highlighted-term' data-term='assembly-point'>punto de reunión</span> principal. No utilice los ascensores durante una evacuación.",
                    hazardousMaterialsTitle: "Manejo de Materiales Peligrosos",
                    hazardousMaterialsText: "Todo el personal que trabaje con materiales peligrosos debe usar el <span class='highlighted-term' data-term='ppe'>Equipo de Protección Personal (EPP)</span> adecuado. Consulte la <span class='highlighted-term' data-term='msds'>Hoja de Datos de Seguridad del Material (HDSM)</span> para obtener instrucciones de manejo específicas y precauciones de seguridad para cada sustancia.",
                    ventilationText: "Asegure una ventilación adecuada cuando trabaje con productos químicos. Informe de inmediato cualquier derrame o incidente a su supervisor."
                },
                policies: {
                    title: "Políticas de la Empresa",
                    intro: "Esta sección detalla las políticas de la empresa con respecto a la conducta, la asistencia y otros aspectos importantes del empleo.",
                    codeOfConductTitle: "Código de Conducta",
                    codeOfConductText: "Se espera que los empleados mantengan una conducta profesional y respetuosa en todo momento. No se tolerará el acoso ni la discriminación de ningún tipo. Informe cualquier violación al departamento de Recursos Humanos.",
                    attendancePolicyTitle: "Política de Asistencia",
                    attendancePolicyText: "La asistencia regular y puntual es crucial. Siga el procedimiento establecido para informar ausencias o tardanzas. El ausentismo excesivo puede dar lugar a medidas disciplinarias."
                },
                benefits: {
                    title: "Beneficios para Empleados",
                    intro: "Conozca los beneficios disponibles para los empleados elegibles, que incluyen seguro médico, planes de jubilación y tiempo libre pagado.",
                    healthInsuranceTitle: "Seguro Médico",
                    healthInsuranceText: "La empresa ofrece planes integrales de seguro médico. Los detalles sobre la cobertura, los deducibles y los períodos de inscripción están disponibles en el departamento de Recursos Humanos.",
                    retirementPlanTitle: "Plan de Jubilación",
                    retirementPlanText: "Los empleados elegibles pueden participar en el plan de ahorro para la jubilación 401(k) de la empresa. La empresa ofrece una contribución equivalente hasta un cierto porcentaje de su salario."
                },
                terms: {
                    "assembly-point": "Un lugar designado fuera del edificio donde todo el personal debe reunirse durante una evacuación de emergencia para asegurarse de que todos estén contabilizados.",
                    "ppe": "Equipo de Protección Personal (EPP): Equipo diseñado para proteger al usuario de lesiones o infecciones. Los ejemplos incluyen guantes, gafas de seguridad y respiradores.",
                    "msds": "Hoja de Datos de Seguridad del Material (HDSM): Un documento que proporciona información detallada sobre una sustancia peligrosa, incluidas sus propiedades, peligros potenciales, manejo, almacenamiento y medidas de emergencia."
                },
                footer: "&copy; 2023 Nombre de la Empresa. Todos los derechos reservados."
            },
            vi: {
                headerTitle: "Sổ Tay Nhân Viên",
                languageButton: "Ngôn ngữ",
                sidebarTitle: "Các Phần của Sổ Tay",
                nav: {
                    safety: "Quy Trình An Toàn",
                    policies: "Chính Sách Công Ty",
                    benefits: "Phúc Lợi Nhân Viên"
                },
                searchPlaceholder: "Tìm kiếm trong sổ tay...",
                searchButton: "Tìm kiếm",
                searchResultsTitle: "Kết quả tìm kiếm",
                safety: {
                    title: "Quy Trình An Toàn",
                    intro: "Phần này phác thảo các quy trình an toàn thiết yếu để đảm bảo môi trường làm việc an toàn cho tất cả nhân viên. Việc tuân thủ các hướng dẫn này là bắt buộc.",
                    emergencyEvacuationTitle: "Sơ Tán Khẩn Cấp",
                    emergencyEvacuationText: "Trong trường hợp có báo cháy hoặc khẩn cấp khác, hãy đi theo các lối thoát hiểm được chỉ định được dán khắp cơ sở. Tập trung tại <span class='highlighted-term' data-term='assembly-point'>điểm tập kết</span> chính. Không sử dụng thang máy trong quá trình sơ tán.",
                    hazardousMaterialsTitle: "Xử Lý Vật Liệu Nguy Hiểm",
                    hazardousMaterialsText: "Tất cả nhân viên làm việc với vật liệu nguy hiểm phải đeo <span class='highlighted-term' data-term='ppe'>Thiết Bị Bảo Hộ Cá Nhân (PPE)</span> phù hợp. Tham khảo <span class='highlighted-term' data-term='msds'>Phiếu Dữ Liệu An Toàn Vật Liệu (MSDS)</span> để biết hướng dẫn xử lý cụ thể và biện pháp phòng ngừa an toàn cho từng chất.",
                    ventilationText: "Đảm bảo thông gió đầy đủ khi làm việc với hóa chất. Báo cáo ngay lập tức mọi sự cố tràn đổ hoặc tai nạn cho người giám sát của bạn."
                },
                policies: {
                    title: "Chính Sách Công Ty",
                    intro: "Phần này trình bày chi tiết các chính sách của công ty về hành vi, việc đi làm và các khía cạnh quan trọng khác của việc làm.",
                    codeOfConductTitle: "Quy Tắc Ứng Xử",
                    codeOfConductText: "Nhân viên được mong đợi duy trì thái độ chuyên nghiệp và tôn trọng mọi lúc. Bất kỳ hình thức quấy rối hoặc phân biệt đối xử nào sẽ không được dung thứ. Báo cáo mọi vi phạm cho bộ phận Nhân sự.",
                    attendancePolicyTitle: "Chính Sách Đi Làm",
                    attendancePolicyText: "Việc đi làm đều đặn và đúng giờ là rất quan trọng. Tuân thủ quy trình đã thiết lập để báo cáo vắng mặt hoặc đi muộn. Việc vắng mặt quá nhiều có thể dẫn đến hành động kỷ luật."
                },
                benefits: {
                    title: "Phúc Lợi Nhân Viên",
                    intro: "Tìm hiểu về các phúc lợi dành cho nhân viên đủ điều kiện, bao gồm bảo hiểm y tế, kế hoạch hưu trí và thời gian nghỉ có lương.",
                    healthInsuranceTitle: "Bảo Hiểm Y Tế",
                    healthInsuranceText: "Công ty cung cấp các kế hoạch bảo hiểm y tế toàn diện. Chi tiết về phạm vi bảo hiểm, mức khấu trừ và thời gian đăng ký có sẵn từ bộ phận Nhân sự.",
                    retirementPlanTitle: "Kế Hoạch Hưu Trí",
                    retirementPlanText: "Nhân viên đủ điều kiện có thể tham gia vào kế hoạch tiết kiệm hưu trí 401(k) của công ty. Công ty cung cấp khoản đóng góp tương ứng lên đến một tỷ lệ nhất định của lương của bạn."
                },
                terms: {
                    "assembly-point": "Một địa điểm được chỉ định bên ngoài tòa nhà nơi tất cả nhân viên nên tập trung trong quá trình sơ tán khẩn cấp để đảm bảo mọi người đều được kiểm đếm.",
                    "ppe": "Thiết Bị Bảo Hộ Cá Nhân (PPE): Trang bị được thiết kế để bảo vệ người mặc khỏi bị thương hoặc nhiễm trùng. Ví dụ bao gồm găng tay, kính bảo hộ và mặt nạ phòng độc.",
                    "msds": "Phiếu Dữ Liệu An Toàn Vật Liệu (MSDS): Một tài liệu cung cấp thông tin chi tiết về một chất nguy hiểm, bao gồm tính chất, nguy hiểm tiềm ẩn, cách xử lý, lưu trữ và các biện pháp khẩn cấp."
                },
                footer: "&copy; 2023 Tên Công Ty. Mọi quyền được bảo lưu."
            }
        };

        let currentLang = 'en';
        const langButton = document.getElementById('language-button');
        const langDropdown = document.getElementById('language-dropdown');
        const langButtons = langDropdown.querySelectorAll('button');
        const navLinks = document.querySelectorAll('.nav-link');
        const contentSections = document.querySelectorAll('.content-section');
        const searchInput = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');
        const searchResultsDiv = document.getElementById('search-results');
        const resultsList = document.getElementById('results-list');
        const scrollToTopButton = document.getElementById('scroll-to-top');
        const visualAidModal = document.getElementById('visual-aid-modal');
        const modalImageContainer = document.getElementById('modal-image-container');
        const closeModalButton = visualAidModal.querySelector('.close-button');

        // Function to update UI text based on language
        function updateUI(lang) {
            const content = handbookContent[lang];

            // Update Header
            document.querySelector('header .logo').textContent = content.headerTitle;
            langButton.textContent = content.languageButton;
            document.documentElement.lang = lang; // Update HTML lang attribute for accessibility

            // Update Sidebar
            document.querySelector('.sidebar h3').textContent = content.sidebarTitle;
            navLinks.forEach(link => {
                const sectionKey = link.getAttribute('data-section');
                link.textContent = content.nav[sectionKey];
            });

            // Update Main Content Sections
            contentSections.forEach(section => {
                const sectionKey = section.getAttribute('data-section');
                const sectionContent = content[sectionKey];
                section.querySelector('h2').textContent = sectionContent.title;

                // Update paragraphs and highlighted terms dynamically
                // This is a simplified approach; a real i18n library would be better
                // Here we'll manually update text content and re-insert highlighted terms
                const paragraphs = section.querySelectorAll('p');
                if (sectionKey === 'safety') {
                    paragraphs[0].innerHTML = sectionContent.intro;
                    paragraphs[1].innerHTML = sectionContent.emergencyEvacuationText;
                    paragraphs[2].innerHTML = sectionContent.hazardousMaterialsText;
                    paragraphs[3].innerHTML = sectionContent.ventilationText;
                    section.querySelector('h3').textContent = sectionContent.emergencyEvacuationTitle;
                    section.querySelectorAll('h3')[1].textContent = sectionContent.hazardousMaterialsTitle;

                } else if (sectionKey === 'policies') {
                     paragraphs[0].innerHTML = sectionContent.intro;
                     paragraphs[1].innerHTML = sectionContent.codeOfConductText;
                     paragraphs[2].innerHTML = sectionContent.attendancePolicyText;
                     section.querySelector('h3').textContent = sectionContent.codeOfConductTitle;
                     section.querySelectorAll('h3')[1].textContent = sectionContent.attendancePolicyTitle;
                } else if (sectionKey === 'benefits') {
                     paragraphs[0].innerHTML = sectionContent.intro;
                     paragraphs[1].innerHTML = sectionContent.healthInsuranceText;
                     paragraphs[2].innerHTML = sectionContent.retirementPlanText;
                     section.querySelector('h3').textContent = sectionContent.healthInsuranceTitle;
                     section.querySelectorAll('h3')[1].textContent = sectionContent.retirementPlanTitle;
                }
            });

            // Update Highlighted Terms Tooltips
            document.querySelectorAll('.highlighted-term').forEach(termElement => {
                const termKey = termElement.getAttribute('data-term');
                const tooltip = termElement.querySelector('.tooltip');
                if (tooltip) {
                    tooltip.innerHTML = content.terms[termKey] || termKey; // Fallback to term key if translation missing
                }
            });


            // Update Search Bar
            searchInput.placeholder = content.searchPlaceholder;
            searchButton.textContent = content.searchButton;
            document.querySelector('#search-results h4').textContent = content.searchResultsTitle;

            // Update Footer
            document.querySelector('footer p').innerHTML = content.footer;

            // Update active language button state
            langButtons.forEach(btn => {
                if (btn.getAttribute('data-lang') === lang) {
                    btn.classList.add('active');
                    btn.setAttribute('aria-current', 'true');
                } else {
                    btn.classList.remove('active');
                    btn.removeAttribute('aria-current');
                }
            });

            currentLang = lang;
        }

        // Initialize UI with default language (English)
        updateUI(currentLang);

        // Language Selector Dropdown Toggle
        langButton.addEventListener('click', () => {
            const isExpanded = langButton.getAttribute('aria-expanded') === 'true';
            langButton.setAttribute('aria-expanded', !isExpanded);
            langDropdown.style.display = isExpanded ? 'none' : 'block';
        });

        // Hide dropdown when clicking outside
        document.addEventListener('click', (event) => {
            if (!langSelector.contains(event.target)) {
                langDropdown.style.display = 'none';
                langButton.setAttribute('aria-expanded', 'false');
            }
        });

        // Language Selection
        langButtons.forEach(button => {
            button.addEventListener('click', () => {
                const lang = button.getAttribute('data-lang');
                updateUI(lang);
                langDropdown.style.display = 'none'; // Hide dropdown after selection
                langButton.setAttribute('aria-expanded', 'false');
            });
        });

        // Navigation Link Clicks
        navLinks.forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault();
                const targetSectionId = link.getAttribute('href');
                const targetSection = document.querySelector(targetSectionId);

                // Remove active class from all nav links and content sections
                navLinks.forEach(nav => nav.classList.remove('active'));
                contentSections.forEach(section => section.classList.remove('active'));
                searchResultsDiv.style.display = 'none'; // Hide search results

                // Add active class to clicked link and corresponding section
                link.classList.add('active');
                targetSection.classList.add('active');

                // Scroll to the section
                targetSection.scrollIntoView({
                    behavior: 'smooth'
                });

                 // Update aria-current for accessibility
                 navLinks.forEach(nav => nav.removeAttribute('aria-current'));
                 link.setAttribute('aria-current', 'page');
            });
        });

        // Initial active state for the first section and nav link
        if (navLinks.length > 0) {
            navLinks[0].classList.add('active');
            navLinks[0].setAttribute('aria-current', 'page');
        }
        if (contentSections.length > 0) {
             contentSections[0].classList.add('active');
        }


        // Search Functionality (Simplified)
        searchButton.addEventListener('click', () => {
            performSearch();
        });

        searchInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                performSearch();
            }
        });

        function performSearch() {
            const query = searchInput.value.toLowerCase();
            resultsList.innerHTML = ''; // Clear previous results

            if (query.length < 2) { // Require at least 2 characters for search
                searchResultsDiv.style.display = 'none';
                return;
            }

            const content = handbookContent[currentLang];
            let foundResults = false;

            // Search through section content
            for (const sectionKey in content) {
                if (handbookContent[currentLang].hasOwnProperty(sectionKey) && typeof content[sectionKey] === 'object' && content[sectionKey].title) {
                     const section = content[sectionKey];
                     const sectionTitle = section.title.toLowerCase();
                     const sectionIntro = section.intro ? section.intro.toLowerCase() : '';

                     let sectionMatch = false;
                     if (sectionTitle.includes(query) || sectionIntro.includes(query)) {
                         addSearchResult(section.title, `#${sectionKey}`);
                         sectionMatch = true;
                         foundResults = true;
                     }

                     // Search within section paragraphs (simplified - just check text content)
                     for (const key in section) {
                         if (typeof section[key] === 'string' && key !== 'title' && key !== 'intro') {
                              const text = section[key].toLowerCase();
                              if (text.includes(query) && !sectionMatch) { // Avoid duplicating section if already matched by title/intro
                                   addSearchResult(section.title + ' - ' + key.replace(/([A-Z])/g, ' $1').trim(), `#${sectionKey}`); // Basic key formatting
                                   sectionMatch = true; // Mark section as matched
                                   foundResults = true;
                              }
                         }
                     }
                }
            }

            searchResultsDiv.style.display = foundResults ? 'block' : 'none';
        }

        function addSearchResult(title, link) {
            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = link;
            a.textContent = title;
             a.addEventListener('click', (event) => {
                 event.preventDefault();
                 const targetSectionId = a.getAttribute('href');
                 const targetSection = document.querySelector(targetSectionId);

                 // Remove active class from all nav links and content sections
                 navLinks.forEach(nav => nav.classList.remove('active'));
                 contentSections.forEach(section => section.classList.remove('active'));

                 // Find the corresponding nav link and activate it
                 const targetNavLink = document.querySelector(`.nav-link[href="${targetSectionId}"]`);
                 if(targetNavLink) {
                     targetNavLink.classList.add('active');
                     targetNavLink.setAttribute('aria-current', 'page');
                 }

                 // Activate the target content section
                 targetSection.classList.add('active');

                 // Scroll to the section
                 targetSection.scrollIntoView({
                     behavior: 'smooth'
                 });

                 searchResultsDiv.style.display = 'none'; // Hide search results after clicking
                 searchInput.value = ''; // Clear search input
             });
            li.appendChild(a);
            resultsList.appendChild(li);
        }


        // Scroll to Top Button Visibility
        window.addEventListener('scroll', () => {
            if (window.scrollY > 200) { // Show button after scrolling 200px
                scrollToTopButton.classList.add('visible');
            } else {
                scrollToTopButton.classList.remove('visible');
            }
        });

        // Scroll to Top Button Click
        scrollToTopButton.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Visual Aid Modal
        document.querySelectorAll('.visual-aid').forEach(img => {
            img.addEventListener('click', () => {
                const imgSrc = img.src;
                const imgAlt = img.alt;

                // Clear previous content and add new image/svg
                modalImageContainer.innerHTML = '';
                 if (imgSrc.toLowerCase().endsWith('.svg')) {
                     // For SVG, ideally fetch and inject SVG content for better scaling/interactivity
                     // For simplicity here, we'll just use an <img> tag
                     const modalImg = document.createElement('img');
                     modalImg.src = imgSrc;
                     modalImg.alt = imgAlt;
                     modalImageContainer.appendChild(modalImg);
                 } else {
                    const modalImg = document.createElement('img');
                    modalImg.src = imgSrc;
                    modalImg.alt = imgAlt;
                    modalImageContainer.appendChild(modalImg);
                 }


                visualAidModal.style.display = 'flex'; // Use flex to center
                visualAidModal.setAttribute('aria-hidden', 'false');
                visualAidModal.focus(); // Focus modal for accessibility
            });
        });

        // Close Modal
        closeModalButton.addEventListener('click', () => {
            visualAidModal.style.display = 'none';
            visualAidModal.setAttribute('aria-hidden', 'true');
            // Optionally return focus to the element that opened the modal
        });

        // Close modal when clicking outside the modal content
        visualAidModal.addEventListener('click', (event) => {
            if (event.target === visualAidModal) {
                visualAidModal.style.display = 'none';
                visualAidModal.setAttribute('aria-hidden', 'true');
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape' && visualAidModal.style.display === 'flex') {
                visualAidModal.style.display = 'none';
                visualAidModal.setAttribute('aria-hidden', 'true');
            }
        });

        // Add ARIA attributes for language selector
        const langSelector = document.querySelector('.language-selector');
        langButton.setAttribute('aria-haspopup', 'true');
        langButton.setAttribute('aria-expanded', 'false');
        langDropdown.setAttribute('role', 'menu');
        langButtons.forEach(btn => btn.setAttribute('role', 'menuitem'));

        // Add ARIA attributes for navigation
        document.querySelector('.sidebar nav ul').setAttribute('role', 'navigation');
        navLinks.forEach(link => link.setAttribute('role', 'link'));

        // Add ARIA attributes for search
        searchInput.setAttribute('aria-label', 'Search handbook content');
        searchButton.setAttribute('aria-label', 'Perform search');

        // Add ARIA attributes for scroll to top
        scrollToTopButton.setAttribute('role', 'button');
        scrollToTopButton.setAttribute('aria-label', 'Scroll to top');

        // Add ARIA attributes for modal
        visualAidModal.setAttribute('role', 'dialog');
        visualAidModal.setAttribute('aria-modal', 'true');
        visualAidModal.setAttribute('aria-labelledby', 'modal-title'); // Assuming a title will be added
        visualAidModal.setAttribute('aria-hidden', 'true');
        closeModalButton.setAttribute('aria-label', 'Close modal');

    </script>

</body>
</html>
