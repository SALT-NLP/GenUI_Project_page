<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Handcrafted Jewelry - Products</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />
    <style>
        :root {
            --primary-color: #a87d5c; /* Subtle gold/bronze */
            --secondary-color: #d4b996; /* Lighter accent */
            --text-color: #333;
            --background-color: #ffffff;
            --card-background: #ffffff;
            --border-color: #eee;
            --spacing-unit: 8px;
            --header-height: 60px;
            --card-padding: calc(var(--spacing-unit) * 2);
            --border-radius: 8px;
            --shadow-subtle: 0 2px 4px rgba(0, 0, 0, 0.05);
            --shadow-hover: 0 6px 12px rgba(0, 0, 0, 0.1);
            --transition-duration: 0.3s; /* Slightly longer for smoother transitions */
            --transition-timing-function: ease-in-out;
            --error-color: #e74c3c;
        }

        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-color);
            background-color: var(--background-color);
            margin: 0;
            padding-top: var(--header-height); /* Add padding equal to header height */
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden; /* Prevent horizontal scroll on mobile menu */
        }

        *, *::before, *::after {
            box-sizing: border-box;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        button {
            font-family: 'Inter', sans-serif;
            cursor: pointer;
            border: none;
            background: none;
            padding: 0;
            color: inherit;
        }

        /* Accessibility: Focus styles */
        a:focus-visible, button:focus-visible, [tabindex="0"]:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
         /* Remove default outline for elements handled visually by focus-within */
         .product-card:focus-within {
             outline: none;
         }


        header {
            background-color: var(--background-color);
            border-bottom: 1px solid var(--border-color);
            height: var(--header-height);
            display: flex;
            align-items: center;
            padding: 0 calc(var(--spacing-unit) * 4);
            box-shadow: var(--shadow-subtle);
            position: fixed; /* Use fixed header for sticky effect */
            top: 0;
            left: 0;
            width: 100%;
            z-index: 100;
            transition: height var(--transition-duration) var(--transition-timing-function); /* Smooth height transition */
        }

        .header-container {
            width: 100%;
            max-width: 1200px; /* Align with main content */
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100%; /* Ensure container takes header height */
        }

        .logo {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--primary-color);
            z-index: 101; /* Ensure logo is above mobile menu */
        }

        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            gap: calc(var(--spacing-unit) * 4);
        }

        nav a {
            font-weight: 500;
            padding: calc(var(--spacing-unit) * 2) 0;
            position: relative;
            transition: color var(--transition-duration) var(--transition-timing-function);
        }

        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--primary-color);
            transform: scaleX(0);
            transition: transform var(--transition-duration) var(--transition-timing-function);
        }

        nav a:hover,
        nav a:focus-visible {
            color: var(--primary-color);
        }

        nav a:hover::after,
        nav a:focus-visible::after {
            transform: scaleX(1);
        }

        .nav-icons {
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-unit) * 3);
            z-index: 101; /* Ensure icons are above mobile menu */
        }

        .icon-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            transition: background-color var(--transition-duration) var(--transition-timing-function);
            color: var(--text-color); /* Default icon color */
        }

        .icon-button:hover,
        .icon-button:focus-visible {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .icon-button .material-symbols-rounded {
            font-size: 24px;
        }

        .cart-icon {
            position: relative;
        }

        .cart-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--primary-color);
            color: white;
            font-size: 0.7em;
            font-weight: 600;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none; /* Ensure clicks go to the button */
            transition: transform var(--transition-duration) var(--transition-timing-function);
        }

        /* Animation for cart badge update */
        .cart-badge.updated {
            animation: badge-pop 0.3s ease-in-out;
        }

        @keyframes badge-pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }


        .menu-toggle {
            display: none; /* Hidden on desktop */
            width: 40px;
            height: 40px;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color var(--transition-duration) var(--transition-timing-function);
            z-index: 101; /* Ensure toggle is above mobile menu */
        }

         .menu-toggle:hover,
         .menu-toggle:focus-visible {
             background-color: rgba(0, 0, 0, 0.05);
         }

        main {
            padding: calc(var(--spacing-unit) * 6) calc(var(--spacing-unit) * 4); /* Generous padding for desktop */
            max-width: 1200px;
            margin: 0 auto;
        }

        section {
            margin-bottom: calc(var(--spacing-unit) * 8); /* Spacing between sections */
        }

        .product-list-header {
            margin-bottom: calc(var(--spacing-unit) * 6);
            text-align: center;
        }

        .product-list-header h1 {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: var(--spacing-unit);
            color: var(--primary-color);
        }

        .product-list-header p {
            font-size: 1.1em;
            color: #666;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* Flexible grid */
            gap: calc(var(--spacing-unit) * 5); /* More gap */
        }

        .product-card {
            background-color: var(--card-background);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-subtle);
            display: flex;
            flex-direction: column;
            transition: transform var(--transition-duration) var(--transition-timing-function), box-shadow var(--transition-duration) var(--transition-timing-function);
            position: relative;
            border: 1px solid var(--border-color);
            cursor: pointer; /* Indicate clickable area */
        }

        .product-card:hover,
        .product-card:focus-within {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }
         .product-card:focus-within .product-card-image img {
             transform: scale(1.05); /* Apply image scale on focus-within too */
         }


        .product-card-image {
            width: 100%;
            height: 350px; /* Taller images on desktop */
            overflow: hidden;
            position: relative;
        }

        .product-card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform var(--transition-duration) var(--transition-timing-function);
        }

        .quick-view-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity var(--transition-duration) var(--transition-timing-function);
            pointer-events: none; /* Allow clicks through by default */
        }

        .product-card:hover .quick-view-overlay,
        .product-card:focus-within .quick-view-overlay {
            opacity: 1;
            pointer-events: auto; /* Enable clicks on hover/focus */
        }

        .quick-view-button {
            background-color: rgba(255, 255, 255, 0.9);
            color: var(--text-color);
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 2);
            border-radius: var(--border-radius);
            font-weight: 600;
            transition: background-color var(--transition-duration) var(--transition-timing-function), color var(--transition-duration) var(--transition-timing-function);
        }

        .quick-view-button:hover,
        .quick-view-button:focus-visible {
            background-color: var(--primary-color);
            color: white;
        }


        .product-card-content {
            padding: var(--card-padding);
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .product-card-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: var(--spacing-unit);
            color: var(--text-color);
            flex-grow: 1; /* Pushes price and button down */
        }

        .product-card-price {
            font-size: 1.1em;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: calc(var(--spacing-unit) * 2);
        }

        .add-to-cart-button {
            display: block;
            width: 100%;
            padding: calc(var(--spacing-unit) * 1.5) calc(var(--spacing-unit) * 2);
            background-color: var(--primary-color);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-size: 1em;
            font-weight: 600;
            transition: background-color var(--transition-duration) var(--transition-timing-function);
        }

        .add-to-cart-button:hover,
        .add-to-cart-button:focus-visible {
            background-color: #8a654b; /* Darker shade */
        }

         .add-to-cart-button:disabled {
             background-color: #ccc;
             cursor: not-allowed;
         }

        footer {
            background-color: #f8f8f8;
            padding: calc(var(--spacing-unit) * 6) calc(var(--spacing-unit) * 4);
            border-top: 1px solid var(--border-color);
            text-align: center;
            color: #666;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); /* Adjust footer grid */
            gap: calc(var(--spacing-unit) * 6); /* More gap */
            text-align: left;
        }

        .footer-section h4 {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: calc(var(--spacing-unit) * 2);
            color: var(--text-color);
        }

        .footer-section ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .footer-section li {
            margin-bottom: var(--spacing-unit);
        }

        .footer-section a {
            color: #666;
            transition: color var(--transition-duration) var(--transition-timing-function);
        }

        .footer-section a:hover,
        .footer-section a:focus-visible {
            color: var(--primary-color);
        }

        .social-icons {
            display: flex;
            gap: calc(var(--spacing-unit) * 2);
            margin-top: calc(var(--spacing-unit) * 2);
        }

        .social-icon-button {
             display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: #ddd;
            transition: background-color var(--transition-duration) var(--transition-timing-function);
        }
         .social-icon-button:hover,
         .social-icon-button:focus-visible {
            background-color: var(--primary-color);
         }

         .social-icon-button .material-symbols-rounded {
            font-size: 20px;
            color: var(--text-color);
            transition: color var(--transition-duration) var(--transition-timing-function);
         }
         .social-icon-button:hover .material-symbols-rounded,
         .social-icon-button:focus-visible .material-symbols-rounded {
            color: white;
         }


        .footer-bottom {
            margin-top: calc(var(--spacing-unit) * 4);
            padding-top: calc(var(--spacing-unit) * 2);
            border-top: 1px solid var(--border-color);
            font-size: 0.9em;
            color: #999;
        }

        /* Modal Styles (Quick View, Cart, Checkout) */
        .modal-overlay {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            justify-content: center;
            align-items: center;
            z-index: 200;
            opacity: 0;
            transition: opacity var(--transition-duration) var(--transition-timing-function);
            overflow-y: auto; /* Allow scrolling for content taller than viewport */
            padding: calc(var(--spacing-unit) * 4) 0; /* Add vertical padding */
        }

        .modal-overlay.visible {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background-color: var(--background-color);
            padding: calc(var(--spacing-unit) * 4);
            border-radius: var(--border-radius);
            max-width: 800px; /* Increased max-width for Quick View/Product Detail */
            width: 95%; /* Wider on smaller screens */
            box-shadow: var(--shadow-hover);
            position: relative;
            transform: translateY(-20px);
            transition: transform var(--transition-duration) var(--transition-timing-function);
            margin: auto; /* Center content if it doesn't fill height */
        }

         .modal-overlay.visible .modal-content {
             transform: translateY(0);
         }

        .modal-close {
            position: absolute;
            top: var(--spacing-unit);
            right: var(--spacing-unit);
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color var(--transition-duration) var(--transition-timing-function);
        }
         .modal-close:hover,
         .modal-close:focus-visible {
             background-color: rgba(0, 0, 0, 0.05);
         }

         .modal-body {
             margin-top: calc(var(--spacing-unit) * 3);
         }

         /* Quick View / Product Detail Modal Specific */
         .product-detail-modal-content {
             display: grid;
             grid-template-columns: 1fr 1fr; /* Two columns for image and details */
             gap: calc(var(--spacing-unit) * 4);
         }

         .product-detail-modal-image {
             /* Adjust as needed */
         }

         .product-detail-modal-image img {
             max-width: 100%;
             height: auto;
             border-radius: var(--border-radius);
         }

         .product-detail-modal-details h2 {
             margin-top: 0;
             font-size: 2em;
             font-weight: 700;
             color: var(--primary-color);
             margin-bottom: var(--spacing-unit);
         }

         .product-detail-modal-details .price {
             font-size: 1.5em;
             font-weight: 700;
             color: var(--text-color);
             margin-bottom: calc(var(--spacing-unit) * 2);
         }

         .product-detail-modal-details .description {
             color: #555;
             margin-bottom: calc(var(--spacing-unit) * 3);
         }

         /* Customization Options */
         .customization-options {
             margin-bottom: calc(var(--spacing-unit) * 3);
             padding-top: calc(var(--spacing-unit) * 2);
             border-top: 1px solid var(--border-color);
         }

         .customization-options h4 {
             font-size: 1.1em;
             font-weight: 600;
             margin-bottom: calc(var(--spacing-unit) * 2);
         }

         .option-group {
             margin-bottom: calc(var(--spacing-unit) * 2);
         }

         .option-group label {
             display: block;
             font-weight: 500;
             margin-bottom: var(--spacing-unit);
         }

         .option-group select,
         .option-group input[type="radio"],
         .option-group input[type="checkbox"] {
             margin-right: var(--spacing-unit);
         }

         .option-group .color-swatch {
             display: inline-block;
             width: 24px;
             height: 24px;
             border-radius: 50%;
             border: 2px solid transparent;
             margin-right: var(--spacing-unit);
             cursor: pointer;
             transition: border-color var(--transition-duration);
         }
         .option-group input[type="radio"]:checked + .color-swatch {
             border-color: var(--primary-color);
         }


         /* Quantity Selector */
         .quantity-selector {
             display: flex;
             align-items: center;
             margin-bottom: calc(var(--spacing-unit) * 3);
         }

         .quantity-selector label {
             font-weight: 500;
             margin-right: var(--spacing-unit);
         }

         .quantity-selector input[type="number"] {
             width: 60px;
             padding: var(--spacing-unit);
             border: 1px solid var(--border-color);
             border-radius: var(--border-radius);
             font-size: 1em;
             text-align: center;
         }

         /* Cart Modal Specific */
         .cart-modal-content h2 {
             margin-top: 0;
             font-size: 2em;
             font-weight: 700;
             color: var(--primary-color);
             margin-bottom: calc(var(--spacing-unit) * 3);
         }

         .cart-items {
             list-style: none;
             padding: 0;
             margin: 0;
         }

         .cart-item {
             display: flex;
             align-items: center;
             border-bottom: 1px solid var(--border-color);
             padding: calc(var(--spacing-unit) * 2) 0;
             gap: calc(var(--spacing-unit) * 2);
         }

         .cart-item img {
             width: 80px;
             height: 80px;
             object-fit: cover;
             border-radius: var(--border-radius);
         }

         .cart-item-details {
             flex-grow: 1;
         }

         .cart-item-details h4 {
             margin: 0 0 var(--spacing-unit) 0;
             font-size: 1.1em;
             font-weight: 600;
         }

         .cart-item-details .price {
             font-weight: 700;
             color: var(--primary-color);
             margin-bottom: var(--spacing-unit);
         }

         .cart-item-quantity input[type="number"] {
             width: 50px;
             padding: var(--spacing-unit);
             border: 1px solid var(--border-color);
             border-radius: var(--border-radius);
             font-size: 0.9em;
             text-align: center;
         }

         .cart-item-remove {
             margin-left: calc(var(--spacing-unit) * 2);
             color: #999;
             transition: color var(--transition-duration);
         }
         .cart-item-remove:hover,
         .cart-item-remove:focus-visible {
             color: var(--error-color);
         }

         .cart-summary {
             margin-top: calc(var(--spacing-unit) * 3);
             padding-top: calc(var(--spacing-unit) * 2);
             border-top: 1px solid var(--border-color);
             text-align: right;
             font-size: 1.2em;
             font-weight: 700;
             color: var(--primary-color);
         }

         .cart-actions {
             margin-top: calc(var(--spacing-unit) * 3);
             text-align: right;
         }

         /* Checkout Modal Specific */
         .checkout-modal-content h2 {
             margin-top: 0;
             font-size: 2em;
             font-weight: 700;
             color: var(--primary-color);
             margin-bottom: calc(var(--spacing-unit) * 3);
         }

         .checkout-step-indicator {
             display: flex;
             justify-content: space-between;
             margin-bottom: calc(var(--spacing-unit) * 4);
             font-weight: 600;
             color: #ccc;
         }

         .checkout-step-indicator .step {
             flex-grow: 1;
             text-align: center;
             position: relative;
         }

         .checkout-step-indicator .step.active {
             color: var(--primary-color);
         }

         .checkout-step-indicator .step::after {
             content: '';
             position: absolute;
             bottom: -var(--spacing-unit);
             left: 0;
             width: 100%;
             height: 2px;
             background-color: #ccc;
         }
          .checkout-step-indicator .step.active::after {
             background-color: var(--primary-color);
         }

         .checkout-form-section {
             margin-bottom: calc(var(--spacing-unit) * 4);
         }

         /* Form Styling */
        .form-group {
            margin-bottom: calc(var(--spacing-unit) * 3);
        }

        .form-group label {
            display: block;
            font-weight: 500;
            margin-bottom: var(--spacing-unit);
            color: var(--text-color);
        }

        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="number"],
        .form-group input[type="tel"],
        .form-group input[type="password"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: calc(var(--spacing-unit) * 1.5);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1em;
            font-family: 'Inter', sans-serif;
            transition: border-color var(--transition-duration) var(--transition-timing-function), box-shadow var(--transition-duration) var(--transition-timing-function);
        }

         .form-group input[type="text"]:focus,
         .form-group input[type="email"]:focus,
         .form-group input[type="number"]:focus,
         .form-group input[type="tel"]:focus,
         .form-group input[type="password"]:focus,
         .form-group select:focus,
         .form-group textarea:focus {
             border-color: var(--primary-color);
             box-shadow: 0 0 0 3px rgba(168, 125, 92, 0.1); /* Use RGBA for primary color */
         }

         .form-group input.error,
         .form-group select.error,
         .form-group textarea.error {
             border-color: var(--error-color); /* Red for error */
         }

         .error-message {
             color: var(--error-color);
             font-size: 0.9em;
             margin-top: var(--spacing-unit);
         }

         .button-primary {
            display: inline-block;
            padding: calc(var(--spacing-unit) * 1.5) calc(var(--spacing-unit) * 3);
            background-color: var(--primary-color);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-size: 1em;
            font-weight: 600;
            transition: background-color var(--transition-duration) var(--transition-timing-function);
         }
         .button-primary:hover,
         .button-primary:focus-visible {
             background-color: #8a654b; /* Darker shade */
         }
          .button-primary:disabled {
              background-color: #ccc;
              cursor: not-allowed;
          }

          .button-secondary {
            display: inline-block;
            padding: calc(var(--spacing-unit) * 1.5) calc(var(--spacing-unit) * 3);
            background-color: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            border-radius: var(--border-radius);
            text-align: center;
            font-size: 1em;
            font-weight: 600;
            transition: background-color var(--transition-duration) var(--transition-timing-function), color var(--transition-duration) var(--transition-timing-function);
          }
          .button-secondary:hover,
          .button-secondary:focus-visible {
              background-color: var(--primary-color);
              color: white;
          }


        /* Analytics Dashboard Placeholder */
        .analytics-dashboard {
             padding: calc(var(--spacing-unit) * 4);
             background-color: #f8f8f8;
             border-radius: var(--border-radius);
             margin-top: calc(var(--spacing-unit) * 6);
         }

         .analytics-dashboard h2 {
             font-size: 2em;
             font-weight: 700;
             color: var(--primary-color);
             margin-bottom: calc(var(--spacing-unit) * 4);
             text-align: center;
         }

         .chart-container {
             position: relative;
             width: 100%;
             height: 400px; /* Fixed height for chart */
             margin-bottom: calc(var(--spacing-unit) * 4);
             background-color: var(--background-color);
             border-radius: var(--border-radius);
             padding: calc(var(--spacing-unit) * 2);
             box-shadow: var(--shadow-subtle);
             cursor: pointer; /* Indicate interactivity */
         }

          .floating-controls {
            position: absolute;
            top: calc(var(--spacing-unit) * 2);
            right: calc(var(--spacing-unit) * 2);
            background: rgba(255, 255, 255, 0.95);
            padding: calc(var(--spacing-unit) * 2);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-hover);
            opacity: 0;
            transform: translateY(-10px);
            transition: all var(--transition-duration) var(--transition-timing-function);
            pointer-events: none;
            z-index: 10; /* Ensure controls are above chart */
        }
        .floating-controls.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }
        .control-group {
            margin: calc(var(--spacing-unit) * 1.5) 0;
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-unit);
            flex-direction: column;
        }
        .control-group label {
            font-weight: 500;
            color: var(--text-color);
            font-size: 0.9em;
        }
        .control-group input[type="color"],
        .control-group input[type="number"],
        .control-group select {
            padding: var(--spacing-unit);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 0.9em;
            font-family: 'Inter', sans-serif;
            width: 100%; /* Make controls fill width */
        }


        /* Utility Classes */
        .hidden {
            display: none;
        }


        /* Responsive adjustments for smaller screens */
        @media (max-width: 1024px) {
            header {
                 padding: 0 calc(var(--spacing-unit) * 3);
            }
            main {
                padding: calc(var(--spacing-unit) * 5) calc(var(--spacing-unit) * 3);
            }
            .product-grid {
                gap: calc(var(--spacing-unit) * 4);
            }
             .footer-content {
                gap: calc(var(--spacing-unit) * 5);
            }
             .modal-content {
                 max-width: 90%; /* Adjust modal width */
             }
             .product-detail-modal-content {
                 grid-template-columns: 1fr; /* Stack image and details */
             }
             .product-detail-modal-image {
                 text-align: center; /* Center image when stacked */
             }
              .product-detail-modal-details h2 {
                 font-size: 1.8em;
             }
        }


        @media (max-width: 768px) {
             header {
                padding: 0 calc(var(--spacing-unit) * 2);
                height: auto; /* Allow header to expand for mobile menu */
                align-items: flex-start; /* Align items to top when stacked */
            }
            .header-container {
                flex-direction: column; /* Stack on smaller screens */
                align-items: center;
                padding: calc(var(--spacing-unit) * 2) 0; /* Add vertical padding */
                height: auto;
            }
             .logo {
                 margin-bottom: var(--spacing-unit) * 2;
                 flex-grow: 0;
                 width: 100%;
                 text-align: center;
             }
             nav {
                 flex-basis: 100%;
                 order: 2; /* Place nav below icons on smaller screens */
                 margin-top: var(--spacing-unit);
                 display: none; /* Hidden by default on mobile */
                 opacity: 0;
                 max-height: 0;
                 overflow: hidden;
                 transition: opacity var(--transition-duration) var(--transition-timing-function), max-height var(--transition-duration) var(--transition-timing-function);
             }
             nav.active {
                 display: block; /* Show when active */
                 opacity: 1;
                 max-height: 300px; /* Arbitrary value, should be large enough */
             }
            nav ul {
                flex-direction: column; /* Stack nav links */
                gap: calc(var(--spacing-unit) * 2);
                justify-content: center;
                width: 100%;
                text-align: center;
            }
             nav a {
                 padding: var(--spacing-unit) 0; /* Adjust padding */
             }
             nav a::after {
                 bottom: -2px; /* Adjust underline position */
             }

            .nav-icons {
                width: 100%; /* Icons take full width */
                justify-content: space-between; /* Space out icons */
                gap: 0; /* Remove gap */
                order: 1; /* Place icons above nav */
            }
             .menu-toggle {
                 display: flex; /* Show toggle button */
             }
             .header-container > .logo,
             .header-container > .nav-icons {
                 width: 100%;
                 display: flex;
                 justify-content: space-between;
                 align-items: center;
             }
             .header-container > .logo {
                 justify-content: center; /* Center logo */
             }


            main {
                padding: calc(var(--spacing-unit) * 4) calc(var(--spacing-unit) * 2); /* Less padding */
            }

            .product-list-header h1 {
                font-size: 2em;
            }
             .product-list-header {
                 margin-bottom: calc(var(--spacing-unit) * 4);
             }

            .product-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); /* Adjust min width */
                gap: calc(var(--spacing-unit) * 3);
            }

            .product-card-image {
                 height: 300px; /* Adjust height */
            }

             .footer-content {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); /* Adjust footer grid */
                gap: calc(var(--spacing-unit) * 4); /* Less gap */
                text-align: left;
            }
             footer {
                 padding: calc(var(--spacing-unit) * 4) calc(var(--spacing-unit) * 2);
             }

             .modal-content {
                 padding: calc(var(--spacing-unit) * 3);
             }
             .product-detail-modal-details h2 {
                 font-size: 1.6em;
             }
              .cart-item {
                 flex-direction: column;
                 align-items: flex-start;
             }
             .cart-item img {
                 margin-bottom: var(--spacing-unit);
             }
             .cart-item-remove {
                 margin-left: 0;
                 margin-top: var(--spacing-unit);
             }
             .cart-summary, .cart-actions {
                 text-align: center;
             }
             .checkout-step-indicator {
                 font-size: 0.9em;
             }
        }

        @media (max-width: 480px) {
             .header-container {
                 padding: calc(var(--spacing-unit) * 2) 0;
                 gap: calc(var(--spacing-unit) * 2);
             }
             .header-container > .logo,
             .header-container > .nav-icons {
                 padding: 0 calc(var(--spacing-unit) * 2); /* Add horizontal padding */
             }
             nav.active {
                 padding: 0 calc(var(--spacing-unit) * 2); /* Add horizontal padding */
             }
             nav ul {
                 gap: calc(var(--spacing-unit) * 2);
             }

             main {
                 padding: calc(var(--spacing-unit) * 3) calc(var(--spacing-unit) * 2);
             }

             .product-grid {
                grid-template-columns: 1fr; /* Single column */
                gap: calc(var(--spacing-unit) * 2);
            }
             .product-card-image {
                 height: 250px; /* Adjust height */
            }
             .footer-content {
                grid-template-columns: 1fr; /* Single column */
                gap: calc(var(--spacing-unit) * 4); /* More gap between sections */
                text-align: center;
            }
            .footer-section ul {
                align-items: center; /* Center list items */
            }
             .social-icons {
                justify-content: center; /* Center social icons */
            }
             .modal-content {
                 padding: calc(var(--spacing-unit) * 2);
             }
             .product-detail-modal-details h2 {
                 font-size: 1.4em;
             }
        }

    </style>
</head>
<body>

    <header>
        <div class="header-container">
            <div class="logo"><a href="#">Jewelry Co.</a></div>
             <button class="menu-toggle" aria-label="Toggle navigation menu" aria-expanded="false">
                <span class="material-symbols-rounded menu-icon-open" aria-hidden="true">menu</span>
                 <span class="material-symbols-rounded menu-icon-close" aria-hidden="true" style="display: none;">close</span>
            </button>
            <nav aria-label="Main navigation">
                <ul>
                    <li><a href="#products">Shop</a></li>
                    <li><a href="#">Collections</a></li>
                    <li><a href="#">Customization</a></li>
                    <li><a href="#">About Us</a></li>
                </ul>
            </nav>
            <div class="nav-icons">
                <button class="icon-button" aria-label="Search">
                    <span class="material-symbols-rounded" aria-hidden="true">search</span>
                </button>
                 <button class="icon-button" aria-label="Account">
                    <span class="material-symbols-rounded" aria-hidden="true">person</span>
                </button>
                <button class="icon-button cart-icon" aria-label="Shopping Cart" id="openCartModal">
                    <span class="material-symbols-rounded" aria-hidden="true">shopping_cart</span>
                    <span class="cart-badge" aria-live="polite" aria-atomic="true">3</span>
                </button>
            </div>
        </div>
    </header>

    <main>
        <section id="products" class="product-list-header">
            <h1>Exquisite Handcrafted Jewelry</h1>
            <p>Discover unique pieces crafted with passion and precision.</p>
        </section>

        <section class="product-grid" aria-label="Product Listing">
            <!-- Product Card 1 -->
            <article class="product-card" tabindex="0" data-product-id="1">
                <div class="product-card-image">
                    <img src="https://placehold.co/400x350?text=Necklace" alt="Elegant Silver Necklace">
                     <div class="quick-view-overlay">
                        <button class="quick-view-button" aria-label="Quick view Elegant Silver Necklace">Quick View</button>
                    </div>
                </div>
                <div class="product-card-content">
                    <h3 class="product-card-title">Elegant Silver Necklace</h3>
                    <p class="product-card-price">$120.00</p>
                    <button class="add-to-cart-button">Add to Cart</button>
                </div>
            </article>

             <!-- Product Card 2 -->
            <article class="product-card" tabindex="0" data-product-id="2">
                <div class="product-card-image">
                    <img src="https://placehold.co/400x350?text=Earrings" alt="Delicate Gold Earrings">
                     <div class="quick-view-overlay">
                        <button class="quick-view-button" aria-label="Quick view Delicate Gold Earrings">Quick View</button>
                    </div>
                </div>
                <div class="product-card-content">
                    <h3 class="product-card-title">Delicate Gold Earrings</h3>
                    <p class="product-card-price">$85.00</p>
                    <button class="add-to-cart-button">Add to Cart</button>
                </div>
            </article>

             <!-- Product Card 3 -->
            <article class="product-card" tabindex="0" data-product-id="3">
                <div class="product-card-image">
                    <img src="https://placehold.co/400x350?text=Bracelet" alt="Beaded Gemstone Bracelet">
                     <div class="quick-view-overlay">
                        <button class="quick-view-button" aria-label="Quick view Beaded Gemstone Bracelet">Quick View</button>
                    </div>
                </div>
                <div class="product-card-content">
                    <h3 class="product-card-title">Beaded Gemstone Bracelet</h3>
                    <p class="product-card-price">$55.00</p>
                    <button class="add-to-cart-button">Add to Cart</button>
                </div>
            </article>

             <!-- Product Card 4 -->
            <article class="product-card" tabindex="0" data-product-id="4">
                <div class="product-card-image">
                    <img src="https://placehold.co/400x350?text=Ring" alt="Minimalist Rose Gold Ring">
                     <div class="quick-view-overlay">
                        <button class="quick-view-button" aria-label="Quick view Minimalist Rose Gold Ring">Quick View</button>
                    </div>
                </div>
                <div class="product-card-content">
                    <h3 class="product-card-title">Minimalist Rose Gold Ring</h3>
                    <p class="product-card-price">$70.00</p>
                    <button class="add-to-cart-button">Add to Cart</button>
                </div>
            </article>

            <!-- Add more product cards here -->
             <article class="product-card" tabindex="0" data-product-id="5">
                <div class="product-card-image">
                    <img src="https://placehold.co/400x350?text=Pendant" alt="Unique Stone Pendant">
                     <div class="quick-view-overlay">
                        <button class="quick-view-button" aria-label="Quick view Unique Stone Pendant">Quick View</button>
                    </div>
                </div>
                <div class="product-card-content">
                    <h3 class="product-card-title">Unique Stone Pendant</h3>
                    <p class="product-card-price">$95.00</p>
                    <button class="add-to-cart-button">Add to Cart</button>
                </div>
            </article>

             <article class="product-card" tabindex="0" data-product-id="6">
                <div class="product-card-image">
                    <img src="https://placehold.co/400x350?text=Hoops" alt="Classic Silver Hoop Earrings">
                     <div class="quick-view-overlay">
                        <button class="quick-view-button" aria-label="Quick view Classic Silver Hoop Earrings">Quick View</button>
                    </div>
                </div>
                <div class="product-card-content">
                    <h3 class="product-card-title">Classic Silver Hoop Earrings</h3>
                    <p class="product-card-price">$60.00</p>
                    <button class="add-to-cart-button">Add to Cart</button>
                </div>
            </article>

        </section>

         <!-- Analytics Dashboard Placeholder Section -->
         <section class="analytics-dashboard hidden" id="analyticsSection">
             <h2>Sales Analytics Dashboard</h2>
             <div class="chart-container" id="salesChartContainer">
                 <canvas id="salesChart"></canvas>
                 <!-- Floating control panel for sales chart -->
                 <div class="floating-controls" id="salesChartControls">
                     <div class="control-group">
                         <label for="salesChartType">Chart Type</label>
                         <select id="salesChartType">
                             <option value="bar">Bar</option>
                             <option value="line">Line</option>
                         </select>
                     </div>
                     <div class="control-group">
                         <label for="salesBgColor">Background Color</label>
                         <input type="color" id="salesBgColor" value="#a87d5c">
                     </div>
                     <div class="control-group">
                         <label for="salesBorderColor">Border Color</label>
                         <input type="color" id="salesBorderColor" value="#8a654b">
                     </div>
                 </div>
             </div>
             <!-- More analytics components could go here -->
         </section>

    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h4>Shop</h4>
                <ul>
                    <li><a href="#">Necklaces</a></li>
                    <li><a href="#">Earrings</a></li>
                    <li><a href="#">Bracelets</a></li>
                    <li><a href="#">Rings</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>About</h4>
                <ul>
                    <li><a href="#">Our Story</a></li>
                    <li><a href="#">Craftsmanship</a></li>
                    <li><a href="#">Contact Us</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Support</h4>
                <ul>
                    <li><a href="#">FAQs</a></li>
                    <li><a href="#">Shipping & Returns</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Terms of Service</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Connect</h4>
                <div class="social-icons">
                    <button class="social-icon-button" aria-label="Follow us on Instagram">
                        <span class="material-symbols-rounded" aria-hidden="true">photo_camera</span>
                    </button>
                    <button class="social-icon-button" aria-label="Follow us on Facebook">
                        <span class="material-symbols-rounded" aria-hidden="true">thumb_up</span>
                    </button>
                    <button class="social-icon-button" aria-label="Follow us on Twitter">
                        <span class="material-symbols-rounded" aria-hidden="true">share</span>
                    </button>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            &copy; 2023 Jewelry Co. All rights reserved.
        </div>
    </footer>

    <!-- Quick View Modal Structure -->
    <div id="quickViewModal" class="modal-overlay" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <div class="modal-content product-detail-modal-content">
            <button class="modal-close" aria-label="Close quick view modal">
                 <span class="material-symbols-rounded" aria-hidden="true">close</span>
            </button>
            <div class="product-detail-modal-image">
                 <img id="modalProductImage" src="https://placehold.co/400x350?text=Product+Image" alt="Product Image">
            </div>
            <div class="product-detail-modal-details">
                <h2 id="modalTitle">Product Quick View</h2>
                <p id="modalProductPrice" class="price">$0.00</p>
                <p id="modalProductDescription" class="description">Short description placeholder...</p>

                <!-- Customization Options Placeholder -->
                <div class="customization-options">
                    <h4>Customization Options</h4>
                    <div class="option-group">
                        <label for="material-select">Material:</label>
                        <select id="material-select">
                            <option value="silver">Silver</option>
                            <option value="gold">Gold</option>
                            <option value="rose-gold">Rose Gold</option>
                        </select>
                    </div>
                     <div class="option-group">
                        <label>Stone Color:</label>
                        <div>
                            <input type="radio" id="color-blue" name="stone-color" value="blue" checked>
                            <label for="color-blue" class="color-swatch" style="background-color: #3498db;" aria-label="Blue stone color"></label>

                            <input type="radio" id="color-red" name="stone-color" value="red">
                            <label for="color-red" class="color-swatch" style="background-color: #e74c3c;" aria-label="Red stone color"></label>

                            <input type="radio" id="color-green" name="stone-color" value="green">
                            <label for="color-green" class="color-swatch" style="background-color: #2ecc71;" aria-label="Green stone color"></label>
                        </div>
                    </div>
                     <div class="option-group">
                        <label for="engraving-text">Engraving (Optional):</label>
                        <input type="text" id="engraving-text" placeholder="Enter text for engraving">
                    </div>
                </div>

                <!-- Quantity Selector -->
                <div class="quantity-selector">
                    <label for="quantity">Quantity:</label>
                    <input type="number" id="quantity" value="1" min="1">
                </div>

                <button class="add-to-cart-button button-primary" style="width: auto; margin-top: var(--spacing-unit) * 2;">Add to Cart</button>
            </div>
        </div>
    </div>

     <!-- Shopping Cart Modal Structure -->
    <div id="cartModal" class="modal-overlay" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="cartModalTitle">
        <div class="modal-content cart-modal-content">
            <button class="modal-close" aria-label="Close shopping cart modal">
                 <span class="material-symbols-rounded" aria-hidden="true">close</span>
            </button>
            <h2 id="cartModalTitle">Your Shopping Cart</h2>
            <ul class="cart-items">
                <!-- Cart items will be added here by JS -->
                <li class="cart-item">
                    <img src="https://placehold.co/80x80?text=Item+1" alt="Cart Item 1">
                    <div class="cart-item-details">
                        <h4>Elegant Silver Necklace</h4>
                        <p class="price">$120.00</p>
                    </div>
                    <div class="cart-item-quantity">
                        <label for="cart-item-qty-1" class="hidden">Quantity:</label>
                        <input type="number" id="cart-item-qty-1" value="1" min="1" aria-label="Quantity for Elegant Silver Necklace">
                    </div>
                    <button class="cart-item-remove" aria-label="Remove Elegant Silver Necklace from cart">
                         <span class="material-symbols-rounded" aria-hidden="true">delete</span>
                    </button>
                </li>
                 <li class="cart-item">
                    <img src="https://placehold.co/80x80?text=Item+2" alt="Cart Item 2">
                    <div class="cart-item-details">
                        <h4>Delicate Gold Earrings</h4>
                        <p class="price">$85.00</p>
                    </div>
                    <div class="cart-item-quantity">
                         <label for="cart-item-qty-2" class="hidden">Quantity:</label>
                        <input type="number" id="cart-item-qty-2" value="2" min="1" aria-label="Quantity for Delicate Gold Earrings">
                    </div>
                    <button class="cart-item-remove" aria-label="Remove Delicate Gold Earrings from cart">
                         <span class="material-symbols-rounded" aria-hidden="true">delete</span>
                    </button>
                </li>
            </ul>
            <div class="cart-summary">
                Total: $290.00 <!-- Placeholder -->
            </div>
            <div class="cart-actions">
                <button class="button-secondary" id="continueShopping">Continue Shopping</button>
                <button class="button-primary" id="openCheckoutModal">Proceed to Checkout</button>
            </div>
        </div>
    </div>

     <!-- Checkout Modal Structure -->
    <div id="checkoutModal" class="modal-overlay" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="checkoutModalTitle">
        <div class="modal-content checkout-modal-content">
            <button class="modal-close" aria-label="Close checkout modal">
                 <span class="material-symbols-rounded" aria-hidden="true">close</span>
            </button>
            <h2 id="checkoutModalTitle">Checkout</h2>

            <div class="checkout-step-indicator">
                <div class="step active">Shipping</div>
                <div class="step">Payment</div>
                <div class="step">Review</div>
            </div>

            <div class="checkout-form-section">
                <h3>Shipping Information</h3>
                <div class="form-group">
                    <label for="fullName">Full Name</label>
                    <input type="text" id="fullName" required>
                    <p class="error-message hidden">Full name is required.</p>
                </div>
                 <div class="form-group">
                    <label for="address1">Address Line 1</label>
                    <input type="text" id="address1" required>
                     <p class="error-message hidden">Address is required.</p>
                </div>
                 <div class="form-group">
                    <label for="address2">Address Line 2 (Optional)</label>
                    <input type="text" id="address2">
                </div>
                 <div class="form-group">
                    <label for="city">City</label>
                    <input type="text" id="city" required>
                     <p class="error-message hidden">City is required.</p>
                </div>
                 <div class="form-group">
                    <label for="state">State/Province</label>
                    <input type="text" id="state" required>
                     <p class="error-message hidden">State/Province is required.</p>
                </div>
                 <div class="form-group">
                    <label for="zip">Zip/Postal Code</label>
                    <input type="text" id="zip" required>
                     <p class="error-message hidden">Zip/Postal Code is required.</p>
                </div>
                 <div class="form-group">
                    <label for="country">Country</label>
                    <select id="country" required>
                        <option value="">Select Country</option>
                        <option value="usa">United States</option>
                        <option value="canada">Canada</option>
                        <!-- Add more countries -->
                    </select>
                     <p class="error-message hidden">Country is required.</p>
                </div>
            </div>

             <div class="checkout-actions" style="text-align: right;">
                 <button class="button-primary">Continue to Payment</button>
             </div>
        </div>
    </div>


    <script type="module">
        import { Chart } from "https://esm.sh/chart.js/auto";

        document.addEventListener('DOMContentLoaded', () => {
            const quickViewButtons = document.querySelectorAll('.quick-view-button');
            const addToCartButtons = document.querySelectorAll('.add-to-cart-button');
            const cartBadge = document.querySelector('.cart-badge');

            const quickViewModal = document.getElementById('quickViewModal');
            const cartModal = document.getElementById('cartModal');
            const checkoutModal = document.getElementById('checkoutModal');

            const modalCloseButtons = document.querySelectorAll('.modal-close');
            const openCartModalButton = document.getElementById('openCartModal');
            const openCheckoutModalButton = document.getElementById('openCheckoutModal');
            const continueShoppingButton = document.getElementById('continueShopping');

            const modalTitle = quickViewModal.querySelector('#modalTitle');
            const modalProductName = quickViewModal.querySelector('.product-detail-modal-details h2');
            const modalProductPrice = quickViewModal.querySelector('#modalProductPrice');
            const modalProductDescription = quickViewModal.querySelector('#modalProductDescription');
            const modalProductImage = quickViewModal.querySelector('#modalProductImage');
            const modalAddToCartButton = quickViewModal.querySelector('.add-to-cart-button'); // Get the button inside the modal

            const menuToggle = document.querySelector('.menu-toggle');
            const mainNav = document.querySelector('header nav');
            const menuIconOpen = menuToggle.querySelector('.menu-icon-open');
            const menuIconClose = menuToggle.querySelector('.menu-icon-close');

            let currentModal = null; // Track the currently open modal

            // --- Modal Functionality ---
            const openModal = (modalElement, productData = null) => {
                if (currentModal) {
                    closeModal(currentModal); // Close any open modal first
                }

                if (productData && modalElement === quickViewModal) {
                    populateQuickViewModal(productData);
                }
                 // TODO: Populate other modals (cart, checkout) with actual data

                modalElement.classList.add('visible');
                modalElement.setAttribute('aria-hidden', 'false');
                document.body.style.overflow = 'hidden'; // Prevent scrolling background
                currentModal = modalElement;

                // Find first focusable element and focus it (e.g., close button)
                const focusableElements = modalElement.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                const firstFocusableElement = focusableElements[0];
                if (firstFocusableElement) {
                    firstFocusableElement.focus();
                }

                 // Add event listener for focus trapping
                 document.addEventListener('keydown', trapFocus);
            };

            const closeModal = (modalElement) => {
                modalElement.classList.remove('visible');
                modalElement.setAttribute('aria-hidden', 'true');
                document.body.style.overflow = ''; // Restore scrolling
                currentModal = null;

                 // Remove event listener for focus trapping
                 document.removeEventListener('keydown', trapFocus);

                 // Return focus to the element that opened the modal (requires storing reference)
                 // For simplicity, we won't implement complex focus restoration here,
                 // but in a real app, you'd store event.target from the openModal call.
            };

             const populateQuickViewModal = (product) => {
                 modalProductName.textContent = product.title || 'Product Name';
                 modalProductPrice.textContent = product.price || '$0.00';
                 modalProductDescription.textContent = product.description || 'Detailed description coming soon.'; // Placeholder description
                 modalProductImage.src = product.imageUrl || 'https://placehold.co/400x350?text=Product+Image'; // Placeholder image
                 modalProductImage.alt = product.imageAlt || 'Product Image';
                 // Store product ID on modal button for Add to Cart action
                 modalAddToCartButton.dataset.productId = product.id;
             };


            quickViewButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    event.stopPropagation(); // Prevent click from propagating to card
                    const productCard = event.target.closest('.product-card');
                    const product = {
                        id: productCard.dataset.productId,
                        title: productCard.querySelector('.product-card-title').textContent,
                        price: productCard.querySelector('.product-card-price').textContent,
                        imageUrl: productCard.querySelector('.product-card-image img').src,
                        imageAlt: productCard.querySelector('.product-card-image img').alt,
                        description: 'This is a beautiful handcrafted piece made with care, featuring high-quality materials and unique design. Perfect for any occasion.' // More detailed placeholder
                        // Add more product data here like options
                    };
                    console.log('Quick View clicked for:', product.title);
                    openModal(quickViewModal, product);
                });
            });

            modalCloseButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const modalToClose = event.target.closest('.modal-overlay');
                    if (modalToClose) {
                        closeModal(modalToClose);
                    }
                });
            });


            // Close modal when clicking outside content
            [quickViewModal, cartModal, checkoutModal].forEach(modal => {
                 modal.addEventListener('click', (event) => {
                    // Check if the click target is the modal overlay itself, not its content
                    if (event.target === modal) {
                        closeModal(modal);
                    }
                });
            });


            // Close modal with Escape key
            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape' && currentModal) {
                    closeModal(currentModal);
                }
            });

            // --- Focus Trapping for Modals ---
            const trapFocus = (event) => {
                if (event.key !== 'Tab' || !currentModal) {
                    return;
                }

                const focusableElements = currentModal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                const firstFocusableElement = focusableElements[0];
                const lastFocusableElement = focusableElements[focusableElements.length - 1];

                if (event.shiftKey) { // Shift + Tab
                    if (document.activeElement === firstFocusableElement) {
                        lastFocusableElement.focus();
                        event.preventDefault();
                    }
                } else { // Tab
                    if (document.activeElement === lastFocusableElement) {
                        firstFocusableElement.focus();
                        event.preventDefault();
                    }
                }
            };


            // --- Add to Cart Functionality ---
            const handleAddToCart = (event) => {
                 event.stopPropagation(); // Prevent click from propagating to card
                 const button = event.target;
                 const productCardOrModal = button.closest('.product-card') || button.closest('.modal-content');
                 const productTitle = productCardOrModal.querySelector('.product-card-title, h2').textContent; // Get title from card or modal h2
                 const productId = productCardOrModal.dataset.productId || button.dataset.productId; // Get ID from card or modal button

                 console.log('Add to Cart clicked for:', productTitle, '(ID:', productId, ')');

                 // Implement add to cart logic here
                 // e.g., send data to backend, update local state (simulated)

                 // Simple cart badge update simulation
                 let currentCount = parseInt(cartBadge.textContent);
                 cartBadge.textContent = currentCount + 1;

                 // Add animation class briefly
                 cartBadge.classList.add('updated');
                 // The animation is CSS-based now, no need for timeout to remove class
                 // setTimeout(() => {
                 //      cartBadge.classList.remove('updated');
                 // }, 300); // Match animation duration

                 // Announce update for screen readers
                 cartBadge.setAttribute('aria-label', `Shopping cart has ${cartBadge.textContent} items`);

                 // Optional: Add a temporary visual feedback on the button/card
                 button.textContent = 'Adding...';
                 button.disabled = true;
                 setTimeout(() => {
                     button.textContent = 'Add to Cart';
                     button.disabled = false;
                     // Could also add a temporary "Added!" message or animation
                 }, 1000); // Simulate delay

                 // If clicked from Quick View modal, close it (optional UX)
                 if (button.closest('.modal-overlay')) {
                     closeModal(button.closest('.modal-overlay'));
                 }
            };

            addToCartButtons.forEach(button => {
                button.addEventListener('click', handleAddToCart);
            });

             // Add event listener for the Add to Cart button inside the Quick View modal
             modalAddToCartButton.addEventListener('click', handleAddToCart);


             // --- Mobile Menu Toggle ---
             menuToggle.addEventListener('click', () => {
                 const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true';
                 menuToggle.setAttribute('aria-expanded', !isExpanded);
                 mainNav.classList.toggle('active');

                 if (mainNav.classList.contains('active')) {
                     menuIconOpen.style.display = 'none';
                     menuIconClose.style.display = 'block';
                 } else {
                     menuIconOpen.style.display = 'block';
                     menuIconClose.style.display = 'none';
                 }
             });

             // Close mobile menu when a link is clicked (optional, depends on UX)
             mainNav.querySelectorAll('a').forEach(link => {
                 link.addEventListener('click', () => {
                     if (mainNav.classList.contains('active') && window.innerWidth <= 768) { // Only close on mobile
                         menuToggle.click(); // Simulate click to close menu
                     }
                 });
             });


             // --- Placeholder for other icon buttons & Modal Openers ---
             document.querySelector('.nav-icons .icon-button[aria-label="Search"]').addEventListener('click', () => {
                 alert('Search functionality coming soon!');
             });
              document.querySelector('.nav-icons .icon-button[aria-label="Account"]').addEventListener('click', () => {
                 alert('Account functionality coming soon!');
             });

              openCartModalButton.addEventListener('click', () => {
                  console.log('Opening Cart Modal');
                  // TODO: Populate cart modal with actual items
                  openModal(cartModal);
              });

              openCheckoutModalButton.addEventListener('click', () => {
                  console.log('Opening Checkout Modal');
                  // TODO: Populate checkout modal with cart items and user info
                  closeModal(cartModal); // Close cart modal before opening checkout
                  openModal(checkoutModal);
              });

              continueShoppingButton.addEventListener('click', () => {
                  console.log('Continuing Shopping');
                  closeModal(cartModal);
                  // Optionally scroll back to products or navigate
                  window.location.hash = '#products';
              });


            // --- Form Validation Placeholder (Basic Example) ---
            const checkoutForm = checkoutModal.querySelector('.checkout-form-section');
            if (checkoutForm) {
                const checkoutButton = checkoutModal.querySelector('.checkout-actions .button-primary');
                checkoutButton.addEventListener('click', (event) => {
                    event.preventDefault(); // Prevent default form submission

                    let isValid = true;
                    checkoutForm.querySelectorAll('input[required], select[required], textarea[required]').forEach(input => {
                        const errorMessage = input.nextElementSibling; // Assuming error message is the next sibling p tag
                        if (!input.value.trim()) {
                            input.classList.add('error');
                            if (errorMessage && errorMessage.classList.contains('error-message')) {
                                errorMessage.classList.remove('hidden');
                            }
                            isValid = false;
                        } else {
                            input.classList.remove('error');
                             if (errorMessage && errorMessage.classList.contains('error-message')) {
                                errorMessage.classList.add('hidden');
                            }
                        }
                    });

                    if (isValid) {
                        console.log('Checkout form is valid. Proceeding...');
                        alert('Checkout form is valid! (Simulated)');
                        // TODO: Implement next step in checkout process or submit form
                    } else {
                        console.log('Checkout form has errors.');
                         // Find the first invalid input and focus it
                         const firstInvalid = checkoutForm.querySelector('input.error, select.error, textarea.error');
                         if (firstInvalid) {
                             firstInvalid.focus();
                         }
                    }
                });

                 // Add input event listeners to clear errors on type
                 checkoutForm.querySelectorAll('input, select, textarea').forEach(input => {
                     input.addEventListener('input', () => {
                         if (input.value.trim()) {
                             input.classList.remove('error');
                             const errorMessage = input.nextElementSibling;
                             if (errorMessage && errorMessage.classList.contains('error-message')) {
                                 errorMessage.classList.add('hidden');
                             }
                         }
                     });
                 });
            }


            // --- Analytics Chart Placeholder ---
            const salesChartCanvas = document.getElementById('salesChart');
            const salesChartControls = document.getElementById('salesChartControls');
            const salesChartContainer = document.getElementById('salesChartContainer');
            let salesChart = null;

            // Sample data
            const salesData = {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                datasets: [{
                    label: 'Monthly Sales ($)',
                    data: [1200, 1500, 1800, 1400, 2000, 2300, 2100],
                    backgroundColor: "var('--primary-color')", // Use CSS variable via JS
                    borderColor: "var('--primary-color')",
                    borderWidth: 2,
                    tension: 0.3, // Add some curve to line chart
                    fill: false // Don't fill area under line
                }]
            };

            const salesChartConfig = {
                type: 'line', // Default type
                data: salesData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    onClick: (e) => toggleControls(salesChartControls), // Toggle controls on chart click
                    plugins: {
                        legend: {
                            display: true,
                            labels: {
                                color: "var('--text-color')",
                                font: {
                                    family: 'Inter, sans-serif'
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(context.parsed.y);
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: "var('--text-color')",
                                font: {
                                    family: 'Inter, sans-serif'
                                },
                                callback: function(value, index, ticks) {
                                     return '$' + value.toLocaleString(); // Format as currency
                                }
                            },
                            grid: {
                                color: "var('--border-color')"
                            }
                        },
                        x: {
                            ticks: {
                                color: "var('--text-color')",
                                font: {
                                    family: 'Inter, sans-serif'
                                }
                            },
                            grid: {
                                color: "var('--border-color')"
                            }
                        }
                    }
                }
            };

            if (salesChartCanvas) {
                 salesChart = new Chart(salesChartCanvas, salesChartConfig);

                 // Toggle controls function
                 const toggleControls = (controlsElement) => {
                     controlsElement.classList.toggle('active');
                 };

                 // Close controls when clicking outside
                 document.addEventListener('click', (e) => {
                     // Check if the click is outside the chart container AND outside the controls
                     if (!e.target.closest('#salesChartContainer') && !e.target.closest('#salesChartControls')) {
                         salesChartControls.classList.remove('active');
                     }
                 });

                 // Dynamic chart updates from controls
                 const salesChartTypeSelect = document.getElementById('salesChartType');
                 const salesBgColorInput = document.getElementById('salesBgColor');
                 const salesBorderColorInput = document.getElementById('salesBorderColor');

                 const updateSalesChart = () => {
                     const newChartType = salesChartTypeSelect.value;
                     const newBgColor = salesBgColorInput.value;
                     const newBorderColor = salesBorderColorInput.value;

                     salesChart.config.type = newChartType;
                     salesChart.config.data.datasets[0].backgroundColor = newBgColor;
                     salesChart.config.data.datasets[0].borderColor = newBorderColor;

                     // Update fill based on chart type
                     salesChart.config.data.datasets[0].fill = (newChartType === 'line'); // Fill area for line chart

                     salesChart.update();
                 };

                 salesChartTypeSelect.addEventListener('change', updateSalesChart);
                 salesBgColorInput.addEventListener('input', updateSalesChart); // Use input for real-time color change
                 salesBorderColorInput.addEventListener('input', updateSalesChart);
            }

             // --- Show Analytics Section (Example) ---
             // You would typically navigate to this section, but for a single file demo,
             // let's add a button or link somewhere to show it.
             // For now, it's just a hidden section structure.
             // Example: Add a link in the footer or header for "Analytics" and add JS to show #analyticsSection
             // document.getElementById('showAnalyticsLink').addEventListener('click', (event) => {
             //     event.preventDefault();
             //     document.getElementById('analyticsSection').classList.remove('hidden');
             //     // Hide other sections if necessary
             //     window.scrollTo({ top: document.getElementById('analyticsSection').offsetTop, behavior: 'smooth' });
             // });


        });
    </script>

</body>
</html>
