<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sustainable Channel Guide</title>
    <!-- Google Fonts: Roboto (sans-serif) -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <style>
        :root {
            --color-primary: #4CAF50; /* Green - Nature/Sustainability */
            --color-secondary: #2196F3; /* Blue - Sky/Water/Clean */
            --color-accent: #FF9800; /* Orange - Energy/Warmth */
            --color-text-dark: #333333;
            --color-text-light: #FFFFFF;
            --color-background-light: #FFFFFF; /* Pure white */
            --color-background-dark: #f4f4f4; /* Light grey */
            --color-border: #dddddd;
            --color-success: #4CAF50;
            --color-error: #f44336;
            --spacing-unit: 8px; /* Base spacing unit */
            --spacing-small: calc(var(--spacing-unit) * 1); /* 8px */
            --spacing-medium: calc(var(--spacing-unit) * 2); /* 16px */
            --spacing-large: calc(var(--spacing-unit) * 3); /* 24px */
            --border-radius: var(--spacing-small); /* 8px */
            --box-shadow-flat: 0 2px 4px rgba(0, 0, 0, 0.05);
            --box-shadow-hover: 0 4px 8px rgba(0, 0, 0, 0.1);
            --transition-duration: 0.3s;
        }

        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--color-background-dark);
            color: var(--color-text-dark);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-y: auto; /* Allow body scroll if content overflows */
        }

        .container {
            display: grid;
            grid-template-columns: 250px 1fr; /* Sidebar and main content */
            flex-grow: 1;
            width: 100%; /* Ensure container takes full width */
            max-width: 1400px; /* Max width for content */
            margin: 0 auto; /* Center container */
        }

        /* Sidebar Navigation */
        .sidebar {
            background-color: var(--color-background-light);
            padding: var(--spacing-large) var(--spacing-medium);
            box-shadow: var(--box-shadow-flat);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-small);
             position: sticky; /* Keep sidebar visible */
             top: 0;
             height: 100vh; /* Full height */
             overflow-y: auto; /* Allow sidebar scrolling if many links */
             z-index: 100; /* Ensure it's above content */
        }

        .sidebar h2 {
            margin-top: 0;
            margin-bottom: var(--spacing-large);
            color: var(--color-primary);
            text-align: center;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: var(--spacing-medium);
            text-decoration: none;
            color: var(--color-text-dark);
            border-radius: var(--border-radius);
            transition: background-color var(--transition-duration), color var(--transition-duration);
            cursor: pointer;
            outline-offset: 4px; /* For focus indicator */
        }

        .nav-link:hover {
            background-color: rgba(76, 175, 80, 0.1); /* Using RGBA for hover */
            color: var(--color-primary);
        }

        .nav-link:focus {
             outline: 2px solid var(--color-secondary);
        }

        .nav-link.active {
            background-color: var(--color-primary);
            color: var(--color-text-light);
        }

        .nav-link.active .material-icons-round {
             color: var(--color-text-light);
        }

        .nav-link .material-icons-round {
            margin-right: var(--spacing-small);
            color: var(--color-text-dark);
            transition: color var(--transition-duration);
        }

        /* Main Content Area */
        .main-content {
            padding: var(--spacing-large);
            overflow-y: auto; /* Enable scrolling for content */
        }

        .page {
            display: none; /* Hide pages by default */
            animation: fadeIn var(--transition-duration) ease-in-out; /* Add fade-in animation */
        }

        .page.active {
            display: block; /* Show active page */
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }


        /* Page Titles */
        .page h1 {
            color: var(--color-text-dark);
            margin-top: 0;
            margin-bottom: var(--spacing-large);
        }

        /* Card Component */
        .card {
            background-color: var(--color-background-light);
            padding: var(--spacing-large);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-flat);
            margin-bottom: var(--spacing-large);
            transition: transform var(--transition-duration), box-shadow var(--transition-duration);
        }

        .card:hover {
             /* Subtle lift effect only on interactive cards */
             /* transform: translateY(-2px); */
             /* box-shadow: var(--box-shadow-hover); */
        }

         .card h2 {
             margin-top: 0;
             color: var(--color-secondary);
             margin-bottom: var(--spacing-medium);
         }


        /* Dashboard Specific Styles */
        .dashboard-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-large);
            margin-bottom: var(--spacing-large);
        }

        .overview-item {
            padding: var(--spacing-large);
            border-radius: var(--border-radius);
            background-color: var(--color-background-light);
            box-shadow: var(--box-shadow-flat);
            text-align: center;
        }

        .overview-item h3 {
            margin-top: 0;
            color: var(--color-secondary);
        }

        .overview-item p {
            font-size: 2em;
            margin: var(--spacing-small) 0;
            color: var(--color-primary);
            font-weight: bold;
        }

        .dashboard-projects h2 {
            margin-top: 0;
            margin-bottom: var(--spacing-large);
            color: var(--color-text-dark);
        }

        .project-list {
            display: grid;
            gap: var(--spacing-medium);
            margin-top: var(--spacing-medium);
        }

        .project-card {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-medium) var(--spacing-large);
            background-color: var(--color-background-light);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-flat);
            cursor: pointer;
            transition: background-color var(--transition-duration), transform var(--transition-duration);
             outline-offset: 4px; /* For focus indicator */
        }

        .project-card:hover {
            background-color: var(--color-background-dark);
            transform: translateY(-2px);
             box-shadow: var(--box-shadow-hover);
        }

        .project-card:focus {
             outline: 2px solid var(--color-primary);
        }

        .project-info h3 {
            margin: 0 0 var(--spacing-small) 0;
            color: var(--color-text-dark);
        }

        .project-info p {
            margin: 0;
            font-size: 0.9em;
            color: #666;
        }

        .progress-bar-container {
            width: 150px;
            height: var(--spacing-small);
            background-color: #e0e0e0;
            border-radius: var(--spacing-small);
            overflow: hidden;
            position: relative; /* Needed for ARIA value text positioning */
        }

         /* Optional: Add text overlay for progress bar for accessibility/clarity */
         .progress-bar-container::after {
             content: attr(aria-valuenow) '%';
             position: absolute;
             right: var(--spacing-small);
             top: 50%;
             transform: translateY(-50%);
             font-size: 0.8em;
             color: var(--color-text-dark);
             mix-blend-mode: difference; /* Ensure visibility against bar */
             display: none; /* Hide by default, can show on hover/focus or always */
         }
         .project-card:hover .progress-bar-container::after,
         .project-card:focus .progress-bar-container::after {
             display: block;
         }


        .progress-bar {
            height: 100%;
            background-color: var(--color-primary);
            width: 0%; /* Controlled by JS */
            transition: width var(--transition-duration) ease-in-out;
        }

        /* Forms */
        .form-group {
            margin-bottom: var(--spacing-medium);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--spacing-small);
            font-weight: bold;
            color: var(--color-text-dark);
        }

        .form-group input[type="text"],
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: var(--spacing-small);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            font-family: 'Roboto', sans-serif;
            font-size: 1em;
            box-sizing: border-box; /* Include padding and border in element's total width and height */
             outline-offset: 2px; /* For focus indicator */
             transition: border-color var(--transition-duration);
        }

         .form-group input[type="text"]:focus,
         .form-group textarea:focus,
         .form-group select:focus {
             outline: 2px solid var(--color-secondary);
             border-color: var(--color-secondary);
         }

         .form-group input[type="text"].invalid,
         .form-group textarea.invalid,
         .form-group select.invalid {
             border-color: var(--color-error);
         }


        .form-group input[type="color"] {
             padding: 0;
             border: none;
             height: 40px; /* Match line height of other inputs */
             width: 40px;
             cursor: pointer;
             vertical-align: middle; /* Align with label */
             outline-offset: 2px; /* For focus indicator */
             background: none; /* Remove default color input background */
        }

         .form-group input[type="color"]::-webkit-color-swatch-wrapper {
             padding: 0;
         }

         .form-group input[type="color"]::-webkit-color-swatch {
             border: 1px solid var(--color-border);
             border-radius: var(--border-radius);
         }

         .form-group input[type="color"]::-moz-color-swatch-wrapper {
             padding: 0;
         }

         .form-group input[type="color"]::-moz-color-swatch {
             border: 1px solid var(--color-border);
             border-radius: var(--border-radius);
         }


         .form-group input[type="color"]:focus {
             outline: 2px solid var(--color-secondary);
         }


        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-actions {
            margin-top: var(--spacing-large);
            text-align: right;
            display: flex;
            gap: var(--spacing-medium);
            justify-content: flex-end;
        }

        /* Buttons */
        .btn {
            padding: var(--spacing-medium) var(--spacing-large);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background-color var(--transition-duration), opacity var(--transition-duration);
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-small);
            outline-offset: 4px; /* For focus indicator */
             text-decoration: none; /* Ensure button-like links don't have underline */
        }

        .btn:focus {
             outline: 2px solid var(--color-secondary);
        }

        .btn-primary {
            background-color: var(--color-primary);
            color: var(--color-text-light);
        }

        .btn-primary:hover {
            background-color: rgba(76, 175, 80, 0.9); /* Darken primary */
        }

         .btn-secondary {
            background-color: var(--color-secondary);
            color: var(--color-text-light);
        }

        .btn-secondary:hover {
            background-color: rgba(33, 150, 243, 0.9); /* Darken secondary */
        }

        .btn-outline {
             background-color: transparent;
             color: var(--color-primary);
             border: 2px solid var(--color-primary);
        }

         .btn-outline:hover {
             background-color: rgba(76, 175, 80, 0.1);
         }


        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Checklists */
        .checklist {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            background-color: var(--color-background-light);
            padding: var(--spacing-medium);
            border-radius: var(--border-radius);
            margin-bottom: var(--spacing-small);
            box-shadow: var(--box-shadow-flat);
             transition: background-color var(--transition-duration);
        }

         .checklist-item:hover {
             background-color: var(--color-background-dark);
         }


        .checklist-item input[type="checkbox"] {
            margin-right: var(--spacing-medium);
            width: 20px;
            height: 20px;
            cursor: pointer;
             accent-color: var(--color-primary); /* Style checkbox */
             outline-offset: 2px; /* For focus indicator */
        }

         .checklist-item input[type="checkbox"]:focus {
             outline: 2px solid var(--color-secondary);
         }


        .checklist-item label {
            flex-grow: 1;
            cursor: pointer;
            font-size: 1em;
        }

        .checklist-item.completed label {
            text-decoration: line-through;
            color: #666;
        }

        /* Guidance Panels */
        .guidance-panel {
            background-color: #e8f5e9; /* Light green background */
            border-left: 4px solid var(--color-primary);
            padding: var(--spacing-medium);
            border-radius: var(--border-radius);
            margin-top: var(--spacing-medium);
            color: var(--color-text-dark);
        }

        .guidance-panel summary {
            font-weight: bold;
            cursor: pointer;
            outline: none; /* Remove default outline */
            padding: var(--spacing-small) 0; /* Add some padding */
             transition: color var(--transition-duration);
        }

         .guidance-panel summary:hover {
             color: var(--color-primary);
         }

         .guidance-panel summary:focus {
             box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.5); /* Focus using RGBA primary */
             border-radius: 4px;
         }

        .guidance-panel p {
            margin-top: var(--spacing-small);
            margin-bottom: 0;
            font-size: 0.9em;
        }

        /* Resource List */
        .resource-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .resource-item {
            background-color: var(--color-background-light);
            padding: var(--spacing-medium);
            border-radius: var(--border-radius);
            margin-bottom: var(--spacing-small);
            box-shadow: var(--box-shadow-flat);
            display: flex;
            align-items: center;
            transition: transform var(--transition-duration), box-shadow var(--transition-duration), background-color var(--transition-duration);
        }

         .resource-item:hover {
             transform: translateY(-2px);
             box-shadow: var(--box-shadow-hover);
             background-color: var(--color-background-dark);
         }


        .resource-item .material-icons-round {
            margin-right: var(--spacing-medium);
            color: var(--color-secondary);
             flex-shrink: 0; /* Prevent icon from shrinking */
        }

        .resource-info {
            flex-grow: 1;
        }

        .resource-info h4 {
            margin: 0 0 var(--spacing-small) 0;
            color: var(--color-text-dark);
        }

        .resource-info p {
            margin: 0 0 var(--spacing-small) 0;
            font-size: 0.9em;
            color: #666;
        }

        .resource-info a {
            color: var(--color-primary);
            text-decoration: none;
            font-weight: bold;
             outline-offset: 2px; /* For focus indicator */
             transition: text-decoration var(--transition-duration);
        }

        .resource-info a:hover {
            text-decoration: underline;
        }

         .resource-info a:focus {
             outline: 2px solid var(--color-secondary);
             border-radius: 2px;
         }

        /* Modal */
        .modal-overlay {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6); /* Darker overlay */
            justify-content: center;
            align-items: center;
            z-index: 1000;
             opacity: 0;
             transition: opacity var(--transition-duration) ease-in-out;
             pointer-events: none; /* Prevent interaction when hidden */
        }

        .modal-overlay.visible {
             display: flex;
             opacity: 1;
             pointer-events: all; /* Allow interaction when visible */
        }

        .modal-content {
            background-color: var(--color-background-light);
            padding: var(--spacing-large);
            border-radius: var(--border-radius);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3); /* More pronounced shadow */
            max-width: 600px;
            width: 90%;
            position: relative;
            transform: translateY(-20px);
            transition: transform var(--transition-duration) ease-in-out;
        }

         .modal-overlay.visible .modal-content {
             transform: translateY(0);
         }

        .modal-close {
            position: absolute;
            top: var(--spacing-medium);
            right: var(--spacing-medium);
            font-size: 1.5em;
            cursor: pointer;
            color: #aaa;
            transition: color var(--transition-duration);
             outline-offset: 4px; /* For focus indicator */
        }

         .modal-close:hover {
             color: var(--color-text-dark);
         }

         .modal-close:focus {
             outline: 2px solid var(--color-secondary);
             border-radius: 4px;
         }

        /* Visual Style Editor */
        .style-preview {
            margin-top: var(--spacing-large);
            padding: var(--spacing-large);
            border: 1px dashed var(--color-border);
            border-radius: var(--border-radius);
            background-color: var(--color-background-dark);
        }

        .style-preview h3 {
            margin-top: 0;
        }

        .style-preview-colors div {
            width: 50px;
            height: 50px;
            display: inline-block;
            margin-right: var(--spacing-small);
            border: 1px solid var(--color-border);
            border-radius: var(--spacing-small);
        }

        .style-preview-text {
            margin-top: var(--spacing-medium);
            font-size: 1.2em;
        }

        /* Progress Page */
        .progress-summary {
             display: grid;
             grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
             gap: var(--spacing-large);
             margin-bottom: var(--spacing-large);
        }

        .progress-item {
            padding: var(--spacing-large);
            border-radius: var(--border-radius);
            background-color: var(--color-background-light);
            box-shadow: var(--box-shadow-flat);
            text-align: center;
        }

        .progress-item h3 {
            margin-top: 0;
            color: var(--color-secondary);
        }

        .progress-item p {
            font-size: 2em;
            margin: var(--spacing-small) 0;
            color: var(--color-primary);
            font-weight: bold;
        }

        .progress-item .progress-bar-container {
            width: 100%;
            margin-top: var(--spacing-medium);
        }

        /* Responsive adjustments */
        @media (max-width: 1024px) {
             .container {
                 grid-template-columns: 200px 1fr; /* Slightly smaller sidebar on medium screens */
             }
        }


        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr; /* Stack sidebar and content */
            }

            .sidebar {
                padding: var(--spacing-medium);
                flex-direction: row; /* Horizontal nav on mobile */
                overflow-x: auto; /* Allow horizontal scrolling if needed */
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Shadow at the bottom */
                margin-bottom: var(--spacing-medium);
                position: sticky; /* Keep nav visible */
                top: 0;
                z-index: 100; /* Ensure it's above content */
                height: auto; /* Auto height for horizontal layout */
            }

             .sidebar h2 {
                 display: none; /* Hide title on mobile */
             }

            .nav-link {
                padding: var(--spacing-small) var(--spacing-medium);
                justify-content: center; /* Center icons/text */
                flex-direction: column;
                font-size: 0.8em;
                flex-shrink: 0; /* Prevent shrinking in flex row */
            }

            .nav-link .material-icons-round {
                margin-right: 0;
                margin-bottom: var(--spacing-small);
            }

            .main-content {
                padding: var(--spacing-medium);
            }

            .dashboard-overview {
                grid-template-columns: 1fr; /* Stack overview items */
            }

            .project-card {
                 flex-direction: column;
                 align-items: flex-start;
                 gap: var(--spacing-small);
            }

            .progress-bar-container {
                 width: 100%; /* Full width on mobile */
            }

             .progress-summary {
                 grid-template-columns: 1fr; /* Stack progress items */
             }

             .modal-content {
                 width: 95%; /* Slightly wider modal on small screens */
             }
        }
    </style>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <h2>Channel Guide</h2>
            <a href="#dashboard" class="nav-link active" data-page="dashboard" role="button" aria-label="Go to Dashboard">
                <span class="material-icons-round" aria-hidden="true">dashboard</span>
                Dashboard
            </a>
            <a href="#planning" class="nav-link" data-page="planning" role="button" aria-label="Go to Planning">
                <span class="material-icons-round" aria-hidden="true">edit_note</span>
                Planning
            </a>
            <a href="#style" class="nav-link" data-page="style" role="button" aria-label="Go to Visual Style">
                <span class="material-icons-round" aria-hidden="true">palette</span>
                Visual Style
            </a>
            <a href="#production" class="nav-link" data-page="production" role="button" aria-label="Go to Production">
                <span class="material-icons-round" aria-hidden="true">videocam</span>
                Production
            </a>
            <a href="#community" class="nav-link" data-page="community" role="button" aria-label="Go to Community">
                <span class="material-icons-round" aria-hidden="true">people</span>
                Community
            </a>
            <a href="#resources" class="nav-link" data-page="resources" role="button" aria-label="Go to Resources">
                <span class="material-icons-round" aria-hidden="true">library_books</span>
                Resources
            </a>
            <a href="#progress" class="nav-link" data-page="progress" role="button" aria-label="Go to Progress">
                <span class="material-icons-round" aria-hidden="true">trending_up</span>
                Progress
            </a>
        </aside>

        <main class="main-content">
            <!-- Dashboard Page -->
            <section id="dashboard-page" class="page active" aria-labelledby="dashboard-heading">
                <h1 id="dashboard-heading">Dashboard</h1>
                <div class="dashboard-overview">
                    <div class="overview-item">
                        <h3>Total Projects</h3>
                        <p id="total-projects" aria-live="polite">0</p>
                    </div>
                     <div class="overview-item">
                        <h3>Projects In Progress</h3>
                        <p id="projects-in-progress" aria-live="polite">0</p>
                    </div>
                    <div class="overview-item">
                        <h3>Projects Completed</h3>
                        <p id="projects-completed" aria-live="polite">0</p>
                    </div>
                </div>

                <div class="card dashboard-projects">
                    <h2>Your Video Projects</h2>
                     <button class="btn btn-primary" id="add-project-btn" aria-label="Add New Project">
                         <span class="material-icons-round" aria-hidden="true">add</span> Add New Project
                     </button>
                    <div class="project-list" id="project-list" role="region" aria-live="polite" aria-label="Video Projects List">
                        <!-- Project cards will be injected here -->
                         <p>No projects added yet. Click "Add New Project" to get started!</p>
                    </div>
                </div>
            </section>

            <!-- Planning Page -->
            <section id="planning-page" class="page" aria-labelledby="planning-heading">
                <h1 id="planning-heading">Video Planning</h1>
                <div class="card">
                    <h2>Plan Your Next Video</h2>
                     <p>Use the "Add New Project" button on the Dashboard to create a plan for a specific video. Each project allows you to define your topic, outline, and key details.</p>
                     <p>Effective planning is crucial for creating focused and engaging content, especially when space and resources are limited. Think about your core message and how to convey it visually.</p>
                </div>
                 <div class="card">
                     <h2>Planning Guidance</h2>
                      <details class="guidance-panel">
                          <summary>Choosing Topics for Urban Sustainability</summary>
                          <p>Focus on practical, actionable tips for apartment living: small-space gardening, composting in limited areas, DIY energy savers, minimalist living, walking/biking tips.</p>
                      </details>
                      <details class="guidance-panel">
                          <summary>Structuring Your Video</summary>
                          <p>Start with a hook (problem/question), introduce the topic, provide clear steps/demonstrations, summarize key takeaways, and end with a call to action (subscribe, comment, try it yourself).</p>
                      </details>
                      <details class="guidance-panel">
                          <summary>Writing a Simple Script/Outline</summary>
                          <p>Even a basic outline helps! List main points, key visuals needed, and important things to say. This saves time during filming and editing.</p>
                      </details>
                 </div>
            </section>

             <!-- Style Page -->
            <section id="style-page" class="page" aria-labelledby="style-heading">
                <h1 id="style-heading">Visual Style & Branding</h1>
                <div class="card">
                    <h2>Define Your Channel's Look and Feel</h2>
                    <p>A consistent visual style helps viewers recognize your channel and builds trust. Choose colors and fonts that reflect your sustainable theme.</p>
                    <div class="form-group">
                        <label for="channel-name">Channel Name</label>
                        <input type="text" id="channel-name" value="Sustainable Urban Living" aria-label="Channel Name">
                    </div>
                    <div class="form-group">
                        <label for="primary-color">Primary Color</label>
                        <input type="color" id="primary-color" value="#4CAF50" aria-label="Select primary color">
                    </div>
                     <div class="form-group">
                        <label for="secondary-color">Secondary Color</label>
                        <input type="color" id="secondary-color" value="#2196F3" aria-label="Select secondary color">
                    </div>
                     <div class="form-group">
                        <label for="accent-color">Accent Color</label>
                        <input type="color" id="accent-color" value="#FF9800" aria-label="Select accent color">
                    </div>
                     <div class="form-group">
                         <label for="font-select">Typography (Body Text)</label>
                         <select id="font-select" aria-label="Select body text font family">
                             <option value="'Roboto', sans-serif">Roboto</option>
                             <option value="'Arial', sans-serif">Arial</option>
                             <option value="'Lato', sans-serif">Lato</option>
                             <option value="'Open Sans', sans-serif">Open Sans</option>
                             <option value="'Montserrat', sans-serif">Montserrat</option>
                         </select>
                     </div>
                     <div class="form-group">
                         <label for="logo-upload">Channel Logo (Upload - Simulated)</label>
                         <input type="file" id="logo-upload" accept="image/*" aria-label="Upload channel logo">
                         <p><small>Note: File upload is simulated in this demo.</small></p>
                     </div>

                    <div class="style-preview" aria-label="Visual style preview">
                        <h3>Preview</h3>
                        <p>See how your chosen colors and font look together:</p>
                        <div class="style-preview-colors">
                            <div id="preview-primary-color" style="background-color: var(--color-primary);" aria-label="Primary color preview"></div>
                            <div id="preview-secondary-color" style="background-color: var(--color-secondary);" aria-label="Secondary color preview"></div>
                            <div id="preview-accent-color" style="background-color: var(--color-accent);" aria-label="Accent color preview"></div>
                        </div>
                        <div class="style-preview-text" id="preview-text">
                            This is a preview of your channel's text style. Clear, readable text is important for tutorials.
                        </div>
                    </div>

                    <div class="form-actions">
                        <button class="btn btn-primary" id="save-style-btn">Save Style</button>
                    </div>
                </div>
            </section>

             <!-- Production Page -->
            <section id="production-page" class="page" aria-labelledby="production-heading">
                <h1 id="production-heading">Video Production Guide</h1>
                <div class="card">
                    <h2>Filming Checklist</h2>
                    <p>Use this checklist to ensure you capture everything needed during filming.</p>
                    <ul class="checklist" id="filming-checklist" role="list" aria-label="Filming Checklist">
                        <!-- Checklist items injected here -->
                    </ul>
                     <details class="guidance-panel">
                         <summary>Tips for Filming in Small Urban Spaces</summary>
                         <p>Use natural light near windows. Keep your background tidy or use a simple backdrop. Position your camera to make the space look bigger if possible. Ensure good audio by minimizing background noise (traffic, neighbors).</p>
                     </details>
                </div>
                 <div class="card">
                    <h2>Editing Checklist</h2>
                    <p>Follow these steps to turn your footage into a polished video.</p>
                    <ul class="checklist" id="editing-checklist" role="list" aria-label="Editing Checklist">
                        <!-- Checklist items injected here -->
                    </ul>
                    <details class="guidance-panel">
                         <summary>Tips for Editing with Free Software</summary>
                         <p>Learn keyboard shortcuts to speed up editing. Use simple cuts and transitions. Add text overlays for key points or instructions. Include background music that fits your channel's mood (check licenses!). Export in 1080p HD or 4K if your camera supports it.</p>
                     </details>
                </div>
            </section>

            <!-- Community Page -->
             <section id="community-page" class="page" aria-labelledby="community-heading">
                <h1 id="community-heading">Community Building & Engagement</h1>
                <div class="card">
                    <h2>Strategies for Growth and Connection</h2>
                    <p>Building a community around sustainable urban living is key. Your viewers share your passion for practical environmentalism. Engage with them directly.</p>
                    <details class="guidance-panel">
                         <summary>Engaging with Comments</summary>
                         <p>Read and respond to as many comments as possible. Answer questions, thank viewers for feedback, and encourage discussion. This shows you value their input.</p>
                     </details>
                     <details class="guidance-panel">
                         <summary>Call to Actions</summary>
                         <p>End your videos by asking viewers to subscribe, like, share, or leave a comment answering a specific question related to the video topic. This prompts interaction.</p>
                     </details>
                </div>
                 <div class="card">
                    <h2>Social Media and Beyond</h2>
                    <p>Promote your videos and connect with your audience on platforms outside of YouTube.</p>
                     <details class="guidance-panel">
                         <summary>Using Other Platforms</summary>
                         <p>Share short clips or behind-the-scenes content on Instagram or TikTok. Post updates and links on Twitter. Create a Facebook group for deeper discussions and sharing tips among community members.</p>
                     </details>
                      <details class="guidance-panel">
                         <summary>Collaborations</summary>
                         <p>Look for other creators in the sustainability or urban living niche for potential collaborations. This can help you reach new audiences.</p>
                     </details>
                </div>
            </section>

            <!-- Resources Page -->
            <section id="resources-page" class="page" aria-labelledby="resources-heading">
                <h1 id="resources-heading">Curated Resources</h1>
                <div class="card">
                    <h2>Helpful Links for Creators</h2>
                    <p>Here are some external resources to help you with production, assets, and learning.</p>
                    <ul class="resource-list" id="resource-list" role="list" aria-label="Curated Resources List">
                        <!-- Resource items injected here -->
                    </ul>
                </div>
            </section>

            <!-- Progress Page -->
            <section id="progress-page" class="page" aria-labelledby="progress-heading">
                <h1 id="progress-heading">Your Progress</h1>
                 <div class="progress-summary">
                     <div class="progress-item">
                         <h3>Overall Channel Launch</h3>
                         <p id="overall-progress-percentage" aria-live="polite">0%</p>
                         <div class="progress-bar-container" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Overall channel launch progress">
                             <div class="progress-bar" id="overall-progress-bar" style="width: 0%;"></div>
                         </div>
                     </div>
                     <div class="progress-item">
                         <h3>Average Project Completion</h3>
                         <p id="avg-project-progress-percentage" aria-live="polite">0%</p>
                         <div class="progress-bar-container" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Average project completion progress">
                             <div class="progress-bar" id="avg-project-progress-bar" style="width: 0%;"></div>
                         </div>
                     </div>
                 </div>

                <div class="card">
                    <h2>Project Progress Details</h2>
                     <div id="project-progress-details" role="region" aria-live="polite" aria-label="Project progress details list">
                         <!-- Project progress list will be injected here -->
                     </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal for Adding/Editing Project -->
    <div class="modal-overlay" id="project-modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="modal-content">
            <span class="material-icons-round modal-close" id="close-project-modal" role="button" aria-label="Close modal" tabindex="0">close</span>
            <h2 id="modal-title">Add New Video Project</h2>
            <div id="project-form">
                <div class="form-group">
                    <label for="project-title">Video Title <span aria-hidden="true">*</span></label>
                    <input type="text" id="project-title" required aria-required="true">
                </div>
                <div class="form-group">
                    <label for="project-topic">Topic/Keywords <span aria-hidden="true">*</span></label>
                    <input type="text" id="project-topic" required aria-required="true">
                </div>
                 <div class="form-group">
                    <label for="project-script">Script Outline / Key Points</label>
                    <textarea id="project-script"></textarea>
                </div>
                <div class="form-actions">
                    <button class="btn btn-outline" id="cancel-project-btn">Cancel</button>
                    <button class="btn btn-primary" id="save-project-btn">Save Project</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State Management (Simple JS Object)
        const state = {
            currentPage: 'dashboard',
            projects: [],
            style: {
                channelName: 'Sustainable Urban Living',
                primaryColor: '#4CAF50',
                secondaryColor: '#2196F3',
                accentColor: '#FF9800',
                fontFamily: "'Roboto', sans-serif",
                logo: null // Placeholder for file data/URL
            },
            checklists: {
                filming: [
                    { id: 'film-setup', text: 'Set up camera, lighting, and audio', completed: false },
                    { id: 'film-record', text: 'Record primary video footage', completed: false },
                    { id: 'film-broll', text: 'Record B-roll and extra shots (demonstrations, close-ups)', completed: false },
                    { id: 'film-audio', text: 'Ensure audio is clear and consistent', completed: false },
                    { id: 'film-backup', text: 'Backup footage to an external drive', completed: false },
                ],
                 editing: [
                    { id: 'edit-import', text: 'Import footage into editing software', completed: false },
                    { id: 'edit-cut', text: 'Cut and arrange main footage (remove mistakes, pauses)', completed: false },
                    { id: 'edit-broll', text: 'Add B-roll, graphics, and text overlays', completed: false },
                    { id: 'edit-audio', text: 'Mix audio (voice, background music, sound effects)', completed: false },
                    { id: 'edit-color', text: 'Color correct/grade footage for consistent look', completed: false },
                    { id: 'edit-export', text: 'Export final video (1080p or 4K) with correct settings', completed: false },
                 ]
            },
            resources: [
                { id: 'res-editing-basics', title: 'Beginner Video Editing Tutorial (General)', description: 'Learn the basic functions of common free editing software.', url: 'https://placehold.co/tutorial-link', type: 'video' }, // Use placehold.co for links
                { id: 'res-lighting', title: 'Simple Lighting Setup for Indoors', description: 'Improve your video quality with basic lighting techniques using household items or affordable lights.', url: 'https://placehold.co/article-link', type: 'article' },
                { id: 'res-audio', title: 'Recording Clear Audio in Urban Environments', description: 'Tips for minimizing background noise and improving voice clarity.', url: 'https://placehold.co/article-link', type: 'article' },
                { id: 'res-music', title: 'Free Background Music Resources', description: 'Find royalty-free music for your videos (check licenses carefully!).', url: 'https://placehold.co/resource-link', type: 'link' },
                { id: 'res-assets', title: 'Free Stock Footage & Graphics Sites', description: 'Find free visual assets to enhance your videos.', url: 'https://placehold.co/resource-link', type: 'link' },
                { id: 'res-seo', title: 'YouTube SEO Basics for Beginners', description: 'Learn how to title, tag, and describe your videos to help people find them.', url: 'https://placehold.co/article-link', type: 'article' },
            ],
            overallMilestones: [ // Simplified overall progress
                { id: 'milestone-planning', text: 'Complete initial channel planning', completed: false },
                { id: 'milestone-style', text: 'Define visual style & branding', completed: false },
                { id: 'milestone-production', text: 'Produce first video', completed: false },
                { id: 'milestone-upload', text: 'Upload and optimize first video', completed: false },
                { id: 'milestone-launch', text: 'Promote channel launch', completed: false },
                // Add more milestones like "Produce 5 videos", "Reach 100 subscribers", etc.
            ]
        };

        // DOM Elements
        const navLinks = document.querySelectorAll('.nav-link');
        const pages = document.querySelectorAll('.page');
        const projectListEl = document.getElementById('project-list');
        const addProjectBtn = document.getElementById('add-project-btn');
        const projectModalOverlay = document.getElementById('project-modal-overlay');
        const closeProjectModalBtn = document.getElementById('close-project-modal');
        const cancelProjectBtn = document.getElementById('cancel-project-btn');
        const saveProjectBtn = document.getElementById('save-project-btn');
        const modalTitleEl = document.getElementById('modal-title');
        const projectTitleInput = document.getElementById('project-title');
        const projectTopicInput = document.getElementById('project-topic');
        const projectScriptTextarea = document.getElementById('project-script');
        const totalProjectsEl = document.getElementById('total-projects');
        const projectsInProgressEl = document.getElementById('projects-in-progress');
        const projectsCompletedEl = document.getElementById('projects-completed');

        const channelNameInput = document.getElementById('channel-name');
        const primaryColorInput = document.getElementById('primary-color');
        const secondaryColorInput = document.getElementById('secondary-color');
        const accentColorInput = document.getElementById('accent-color');
        const fontSelect = document.getElementById('font-select');
        const logoUploadInput = document.getElementById('logo-upload'); // Simulated upload
        const previewPrimaryColorEl = document.getElementById('preview-primary-color');
        const previewSecondaryColorEl = document.getElementById('preview-secondary-color');
        const previewAccentColorEl = document.getElementById('preview-accent-color');
        const previewTextEl = document.getElementById('preview-text');
        const saveStyleBtn = document.getElementById('save-style-btn');

        const filmingChecklistEl = document.getElementById('filming-checklist');
        const editingChecklistEl = document.getElementById('editing-checklist');
        const resourceListEl = document.getElementById('resource-list');

        const overallProgressPercentageEl = document.getElementById('overall-progress-percentage');
        const overallProgressBarContainerEl = document.querySelector('#overall-progress-bar').parentElement; // Get container
        const overallProgressBarEl = document.getElementById('overall-progress-bar');
        const avgProjectProgressPercentageEl = document.getElementById('avg-project-progress-percentage');
         const avgProjectProgressBarContainerEl = document.querySelector('#avg-project-progress-bar').parentElement; // Get container
        const avgProjectProgressBarEl = document.getElementById('avg-project-progress-bar');
        const projectProgressDetailsEl = document.getElementById('project-progress-details');


        // --- Helper Functions ---

        function renderProjects() {
            projectListEl.innerHTML = ''; // Clear current list
            if (state.projects.length === 0) {
                projectListEl.innerHTML = '<p>No projects added yet. Click "Add New Project" to get started!</p>';
                return;
            }
            state.projects.forEach(project => {
                const projectCard = document.createElement('div');
                projectCard.classList.add('project-card');
                projectCard.dataset.projectId = project.id; // Store project ID
                 projectCard.setAttribute('role', 'button');
                 projectCard.setAttribute('tabindex', '0'); // Make div focusable
                 projectCard.setAttribute('aria-label', `Project: ${project.title || 'Untitled Project'}. Topic: ${project.topic || 'No topic specified'}. Progress: ${project.progress} percent.`);

                projectCard.innerHTML = `
                    <div class="project-info">
                        <h3>${project.title || 'Untitled Project'}</h3>
                        <p>${project.topic || 'No topic specified'}</p>
                    </div>
                    <div class="progress-bar-container" role="progressbar" aria-valuenow="${project.progress}" aria-valuemin="0" aria-valuemax="100" aria-label="Project progress">
                        <div class="progress-bar" style="width: ${project.progress}%;"></div>
                    </div>
                `;
                projectListEl.appendChild(projectCard);
            });
        }

        function updateDashboardOverview() {
            totalProjectsEl.textContent = state.projects.length;
            const completed = state.projects.filter(p => p.progress >= 100).length;
            const inProgress = state.projects.length - completed;
            projectsCompletedEl.textContent = completed;
            projectsInProgressEl.textContent = inProgress;
        }

        function renderChecklist(checklistId, element) {
            element.innerHTML = '';
            const checklistData = state.checklists[checklistId];
            if (!checklistData) return;

            checklistData.forEach(item => {
                const listItem = document.createElement('li');
                listItem.classList.add('checklist-item');
                if (item.completed) {
                    listItem.classList.add('completed');
                }
                 listItem.setAttribute('role', 'listitem'); // Explicitly define list item role

                listItem.innerHTML = `
                    <input type="checkbox" id="checklist-${item.id}" ${item.completed ? 'checked' : ''} data-checklist-id="${checklistId}" data-item-id="${item.id}" aria-label="${item.text}">
                    <label for="checklist-${item.id}">${item.text}</label>
                `;
                element.appendChild(listItem);
            });
        }

        function handleChecklistChange(event) {
            const checkbox = event.target;
            if (checkbox.type === 'checkbox') {
                const checklistId = checkbox.dataset.checklistId;
                const itemId = checkbox.dataset.itemId;
                const item = state.checklists[checklistId].find(i => i.id === itemId);
                if (item) {
                    item.completed = checkbox.checked;
                    checkbox.closest('.checklist-item').classList.toggle('completed', checkbox.checked);
                    // In a real app, this would update project-specific progress
                    // For this demo, we'll just trigger overall progress update based on global checklists
                    updateProgress(); // Update overall/avg progress
                     console.log(`Checklist item "${item.text}" in "${checklistId}" marked as ${item.completed ? 'completed' : 'incomplete'}`);
                }
            }
        }

        function renderResources() {
            resourceListEl.innerHTML = '';
            state.resources.forEach(resource => {
                const listItem = document.createElement('li');
                listItem.classList.add('resource-item');
                 listItem.setAttribute('role', 'listitem');

                let icon = 'link'; // Default icon
                if (resource.type === 'video') icon = 'play_circle';
                if (resource.type === 'article') icon = 'article';
                if (resource.type === 'link') icon = 'public'; // More general link icon

                listItem.innerHTML = `
                    <span class="material-icons-round" aria-hidden="true">${icon}</span>
                    <div class="resource-info">
                        <h4>${resource.title}</h4>
                        <p>${resource.description}</p>
                        <a href="${resource.url}" target="_blank" rel="noopener noreferrer" aria-label="View resource: ${resource.title}">View Resource</a>
                    </div>
                `;
                resourceListEl.appendChild(listItem);
            });
        }

        function updateStylePreview() {
            const primary = primaryColorInput.value;
            const secondary = secondaryColorInput.value;
            const accent = accentColorInput.value;
            const font = fontSelect.value;

            previewPrimaryColorEl.style.backgroundColor = primary;
            previewSecondaryColorEl.style.backgroundColor = secondary;
            previewAccentColorEl.style.backgroundColor = accent;
            previewTextEl.style.fontFamily = font;

            // Update CSS variables for immediate site-wide preview
             document.documentElement.style.setProperty('--color-primary', primary);
             document.documentElement.style.setProperty('--color-secondary', secondary);
             document.documentElement.style.setProperty('--color-accent', accent);
             // Note: Font family is harder to apply globally like this without preloading
             // Applying to body might work for preview but affects the whole app
             // document.body.style.fontFamily = font; // This would apply globally
        }

        function loadStyleSettings() {
             channelNameInput.value = state.style.channelName;
             primaryColorInput.value = state.style.primaryColor;
             secondaryColorInput.value = state.style.secondaryColor;
             accentColorInput.value = state.style.accentColor;
             fontSelect.value = state.style.fontFamily;
             updateStylePreview(); // Update preview on load
        }

        function saveStyleSettings() {
             state.style.channelName = channelNameInput.value;
             state.style.primaryColor = primaryColorInput.value;
             state.style.secondaryColor = secondaryColorInput.value;
             state.style.accentColor = accentColorInput.value;
             state.style.fontFamily = fontSelect.value;
             // Handle logo upload (simulated)
             if (logoUploadInput.files && logoUploadInput.files[0]) {
                 // In a real app, you'd process/upload the file
                 // For this demo, just store a placeholder or data URL if needed
                 console.log("Logo file selected:", logoUploadInput.files[0].name);
                 // state.style.logo = ...
             }

             updateStylePreview(); // Update preview after saving
             console.log("Style settings saved:", state.style);

             // Mark 'Define visual style' milestone as complete if colors/font are set
             const styleMilestone = state.overallMilestones.find(m => m.id === 'milestone-style');
             if (styleMilestone && state.style.primaryColor && state.style.secondaryColor && state.style.accentColor && state.style.fontFamily) {
                  styleMilestone.completed = true;
                  updateProgress(); // Recalculate overall progress
             }

             // Show a simple feedback message (optional, could be a small banner)
             // alert('Style settings saved!'); // Avoid disruptive alerts
        }

        function calculateOverallProgress() {
            // Calculation based on completion of overall milestones
            const completedMilestones = state.overallMilestones.filter(m => m.completed).length;
            const totalMilestones = state.overallMilestones.length;
            return totalMilestones > 0 ? Math.round((completedMilestones / totalMilestones) * 100) : 0;
        }

        function calculateAvgProjectProgress() {
             if (state.projects.length === 0) return 0;
             const totalProjectProgress = state.projects.reduce((sum, project) => sum + project.progress, 0);
             return Math.round(totalProjectProgress / state.projects.length);
        }

        function renderProjectProgressDetails() {
             projectProgressDetailsEl.innerHTML = '';
             if (state.projects.length === 0) {
                 projectProgressDetailsEl.innerHTML = '<p>No projects to show progress for.</p>';
                 return;
             }
             state.projects.forEach(project => {
                 const projectProgressEl = document.createElement('div');
                 projectProgressEl.classList.add('card'); // Re-using card style
                 projectProgressEl.innerHTML = `
                     <h3>${project.title || 'Untitled Project'}</h3>
                     <p>Status: ${project.progress >= 100 ? 'Completed' : 'In Progress'}</p>
                     <div class="progress-bar-container" role="progressbar" aria-valuenow="${project.progress}" aria-valuemin="0" aria-valuemax="100" aria-label="Project progress for ${project.title || 'Untitled Project'}">
                         <div class="progress-bar" style="width: ${project.progress}%;"></div>
                     </div>
                 `;
                 projectProgressDetailsEl.appendChild(projectProgressEl);
             });
        }

        function updateProgress() {
            // This demo links overall progress to global checklists/milestones.
            // A real app would have project-specific checklists.

            // Link Production milestone to global checklists completion for demo
            const productionMilestone = state.overallMilestones.find(m => m.id === 'milestone-production');
            if (productionMilestone) {
                 productionMilestone.completed =
                    state.checklists.filming.every(item => item.completed) &&
                    state.checklists.editing.every(item => item.completed);
            }

            // Link Planning milestone to having at least one project for demo
             const planningMilestone = state.overallMilestones.find(m => m.id === 'milestone-planning');
             if (planningMilestone && state.projects.length > 0) {
                 planningMilestone.completed = true;
             } else if (planningMilestone && state.projects.length === 0) {
                  planningMilestone.completed = false; // Reset if all projects deleted
             }


            // Simulate project progress update (e.g., random for demo, or could add manual update)
            // For this demo, let's just update project progress based on global checklist completion percentage
            // This is NOT correct for a real app but demonstrates progress bar updates
             const totalChecklistItems = state.checklists.filming.length + state.checklists.editing.length;
             const completedChecklistItems = state.checklists.filming.filter(item => item.completed).length + state.checklists.editing.filter(item => item.completed).length;
             const simulatedProjectProgress = totalChecklistItems > 0 ? Math.round((completedChecklistItems / totalChecklistItems) * 100) : 0;

             state.projects.forEach(project => {
                 // In a real app, calculate progress based on project's specific tasks/checklists
                 // For demo, just update based on the global simulated progress
                 project.progress = simulatedProjectProgress;
             });


            const overallProgress = calculateOverallProgress();
            overallProgressPercentageEl.textContent = `${overallProgress}%`;
            overallProgressBarEl.style.width = `${overallProgress}%`;
             overallProgressBarContainerEl.setAttribute('aria-valuenow', overallProgress);


            const avgProjectProgress = calculateAvgProjectProgress();
             avgProjectProgressPercentageEl.textContent = `${avgProjectProgress}%`;
             avgProjectProgressBarEl.style.width = `${avgProjectProgress}%`;
             avgProjectProgressBarContainerEl.setAttribute('aria-valuenow', avgProjectProgress);


             renderProjectProgressDetails(); // Re-render project progress list
             renderProjects(); // Re-render dashboard project list to show updated bars
             updateDashboardOverview(); // Update counts based on potentially completed projects
        }


        // --- Navigation ---

        function navigateTo(pageId) {
            pages.forEach(page => {
                page.classList.remove('active');
                 page.setAttribute('aria-hidden', 'true'); // Hide from screen readers
            });
            const activePage = document.getElementById(`${pageId}-page`);
            if (activePage) {
                activePage.classList.add('active');
                 activePage.setAttribute('aria-hidden', 'false'); // Show to screen readers
                 activePage.focus(); // Set focus to the page container for accessibility
            }


            navLinks.forEach(link => {
                link.classList.remove('active');
                 link.setAttribute('aria-current', 'false');
                if (link.dataset.page === pageId) {
                    link.classList.add('active');
                     link.setAttribute('aria-current', 'page'); // Indicate current page
                }
            });

            state.currentPage = pageId;
            console.log('Navigated to:', pageId);

            // Update URL hash without triggering hashchange event
             history.pushState(null, '', `#${pageId}`);


            // Trigger specific page rendering/updates if needed
            if (pageId === 'dashboard') {
                renderProjects();
                updateDashboardOverview();
            } else if (pageId === 'style') {
                loadStyleSettings();
            } else if (pageId === 'production') {
                 renderChecklist('filming', filmingChecklistEl);
                 renderChecklist('editing', editingChecklistEl);
            } else if (pageId === 'resources') {
                renderResources();
            } else if (pageId === 'progress') {
                updateProgress(); // Recalculate and render progress
            }
             // Planning page content is static guidance, no dynamic rendering needed on nav
        }

        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault(); // Prevent default link behavior
                const pageId = e.target.closest('.nav-link').dataset.page;
                navigateTo(pageId);
            });
             // Add keyboard support for navigation links (Enter/Space)
             link.addEventListener('keydown', (e) => {
                 if (e.key === 'Enter' || e.key === ' ') {
                     e.preventDefault(); // Prevent default space scrolling
                     const pageId = e.target.closest('.nav-link').dataset.page;
                     navigateTo(pageId);
                 }
             });
        });

         // Handle browser back/forward buttons
         window.addEventListener('popstate', () => {
             const pageIdFromHash = window.location.hash.substring(1) || 'dashboard';
             // Check if the hash corresponds to a valid page ID
             if (document.getElementById(`${pageIdFromHash}-page`)) {
                 navigateTo(pageIdFromHash);
             } else {
                 navigateTo('dashboard'); // Default to dashboard if hash is invalid
             }
         });


        // --- Modal / Project Form ---

        function openProjectModal(project = null) {
            projectModalOverlay.classList.add('visible');
             projectModalOverlay.setAttribute('aria-hidden', 'false');
             document.body.style.overflow = 'hidden'; // Prevent body scroll when modal is open

            if (project) {
                modalTitleEl.textContent = 'Edit Video Project';
                projectTitleInput.value = project.title || '';
                projectTopicInput.value = project.topic || '';
                projectScriptTextarea.value = project.script || '';
                saveProjectBtn.dataset.projectId = project.id; // Store ID for saving
            } else {
                modalTitleEl.textContent = 'Add New Video Project';
                projectTitleInput.value = '';
                projectTopicInput.value = '';
                projectScriptTextarea.value = '';
                delete saveProjectBtn.dataset.projectId; // No ID for new project
            }
             // Clear validation styles
             projectTitleInput.classList.remove('invalid');
             projectTopicInput.classList.remove('invalid');

             projectTitleInput.focus(); // Set focus to the first input
        }

        function closeProjectModal() {
            projectModalOverlay.classList.remove('visible');
             projectModalOverlay.setAttribute('aria-hidden', 'true');
             document.body.style.overflow = ''; // Restore body scroll

            // Clear form fields
            projectTitleInput.value = '';
            projectTopicInput.value = '';
            projectScriptTextarea.value = '';
            delete saveProjectBtn.dataset.projectId;
             // Reset validation styles
             projectTitleInput.classList.remove('invalid');
             projectTopicInput.classList.remove('invalid');

             // Return focus to the element that opened the modal (if possible)
             // This requires storing the active element before opening the modal
             // For simplicity in this demo, we won't implement tracking the opener element.
             // A better approach would be to focus the add button or the edited project card.
        }

        addProjectBtn.addEventListener('click', () => openProjectModal());
        closeProjectModalBtn.addEventListener('click', closeProjectModal);
        cancelProjectBtn.addEventListener('click', closeProjectModal);

        // Close modal if clicking outside the content
        projectModalOverlay.addEventListener('click', (e) => {
            if (e.target === projectModalOverlay) {
                closeProjectModal();
            }
        });

         // Close modal with Escape key
         document.addEventListener('keydown', (e) => {
             if (e.key === 'Escape' && projectModalOverlay.classList.contains('visible')) {
                 closeProjectModal();
             }
         });

         // Allow modal close button to be activated by Enter/Space
         closeProjectModalBtn.addEventListener('keydown', (e) => {
              if (e.key === 'Enter' || e.key === ' ') {
                 e.preventDefault();
                 closeProjectModal();
              }
         });


        // Save Project
        saveProjectBtn.addEventListener('click', () => {
            const title = projectTitleInput.value.trim();
            const topic = projectTopicInput.value.trim();
            const script = projectScriptTextarea.value.trim();
            const projectId = saveProjectBtn.dataset.projectId;

            let isValid = true;
            if (!title) {
                 projectTitleInput.classList.add('invalid');
                 projectTitleInput.setAttribute('aria-invalid', 'true');
                 isValid = false;
            } else {
                 projectTitleInput.classList.remove('invalid');
                 projectTitleInput.setAttribute('aria-invalid', 'false');
            }

            if (!topic) {
                 projectTopicInput.classList.add('invalid');
                 projectTopicInput.setAttribute('aria-invalid', 'true');
                 isValid = false;
            } else {
                 projectTopicInput.classList.remove('invalid');
                 projectTopicInput.setAttribute('aria-invalid', 'false');
            }

            if (!isValid) {
                 console.warn('Validation failed: Title and Topic are required.');
                // Could display inline error messages here
                return;
            }

            if (projectId) {
                // Edit existing project
                const project = state.projects.find(p => p.id === projectId);
                if (project) {
                    project.title = title;
                    project.topic = topic;
                    project.script = script;
                    // Project progress is currently simulated based on global state
                }
            } else {
                // Add new project
                const newProject = {
                    id: Date.now().toString(), // Simple unique ID
                    title: title,
                    topic: topic,
                    script: script,
                    progress: 0 // New projects start at 0%
                     // In a real app, you'd add checklist states specific to this project
                };
                state.projects.push(newProject);
            }

            closeProjectModal();
            renderProjects(); // Update dashboard list
            updateDashboardOverview(); // Update dashboard counts
            updateProgress(); // Update overall/avg progress
            console.log('Projects state:', state.projects);
        });

        // Clicking on a project card to potentially view/edit (simplified: opens modal with data)
        projectListEl.addEventListener('click', (e) => {
             const projectCard = e.target.closest('.project-card');
             if (projectCard) {
                 const projectId = projectCard.dataset.projectId;
                 const project = state.projects.find(p => p.id === projectId);
                 if (project) {
                     // In a real app, this might navigate to a dedicated project detail page
                     // For this demo, we'll just open the modal with the project data
                     openProjectModal(project);
                 }
             }
        });

        // Add keyboard support for project cards (Enter/Space)
         projectListEl.addEventListener('keydown', (e) => {
             const projectCard = e.target.closest('.project-card');
             if (projectCard && (e.key === 'Enter' || e.key === ' ')) {
                 e.preventDefault();
                 const projectId = projectCard.dataset.projectId;
                 const project = state.projects.find(p => p.id === projectId);
                 if (project) {
                     openProjectModal(project);
                 }
             }
         });


        // --- Style Editor Interactions ---
        primaryColorInput.addEventListener('input', updateStylePreview);
        secondaryColorInput.addEventListener('input', updateStylePreview);
        accentColorInput.addEventListener('input', updateStylePreview);
        fontSelect.addEventListener('change', updateStylePreview);

        saveStyleBtn.addEventListener('click', saveStyleSettings);


        // --- Checklist Interactions ---
        // Use event delegation on the parent elements
        filmingChecklistEl.addEventListener('change', handleChecklistChange);
        editingChecklistEl.addEventListener('change', handleChecklistChange);


        // --- Initial Load ---
        // Load initial data and render the dashboard
        document.addEventListener('DOMContentLoaded', () => {
            // Simulate loading state from local storage if available
            const savedState = localStorage.getItem('channelGuideState');
            if (savedState) {
                try {
                    const parsedState = JSON.parse(savedState);
                     // Basic validation for loaded state structure
                     if (parsedState && Array.isArray(parsedState.projects) && parsedState.checklists && Array.isArray(parsedState.resources) && Array.isArray(parsedState.overallMilestones) && parsedState.style) {
                          // Deep merge or careful assignment if state structure changes
                          // For this simple structure, Object.assign is okay, but be cautious
                          Object.assign(state, parsedState);
                          // Ensure projects have a progress property if loaded from old state
                           state.projects.forEach(p => { if (p.progress === undefined) p.progress = 0; });
                           // Ensure milestones have completed property
                            state.overallMilestones.forEach(m => { if (m.completed === undefined) m.completed = false; });
                            // Ensure checklist items have completed property
                            Object.values(state.checklists).forEach(list => {
                                list.forEach(item => { if (item.completed === undefined) item.completed = false; });
                            });

                     } else {
                         console.warn("Invalid state structure loaded from localStorage, using default state.");
                     }
                } catch (e) {
                    console.error("Failed to parse state from localStorage:", e);
                }
            }

            // Determine initial page from URL hash or default
             const pageIdFromHash = window.location.hash.substring(1);
             if (pageIdFromHash && document.getElementById(`${pageIdFromHash}-page`)) {
                 navigateTo(pageIdFromHash);
             } else {
                 navigateTo(state.currentPage); // Navigate to saved page or default dashboard
             }


            // Save state to local storage periodically or on significant changes
             // Use a more robust saving mechanism in a real app (e.g., on specific button clicks, before closing)
             // This interval is just for demo purposes.
             setInterval(() => {
                 try {
                    localStorage.setItem('channelGuideState', JSON.stringify(state));
                    // console.log("State saved to localStorage.");
                 } catch (e) {
                     console.error("Failed to save state to localStorage:", e);
                     // Handle potential QuotaExceededError
                 }
             }, 5000); // Save every 5 seconds (for demo)
        });

        // Basic input validation feedback
        projectTitleInput.addEventListener('input', () => {
             if (projectTitleInput.value.trim() === '') {
                 projectTitleInput.classList.add('invalid');
                 projectTitleInput.setAttribute('aria-invalid', 'true');
             } else {
                 projectTitleInput.classList.remove('invalid');
                 projectTitleInput.setAttribute('aria-invalid', 'false');
             }
        });
         projectTopicInput.addEventListener('input', () => {
             if (projectTopicInput.value.trim() === '') {
                 projectTopicInput.classList.add('invalid');
                 projectTopicInput.setAttribute('aria-invalid', 'true');
             } else {
                 projectTopicInput.classList.remove('invalid');
                 projectTopicInput.setAttribute('aria-invalid', 'false');
             }
        });

    </script>
</body>
</html>
