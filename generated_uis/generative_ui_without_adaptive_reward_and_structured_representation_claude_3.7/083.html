<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sustainable Fashion Content Manager</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --color-primary: #4CAF50; /* Earthy Green */
            --color-primary-dark: #388E3C;
            --color-primary-light: #81C784;
            --color-secondary: #2196F3; /* Blue */
            --color-secondary-dark: #1976D2;
            --color-accent: #FF9800; /* Orange/Natural tone */
            --color-background: #F8F9FA; /* Clean White-ish */
            --color-surface: #FFFFFF; /* Pure White */
            --color-text-primary: #212529; /* Dark Gray */
            --color-text-secondary: #495057; /* Medium Gray */
            --color-border: #DEE2E6; /* Light Gray */
            --color-success: #28A745;
            --color-danger: #DC3545;
            --color-warning: #FFC107;

            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;

            --border-radius-sm: 4px;
            --border-radius-md: 8px;
            --border-radius-lg: 12px;

            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.15);

            --sidebar-width: 250px;
            --sidebar-width-collapsed: 70px;

            --font-family-inter: 'Inter', sans-serif;
        }

        body {
            font-family: var(--font-family-inter);
            margin: 0;
            padding: 0;
            background-color: var(--color-background);
            color: var(--color-text-primary);
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .layout-container {
            display: flex;
            width: 100%;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--color-surface);
            color: var(--color-text-secondary);
            padding: var(--spacing-lg) var(--spacing-md);
            box-shadow: var(--shadow-md);
            transition: width 0.3s ease-in-out;
            flex-shrink: 0;
            overflow-y: auto;
            position: sticky;
            top: 0;
            height: 100vh;
            z-index: 500; /* Ensure sidebar is above content */
        }

        .sidebar.collapsed {
            width: var(--sidebar-width-collapsed);
            padding: var(--spacing-lg) var(--spacing-sm);
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            margin-bottom: var(--spacing-xl);
            padding: 0 var(--spacing-sm);
            white-space: nowrap;
            overflow: hidden;
        }

        .sidebar-header .brand-logo {
            font-size: 24px;
            margin-right: var(--spacing-sm);
            color: var(--color-primary);
        }

        .sidebar-header .brand-name {
            font-size: 1.2em;
            font-weight: 600;
            color: var(--color-text-primary);
            opacity: 1;
            transition: opacity 0.3s ease-in-out;
        }

        .sidebar.collapsed .brand-name {
            opacity: 0;
            width: 0;
        }

        .sidebar-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar-nav li {
            margin-bottom: var(--spacing-sm);
        }

        .sidebar-nav a {
            display: flex;
            align-items: center;
            padding: var(--spacing-sm) var(--spacing-md);
            color: var(--color-text-secondary);
            text-decoration: none;
            border-radius: var(--border-radius-sm);
            transition: background-color 0.2s ease, color 0.2s ease;
            white-space: nowrap;
            overflow: hidden;
            outline: none; /* Remove default outline */
        }

        .sidebar-nav a:focus-visible {
             outline: 2px solid var(--color-primary-dark);
             outline-offset: 2px;
        }

        .sidebar-nav a .material-icons-round {
            margin-right: var(--spacing-md);
            font-size: 20px;
            flex-shrink: 0;
        }

        .sidebar.collapsed .sidebar-nav a .material-icons-round {
            margin-right: 0;
        }

        .sidebar-nav a span {
            opacity: 1;
            transition: opacity 0.3s ease-in-out;
        }

        .sidebar.collapsed .sidebar-nav a span {
            opacity: 0;
            width: 0;
        }

        .sidebar-nav a:hover,
        .sidebar-nav a.active {
            background-color: var(--color-primary-light);
            color: var(--color-primary-dark);
        }

        .sidebar-toggle {
            background: none;
            border: none;
            color: var(--color-text-secondary);
            cursor: pointer;
            padding: var(--spacing-sm);
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-md);
            font-size: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease;
            outline: none; /* Remove default outline */
        }

         .sidebar-toggle:focus-visible {
             outline: 2px solid var(--color-primary-dark);
             outline-offset: 2px;
         }

        .sidebar-toggle:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .sidebar.collapsed .sidebar-toggle {
            right: var(--spacing-sm);
        }

        /* Main Content */
        .main-content {
            flex-grow: 1;
            padding: var(--spacing-xl);
            overflow-y: auto;
            transition: padding 0.3s ease-in-out;
        }

        .section {
            display: none; /* Hidden by default */
            margin-bottom: var(--spacing-xl);
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .section.active {
            display: block;
            opacity: 1;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }

        .section-header h1 {
            font-size: 2em;
            color: var(--color-text-primary);
            margin: 0;
        }

        /* Cards */
        .card {
            background-color: var(--color-surface);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-sm);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
            border: 1px solid var(--color-border);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-md);
        }

        .card-title {
            font-size: 1.2em;
            font-weight: 600;
            color: var(--color-text-primary);
            margin-top: 0;
            margin-bottom: var(--spacing-sm);
        }

        .card-content {
            color: var(--color-text-secondary);
            font-size: 0.9em;
        }

        /* Forms */
        .form-group {
            margin-bottom: var(--spacing-md);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--spacing-sm);
            font-weight: 500;
            color: var(--color-text-primary);
        }

        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="number"],
        .form-group input[type="date"],
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: var(--spacing-sm);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-sm);
            font-family: var(--font-family-inter);
            font-size: 1em;
            color: var(--color-text-primary);
            background-color: var(--color-surface);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            outline: none; /* Remove default outline */
        }

        .form-group input[type="text"]:focus,
        .form-group input[type="email"]:focus,
        .form-group input[type="number"]:focus,
        .form-group input[type="date"]:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            border-color: var(--color-primary);
            box-shadow: 0 0 0 0.2rem rgba(76, 175, 80, 0.25);
            outline: none;
        }

        .form-group input.error,
        .form-group textarea.error {
             border-color: var(--color-danger);
        }

        .form-group .error-message {
             color: var(--color-danger);
             font-size: 0.8em;
             margin-top: var(--spacing-xs);
             display: none;
        }
         .form-group input.error + .error-message,
         .form-group textarea.error + .error-message {
             display: block;
         }


        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 1em;
            font-weight: 500;
            border: none;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: background-color 0.2s ease, opacity 0.2s ease;
            text-decoration: none;
            outline: none; /* Remove default outline */
        }

         .button:focus-visible {
             outline: 2px solid var(--color-primary-dark);
             outline-offset: 2px;
         }

        .button-primary {
            background-color: var(--color-primary);
            color: var(--color-surface);
        }

        .button-primary:hover {
            background-color: var(--color-primary-dark);
        }

        .button-secondary {
            background-color: var(--color-background);
            color: var(--color-text-primary);
            border: 1px solid var(--color-border);
        }

        .button-secondary:hover {
            background-color: var(--color-border);
        }

        .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--color-border);
            margin-bottom: var(--spacing-lg);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        }

        .tab-button {
            padding: var(--spacing-sm) var(--spacing-md);
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1em;
            color: var(--color-text-secondary);
            transition: color 0.2s ease, border-bottom-color 0.2s ease;
            border-bottom: 2px solid transparent;
            margin-right: var(--spacing-sm);
            white-space: nowrap;
            outline: none; /* Remove default outline */
        }

         .tab-button:focus-visible {
             outline: 2px solid var(--color-primary-dark);
             outline-offset: 2px;
         }

        .tab-button.active {
            color: var(--color-primary-dark);
            border-bottom-color: var(--color-primary);
            font-weight: 500;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Calendar Placeholder */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: var(--color-border); /* Grid lines */
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-md);
            overflow: hidden;
        }

        .calendar-day-header {
            background-color: var(--color-background);
            padding: var(--spacing-sm);
            text-align: center;
            font-weight: 500;
            font-size: 0.9em;
            color: var(--color-text-primary);
        }

        .calendar-day {
            min-height: 100px;
            background-color: var(--color-surface);
            padding: var(--spacing-sm);
            font-size: 0.8em;
            color: var(--color-text-secondary);
            position: relative;
            cursor: pointer; /* Indicate interactivity */
            transition: background-color 0.2s ease;
        }

        .calendar-day:hover:not(.empty) {
             background-color: var(--color-background);
        }

        .calendar-day-number {
            position: absolute;
            top: var(--spacing-xs);
            right: var(--spacing-xs);
            font-size: 1em;
            font-weight: 600;
            color: var(--color-text-primary);
        }

        .calendar-day.empty {
             background-color: var(--color-background);
             cursor: default;
        }
         .calendar-day.empty:hover {
             background-color: var(--color-background);
         }


        /* Asset Library Grid */
        .asset-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--spacing-md);
        }

        .asset-item {
            background-color: var(--color-background);
            border-radius: var(--border-radius-md);
            overflow: hidden;
            border: 1px solid var(--color-border);
            position: relative;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .asset-item:hover {
             transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .asset-item img {
            display: block;
            width: 100%;
            height: 150px; /* Fixed height for grid items */
            object-fit: cover;
        }

        .asset-item-info {
            padding: var(--spacing-sm);
            font-size: 0.8em;
            color: var(--color-text-secondary);
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .asset-item-actions {
            position: absolute;
            top: var(--spacing-xs);
            right: var(--spacing-xs);
            display: flex;
            gap: var(--spacing-xs);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .asset-item:hover .asset-item-actions {
            opacity: 1;
        }

        .asset-item-actions button {
            background-color: rgba(255, 255, 255, 0.8);
            border: none;
            border-radius: var(--border-radius-sm);
            padding: var(--spacing-xs);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-text-secondary);
            font-size: 1em;
            transition: background-color 0.2s ease;
             outline: none;
        }
         .asset-item-actions button:focus-visible {
             outline: 2px solid var(--color-primary-dark);
             outline-offset: 2px;
         }

        .asset-item-actions button:hover {
            background-color: var(--color-surface);
            color: var(--color-primary-dark);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: var(--color-surface);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }

         .modal-overlay.visible .modal-content {
             transform: translateY(0);
         }


        .modal-close {
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-md);
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--color-text-secondary);
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease;
             outline: none;
        }
         .modal-close:focus-visible {
             outline: 2px solid var(--color-primary-dark);
             outline-offset: 2px;
         }

        .modal-close:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        #modal-asset-content img,
        #modal-asset-content video {
            max-width: 100%;
            max-height: calc(90vh - 150px); /* Adjust based on modal padding/title height */
            display: block;
            margin: var(--spacing-md) auto 0 auto;
        }

        /* Chart Controls (Floating) */
         .chart-container {
            position: relative;
            min-height: 300px; /* Ensure chart has space */
            margin-top: var(--spacing-lg);
         }

        .floating-controls {
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-md);
            background: rgba(255, 255, 255, 0.95);
            padding: var(--spacing-md);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-sm);
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            pointer-events: none;
            z-index: 10;
        }
        .floating-controls.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }
        .control-group {
            margin: var(--spacing-sm) 0;
            display: flex;
            flex-direction: column;
        }
        .control-group label {
            font-size: 0.9em;
            margin-bottom: var(--spacing-xs);
            color: var(--color-text-secondary);
        }
         .control-group input,
         .control-group select {
             padding: var(--spacing-xs);
             border: 1px solid var(--color-border);
             border-radius: var(--border-radius-sm);
             font-size: 0.9em;
             font-family: var(--font-family-inter);
             outline: none;
         }
         .control-group input:focus,
         .control-group select:focus {
             border-color: var(--color-primary);
             box-shadow: 0 0 0 0.1rem rgba(76, 175, 80, 0.25);
         }


        /* Loading Spinner Placeholder */
         .loading-spinner {
             border: 4px solid var(--color-border);
             border-top: 4px solid var(--color-primary);
             border-radius: 50%;
             width: 20px;
             height: 20px;
             animation: spin 1s linear infinite;
             margin-left: var(--spacing-sm);
             display: inline-block;
             vertical-align: middle;
             display: none; /* Hidden by default */
         }

         .loading-spinner.visible {
             display: inline-block;
         }

         @keyframes spin {
             0% { transform: rotate(0deg); }
             100% { transform: rotate(360deg); }
         }


        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                width: var(--sidebar-width-collapsed);
                padding: var(--spacing-lg) var(--spacing-sm);
            }
             .sidebar .brand-name,
             .sidebar-nav a span {
                opacity: 0;
                width: 0;
             }
             .sidebar-nav a .material-icons-round {
                margin-right: 0;
             }
             .sidebar-toggle {
                right: var(--spacing-sm);
             }
             .main-content {
                 padding: var(--spacing-lg);
             }
        }

        @media (max-width: 768px) {
             body {
                 flex-direction: column;
             }
             .layout-container {
                 flex-direction: column;
             }
             .sidebar {
                 width: 100%;
                 height: auto;
                 position: static;
                 box-shadow: var(--shadow-sm);
                 padding: var(--spacing-md);
                 overflow-y: visible; /* Allow content to dictate height */
             }
             .sidebar.collapsed {
                 width: 100%;
                 padding: var(--spacing-md);
             }
             .sidebar-header {
                 justify-content: center;
                 margin-bottom: var(--spacing-md);
             }
             .sidebar .brand-name,
             .sidebar-nav a span {
                opacity: 1;
                width: auto;
             }
             .sidebar-nav a .material-icons-round {
                margin-right: var(--spacing-md);
             }
             .sidebar-toggle {
                 display: none; /* Hide toggle on mobile, use full sidebar */
             }
             .sidebar-nav ul {
                 display: flex;
                 flex-wrap: wrap;
                 justify-content: center;
                 gap: var(--spacing-sm);
             }
             .sidebar-nav li {
                 margin-bottom: 0;
             }
             .sidebar-nav a {
                 flex-direction: column;
                 align-items: center;
                 padding: var(--spacing-sm);
                 font-size: 0.8em;
             }
             .sidebar-nav a .material-icons-round {
                 margin-right: 0;
                 margin-bottom: var(--spacing-xs);
                 font-size: 20px;
             }
             .main-content {
                 padding: var(--spacing-md);
             }
             .card-grid {
                 grid-template-columns: 1fr; /* Stack cards on mobile */
             }
             .asset-grid {
                 grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); /* Smaller asset grid */
             }
             .asset-item img {
                 height: 100px;
             }
             .modal-content {
                 width: 95%;
                 padding: var(--spacing-md);
             }
             .calendar-grid {
                 grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); /* Smaller calendar days */
             }
             .calendar-day {
                 min-height: 80px;
             }
             .calendar-day-number {
                 font-size: 0.9em;
             }
        }

    </style>
</head>
<body>
    <div class="layout-container">
        <aside class="sidebar" id="sidebar">
            <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                 <span class="material-icons-round">chevron_left</span>
            </button>
            <div class="sidebar-header">
                <span class="material-icons-round brand-logo">spa</span>
                <span class="brand-name">EcoBrand CMS</span>
            </div>
            <nav class="sidebar-nav" aria-label="Main navigation">
                <ul>
                    <li><a href="#dashboard" class="nav-link" data-section="dashboard"><span class="material-icons-round">dashboard</span> <span>Dashboard</span></a></li>
                    <li><a href="#strategy" class="nav-link" data-section="strategy"><span class="material-icons-round">lightbulb</span> <span>Strategy</span></a></li>
                    <li><a href="#adapters" class="nav-link" data-section="adapters"><span class="material-icons-round">tune</span> <span>Adapters</span></a></li>
                    <li><a href="#calendar" class="nav-link" data-section="calendar"><span class="material-icons-round">calendar_today</span> <span>Calendar</span></a></li>
                    <li><a href="#assets" class="nav-link" data-section="assets"><span class="material-icons-round">image</span> <span>Asset Library</span></a></li>
                    <li><a href="#ideas" class="nav-link" data-section="ideas"><span class="material-icons-round">auto_awesome</span> <span>Idea Generator</span></a></li>
                    <li><a href="#audience" class="nav-link" data-section="audience"><span class="material-icons-round">people</span> <span>Audience</span></a></li>
                    <li><a href="#performance" class="nav-link" data-section="performance"><span class="material-icons-round">analytics</span> <span>Performance</span></a></li>
                </ul>
            </nav>
        </aside>

        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="section active" aria-labelledby="dashboard-heading">
                <div class="section-header">
                    <h1 id="dashboard-heading">Dashboard</h1>
                </div>
                <div class="card-grid">
                    <div class="card">
                        <h2 class="card-title">Upcoming Posts</h2>
                        <div class="card-content">View your scheduled content.</div>
                    </div>
                    <div class="card">
                        <h2 class="card-title">Recent Ideas</h2>
                        <div class="card-content">Review recently generated ideas.</div>
                    </div>
                    <div class="card">
                        <h2 class="card-title">Asset Overview</h2>
                        <div class="card-content">Quick access to your assets.</div>
                    </div>
                    <div class="card">
                        <h2 class="card-title">Performance Snapshot</h2>
                        <div class="card-content">See key metrics at a glance.</div>
                    </div>
                </div>
            </section>

            <!-- Content Strategy Section -->
            <section id="strategy" class="section" aria-labelledby="strategy-heading">
                <div class="section-header">
                    <h1 id="strategy-heading">Content Strategy</h1>
                </div>
                <div class="card">
                    <h2 class="card-title">Brand Voice & Guidelines</h2>
                    <div class="form-group">
                        <label for="brand-voice">Define Brand Voice (Keywords, Tone):</label>
                        <input type="text" id="brand-voice" placeholder="e.g., Authentic, Ethical, Inspiring, Calm">
                    </div>
                     <div class="form-group">
                        <label for="brand-guidelines">Content Guidelines:</label>
                        <textarea id="brand-guidelines" placeholder="Write down key rules for content creation..."></textarea>
                    </div>
                    <button class="button button-primary" id="save-guidelines">Save Guidelines</button>
                </div>

                <div class="card">
                    <h2 class="card-title">Content Pillars</h2>
                     <div id="pillar-list">
                        <!-- Pillar cards will be added here by JS -->
                     </div>
                     <div class="form-group" style="margin-top: var(--spacing-md);">
                         <label for="new-pillar-title">New Pillar Title:</label>
                         <input type="text" id="new-pillar-title" required aria-required="true">
                         <span class="error-message" role="alert">Title is required.</span>
                     </div>
                     <div class="form-group">
                         <label for="new-pillar-description">New Pillar Description:</label>
                         <textarea id="new-pillar-description" required aria-required="true"></textarea>
                         <span class="error-message" role="alert">Description is required.</span>
                     </div>
                    <button class="button button-secondary" id="add-pillar-button">Add Pillar</button>
                </div>
            </section>

            <!-- Platform Adapters Section -->
            <section id="adapters" class="section" aria-labelledby="adapters-heading">
                 <div class="section-header">
                    <h1 id="adapters-heading">Platform Adapters</h1>
                </div>
                <div class="tabs" role="tablist">
                    <button class="tab-button active" data-tab="instagram" id="tab-instagram" role="tab" aria-controls="instagram" aria-selected="true">Instagram</button>
                    <button class="tab-button" data-tab="tiktok" id="tab-tiktok" role="tab" aria-controls="tiktok" aria-selected="false" tabindex="-1">TikTok</button>
                    <button class="tab-button" data-tab="blog" id="tab-blog" role="tab" aria-controls="blog" aria-selected="false" tabindex="-1">Blog</button>
                    <button class="tab-button" data-tab="newsletter" id="tab-newsletter" role="tab" aria-controls="newsletter" aria-selected="false" tabindex="-1">Newsletter</button>
                </div>

                <div id="instagram" class="tab-content active" role="tabpanel" aria-labelledby="tab-instagram">
                    <div class="card">
                        <h2 class="card-title">Instagram Content</h2>
                        <div class="form-group">
                            <label for="insta-caption">Caption:</label>
                            <textarea id="insta-caption" placeholder="Write your Instagram caption..." maxlength="2200"></textarea>
                            <small><span id="insta-char-count">0</span>/2200 characters</small>
                        </div>
                        <div class="form-group">
                            <label for="insta-hashtags">Hashtags:</label>
                            <input type="text" id="insta-hashtags" placeholder="#sustainablefashion #ecofriendly #[YourBrand]">
                        </div>
                         <div class="form-group">
                            <label>Checklist:</label>
                            <div><input type="checkbox" id="insta-chk-visual"> <label for="insta-chk-visual">High-quality visual</label></div>
                            <div><input type="checkbox" id="insta-chk-cta"> <label for="insta-chk-cta">Clear Call to Action</label></div>
                             <div><input type="checkbox" id="insta-chk-story"> <label for="insta-chk-story">Connects to Brand Story</label></div>
                        </div>
                        <button class="button button-primary" id="save-insta-draft">Save Instagram Draft</button>
                    </div>
                </div>

                 <div id="tiktok" class="tab-content" role="tabpanel" aria-labelledby="tab-tiktok" hidden>
                    <div class="card">
                        <h2 class="card-title">TikTok Content</h2>
                        <div class="form-group">
                            <label for="tiktok-script">Video Script/Concept:</label>
                            <textarea id="tiktok-script" placeholder="Outline your TikTok video idea..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="tiktok-hashtags">Hashtags:</label>
                            <input type="text" id="tiktok-hashtags" placeholder="#ecofashion #sustainableliving #stylehacks #[YourBrand]">
                        </div>
                         <div class="form-group">
                            <label>Checklist:</label>
                            <div><input type="checkbox" id="tiktok-chk-hook"> <label for="tiktok-chk-hook">Strong Hook (first 3s)</label></div>
                            <div><input type="checkbox" id="tiktok-chk-trend"> <label for="tiktok-chk-trend">Uses Relevant Trend/Sound</label></div>
                             <div><input type="checkbox" id="tiktok-chk-short"> <label for="tiktok-chk-short">Kept Short & Engaging</label></div>
                        </div>
                        <button class="button button-primary" id="save-tiktok-draft">Save TikTok Draft</button>
                    </div>
                </div>

                 <div id="blog" class="tab-content" role="tabpanel" aria-labelledby="tab-blog" hidden>
                    <div class="card">
                        <h2 class="card-title">Blog Post</h2>
                        <div class="form-group">
                            <label for="blog-title">Title:</label>
                            <input type="text" id="blog-title" placeholder="Blog post title">
                        </div>
                        <div class="form-group">
                            <label for="blog-content">Content:</label>
                            <textarea id="blog-content" placeholder="Write your blog post..."></textarea>
                        </div>
                         <div class="form-group">
                            <label>Checklist:</label>
                            <div><input type="checkbox" id="blog-chk-seo"> <label for="blog-chk-seo">SEO Optimized</label></div>
                            <div><input type="checkbox" id="blog-chk-value"> <label for="blog-chk-value">Provides Value (Info/Tips)</label></div>
                             <div><input type="checkbox" id="blog-chk-internal"> <label for="blog-chk-internal">Includes Internal Links</label></div>
                        </div>
                        <button class="button button-primary" id="save-blog-draft">Save Blog Draft</button>
                    </div>
                </div>

                 <div id="newsletter" class="tab-content" role="tabpanel" aria-labelledby="tab-newsletter" hidden>
                    <div class="card">
                        <h2 class="card-title">Newsletter Content</h2>
                        <div class="form-group">
                            <label for="newsletter-subject">Subject Line:</label>
                            <input type="text" id="newsletter-subject" placeholder="Newsletter subject line">
                        </div>
                        <div class="form-group">
                            <label for="newsletter-body">Body:</label>
                            <textarea id="newsletter-body" placeholder="Write your newsletter content..."></textarea>
                        </div>
                         <div class="form-group">
                            <label>Checklist:</label>
                            <div><input type="checkbox" id="newsletter-chk-personal"> <label for="newsletter-chk-personal">Personalized Tone</label></div>
                            <div><input type="checkbox" id="newsletter-chk-cta"> <label for="newsletter-chk-cta">Clear Call to Action</label></div>
                             <div><input type="checkbox" id="newsletter-chk-segment"> <label for="newsletter-chk-segment">Tailored for Segment</label></div>
                        </div>
                        <button class="button button-primary" id="save-newsletter-draft">Save Newsletter Draft</button>
                    </div>
                </div>
            </section>

            <!-- Content Calendar Section -->
            <section id="calendar" class="section" aria-labelledby="calendar-heading">
                 <div class="section-header">
                    <h1 id="calendar-heading">Content Calendar</h1>
                 </div>
                <div class="card">
                    <h2 class="card-title">Monthly View (Placeholder)</h2>
                    <p class="card-content">Click on a day to add or view scheduled content. Drag-and-drop scheduling is a future feature.</p>
                    <div class="calendar-grid" id="calendar-grid">
                        <div class="calendar-day-header">Sun</div>
                        <div class="calendar-day-header">Mon</div>
                        <div class="calendar-day-header">Tue</div>
                        <div class="calendar-day-header">Wed</div>
                        <div class="calendar-day-header">Thu</div>
                        <div class="calendar-day-header">Fri</div>
                        <div class="calendar-day-header">Sat</div>
                        <!-- Calendar days will be generated here by JS -->
                    </div>
                </div>
            </section>

            <!-- Asset Library Section -->
            <section id="assets" class="section" aria-labelledby="assets-heading">
                 <div class="section-header">
                    <h1 id="assets-heading">Asset Library</h1>
                     <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap;">
                        <input type="text" id="asset-search" placeholder="Search assets..." style="flex-grow: 1; min-width: 150px;">
                        <button class="button button-secondary" id="asset-filter-button">Filter</button>
                        <button class="button button-primary">Upload Asset</button>
                     </div>
                </div>
                <div class="asset-grid" id="asset-grid">
                    <!-- Placeholder assets will be rendered here by JS -->
                </div>
            </section>

            <!-- Content Idea Generator Section -->
            <section id="ideas" class="section" aria-labelledby="ideas-heading">
                 <div class="section-header">
                    <h1 id="ideas-heading">Content Idea Generator</h1>
                 </div>
                 <div class="card">
                     <h2 class="card-title">Generate Ideas</h2>
                     <div class="form-group">
                         <label for="idea-keyword">Enter a keyword or topic:</label>
                         <input type="text" id="idea-keyword" placeholder="e.g., upcycling, spring collection, customer story">
                     </div>
                     <button class="button button-primary" id="generate-idea-button">
                         Generate Ideas <span class="loading-spinner" id="idea-spinner"></span>
                     </button>
                 </div>

                 <div class="card" style="margin-top: var(--spacing-lg);">
                     <h2 class="card-title">Generated Ideas</h2>
                      <div id="idea-list">
                         <!-- Generated ideas will appear here -->
                          <p style="color: var(--color-text-secondary);">Enter a keyword and click "Generate Ideas".</p>
                      </div>
                 </div>
            </section>

            <!-- Audience Insights Section -->
            <section id="audience" class="section" aria-labelledby="audience-heading">
                 <div class="section-header">
                    <h1 id="audience-heading">Audience Insights & Personas</h1>
                 </div>
                 <div class="card">
                     <h2 class="card-title">Target Audience Overview</h2>
                     <p class="card-content">Environmentally conscious millennials (approx. 25-40), disposable income, value ethics and sustainability, active on social media, read blogs for information.</p>
                 </div>

                 <div class="card">
                     <h2 class="card-title">Persona Builder</h2>
                     <div id="persona-list">
                         <!-- Persona cards will be added here by JS -->
                     </div>
                     <div class="form-group" style="margin-top: var(--spacing-md);">
                         <label for="new-persona-name">Persona Name:</label>
                         <input type="text" id="new-persona-name" required aria-required="true">
                         <span class="error-message" role="alert">Name is required.</span>
                     </div>
                     <div class="form-group">
                         <label for="new-persona-details">Persona Details (Age, Occupation, Interests, Values, Platforms):</label>
                         <textarea id="new-persona-details" required aria-required="true"></textarea>
                         <span class="error-message" role="alert">Details are required.</span>
                     </div>
                    <button class="button button-secondary" id="add-persona-button">Add Persona</button>
                 </div>
            </section>

            <!-- Performance Tracking Section -->
            <section id="performance" class="section" aria-labelledby="performance-heading">
                 <div class="section-header">
                    <h1 id="performance-heading">Performance Tracking</h1>
                 </div>
                 <div class="card">
                     <h2 class="card-title">Content Performance Overview</h2>
                     <div class="chart-container">
                         <canvas id="performanceChart"></canvas>
                         <!-- Floating control panel -->
                        <div class="floating-controls" id="chartControls" aria-hidden="true">
                            <div class="control-group">
                                <label for="chartType">Chart Type</label>
                                <select id="chartType" aria-controls="performanceChart">
                                    <option value="bar">Bar</option>
                                    <option value="line">Line</option>
                                </select>
                            </div>
                             <div class="control-group">
                                <label for="chartMetric">Metric</label>
                                <select id="chartMetric" aria-controls="performanceChart">
                                    <option value="engagement">Engagement</option>
                                    <option value="reach">Reach</option>
                                    <option value="clicks">Link Clicks</option>
                                </select>
                            </div>
                        </div>
                     </div>
                 </div>
            </section>
        </main>
    </div>

    <!-- Modal for Asset Preview -->
    <div class="modal-overlay" id="asset-preview-modal" role="dialog" aria-modal="true" aria-labelledby="modal-asset-title">
        <div class="modal-content">
            <button class="modal-close" aria-label="Close modal"><span class="material-icons-round">close</span></button>
            <h2 class="card-title" id="modal-asset-title">Asset Preview</h2>
            <div id="modal-asset-content">
                <!-- Asset (image/video) will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Modal for Calendar Day Details/Add Content -->
     <div class="modal-overlay" id="calendar-day-modal" role="dialog" aria-modal="true" aria-labelledby="modal-calendar-title">
        <div class="modal-content">
            <button class="modal-close" aria-label="Close modal"><span class="material-icons-round">close</span></button>
            <h2 class="card-title" id="modal-calendar-title">Content for [Date]</h2>
             <div id="modal-calendar-content">
                 <!-- Content for the selected day will be loaded here -->
                 <p>No content scheduled for this day.</p>
                 <button class="button button-primary" style="margin-top: var(--spacing-md);">Add Content</button>
             </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebar-toggle');
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('.section');
            const mainContent = document.querySelector('.main-content');

            const assetPreviewModal = document.getElementById('asset-preview-modal');
            const modalCloseButtons = document.querySelectorAll('.modal-close'); // Select all close buttons
            const modalAssetContent = document.getElementById('modal-asset-content');
            const modalAssetTitle = document.getElementById('modal-asset-title');

            const calendarDayModal = document.getElementById('calendar-day-modal');
            const modalCalendarTitle = document.getElementById('modal-calendar-title');
            const modalCalendarContent = document.getElementById('modal-calendar-content');


            const tabs = document.querySelectorAll('.tabs button');
            const tabContents = document.querySelectorAll('.tab-content');
            const instaCaption = document.getElementById('insta-caption');
            const instaCharCount = document.getElementById('insta-char-count');
            const addPillarButton = document.getElementById('add-pillar-button');
            const newPillarTitleInput = document.getElementById('new-pillar-title');
            const newPillarDescriptionInput = document.getElementById('new-pillar-description');
            const pillarList = document.getElementById('pillar-list');
            const addPersonaButton = document.getElementById('add-persona-button');
            const newPersonaNameInput = document.getElementById('new-persona-name');
            const newPersonaDetailsInput = document.getElementById('new-persona-details');
            const personaList = document.getElementById('persona-list');
            const generateIdeaButton = document.getElementById('generate-idea-button');
            const ideaKeywordInput = document.getElementById('idea-keyword');
            const ideaList = document.getElementById('idea-list');
            const ideaSpinner = document.getElementById('idea-spinner');
            const assetSearchInput = document.getElementById('asset-search');
            const assetGrid = document.getElementById('asset-grid');
            const calendarGrid = document.getElementById('calendar-grid');

            // --- Local Storage Keys ---
            const LS_KEYS = {
                STRATEGY_GUIDELINES: 'cms_strategy_guidelines',
                STRATEGY_PILLARS: 'cms_strategy_pillars',
                ADAPTERS_INSTA: 'cms_adapters_insta',
                ADAPTERS_TIKTOK: 'cms_adapters_tiktok',
                ADAPTERS_BLOG: 'cms_adapters_blog',
                ADAPTERS_NEWSLETTER: 'cms_adapters_newsletter',
                AUDIENCE_PERSONAS: 'cms_audience_personas',
                CALENDAR_CONTENT: 'cms_calendar_content' // Placeholder for calendar data
            };

            // --- Persistence Functions ---
            function saveToLocalStorage(key, data) {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                } catch (e) {
                    console.error('Error saving to localStorage', e);
                }
            }

            function loadFromLocalStorage(key, defaultValue) {
                try {
                    const data = localStorage.getItem(key);
                    return data ? JSON.parse(data) : defaultValue;
                } catch (e) {
                    console.error('Error loading from localStorage', e);
                    return defaultValue;
                }
            }

            // --- Sidebar Toggle ---
            sidebarToggle.addEventListener('click', () => {
                sidebar.classList.toggle('collapsed');
                // Update toggle icon
                const icon = sidebarToggle.querySelector('.material-icons-round');
                if (sidebar.classList.contains('collapsed')) {
                    icon.textContent = 'chevron_right';
                    sidebarToggle.setAttribute('aria-label', 'Expand sidebar');
                } else {
                    icon.textContent = 'chevron_left';
                    sidebarToggle.setAttribute('aria-label', 'Collapse sidebar');
                }
            });

            // --- Navigation ---
            function showSection(sectionId) {
                sections.forEach(section => {
                    section.classList.remove('active');
                });
                const activeSection = document.getElementById(sectionId);
                if (activeSection) {
                    activeSection.classList.add('active');
                    // Scroll to top of main content
                    mainContent.scrollTop = 0;

                    // Hide chart controls if not on performance section
                     if (sectionId !== 'performance') {
                         chartControls.classList.remove('active');
                         chartControls.setAttribute('aria-hidden', 'true');
                     } else {
                          chartControls.setAttribute('aria-hidden', 'false');
                     }
                }

                navLinks.forEach(link => {
                    const linkSectionId = link.getAttribute('data-section');
                    if (linkSectionId === sectionId) {
                        link.classList.add('active');
                        link.setAttribute('aria-current', 'page');
                    } else {
                        link.classList.remove('active');
                        link.removeAttribute('aria-current');
                    }
                });
            }

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = link.getAttribute('data-section');
                    showSection(sectionId);
                     // Update URL hash
                    history.pushState(null, '', `#${sectionId}`);
                });
            });

             // Handle initial load based on URL hash
            const initialSection = window.location.hash ? window.location.hash.substring(1) : 'dashboard';
            showSection(initialSection);


            // --- Platform Adapters Tabs ---
            tabs.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTabId = button.getAttribute('data-tab');

                    // Update button states and aria attributes
                    tabs.forEach(btn => {
                        const isSelected = btn === button;
                        btn.classList.toggle('active', isSelected);
                        btn.setAttribute('aria-selected', isSelected);
                        btn.setAttribute('tabindex', isSelected ? '0' : '-1');
                    });

                    // Update tab content visibility and aria attributes
                    tabContents.forEach(content => {
                        const isTarget = content.id === targetTabId;
                        content.classList.toggle('active', isTarget);
                        content.hidden = !isTarget; // Use hidden attribute for accessibility
                    });
                });

                 // Add keyboard navigation for tabs (Left/Right arrow)
                 button.addEventListener('keydown', (e) => {
                     const tabList = button.closest('.tabs');
                     const tabButtons = Array.from(tabList.querySelectorAll('.tab-button'));
                     const currentIndex = tabButtons.indexOf(button);
                     let nextIndex = -1;

                     if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
                         e.preventDefault(); // Prevent default scroll behavior

                         if (e.key === 'ArrowRight') {
                             nextIndex = (currentIndex + 1) % tabButtons.length;
                         } else { // ArrowLeft
                             nextIndex = (currentIndex - 1 + tabButtons.length) % tabButtons.length;
                         }

                         const nextButton = tabButtons[nextIndex];
                         nextButton.click(); // Activate the tab
                         nextButton.focus(); // Move focus to the next tab
                     }
                 });
            });

            // --- Character Counter for Instagram Caption ---
            if (instaCaption && instaCharCount) {
                instaCaption.addEventListener('input', () => {
                    instaCharCount.textContent = instaCaption.value.length;
                });
                 // Initial count
                instaCharCount.textContent = instaCaption.value.length;
            }

            // --- Form Validation Helper ---
            function validateFormGroup(input) {
                const formGroup = input.closest('.form-group');
                const errorMessage = formGroup ? formGroup.querySelector('.error-message') : null;
                const isValid = !input.hasAttribute('required') || input.value.trim() !== '';

                if (!isValid) {
                    input.classList.add('error');
                    if (errorMessage) {
                         errorMessage.style.display = 'block';
                         input.setAttribute('aria-invalid', 'true');
                    }
                } else {
                    input.classList.remove('error');
                    if (errorMessage) {
                         errorMessage.style.display = 'none';
                         input.setAttribute('aria-invalid', 'false');
                    }
                }
                return isValid;
            }

            // Add blur validation for required fields
            document.querySelectorAll('input[required], textarea[required]').forEach(input => {
                 input.addEventListener('blur', () => {
                     validateFormGroup(input);
                 });
                 input.addEventListener('input', () => {
                     // Clear error on input if it's no longer empty
                     if (input.value.trim() !== '') {
                          input.classList.remove('error');
                          const formGroup = input.closest('.form-group');
                          const errorMessage = formGroup ? formGroup.querySelector('.error-message') : null;
                          if (errorMessage) errorMessage.style.display = 'none';
                          input.setAttribute('aria-invalid', 'false');
                     }
                 });
            });


             // --- Add Content Pillar ---
            if (addPillarButton && newPillarTitleInput && newPillarDescriptionInput && pillarList) {
                // Load existing pillars from localStorage
                const savedPillars = loadFromLocalStorage(LS_KEYS.STRATEGY_PILLARS, [
                    { title: 'Pillar 1: Sustainable Practices', description: 'Highlight ethical sourcing, production methods, and environmental impact.' },
                    { title: 'Pillar 2: Style & Versatility', description: 'Showcase how sustainable fashion can be stylish and versatile for everyday wear.' },
                    { title: 'Pillar 3: Community & Values', description: 'Share brand story, connect with the community, and promote conscious consumerism.' }
                ]);

                function renderPillars(pillars) {
                     pillarList.innerHTML = ''; // Clear existing
                     if (pillars.length === 0) {
                         pillarList.innerHTML = '<p style="color: var(--color-text-secondary);">No pillars added yet.</p>';
                     } else {
                         pillars.forEach(pillar => {
                             const newPillarCard = document.createElement('div');
                             newPillarCard.classList.add('card', 'card-content');
                             newPillarCard.innerHTML = `
                                 <h3 class="card-title">${pillar.title}</h3>
                                 <p>${pillar.description}</p>
                             `;
                             pillarList.appendChild(newPillarCard);
                         });
                     }
                }

                renderPillars(savedPillars);

                addPillarButton.addEventListener('click', () => {
                    const isTitleValid = validateFormGroup(newPillarTitleInput);
                    const isDescriptionValid = validateFormGroup(newPillarDescriptionInput);

                    if (isTitleValid && isDescriptionValid) {
                        const title = newPillarTitleInput.value.trim();
                        const description = newPillarDescriptionInput.value.trim();

                        const currentPillars = loadFromLocalStorage(LS_KEYS.STRATEGY_PILLARS, []);
                        currentPillars.push({ title, description });
                        saveToLocalStorage(LS_KEYS.STRATEGY_PILLARS, currentPillars);
                        renderPillars(currentPillars);

                        // Clear inputs and validation state
                        newPillarTitleInput.value = '';
                        newPillarDescriptionInput.value = '';
                        newPillarTitleInput.classList.remove('error');
                        newPillarDescriptionInput.classList.remove('error');
                         newPillarTitleInput.setAttribute('aria-invalid', 'false');
                         newPillarDescriptionInput.setAttribute('aria-invalid', 'false');
                         newPillarTitleInput.closest('.form-group').querySelector('.error-message').style.display = 'none';
                         newPillarDescriptionInput.closest('.form-group').querySelector('.error-message').style.display = 'none';
                    } else {
                        // Trigger validation display on click if not already shown by blur
                        validateFormGroup(newPillarTitleInput);
                        validateFormGroup(newPillarDescriptionInput);
                    }
                });
            }

            // --- Save Brand Guidelines ---
            const brandVoiceInput = document.getElementById('brand-voice');
            const brandGuidelinesTextarea = document.getElementById('brand-guidelines');
            const saveGuidelinesButton = document.getElementById('save-guidelines');

            if (brandVoiceInput && brandGuidelinesTextarea && saveGuidelinesButton) {
                 // Load existing guidelines
                 const savedGuidelines = loadFromLocalStorage(LS_KEYS.STRATEGY_GUIDELINES, { voice: '', guidelines: '' });
                 brandVoiceInput.value = savedGuidelines.voice;
                 brandGuidelinesTextarea.value = savedGuidelines.guidelines;

                 saveGuidelinesButton.addEventListener('click', () => {
                     const voice = brandVoiceInput.value.trim();
                     const guidelines = brandGuidelinesTextarea.value.trim();
                     saveToLocalStorage(LS_KEYS.STRATEGY_GUIDELINES, { voice, guidelines });
                     // Simple feedback - could be a temporary success message element
                     const originalText = saveGuidelinesButton.textContent;
                     saveGuidelinesButton.textContent = 'Saved!';
                     saveGuidelinesButton.disabled = true;
                     setTimeout(() => {
                         saveGuidelinesButton.textContent = originalText;
                         saveGuidelinesButton.disabled = false;
                     }, 1500);
                 });
            }


             // --- Add Audience Persona ---
            if (addPersonaButton && newPersonaNameInput && newPersonaDetailsInput && personaList) {
                 // Load existing personas from localStorage
                const savedPersonas = loadFromLocalStorage(LS_KEYS.AUDIENCE_PERSONAS, [
                    { name: 'Eco-Conscious Emily', details: 'Age: 30 | Occupation: Graphic Designer | Interests: Yoga, healthy eating, travel | Values: Sustainability, transparency, quality over quantity | Platforms: Instagram, Blog, Newsletter.' }
                ]);

                function renderPersonas(personas) {
                     personaList.innerHTML = ''; // Clear existing
                     if (personas.length === 0) {
                          personaList.innerHTML = '<p style="color: var(--color-text-secondary);">No personas added yet.</p>';
                     } else {
                         personas.forEach(persona => {
                             const newPersonaCard = document.createElement('div');
                             newPersonaCard.classList.add('card', 'card-content');
                             newPersonaCard.innerHTML = `
                                 <h3 class="card-title">Persona: ${persona.name}</h3>
                                 <p>${persona.details}</p>
                             `;
                             personaList.appendChild(newPersonaCard);
                         });
                     }
                }

                renderPersonas(savedPersonas);

                addPersonaButton.addEventListener('click', () => {
                    const isNameValid = validateFormGroup(newPersonaNameInput);
                    const isDetailsValid = validateFormGroup(newPersonaDetailsInput);

                    if (isNameValid && isDetailsValid) {
                        const name = newPersonaNameInput.value.trim();
                        const details = newPersonaDetailsInput.value.trim();

                        const currentPersonas = loadFromLocalStorage(LS_KEYS.AUDIENCE_PERSONAS, []);
                        currentPersonas.push({ name, details });
                        saveToLocalStorage(LS_KEYS.AUDIENCE_PERSONAS, currentPersonas);
                        renderPersonas(currentPersonas);

                        // Clear inputs and validation state
                        newPersonaNameInput.value = '';
                        newPersonaDetailsInput.value = '';
                         newPersonaNameInput.classList.remove('error');
                         newPersonaDetailsInput.classList.remove('error');
                         newPersonaNameInput.setAttribute('aria-invalid', 'false');
                         newPersonaDetailsInput.setAttribute('aria-invalid', 'false');
                         newPersonaNameInput.closest('.form-group').querySelector('.error-message').style.display = 'none';
                         newPersonaDetailsInput.closest('.form-group').querySelector('.error-message').style.display = 'none';

                    } else {
                         // Trigger validation display on click if not already shown by blur
                         validateFormGroup(newPersonaNameInput);
                         validateFormGroup(newPersonaDetailsInput);
                    }
                });
            }

            // --- Save Platform Drafts (Basic Persistence) ---
            const adapterForms = {
                 instagram: {
                     caption: document.getElementById('insta-caption'),
                     hashtags: document.getElementById('insta-hashtags'),
                     checklist: document.querySelectorAll('#instagram input[type="checkbox"]'),
                     saveButton: document.getElementById('save-insta-draft'),
                     lsKey: LS_KEYS.ADAPTERS_INSTA
                 },
                 tiktok: {
                     script: document.getElementById('tiktok-script'),
                     hashtags: document.getElementById('tiktok-hashtags'),
                     checklist: document.querySelectorAll('#tiktok input[type="checkbox"]'),
                     saveButton: document.getElementById('save-tiktok-draft'),
                     lsKey: LS_KEYS.ADAPTERS_TIKTOK
                 },
                 blog: {
                     title: document.getElementById('blog-title'),
                     content: document.getElementById('blog-content'),
                     checklist: document.querySelectorAll('#blog input[type="checkbox"]'),
                     saveButton: document.getElementById('save-blog-draft'),
                     lsKey: LS_KEYS.ADAPTERS_BLOG
                 },
                 newsletter: {
                     subject: document.getElementById('newsletter-subject'),
                     body: document.getElementById('newsletter-body'),
                     checklist: document.querySelectorAll('#newsletter input[type="checkbox"]'),
                     saveButton: document.getElementById('save-newsletter-draft'),
                     lsKey: LS_KEYS.ADAPTERS_NEWSLETTER
                 }
            };

            // Load existing drafts
            Object.keys(adapterForms).forEach(platform => {
                 const form = adapterForms[platform];
                 const savedData = loadFromLocalStorage(form.lsKey, {});

                 if (form.caption) form.caption.value = savedData.caption || '';
                 if (form.hashtags) form.hashtags.value = savedData.hashtags || '';
                 if (form.script) form.script.value = savedData.script || '';
                 if (form.title) form.title.value = savedData.title || '';
                 if (form.content) form.content.value = savedData.content || '';
                 if (form.subject) form.subject.value = savedData.subject || '';
                 if (form.body) form.body.value = savedData.body || '';

                 if (form.checklist) {
                     form.checklist.forEach(checkbox => {
                         if (savedData.checklist && savedData.checklist[checkbox.id] !== undefined) {
                             checkbox.checked = savedData.checklist[checkbox.id];
                         }
                     });
                 }

                 // Add save listener
                 if (form.saveButton) {
                     form.saveButton.addEventListener('click', () => {
                         const dataToSave = {};
                         if (form.caption) dataToSave.caption = form.caption.value.trim();
                         if (form.hashtags) dataToSave.hashtags = form.hashtags.value.trim();
                         if (form.script) dataToSave.script = form.script.value.trim();
                         if (form.title) dataToSave.title = form.title.value.trim();
                         if (form.content) dataToSave.content = form.content.value.trim();
                         if (form.subject) dataToSave.subject = form.subject.value.trim();
                         if (form.body) dataToSave.body = form.body.value.trim();

                         if (form.checklist) {
                             dataToSave.checklist = {};
                             form.checklist.forEach(checkbox => {
                                 dataToSave.checklist[checkbox.id] = checkbox.checked;
                             });
                         }

                         saveToLocalStorage(form.lsKey, dataToSave);
                         // Simple feedback
                         const originalText = form.saveButton.textContent;
                         form.saveButton.textContent = 'Saved!';
                         form.saveButton.disabled = true;
                         setTimeout(() => {
                             form.saveButton.textContent = originalText;
                             form.saveButton.disabled = false;
                         }, 1500);
                     });
                 }
            });


             // --- Content Idea Generator Placeholder ---
            if (generateIdeaButton && ideaKeywordInput && ideaList && ideaSpinner) {
                 generateIdeaButton.addEventListener('click', () => {
                     const keyword = ideaKeywordInput.value.trim();
                     if (keyword) {
                         ideaSpinner.classList.add('visible');
                         generateIdeaButton.disabled = true;

                         // Simulate API call delay
                         setTimeout(() => {
                             ideaList.innerHTML = ''; // Clear previous ideas
                             const ideas = [
                                 `How ${keyword} relates to sustainable fashion`,
                                 `5 ways to incorporate ${keyword} into your style`,
                                 `Behind the scenes: Our ${keyword} process`,
                                 `Customer story: Using ${keyword} in daily life`,
                                 `The history of ${keyword} and sustainability`,
                                 `DIY ${keyword} upcycling tutorial`,
                                 `Interview with an expert on ${keyword}`
                             ];

                             if (ideas.length === 0) {
                                  ideaList.innerHTML = '<p style="color: var(--color-text-secondary);">No ideas generated for this keyword.</p>';
                             } else {
                                 ideas.forEach(ideaText => {
                                     const ideaCard = document.createElement('div');
                                     ideaCard.classList.add('card', 'card-content');
                                      ideaCard.style.cursor = 'pointer'; // Make them feel interactive
                                      ideaCard.setAttribute('tabindex', '0'); // Make cards focusable
                                      ideaCard.setAttribute('role', 'button'); // Indicate they are interactive
                                     ideaCard.innerHTML = `<p>${ideaText}</p>`;
                                     ideaList.appendChild(ideaCard);
                                 });
                             }


                             ideaKeywordInput.value = ''; // Clear input
                             ideaSpinner.classList.remove('visible');
                             generateIdeaButton.disabled = false;

                         }, 1000); // Simulate 1-second delay

                     } else {
                         // Simple alert for missing keyword
                         alert('Please enter a keyword to generate ideas.');
                     }
                 });
            }

            // --- Asset Library Placeholder Assets ---
            const placeholderAssets = [
                { url: "https://placehold.co/300x200?text=Sustainable+Dress+1", name: "Dress 1.jpg", type: "image" },
                { url: "https://placehold.co/300x200?text=Organic+Cotton+Shirt", name: "Shirt.png", type: "image" },
                { url: "https://placehold.co/300x200?text=Eco-Friendly+Bag", name: "Bag.mp4", type: "video" },
                { url: "https://placehold.co/300x200?text=Recycled+Scarf", name: "Scarf.jpg", type: "image" },
                { url: "https://placehold.co/300x200?text=Ethical+Jeans", name: "Jeans.jpg", type: "image" },
                 { url: "https://placehold.co/300x200?text=Upcycled+Jacket", name: "Jacket.jpg", type: "image" },
                 { url: "https://placehold.co/300x200?text=Natural+Dye+Process", name: "DyeProcess.mp4", type: "video" },
                 { url: "https://placehold.co/300x200?text=Fair+Trade+Factory", name: "Factory.jpg", type: "image" },
            ];

            function renderAssets(assets) {
                 assetGrid.innerHTML = ''; // Clear existing
                 if (assets.length === 0) {
                     assetGrid.innerHTML = '<p style="color: var(--color-text-secondary);">No assets found.</p>';
                 } else {
                     assets.forEach(asset => {
                         const assetItem = document.createElement('div');
                         assetItem.classList.add('asset-item');
                         assetItem.setAttribute('data-asset-url', asset.url);
                         assetItem.setAttribute('data-asset-type', asset.type);
                         assetItem.setAttribute('tabindex', '0'); // Make asset items focusable
                         assetItem.setAttribute('role', 'button'); // Indicate they are interactive

                         let mediaElement;
                         if (asset.type === 'video') {
                             mediaElement = `<img src="https://placehold.co/300x200/cccccc/000000?text=Video+Preview" alt="Video thumbnail for ${asset.name}">`; // Use a generic video thumbnail placeholder
                         } else {
                             mediaElement = `<img src="${asset.url}" alt="${asset.name}">`;
                         }


                         assetItem.innerHTML = `
                             ${mediaElement}
                             <div class="asset-item-info">${asset.name}</div>
                              <div class="asset-item-actions">
                                 <button aria-label="View asset" class="view-asset-button"><span class="material-icons-round" style="font-size: 1em;">visibility</span></button>
                                 <button aria-label="Download asset" class="download-asset-button"><span class="material-icons-round" style="font-size: 1em;">download</span></button>
                              </div>
                         `;
                         assetGrid.appendChild(assetItem);
                     });
                 }
            }

            renderAssets(placeholderAssets); // Initial render

            // --- Asset Preview Modal ---
            assetGrid.addEventListener('click', (e) => {
                 const assetItem = e.target.closest('.asset-item');
                 if (!assetItem) return;

                 const viewButton = e.target.closest('.view-asset-button');
                 const downloadButton = e.target.closest('.download-asset-button');

                 if (downloadButton) {
                     // Handle download action
                     e.stopPropagation(); // Prevent modal from opening
                     const assetUrl = assetItem.getAttribute('data-asset-url');
                     const assetName = assetItem.querySelector('.asset-item-info').textContent;
                     // Simulate download - in a real app, this would trigger a file download
                     alert(`Simulating download for ${assetName} from ${assetUrl}`);
                     return;
                 }

                 if (viewButton || (!viewButton && !downloadButton)) { // Open modal if view button or item itself is clicked
                     e.stopPropagation(); // Prevent grid click handler if a button was clicked
                     const assetUrl = assetItem.getAttribute('data-asset-url');
                     const assetName = assetItem.querySelector('.asset-item-info').textContent;
                     const assetType = assetItem.getAttribute('data-asset-type');

                     modalAssetTitle.textContent = `Preview: ${assetName}`;
                     modalAssetContent.innerHTML = ''; // Clear previous content

                     if (assetType === 'video') {
                         const video = document.createElement('video');
                         video.src = assetUrl;
                         video.controls = true;
                         video.style.maxWidth = '100%';
                         video.style.maxHeight = 'calc(90vh - 150px)'; // Adjust based on modal padding/title height
                         video.setAttribute('aria-label', `Preview of ${assetName}`);
                         modalAssetContent.appendChild(video);
                     } else { // Assume image
                         const img = document.createElement('img');
                         img.src = assetUrl;
                         img.alt = assetName;
                         img.style.maxWidth = '100%';
                         img.style.maxHeight = 'calc(90vh - 150px)';
                         img.style.display = 'block';
                         img.style.margin = 'var(--spacing-md) auto 0 auto';
                         modalAssetContent.appendChild(img);
                     }

                     assetPreviewModal.classList.add('visible');
                     // Focus the modal content or a focusable element inside it for accessibility
                     assetPreviewModal.querySelector('.modal-close').focus();
                 }
            });

            // Close modal listeners (re-usable)
            modalCloseButtons.forEach(button => {
                 button.addEventListener('click', (e) => {
                     const modal = e.target.closest('.modal-overlay');
                     if (modal) {
                         modal.classList.remove('visible');
                         // Clear content for asset modal to stop media
                         if (modal.id === 'asset-preview-modal') {
                              modalAssetContent.innerHTML = '';
                         }
                     }
                 });
            });


            // Close modal if clicking outside content (re-usable)
            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                 overlay.addEventListener('click', (e) => {
                     if (e.target === overlay) {
                         overlay.classList.remove('visible');
                         // Clear content for asset modal to stop media
                         if (overlay.id === 'asset-preview-modal') {
                              modalAssetContent.innerHTML = '';
                         }
                     }
                 });
            });


            // Close modal with Escape key (re-usable)
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    document.querySelectorAll('.modal-overlay.visible').forEach(modal => {
                         modal.classList.remove('visible');
                         // Clear content for asset modal to stop media
                         if (modal.id === 'asset-preview-modal') {
                              modalAssetContent.innerHTML = '';
                         }
                    });
                }
            });


            // --- Asset Search (Client-side Filtering) ---
            if (assetSearchInput && assetGrid) {
                 assetSearchInput.addEventListener('input', () => {
                     const searchTerm = assetSearchInput.value.toLowerCase();
                     const items = assetGrid.querySelectorAll('.asset-item');
                     let foundCount = 0;

                     items.forEach(item => {
                         const infoText = item.querySelector('.asset-item-info').textContent.toLowerCase();
                         if (infoText.includes(searchTerm)) {
                             item.style.display = ''; // Show item
                             foundCount++;
                         } else {
                             item.style.display = 'none'; // Hide item
                         }
                     });

                     // Optional: Show a message if no results found
                     const noResultsMessage = assetGrid.querySelector('.no-results');
                     if (foundCount === 0 && !noResultsMessage && placeholderAssets.length > 0) {
                          const p = document.createElement('p');
                          p.classList.add('no-results');
                          p.style.color = 'var(--color-text-secondary)';
                          p.textContent = 'No assets match your search.';
                          assetGrid.appendChild(p);
                     } else if (foundCount > 0 && noResultsMessage) {
                         noResultsMessage.remove();
                     }
                 });
            }

            // --- Calendar Placeholder Interaction ---
             if (calendarGrid) {
                 // Simple rendering for the current month (hardcoded for now)
                 const today = new Date();
                 const year = today.getFullYear();
                 const month = today.getMonth(); // 0-indexed
                 const daysInMonth = new Date(year, month + 1, 0).getDate();
                 const firstDayOfMonth = new Date(year, month, 1).getDay(); // 0 for Sunday, 6 for Saturday

                 // Clear previous days (keep headers)
                 calendarGrid.querySelectorAll('.calendar-day, .calendar-day.empty').forEach((day, index) => {
                     if (index >= 7) day.remove(); // Keep headers
                 });

                 // Add empty days for the start of the month
                 for (let i = 0; i < firstDayOfMonth; i++) {
                     const emptyDay = document.createElement('div');
                     emptyDay.classList.add('calendar-day', 'empty');
                     calendarGrid.appendChild(emptyDay);
                 }

                 // Add days of the month
                 for (let dayNum = 1; dayNum <= daysInMonth; dayNum++) {
                     const dayElement = document.createElement('div');
                     dayElement.classList.add('calendar-day');
                     dayElement.setAttribute('data-date', `${year}-${month + 1}-${dayNum}`); // YYYY-M-D format
                     dayElement.setAttribute('tabindex', '0'); // Make focusable
                     dayElement.setAttribute('role', 'button'); // Indicate interactive

                     dayElement.innerHTML = `<span class="calendar-day-number">${dayNum}</span>`;
                     // Add placeholder content if any (from LS or hardcoded)
                     // Example: if dayNum is 1, 2, 3, 4 add some text
                     if (dayNum === 1) dayElement.innerHTML += '<p>Blog Draft</p>';
                     if (dayNum === 2) dayElement.innerHTML += '<p>IG Story</p>';
                     if (dayNum === 3) dayElement.innerHTML += '<p>TikTok Idea</p>';
                     if (dayNum === 4) dayElement.innerHTML += '<p>Newsletter</p>';


                     calendarGrid.appendChild(dayElement);
                 }

                 // Add click listener to open modal
                 calendarGrid.addEventListener('click', (e) => {
                     const dayElement = e.target.closest('.calendar-day:not(.empty)');
                     if (dayElement) {
                         const date = dayElement.getAttribute('data-date');
                         modalCalendarTitle.textContent = `Content for ${date}`;
                         modalCalendarContent.innerHTML = `
                             <p>Content scheduled for ${date}:</p>
                             <ul>
                                 <li>Placeholder Item 1</li>
                                 <li>Placeholder Item 2</li>
                             </ul>
                             <button class="button button-primary" style="margin-top: var(--spacing-md);">Add Content</button>
                         `; // Replace with actual loaded data later
                         calendarDayModal.classList.add('visible');
                          calendarDayModal.querySelector('.modal-close').focus();
                     }
                 });
             }


            // --- Performance Chart ---
            const ctx = document.getElementById('performanceChart');
            const chartControls = document.getElementById('chartControls');
            const chartTypeSelect = document.getElementById('chartType');
            const chartMetricSelect = document.getElementById('chartMetric');

            let performanceChart;

            const chartData = {
                 engagement: [350, 420, 380, 510, 450, 600],
                 reach: [5000, 6500, 5800, 7200, 6800, 8500],
                 clicks: [50, 65, 55, 80, 70, 95]
            };

            const chartLabels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];

            function createOrUpdateChart(type, metric) {
                if (performanceChart) {
                    performanceChart.destroy();
                }

                const data = {
                    labels: chartLabels,
                    datasets: [{
                        label: `${metric.charAt(0).toUpperCase() + metric.slice(1)}`,
                        data: chartData[metric],
                        backgroundColor: type === 'bar' ? 'var(--color-primary-light)' : 'rgba(76, 175, 80, 0.25)', /* Green with transparency for area */
                        borderColor: 'var(--color-primary)',
                        borderWidth: type === 'line' ? 3 : 1,
                        tension: type === 'line' ? 0.3 : 0,
                        fill: type === 'line' ? 'start' : false,
                        pointBackgroundColor: 'var(--color-primary)',
                        pointBorderColor: 'var(--color-surface)',
                        pointRadius: 5,
                        pointHoverRadius: 7,
                    }]
                };

                const config = {
                    type: type,
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                labels: {
                                    color: "var(--color-text-secondary)", /* Using CSS variable with quotes */
                                    font: {
                                        family: "var(--font-family-inter)", /* Using CSS variable with quotes */
                                        size: 12
                                    }
                                }
                            },
                             tooltip: {
                                 backgroundColor: "var(--color-surface)",
                                 bodyColor: "var(--color-text-primary)",
                                 titleColor: "var(--color-text-primary)",
                                 borderColor: "var(--color-border)",
                                 borderWidth: 1,
                                 cornerRadius: parseInt(getComputedStyle(document.documentElement).getPropertyValue('--border-radius-sm')),
                                 titleFont: { family: "var(--font-family-inter)", weight: 'bold' },
                                 bodyFont: { family: "var(--font-family-inter)" },
                                 padding: 10,
                             }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    color: "var(--color-text-secondary)",
                                     font: { family: "var(--font-family-inter)", size: 10 }
                                },
                                grid: {
                                    color: "var(--color-border)"
                                }
                            },
                            x: {
                                ticks: {
                                    color: "var(--color-text-secondary)",
                                     font: { family: "var(--font-family-inter)", size: 10 }
                                },
                                grid: {
                                     display: false
                                }
                            }
                        },
                         onClick: (e) => {
                             // Toggle controls visibility on chart click
                             chartControls.classList.toggle('active');
                             chartControls.setAttribute('aria-hidden', chartControls.classList.contains('active') ? 'false' : 'true');
                         }
                    }
                };

                performanceChart = new Chart(ctx, config);
            }

            // Initial chart render
            createOrUpdateChart(chartTypeSelect.value, chartMetricSelect.value);

            // Update chart on control change
            chartTypeSelect.addEventListener('change', () => {
                createOrUpdateChart(chartTypeSelect.value, chartMetricSelect.value);
            });

            chartMetricSelect.addEventListener('change', () => {
                 createOrUpdateChart(chartTypeSelect.value, chartMetricSelect.value);
            });

            // Close chart controls when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('#chartControls') && !e.target.closest('#performanceChart')) {
                    chartControls.classList.remove('active');
                    chartControls.setAttribute('aria-hidden', 'true');
                }
            });


        }); // DOMContentLoaded
    </script>
</body>
</html>
