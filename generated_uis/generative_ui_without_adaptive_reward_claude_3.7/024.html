<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Traffic Analytics Dashboard</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0">
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --warning: #f72585;
            --danger: #e63946;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --white: #ffffff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            --border-radius: 8px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f8f9fa;
            color: var(--dark);
            line-height: 1.6;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 240px 1fr;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            background-color: var(--white);
            padding: 1.5rem;
            border-right: 1px solid var(--light-gray);
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
        }

        .logo {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            color: var(--gray);
            text-decoration: none;
            border-radius: var(--border-radius);
            transition: var(--transition);
            gap: 0.75rem;
        }

        .nav-link:hover, .nav-link.active {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        .nav-link.active {
            font-weight: 600;
        }

        /* Main Content Styles */
        .main-content {
            padding: 2rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .page-title {
            font-size: 1.75rem;
            font-weight: 700;
        }

        .date-filter {
            display: flex;
            align-items: center;
            gap: 1rem;
            background-color: var(--white);
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .date-input {
            border: none;
            padding: 0.5rem;
            font-family: inherit;
            color: var(--dark);
            font-size: 0.875rem;
        }

        .date-input:focus {
            outline: none;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .metric-card {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }

        .metric-title {
            color: var(--gray);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .metric-change {
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            gap: 0.25rem;
        }

        .change-positive {
            color: #10b981;
        }

        .change-negative {
            color: var(--danger);
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .chart-container {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            position: relative;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .chart-title {
            font-size: 1.125rem;
            font-weight: 600;
        }

        .chart-controls {
            display: flex;
            gap: 0.5rem;
        }

        .chart-control {
            background-color: var(--light-gray);
            border: none;
            border-radius: 4px;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .chart-control:hover, .chart-control.active {
            background-color: var(--primary);
            color: var(--white);
        }

        .chart-canvas {
            height: 300px;
            width: 100%;
        }

        .data-table-container {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            overflow-x: auto;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .table-title {
            font-size: 1.125rem;
            font-weight: 600;
        }

        .table-search {
            display: flex;
            align-items: center;
            background-color: var(--light-gray);
            border-radius: 4px;
            padding: 0.25rem 0.5rem;
            gap: 0.5rem;
        }

        .search-input {
            border: none;
            background-color: transparent;
            padding: 0.25rem;
            font-family: inherit;
            font-size: 0.875rem;
        }

        .search-input:focus {
            outline: none;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--light-gray);
        }

        th {
            font-weight: 600;
            color: var(--gray);
            font-size: 0.875rem;
        }

        td {
            font-size: 0.875rem;
        }

        tr:last-child td {
            border-bottom: none;
        }

        .table-pagination {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-top: 1rem;
            gap: 0.5rem;
        }

        .page-btn {
            background-color: var(--light-gray);
            border: none;
            border-radius: 4px;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .page-btn:hover, .page-btn.active {
            background-color: var(--primary);
            color: var(--white);
        }

        .floating-controls {
            position: absolute;
            top: 4rem;
            right: 1.5rem;
            background: var(--white);
            padding: 1rem;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            pointer-events: none;
            z-index: 10;
        }

        .floating-controls.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .control-group {
            margin-bottom: 0.75rem;
        }

        .control-group label {
            display: block;
            margin-bottom: 0.25rem;
            font-size: 0.75rem;
            color: var(--gray);
        }

        .control-group input,
        .control-group select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--light-gray);
            border-radius: 4px;
            font-family: inherit;
            font-size: 0.875rem;
        }

        /* Responsive styles */
        @media (max-width: 1024px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .metrics-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }
        }

        @media (max-width: 480px) {
            .main-content {
                padding: 1rem;
            }
            
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="material-symbols-rounded">analytics</span>
                    <span>TrafficInsights</span>
                </div>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link active">
                        <span class="material-symbols-rounded">dashboard</span>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="material-symbols-rounded">bar_chart</span>
                        <span>Analytics</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="material-symbols-rounded">group</span>
                        <span>Audience</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="material-symbols-rounded">bolt</span>
                        <span>Behavior</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="material-symbols-rounded">public</span>
                        <span>Acquisition</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="material-symbols-rounded">settings</span>
                        <span>Settings</span>
                    </a>
                </li>
            </ul>
        </aside>
        <main class="main-content">
            <div class="header">
                <h1 class="page-title">Website Traffic Dashboard</h1>
                <div class="date-filter">
                    <span class="material-symbols-rounded">calendar_today</span>
                    <input type="date" class="date-input" id="start-date" value="2023-01-01">
                    <span>to</span>
                    <input type="date" class="date-input" id="end-date" value="2023-01-31">
                </div>
            </div>
            
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-title">Total Visitors</div>
                    <div class="metric-value">24,582</div>
                    <div class="metric-change change-positive">
                        <span class="material-symbols-rounded">trending_up</span>
                        <span>12.3% vs previous period</span>
                    </div>
                </div>
                <div class="metric-card">
                    <div class="metric-title">Page Views</div>
                    <div class="metric-value">87,429</div>
                    <div class="metric-change change-positive">
                        <span class="material-symbols-rounded">trending_up</span>
                        <span>8.7% vs previous period</span>
                    </div>
                </div>
                <div class="metric-card">
                    <div class="metric-title">Avg. Session Duration</div>
                    <div class="metric-value">3:42</div>
                    <div class="metric-change change-negative">
                        <span class="material-symbols-rounded">trending_down</span>
                        <span>2.1% vs previous period</span>
                    </div>
                </div>
                <div class="metric-card">
                    <div class="metric-title">Bounce Rate</div>
                    <div class="metric-value">42.8%</div>
                    <div class="metric-change change-positive">
                        <span class="material-symbols-rounded">trending_down</span>
                        <span>3.5% vs previous period</span>
                    </div>
                </div>
            </div>
            
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-header">
                        <h2 class="chart-title">Visitors Over Time</h2>
                        <div class="chart-controls">
                            <button class="chart-control active" data-period="day">Day</button>
                            <button class="chart-control" data-period="week">Week</button>
                            <button class="chart-control" data-period="month">Month</button>
                            <button class="chart-control" id="visitorChartSettings">
                                <span class="material-symbols-rounded">settings</span>
                            </button>
                        </div>
                    </div>
                    <canvas id="visitorsChart" class="chart-canvas"></canvas>
                    
                    <!-- Floating controls for visitors chart -->
                    <div class="floating-controls" id="visitorChartControls">
                        <div class="control-group">
                            <label for="chartType1">Chart Type</label>
                            <select id="chartType1">
                                <option value="line">Line</option>
                                <option value="bar">Bar</option>
                                <option value="area">Area</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label for="dataPoints1">Data Points</label>
                            <select id="dataPoints1">
                                <option value="7">Last 7 days</option>
                                <option value="14">Last 14 days</option>
                                <option value="30" selected>Last 30 days</option>
                                <option value="90">Last 90 days</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label for="lineColor1">Line Color</label>
                            <input type="color" id="lineColor1" value="#4361ee">
                        </div>
                        <div class="control-group">
                            <label for="bgColor1">Background Color</label>
                            <input type="color" id="bgColor1" value="#4895ef">
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <h2 class="chart-title">Traffic Sources</h2>
                        <div class="chart-controls">
                            <button class="chart-control" id="sourceChartSettings">
                                <span class="material-symbols-rounded">settings</span>
                            </button>
                        </div>
                    </div>
                    <canvas id="sourcesChart" class="chart-canvas"></canvas>
                    
                    <!-- Floating controls for sources chart -->
                    <div class="floating-controls" id="sourceChartControls">
                        <div class="control-group">
                            <label for="chartType2">Chart Type</label>
                            <select id="chartType2">
                                <option value="pie">Pie</option>
                                <option value="doughnut" selected>Doughnut</option>
                                <option value="polarArea">Polar Area</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label for="legendPosition">Legend Position</label>
                            <select id="legendPosition">
                                <option value="top">Top</option>
                                <option value="right" selected>Right</option>
                                <option value="bottom">Bottom</option>
                                <option value="left">Left</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Color Scheme</label>
                            <div style="display: flex; gap: 5px;">
                                <input type="color" id="color1" value="#4361ee" style="flex: 1;">
                                <input type="color" id="color2" value="#3f37c9" style="flex: 1;">
                                <input type="color" id="color3" value="#4cc9f0" style="flex: 1;">
                                <input type="color" id="color4" value="#f72585" style="flex: 1;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="chart-container">
                <div class="chart-header">
                    <h2 class="chart-title">Page Performance</h2>
                    <div class="chart-controls">
                        <button class="chart-control active" data-metric="views">Views</button>
                        <button class="chart-control" data-metric="time">Time on Page</button>
                        <button class="chart-control" data-metric="bounce">Bounce Rate</button>
                        <button class="chart-control" id="pageChartSettings">
                            <span class="material-symbols-rounded">settings</span>
                        </button>
                    </div>
                </div>
                <canvas id="pagesChart" class="chart-canvas"></canvas>
                
                <!-- Floating controls for pages chart -->
                <div class="floating-controls" id="pageChartControls">
                    <div class="control-group">
                        <label for="chartType3">Chart Type</label>
                        <select id="chartType3">
                            <option value="bar" selected>Bar</option>
                            <option value="horizontalBar">Horizontal Bar</option>
                            <option value="line">Line</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label for="sortBy">Sort By</label>
                        <select id="sortBy">
                            <option value="value">Value (Descending)</option>
                            <option value="valueAsc">Value (Ascending)</option>
                            <option value="name">Name (A-Z)</option>
                            <option value="nameDesc">Name (Z-A)</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label for="maxPages">Max Pages</label>
                        <input type="number" id="maxPages" value="10" min="5" max="20">
                    </div>
                    <div class="control-group">
                        <label for="barColor">Bar Color</label>
                        <input type="color" id="barColor" value="#4361ee">
                    </div>
                </div>
            </div>
            
            <div class="data-table-container">
                <div class="table-header">
                    <h2 class="table-title">Top Pages</h2>
                    <div class="table-search">
                        <span class="material-symbols-rounded">search</span>
                        <input type="text" class="search-input" placeholder="Search pages...">
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Page</th>
                            <th>Views</th>
                            <th>Unique Views</th>
                            <th>Avg. Time</th>
                            <th>Bounce Rate</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>/home</td>
                            <td>12,543</td>
                            <td>9,872</td>
                            <td>2:15</td>
                            <td>35.2%</td>
                        </tr>
                        <tr>
                            <td>/products</td>
                            <td>8,721</td>
                            <td>6,453</td>
                            <td>3:42</td>
                            <td>28.7%</td>
                        </tr>
                        <tr>
                            <td>/blog/top-10-tips</td>
                            <td>6,932</td>
                            <td>5,821</td>
                            <td>4:51</td>
                            <td>22.3%</td>
                        </tr>
                        <tr>
                            <td>/about</td>
                            <td>4,271</td>
                            <td>3,982</td>
                            <td>1:47</td>
                            <td>45.8%</td>
                        </tr>
                        <tr>
                            <td>/contact</td>
                            <td>3,842</td>
                            <td>3,651</td>
                            <td>1:23</td>
                            <td>52.1%</td>
                        </tr>
                        <tr>
                            <td>/blog/case-study</td>
                            <td>3,214</td>
                            <td>2,987</td>
                            <td>5:32</td>
                            <td>18.4%</td>
                        </tr>
                        <tr>
                            <td>/pricing</td>
                            <td>2,983</td>
                            <td>2,765</td>
                            <td>2:58</td>
                            <td>31.2%</td>
                        </tr>
                    </tbody>
                </table>
                <div class="table-pagination">
                    <button class="page-btn">&laquo;</button>
                    <button class="page-btn active">1</button>
                    <button class="page-btn">2</button>
                    <button class="page-btn">3</button>
                    <button class="page-btn">&raquo;</button>
                </div>
            </div>
        </main>
    </div>

    <script type="module">
        import { Chart } from "https://esm.sh/chart.js/auto";

        // Initialize charts when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            initVisitorsChart();
            initSourcesChart();
            initPagesChart();
            setupControlPanels();
        });

        // Visitors Chart
        function initVisitorsChart() {
            const ctx = document.getElementById('visitorsChart').getContext('2d');
            
            const visitorsData = {
                labels: ['Jan 1', 'Jan 2', 'Jan 3', 'Jan 4', 'Jan 5', 'Jan 6', 'Jan 7', 'Jan 8', 'Jan 9', 'Jan 10', 
                         'Jan 11', 'Jan 12', 'Jan 13', 'Jan 14', 'Jan 15', 'Jan 16', 'Jan 17', 'Jan 18', 'Jan 19', 'Jan 20', 
                         'Jan 21', 'Jan 22', 'Jan 23', 'Jan 24', 'Jan 25', 'Jan 26', 'Jan 27', 'Jan 28', 'Jan 29', 'Jan 30', 'Jan 31'],
                datasets: [{
                    label: 'Visitors',
                    data: [820, 932, 901, 934, 1290, 1330, 1320, 1250, 1100, 980, 
                           870, 910, 950, 1020, 1080, 1200, 1300, 1400, 1350, 1250, 
                           1150, 1050, 950, 850, 950, 1050, 1150, 1250, 1350, 1450, 1550],
                    borderColor: '#4361ee',
                    backgroundColor: 'rgba(72, 149, 239, 0.2)',
                    tension: 0.4,
                    fill: true
                }]
            };
            
            window.visitorsChart = new Chart(ctx, {
                type: 'line',
                data: visitorsData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(255, 255, 255, 0.9)',
                            titleColor: '#212529',
                            bodyColor: '#212529',
                            borderColor: '#e9ecef',
                            borderWidth: 1,
                            padding: 10,
                            boxPadding: 5,
                            usePointStyle: true,
                            callbacks: {
                                label: function(context) {
                                    return `Visitors: ${context.parsed.y.toLocaleString()}`;
                                }
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
            
            // Period controls
            document.querySelectorAll('.chart-control[data-period]').forEach(button => {
                button.addEventListener('click', () => {
                    document.querySelectorAll('.chart-control[data-period]').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    button.classList.add('active');
                    
                    // Update chart based on period
                    const period = button.dataset.period;
                    updateVisitorsChartPeriod(period);
                });
            });
        }
        
        function updateVisitorsChartPeriod(period) {
            let labels, data;
            
            switch(period) {
                case 'day':
                    labels = ['Jan 1', 'Jan 2', 'Jan 3', 'Jan 4', 'Jan 5', 'Jan 6', 'Jan 7', 'Jan 8', 'Jan 9', 'Jan 10', 
                             'Jan 11', 'Jan 12', 'Jan 13', 'Jan 14', 'Jan 15', 'Jan 16', 'Jan 17', 'Jan 18', 'Jan 19', 'Jan 20', 
                             'Jan 21', 'Jan 22', 'Jan 23', 'Jan 24', 'Jan 25', 'Jan 26', 'Jan 27', 'Jan 28', 'Jan 29', 'Jan 30', 'Jan 31'];
                    data = [820, 932, 901, 934, 1290, 1330, 1320, 1250, 1100, 980, 
                           870, 910, 950, 1020, 1080, 1200, 1300, 1400, 1350, 1250, 
                           1150, 1050, 950, 850, 950, 1050, 1150, 1250, 1350, 1450, 1550];
                    break;
                case 'week':
                    labels = ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5'];
                    data = [7527, 7410, 8950, 7250, 3450];
                    break;
                case 'month':
                    labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                    data = [24582, 22150, 25840, 27350, 29120, 32450, 35200, 34150, 31250, 28750, 26450, 25200];
                    break;
            }
            
            window.visitorsChart.data.labels = labels;
            window.visitorsChart.data.datasets[0].data = data;
            window.visitorsChart.update();
        }

        // Sources Chart
        function initSourcesChart() {
            const ctx = document.getElementById('sourcesChart').getContext('2d');
            
            window.sourcesChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Organic Search', 'Direct', 'Social Media', 'Referral', 'Email'],
                    datasets: [{
                        data: [45, 25, 15, 10, 5],
                        backgroundColor: [
                            '#4361ee',
                            '#3f37c9',
                            '#4cc9f0',
                            '#f72585',
                            '#6c757d'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                boxWidth: 15,
                                padding: 15
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.9)',
                            titleColor: '#212529',
                            bodyColor: '#212529',
                            borderColor: '#e9ecef',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.parsed}%`;
                                }
                            }
                        }
                    },
                    cutout: '65%'
                }
            });
        }

        // Pages Chart
        function initPagesChart() {
            const ctx = document.getElementById('pagesChart').getContext('2d');
            
            const pagesData = {
                labels: ['/home', '/products', '/blog/top-10-tips', '/about', '/contact', '/blog/case-study', '/pricing'],
                datasets: [{
                    label: 'Page Views',
                    data: [12543, 8721, 6932, 4271, 3842, 3214, 2983],
                    backgroundColor: '#4361ee',
                    borderWidth: 0,
                    borderRadius: 4
                }]
            };
            
            window.pagesChart = new Chart(ctx, {
                type: 'bar',
                data: pagesData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.9)',
                            titleColor: '#212529',
                            bodyColor: '#212529',
                            borderColor: '#e9ecef',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return `Views: ${context.parsed.x.toLocaleString()}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
            
            // Metric controls
            document.querySelectorAll('.chart-control[data-metric]').forEach(button => {
                button.addEventListener('click', () => {
                    document.querySelectorAll('.chart-control[data-metric]').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    button.classList.add('active');
                    
                    // Update chart based on metric
                    const metric = button.dataset.metric;
                    updatePagesChartMetric(metric);
                });
            });
        }
        
        function updatePagesChartMetric(metric) {
            let label, data, color;
            
            switch(metric) {
                case 'views':
                    label = 'Page Views';
                    data = [12543, 8721, 6932, 4271, 3842, 3214, 2983];
                    color = '#4361ee';
                    break;
                case 'time':
                    label = 'Avg. Time on Page (seconds)';
                    data = [135, 222, 291, 107, 83, 332, 178];
                    color = '#4cc9f0';
                    break;
                case 'bounce':
                    label = 'Bounce Rate (%)';
                    data = [35.2, 28.7, 22.3, 45.8, 52.1, 18.4, 31.2];
                    color = '#f72585';
                    break;
            }
            
            window.pagesChart.data.datasets[0].label = label;
            window.pagesChart.data.datasets[0].data = data;
            window.pagesChart.data.datasets[0].backgroundColor = color;
            window.pagesChart.update();
        }
        
        // Setup control panels
        function setupControlPanels() {
            // Visitor chart settings
            const visitorChartSettings = document.getElementById('visitorChartSettings');
            const visitorChartControls = document.getElementById('visitorChartControls');
            
            visitorChartSettings.addEventListener('click', () => {
                visitorChartControls.classList.toggle('active');
                sourceChartControls.classList.remove('active');
                pageChartControls.classList.remove('active');
            });
            
            // Source chart settings
            const sourceChartSettings = document.getElementById('sourceChartSettings');
            const sourceChartControls = document.getElementById('sourceChartControls');
            
            sourceChartSettings.addEventListener('click', () => {
                sourceChartControls.classList.toggle('active');
                visitorChartControls.classList.remove('active');
                pageChartControls.classList.remove('active');
            });
            
            // Page chart settings
            const pageChartSettings = document.getElementById('pageChartSettings');
            const pageChartControls = document.getElementById('pageChartControls');
            
            pageChartSettings.addEventListener('click', () => {
                pageChartControls.classList.toggle('active');
                visitorChartControls.classList.remove('active');
                sourceChartControls.classList.remove('active');
            });
            
            // Close panels when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.floating-controls') && 
                    !e.target.closest('#visitorChartSettings') &&
                    !e.target.closest('#sourceChartSettings') &&
                    !e.target.closest('#pageChartSettings')) {
                    visitorChartControls.classList.remove('active');
                    sourceChartControls.classList.remove('active');
                    pageChartControls.classList.remove('active');
                }
            });
            
            // Visitor chart controls
            document.getElementById('chartType1').addEventListener('change', (e) => {
                const type = e.target.value;
                if (type === 'line' || type === 'area') {
                    window.visitorsChart.config.type = 'line';
                    window.visitorsChart.data.datasets[0].fill = type === 'area';
                } else {
                    window.visitorsChart.config.type = type;
                }
                window.visitorsChart.update();
            });
            
            document.getElementById('dataPoints1').addEventListener('change', (e) => {
                const days = parseInt(e.target.value);
                const labels = window.visitorsChart.data.labels;
                const data = window.visitorsChart.data.datasets[0].data;
                
                window.visitorsChart.data.labels = labels.slice(-days);
                window.visitorsChart.data.datasets[0].data = data.slice(-days);
                window.visitorsChart.update();
            });
            
            document.getElementById('lineColor1').addEventListener('change', (e) => {
                window.visitorsChart.data.datasets[0].borderColor = e.target.value;
                window.visitorsChart.update();
            });
            
            document.getElementById('bgColor1').addEventListener('change', (e) => {
                const color = e.target.value;
                window.visitorsChart.data.datasets[0].backgroundColor = `${color}33`; // Add transparency
                window.visitorsChart.update();
            });
            
            // Source chart controls
            document.getElementById('chartType2').addEventListener('change', (e) => {
                window.sourcesChart.config.type = e.target.value;
                window.sourcesChart.update();
            });
            
            document.getElementById('legendPosition').addEventListener('change', (e) => {
                window.sourcesChart.options.plugins.legend.position = e.target.value;
                window.sourcesChart.update();
            });
            
            const colorInputs = [
                document.getElementById('color1'),
                document.getElementById('color2'),
                document.getElementById('color3'),
                document.getElementById('color4')
            ];
            
            colorInputs.forEach((input, index) => {
                input.addEventListener('change', () => {
                    const colors = colorInputs.map(input => input.value);
                    colors.push('#6c757d'); // Add the fifth color
                    window.sourcesChart.data.datasets[0].backgroundColor = colors;
                    window.sourcesChart.update();
                });
            });
            
            // Page chart controls
            document.getElementById('chartType3').addEventListener('change', (e) => {
                const type = e.target.value;
                window.pagesChart.config.type = type === 'horizontalBar' ? 'bar' : type;
                window.pagesChart.options.indexAxis = type === 'horizontalBar' ? 'y' : 'x';
                window.pagesChart.update();
            });
            
            document.getElementById('sortBy').addEventListener('change', (e) => {
                const sortBy = e.target.value;
                const labels = [...window.pagesChart.data.labels];
                const data = [...window.pagesChart.data.datasets[0].data];
                
                // Create pairs for sorting
                const pairs = labels.map((label, i) => ({ label, value: data[i] }));
                
                // Sort based on selection
                switch(sortBy) {
                    case 'value':
                        pairs.sort((a, b) => b.value - a.value);
                        break;
                    case 'valueAsc':
                        pairs.sort((a, b) => a.value - b.value);
                        break;
                    case 'name':
                        pairs.sort((a, b) => a.label.localeCompare(b.label));
                        break;
                    case 'nameDesc':
                        pairs.sort((a, b) => b.label.localeCompare(a.label));
                        break;
                }
                
                // Update chart with sorted data
                window.pagesChart.data.labels = pairs.map(pair => pair.label);
                window.pagesChart.data.datasets[0].data = pairs.map(pair => pair.value);
                window.pagesChart.update();
            });
            
            document.getElementById('maxPages').addEventListener('change', (e) => {
                const max = parseInt(e.target.value);
                const labels = window.pagesChart.data.labels;
                const data = window.pagesChart.data.datasets[0].data;
                
                // Create pairs for sorting by value (descending)
                const pairs = labels.map((label, i) => ({ label, value: data[i] }));
                pairs.sort((a, b) => b.value - a.value);
                
                // Take only the top N items
                const topPairs = pairs.slice(0, max);
                
                // Update chart
                window.pagesChart.data.labels = topPairs.map(pair => pair.label);
                window.pagesChart.data.datasets[0].data = topPairs.map(pair => pair.value);
                window.pagesChart.update();
            });
            
            document.getElementById('barColor').addEventListener('change', (e) => {
                window.pagesChart.data.datasets[0].backgroundColor = e.target.value;
                window.pagesChart.update();
            });
            
            // Date range picker
            const startDate = document.getElementById('start-date');
            const endDate = document.getElementById('end-date');
            
            [startDate, endDate].forEach(input => {
                input.addEventListener('change', () => {
                    // In a real application, this would fetch new data for the selected date range
                    // For this demo, we'll just show an alert
                    alert(`Date range updated: ${startDate.value} to ${endDate.value}`);
                });
            });
            
            // Table search
            const searchInput = document.querySelector('.search-input');
            const tableRows = document.querySelectorAll('tbody tr');
            
            searchInput.addEventListener('input', () => {
                const query = searchInput.value.toLowerCase();
                
                tableRows.forEach(row => {
                    const pageName = row.querySelector('td').textContent.toLowerCase();
                    if (pageName.includes(query)) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });
            
            // Pagination buttons
            const pageButtons = document.querySelectorAll('.page-btn');
            
            pageButtons.forEach(button => {
                button.addEventListener('click', () => {
                    if (!button.classList.contains('active') && !button.textContent.includes('«') && !button.textContent.includes('»')) {
                        pageButtons.forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');
                        
                        // In a real application, this would load the corresponding page of data
                        // For this demo, we'll just show an alert
                        alert(`Navigated to page ${button.textContent}`);
                    }
                });
            });
        }
    </script>
</body>
</html>