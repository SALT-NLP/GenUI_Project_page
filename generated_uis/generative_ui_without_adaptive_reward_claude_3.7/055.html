<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Segmentation Wizard</title>
    <style>
        :root {
            --primary: #4a6fdc;
            --primary-light: #7a93e6;
            --primary-dark: #3955b0;
            --secondary: #ff7d45;
            --secondary-light: #ff9e75;
            --secondary-dark: #e66226;
            --tertiary: #2cc3a0;
            --text-dark: #333333;
            --text-light: #666666;
            --background: #f8f9fc;
            --white: #ffffff;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', Oxygen, Ubuntu, Cantarell, 'Open Sans', sans-serif;
            background-color: var(--background);
            color: var(--text-dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            padding: 20px 0;
            background-color: var(--white);
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        h1, h2, h3, h4 {
            color: var(--text-dark);
            margin-bottom: 0.5em;
        }

        h1 {
            font-size: 2.2rem;
            font-weight: 700;
        }

        h2 {
            font-size: 1.8rem;
            font-weight: 600;
        }

        h3 {
            font-size: 1.4rem;
            font-weight: 600;
        }

        p {
            margin-bottom: 1em;
            color: var(--text-light);
        }

        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: var(--primary);
            color: var(--white);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            text-align: center;
            transition: var(--transition);
            text-decoration: none;
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background-color: var(--secondary);
        }

        .btn-secondary:hover {
            background-color: var(--secondary-dark);
        }

        .btn-tertiary {
            background-color: var(--tertiary);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: var(--white);
        }

        .wizard-container {
            background-color: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .wizard-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-container {
            width: 100%;
            margin: 20px 0;
            position: relative;
        }

        .progress-bar {
            display: flex;
            justify-content: space-between;
            position: relative;
            margin-bottom: 30px;
            z-index: 1;
        }

        .progress-bar::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            transform: translateY(-50%);
            height: 4px;
            width: 100%;
            background-color: var(--gray-200);
            z-index: -1;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            transform: translateY(-50%);
            height: 4px;
            width: 0%;
            background-color: var(--primary);
            z-index: -1;
            transition: var(--transition);
        }

        .progress-step {
            width: 30px;
            height: 30px;
            background-color: var(--white);
            border: 3px solid var(--gray-200);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: 600;
            color: var(--gray-400);
            transition: var(--transition);
        }

        .progress-step.active {
            border-color: var(--primary);
            color: var(--primary);
        }

        .progress-step.completed {
            border-color: var(--primary);
            background-color: var(--primary);
            color: var(--white);
        }

        .step-label {
            position: absolute;
            top: 40px;
            transform: translateX(-50%);
            font-size: 0.85rem;
            color: var(--text-light);
            white-space: nowrap;
        }

        .wizard-content {
            padding: 30px;
        }

        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .wizard-footer {
            padding: 20px;
            border-top: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
        }

        .file-upload {
            border: 2px dashed var(--gray-300);
            border-radius: var(--border-radius);
            padding: 40px;
            text-align: center;
            transition: var(--transition);
            margin-bottom: 20px;
            cursor: pointer;
        }

        .file-upload:hover {
            border-color: var(--primary);
        }

        .file-upload input[type="file"] {
            display: none;
        }

        .file-upload-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .data-preview {
            width: 100%;
            overflow-x: auto;
            margin-top: 20px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 10px;
            border: 1px solid var(--gray-200);
            text-align: left;
        }

        .data-table th {
            background-color: var(--gray-100);
            font-weight: 600;
        }

        .data-table tr:nth-child(even) {
            background-color: var(--gray-100);
        }

        .variable-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .variable-item {
            background-color: var(--gray-100);
            border-radius: var(--border-radius);
            padding: 15px;
            transition: var(--transition);
        }

        .variable-item:hover {
            box-shadow: var(--shadow);
        }

        .variable-item label {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .variable-item input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
        }

        .variable-category {
            font-size: 0.85rem;
            color: var(--primary);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .variable-description {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-top: 5px;
        }

        .cluster-controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }

        .slider-container {
            width: 100%;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.85rem;
            color: var(--text-light);
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: var(--gray-200);
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }

        .chart-container {
            height: 300px;
            margin: 30px 0;
            position: relative;
        }

        .segment-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .segment-card {
            background-color: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            transition: var(--transition);
        }

        .segment-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .segment-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .segment-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 15px;
            color: var(--white);
        }

        .segment-stats {
            margin-top: 15px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .stat-label {
            color: var(--text-light);
        }

        .stat-value {
            font-weight: 600;
        }

        .segment-strategies {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--gray-200);
        }

        .strategy-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .strategy-icon {
            color: var(--tertiary);
            margin-right: 10px;
            font-size: 1.1rem;
        }

        .info-box {
            background-color: var(--gray-100);
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }

        .info-box-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--primary);
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: pointer;
        }

        .tooltip-icon {
            color: var(--gray-400);
            font-size: 1rem;
            margin-left: 5px;
        }

        .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: var(--text-dark);
            color: var(--white);
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .loading-container {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 300px;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--gray-200);
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .variable-list {
                grid-template-columns: 1fr;
            }

            .segment-container {
                grid-template-columns: 1fr;
            }

            .wizard-footer {
                flex-direction: column;
                gap: 10px;
            }

            .wizard-footer .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Customer Segmentation Wizard</h1>
            <p>A step-by-step guide to segment your e-commerce customers and develop targeted marketing strategies</p>
        </div>
    </header>

    <div class="container">
        <div class="wizard-container">
            <div class="wizard-header">
                <h2>Segmentation Process</h2>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-step active" id="step1">1
                            <span class="step-label">Data Upload</span>
                        </div>
                        <div class="progress-step" id="step2">2
                            <span class="step-label">Variable Selection</span>
                        </div>
                        <div class="progress-step" id="step3">3
                            <span class="step-label">Cluster Determination</span>
                        </div>
                        <div class="progress-step" id="step4">4
                            <span class="step-label">Run Segmentation</span>
                        </div>
                        <div class="progress-step" id="step5">5
                            <span class="step-label">Interpret Results</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="wizard-content">
                <!-- Step 1: Data Upload -->
                <div class="step-content active" id="step1-content">
                    <h3>Upload Your Customer Data</h3>
                    <p>Upload your e-commerce customer data to begin the segmentation process. We support CSV, Excel, and JSON formats.</p>
                    
                    <div class="info-box">
                        <div class="info-box-title">Data Requirements</div>
                        <p>Your data should include customer IDs, purchase history, demographics, and behavioral metrics. Each row should represent a unique customer, and each column should represent a variable.</p>
                    </div>

                    <label class="file-upload" for="data-file">
                        <div class="file-upload-icon">📤</div>
                        <h3>Drop your file here</h3>
                        <p>or click to browse your files</p>
                        <p class="file-types">Supported formats: .csv, .xlsx, .json</p>
                        <input type="file" id="data-file" accept=".csv,.xlsx,.json">
                    </label>

                    <div class="data-preview">
                        <h3>Data Preview</h3>
                        <p>First 5 rows of your dataset will appear here after upload.</p>
                        <div class="data-table-container">
                            <table class="data-table" id="preview-table">
                                <thead>
                                    <tr>
                                        <th>Customer ID</th>
                                        <th>Age</th>
                                        <th>Gender</th>
                                        <th>Purchase Frequency</th>
                                        <th>Avg Order Value</th>
                                        <th>Total Spend</th>
                                        <th>Product Categories</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1001</td>
                                        <td>34</td>
                                        <td>F</td>
                                        <td>12</td>
                                        <td>$85.50</td>
                                        <td>$1,026.00</td>
                                        <td>Clothing, Accessories</td>
                                    </tr>
                                    <tr>
                                        <td>1002</td>
                                        <td>45</td>
                                        <td>M</td>
                                        <td>4</td>
                                        <td>$210.25</td>
                                        <td>$841.00</td>
                                        <td>Electronics</td>
                                    </tr>
                                    <tr>
                                        <td>1003</td>
                                        <td>28</td>
                                        <td>F</td>
                                        <td>8</td>
                                        <td>$65.75</td>
                                        <td>$526.00</td>
                                        <td>Beauty, Clothing</td>
                                    </tr>
                                    <tr>
                                        <td>1004</td>
                                        <td>52</td>
                                        <td>M</td>
                                        <td>2</td>
                                        <td>$350.00</td>
                                        <td>$700.00</td>
                                        <td>Home, Garden</td>
                                    </tr>
                                    <tr>
                                        <td>1005</td>
                                        <td>31</td>
                                        <td>F</td>
                                        <td>20</td>
                                        <td>$45.25</td>
                                        <td>$905.00</td>
                                        <td>Beauty, Clothing, Accessories</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Variable Selection -->
                <div class="step-content" id="step2-content">
                    <h3>Select Variables for Segmentation</h3>
                    <p>Choose the variables that will be used to segment your customers. Select variables that you believe will differentiate your customer groups.</p>

                    <div class="info-box">
                        <div class="info-box-title">Variable Selection Tips</div>
                        <p>Choose a mix of demographic, behavioral, and transactional variables. Avoid selecting too many variables (5-10 is ideal) and ensure they are not highly correlated with each other.</p>
                    </div>

                    <div class="variable-list">
                        <div class="variable-item">
                            <div class="variable-category">Demographics</div>
                            <label>
                                <input type="checkbox" name="variables" value="age" checked>
                                Age
                            </label>
                            <div class="variable-description">Customer age in years</div>
                        </div>
                        <div class="variable-item">
                            <div class="variable-category">Demographics</div>
                            <label>
                                <input type="checkbox" name="variables" value="gender" checked>
                                Gender
                            </label>
                            <div class="variable-description">Customer gender (M/F/Other)</div>
                        </div>
                        <div class="variable-item">
                            <div class="variable-category">Demographics</div>
                            <label>
                                <input type="checkbox" name="variables" value="location">
                                Location
                            </label>
                            <div class="variable-description">Customer's geographic location</div>
                        </div>
                        <div class="variable-item">
                            <div class="variable-category">Purchase Behavior</div>
                            <label>
                                <input type="checkbox" name="variables" value="purchase_frequency" checked>
                                Purchase Frequency
                            </label>
                            <div class="variable-description">Number of purchases in the last year</div>
                        </div>
                        <div class="variable-item">
                            <div class="variable-category">Purchase Behavior</div>
                            <label>
                                <input type="checkbox" name="variables" value="avg_order_value" checked>
                                Average Order Value
                            </label>
                            <div class="variable-description">Average amount spent per order</div>
                        </div>
                        <div class="variable-item">
                            <div class="variable-category">Purchase Behavior</div>
                            <label>
                                <input type="checkbox" name="variables" value="total_spend" checked>
                                Total Spend
                            </label>
                            <div class="variable-description">Total amount spent in the last year</div>
                        </div>
                        <div class="variable-item">
                            <div class="variable-category">Product Preferences</div>
                            <label>
                                <input type="checkbox" name="variables" value="product_categories">
                                Product Categories
                            </label>
                            <div class="variable-description">Types of products purchased</div>
                        </div>
                        <div class="variable-item">
                            <div class="variable-category">Product Preferences</div>
                            <label>
                                <input type="checkbox" name="variables" value="brand_affinity">
                                Brand Affinity
                            </label>
                            <div class="variable-description">Preferred brands</div>
                        </div>
                        <div class="variable-item">
                            <div class="variable-category">Engagement</div>
                            <label>
                                <input type="checkbox" name="variables" value="email_engagement">
                                Email Engagement
                            </label>
                            <div class="variable-description">Email open and click rates</div>
                        </div>
                        <div class="variable-item">
                            <div class="variable-category">Engagement</div>
                            <label>
                                <input type="checkbox" name="variables" value="website_visits">
                                Website Visits
                            </label>
                            <div class="variable-description">Number of website visits</div>
                        </div>
                        <div class="variable-item">
                            <div class="variable-category">Customer Value</div>
                            <label>
                                <input type="checkbox" name="variables" value="recency">
                                Recency
                            </label>
                            <div class="variable-description">Days since last purchase</div>
                        </div>
                        <div class="variable-item">
                            <div class="variable-category">Customer Value</div>
                            <label>
                                <input type="checkbox" name="variables" value="clv">
                                Customer Lifetime Value
                            </label>
                            <div class="variable-description">Predicted future value</div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Cluster Determination -->
                <div class="step-content" id="step3-content">
                    <h3>Determine Optimal Number of Clusters</h3>
                    <p>Use these tools to determine the optimal number of customer segments for your data.</p>

                    <div class="info-box">
                        <div class="info-box-title">Finding the Right Number of Segments</div>
                        <p>The ideal number of segments balances statistical validity with business usability. Use the Elbow Method and Silhouette Score to guide your decision, but also consider how actionable each segment will be for your marketing strategies.</p>
                    </div>

                    <div class="cluster-controls">
                        <div>
                            <h4>Number of Clusters
                                <span class="tooltip">
                                    <span class="tooltip-icon">ⓘ</span>
                                    <span class="tooltip-text">Choose between 2-10 clusters. The optimal number will be highlighted based on statistical methods.</span>
                                </span>
                            </h4>
                            <div class="slider-container">
                                <input type="range" id="cluster-slider" min="2" max="10" value="5">
                                <div class="slider-labels">
                                    <span>2</span>
                                    <span>3</span>
                                    <span>4</span>
                                    <span>5</span>
                                    <span>6</span>
                                    <span>7</span>
                                    <span>8</span>
                                    <span>9</span>
                                    <span>10</span>
                                </div>
                            </div>
                            <p>Selected clusters: <span id="cluster-value">5</span></p>
                        </div>

                        <div class="chart-container">
                            <h4>Elbow Method
                                <span class="tooltip">
                                    <span class="tooltip-icon">ⓘ</span>
                                    <span class="tooltip-text">The "elbow" in the graph suggests the optimal number of clusters. It's where adding more clusters doesn't significantly reduce the within-cluster sum of squares.</span>
                                </span>
                            </h4>
                            <canvas id="elbowChart"></canvas>
                        </div>

                        <div class="chart-container">
                            <h4>Silhouette Score
                                <span class="tooltip">
                                    <span class="tooltip-icon">ⓘ</span>
                                    <span class="tooltip-text">Higher silhouette scores indicate better-defined clusters. Look for the peak value to determine the optimal number of clusters.</span>
                                </span>
                            </h4>
                            <canvas id="silhouetteChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Run Segmentation -->
                <div class="step-content" id="step4-content">
                    <h3>Run Segmentation Analysis</h3>
                    <p>Execute the clustering algorithm using your selected variables and optimal number of clusters.</p>

                    <div class="info-box">
                        <div class="info-box-title">About K-Means Clustering</div>
                        <p>We'll use K-means clustering, a popular algorithm that groups customers based on the similarity of their selected variables. The algorithm will create the number of segments you specified in the previous step.</p>
                    </div>

                    <div class="cluster-controls">
                        <h4>Algorithm Settings</h4>
                        <div class="variable-item">
                            <label>
                                <input type="checkbox" name="normalize" checked>
                                Normalize Data
                                <span class="tooltip">
                                    <span class="tooltip-icon">ⓘ</span>
                                    <span class="tooltip-text">Recommended. Scales all variables to have similar ranges, preventing variables with larger scales from dominating the clustering.</span>
                                </span>
                            </label>
                        </div>
                        <div class="variable-item">
                            <label>
                                <input type="checkbox" name="remove_outliers">
                                Remove Outliers
                                <span class="tooltip">
                                    <span class="tooltip-icon">ⓘ</span>
                                    <span class="tooltip-text">Removes extreme values that might skew your segments. Use with caution as outliers might represent valuable niche customers.</span>
                                </span>
                            </label>
                        </div>

                        <button id="run-segmentation" class="btn btn-secondary">Run Segmentation</button>
                    </div>

                    <div class="loading-container" id="loading-container">
                        <div class="loading-spinner"></div>
                        <p>Processing your data and creating customer segments...</p>
                        <p>This may take a few minutes for large datasets.</p>
                    </div>
                </div>

                <!-- Step 5: Interpret Results -->
                <div class="step-content" id="step5-content">
                    <h3>Segmentation Results</h3>
                    <p>Review your customer segments and develop targeted marketing strategies for each group.</p>

                    <div class="chart-container">
                        <h4>Customer Segment Distribution</h4>
                        <canvas id="segmentDistributionChart"></canvas>
                    </div>

                    <div class="chart-container">
                        <h4>Segment Characteristics Comparison</h4>
                        <canvas id="segmentComparisonChart"></canvas>
                    </div>

                    <h3>Segment Profiles & Marketing Strategies</h3>
                    <div class="segment-container">
                        <div class="segment-card">
                            <div class="segment-header">
                                <div class="segment-icon" style="background-color: #4a6fdc;">💎</div>
                                <div>
                                    <h4>High-Value Loyalists</h4>
                                    <p>18% of customers</p>
                                </div>
                            </div>
                            <p>Frequent shoppers with high average order values who purchase across multiple categories.</p>
                            <div class="segment-stats">
                                <div class="stat-item">
                                    <span class="stat-label">Avg. Purchase Frequency:</span>
                                    <span class="stat-value">15 orders/year</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Avg. Order Value:</span>
                                    <span class="stat-value">$120</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Total Annual Spend:</span>
                                    <span class="stat-value">$1,800</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Primary Categories:</span>
                                    <span class="stat-value">Multiple</span>
                                </div>
                            </div>
                            <div class="segment-strategies">
                                <h4>Recommended Strategies:</h4>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Exclusive VIP program with early access to new products</span>
                                </div>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Personalized recommendations based on purchase history</span>
                                </div>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Premium customer service with dedicated support</span>
                                </div>
                            </div>
                        </div>

                        <div class="segment-card">
                            <div class="segment-header">
                                <div class="segment-icon" style="background-color: #2cc3a0;">🛒</div>
                                <div>
                                    <h4>Potential Loyalists</h4>
                                    <p>24% of customers</p>
                                </div>
                            </div>
                            <p>Moderate purchase frequency and order values with growth potential.</p>
                            <div class="segment-stats">
                                <div class="stat-item">
                                    <span class="stat-label">Avg. Purchase Frequency:</span>
                                    <span class="stat-value">8 orders/year</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Avg. Order Value:</span>
                                    <span class="stat-value">$75</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Total Annual Spend:</span>
                                    <span class="stat-value">$600</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Primary Categories:</span>
                                    <span class="stat-value">Clothing, Beauty</span>
                                </div>
                            </div>
                            <div class="segment-strategies">
                                <h4>Recommended Strategies:</h4>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Loyalty program with tiered rewards to encourage more purchases</span>
                                </div>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Cross-selling campaigns for complementary products</span>
                                </div>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Targeted email campaigns with product recommendations</span>
                                </div>
                            </div>
                        </div>

                        <div class="segment-card">
                            <div class="segment-header">
                                <div class="segment-icon" style="background-color: #ff7d45;">🔍</div>
                                <div>
                                    <h4>Occasional Shoppers</h4>
                                    <p>32% of customers</p>
                                </div>
                            </div>
                            <p>Infrequent purchases but decent order values when they do buy.</p>
                            <div class="segment-stats">
                                <div class="stat-item">
                                    <span class="stat-label">Avg. Purchase Frequency:</span>
                                    <span class="stat-value">3 orders/year</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Avg. Order Value:</span>
                                    <span class="stat-value">$95</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Total Annual Spend:</span>
                                    <span class="stat-value">$285</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Primary Categories:</span>
                                    <span class="stat-value">Electronics, Home</span>
                                </div>
                            </div>
                            <div class="segment-strategies">
                                <h4>Recommended Strategies:</h4>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Re-engagement campaigns with special offers</span>
                                </div>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Content marketing focused on product value and durability</span>
                                </div>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Seasonal promotions timed to their typical purchase patterns</span>
                                </div>
                            </div>
                        </div>

                        <div class="segment-card">
                            <div class="segment-header">
                                <div class="segment-icon" style="background-color: #9c59b6;">🌱</div>
                                <div>
                                    <h4>New Customers</h4>
                                    <p>15% of customers</p>
                                </div>
                            </div>
                            <p>Recent first-time buyers with unknown purchase patterns.</p>
                            <div class="segment-stats">
                                <div class="stat-item">
                                    <span class="stat-label">Avg. Purchase Frequency:</span>
                                    <span class="stat-value">1 order/year</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Avg. Order Value:</span>
                                    <span class="stat-value">$65</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Total Annual Spend:</span>
                                    <span class="stat-value">$65</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Primary Categories:</span>
                                    <span class="stat-value">Various</span>
                                </div>
                            </div>
                            <div class="segment-strategies">
                                <h4>Recommended Strategies:</h4>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Welcome series emails with product education</span>
                                </div>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>First-time buyer special offers to encourage second purchase</span>
                                </div>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Feedback surveys to understand preferences and improve experience</span>
                                </div>
                            </div>
                        </div>

                        <div class="segment-card">
                            <div class="segment-header">
                                <div class="segment-icon" style="background-color: #e74c3c;">⚠️</div>
                                <div>
                                    <h4>At-Risk Customers</h4>
                                    <p>11% of customers</p>
                                </div>
                            </div>
                            <p>Previously active customers who haven't purchased recently.</p>
                            <div class="segment-stats">
                                <div class="stat-item">
                                    <span class="stat-label">Avg. Purchase Frequency:</span>
                                    <span class="stat-value">6 orders/year (historical)</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Avg. Order Value:</span>
                                    <span class="stat-value">$85</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Days Since Last Purchase:</span>
                                    <span class="stat-value">180+</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Primary Categories:</span>
                                    <span class="stat-value">Clothing, Accessories</span>
                                </div>
                            </div>
                            <div class="segment-strategies">
                                <h4>Recommended Strategies:</h4>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Win-back campaigns with personalized offers</span>
                                </div>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Surveys to understand reasons for decreased engagement</span>
                                </div>
                                <div class="strategy-item">
                                    <span class="strategy-icon">✓</span>
                                    <span>Special discount on previously purchased categories</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="wizard-footer">
                <button id="prev-step" class="btn btn-outline" disabled>Previous Step</button>
                <button id="next-step" class="btn">Next Step</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { Chart } from "https://esm.sh/chart.js/auto";

        // Navigation logic
        const steps = ['step1', 'step2', 'step3', 'step4', 'step5'];
        let currentStep = 0;

        const prevButton = document.getElementById('prev-step');
        const nextButton = document.getElementById('next-step');

        function updateProgressBar() {
            const progressBar = document.querySelector('.progress-bar');
            const progressPercentage = (currentStep / (steps.length - 1)) * 100;
            progressBar.style.setProperty('--progress', `${progressPercentage}%`);

            for (let i = 0; i < steps.length; i++) {
                const stepElement = document.getElementById(steps[i]);
                if (i < currentStep) {
                    stepElement.classList.remove('active');
                    stepElement.classList.add('completed');
                } else if (i === currentStep) {
                    stepElement.classList.add('active');
                    stepElement.classList.remove('completed');
                } else {
                    stepElement.classList.remove('active');
                    stepElement.classList.remove('completed');
                }
            }
        }

        function showStep(stepIndex) {
            document.querySelectorAll('.step-content').forEach(step => {
                step.classList.remove('active');
            });
            document.getElementById(`${steps[stepIndex]}-content`).classList.add('active');

            prevButton.disabled = stepIndex === 0;
            nextButton.textContent = stepIndex === steps.length - 1 ? 'Finish' : 'Next Step';

            currentStep = stepIndex;
            updateProgressBar();
        }

        prevButton.addEventListener('click', () => {
            if (currentStep > 0) {
                showStep(currentStep - 1);
            }
        });

        nextButton.addEventListener('click', () => {
            if (currentStep < steps.length - 1) {
                showStep(currentStep + 1);
            } else {
                alert('Segmentation process complete! You can now implement your marketing strategies based on the identified segments.');
            }
        });

        // File upload handling
        const fileUpload = document.getElementById('data-file');
        fileUpload.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                // In a real implementation, we would process the file here
                // For this demo, we'll just show the sample data
                alert(`File "${file.name}" uploaded successfully!`);
            }
        });

        // Drag and drop functionality
        const dropArea = document.querySelector('.file-upload');
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
            dropArea.style.borderColor = 'var(--primary)';
            dropArea.style.backgroundColor = 'var(--gray-100)';
        }

        function unhighlight() {
            dropArea.style.borderColor = 'var(--gray-300)';
            dropArea.style.backgroundColor = 'var(--white)';
        }

        dropArea.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const file = dt.files[0];
            
            if (file) {
                fileUpload.files = dt.files;
                alert(`File "${file.name}" uploaded successfully!`);
            }
        }

        // Cluster slider
        const clusterSlider = document.getElementById('cluster-slider');
        const clusterValue = document.getElementById('cluster-value');
        
        clusterSlider.addEventListener('input', () => {
            clusterValue.textContent = clusterSlider.value;
            updateCharts();
        });

        // Run segmentation button
        const runSegmentationBtn = document.getElementById('run-segmentation');
        const loadingContainer = document.getElementById('loading-container');
        
        runSegmentationBtn.addEventListener('click', () => {
            loadingContainer.style.display = 'flex';
            runSegmentationBtn.disabled = true;
            
            // Simulate processing time
            setTimeout(() => {
                loadingContainer.style.display = 'none';
                runSegmentationBtn.disabled = false;
                showStep(currentStep + 1);
            }, 3000);
        });

        // Charts
        function createElbowChart() {
            const ctx = document.getElementById('elbowChart').getContext('2d');
            
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [2, 3, 4, 5, 6, 7, 8, 9, 10],
                    datasets: [{
                        label: 'Within-Cluster Sum of Squares',
                        data: [280, 200, 150, 120, 105, 95, 90, 88, 85],
                        borderColor: 'var(--primary)',
                        backgroundColor: 'rgba(74, 111, 220, 0.1)',
                        tension: 0.3,
                        pointRadius: 5,
                        pointBackgroundColor: 'var(--primary)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: 'Within-Cluster Sum of Squares'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Number of Clusters'
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return `${context[0].label} Clusters`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function createSilhouetteChart() {
            const ctx = document.getElementById('silhouetteChart').getContext('2d');
            
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [2, 3, 4, 5, 6, 7, 8, 9, 10],
                    datasets: [{
                        label: 'Silhouette Score',
                        data: [0.45, 0.52, 0.58, 0.65, 0.61, 0.57, 0.53, 0.51, 0.49],
                        borderColor: 'var(--tertiary)',
                        backgroundColor: 'rgba(44, 195, 160, 0.1)',
                        tension: 0.3,
                        pointRadius: 5,
                        pointBackgroundColor: 'var(--tertiary)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            max: 0.7,
                            title: {
                                display: true,
                                text: 'Silhouette Score'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Number of Clusters'
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return `${context[0].label} Clusters`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function createSegmentDistributionChart() {
            const ctx = document.getElementById('segmentDistributionChart').getContext('2d');
            
            return new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['High-Value Loyalists', 'Potential Loyalists', 'Occasional Shoppers', 'New Customers', 'At-Risk Customers'],
                    datasets: [{
                        label: 'Customer Distribution',
                        data: [18, 24, 32, 15, 11],
                        backgroundColor: [
                            'var(--primary)',
                            'var(--tertiary)',
                            'var(--secondary)',
                            'var(--primary-light)',
                            'var(--secondary-dark)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.raw}% of customers`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function createSegmentComparisonChart() {
            const ctx = document.getElementById('segmentComparisonChart').getContext('2d');
            
            return new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Purchase Frequency', 'Order Value', 'Total Spend', 'Recency', 'Product Categories'],
                    datasets: [
                        {
                            label: 'High-Value Loyalists',
                            data: [9, 8.5, 9.5, 8, 7.5],
                            borderColor: 'var(--primary)',
                            backgroundColor: 'rgba(74, 111, 220, 0.2)'
                        },
                        {
                            label: 'Potential Loyalists',
                            data: [7, 6, 7, 7.5, 6],
                            borderColor: 'var(--tertiary)',
                            backgroundColor: 'rgba(44, 195, 160, 0.2)'
                        },
                        {
                            label: 'Occasional Shoppers',
                            data: [3, 7, 4, 5, 4],
                            borderColor: 'var(--secondary)',
                            backgroundColor: 'rgba(255, 125, 69, 0.2)'
                        },
                        {
                            label: 'New Customers',
                            data: [1, 4, 2, 9, 3],
                            borderColor: 'var(--primary-light)',
                            backgroundColor: 'rgba(122, 147, 230, 0.2)'
                        },
                        {
                            label: 'At-Risk Customers',
                            data: [5, 6, 5, 2, 5],
                            borderColor: 'var(--secondary-dark)',
                            backgroundColor: 'rgba(230, 98, 38, 0.2)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {
                                display: true
                            },
                            suggestedMin: 0,
                            suggestedMax: 10
                        }
                    }
                }
            });
        }

        let elbowChart, silhouetteChart, segmentDistributionChart, segmentComparisonChart;

        function initCharts() {
            elbowChart = createElbowChart();
            silhouetteChart = createSilhouetteChart();
            segmentDistributionChart = createSegmentDistributionChart();
            segmentComparisonChart = createSegmentComparisonChart();
        }

        function updateCharts() {
            // Highlight the selected number of clusters in the Elbow chart
            const selectedClusters = parseInt(clusterSlider.value);
            const newElbowBackgroundColors = Array(9).fill('rgba(74, 111, 220, 0.1)');
            const newElbowPointBackgroundColors = Array(9).fill('var(--primary)');
            
            newElbowBackgroundColors[selectedClusters - 2] = 'rgba(74, 111, 220, 0.5)';
            newElbowPointBackgroundColors[selectedClusters - 2] = 'var(--secondary)';
            
            elbowChart.data.datasets[0].pointBackgroundColor = newElbowPointBackgroundColors;
            elbowChart.update();

            // Highlight the selected number of clusters in the Silhouette chart
            const newSilhouetteBackgroundColors = Array(9).fill('rgba(44, 195, 160, 0.1)');
            const newSilhouettePointBackgroundColors = Array(9).fill('var(--tertiary)');
            
            newSilhouetteBackgroundColors[selectedClusters - 2] = 'rgba(44, 195, 160, 0.5)';
            newSilhouettePointBackgroundColors[selectedClusters - 2] = 'var(--secondary)';
            
            silhouetteChart.data.datasets[0].pointBackgroundColor = newSilhouettePointBackgroundColors;
            silhouetteChart.update();
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            initCharts();
            updateCharts();
        });
    </script>
</body>
</html>