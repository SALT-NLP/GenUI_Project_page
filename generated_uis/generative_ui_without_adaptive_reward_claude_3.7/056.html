<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoExplorer: 4th Grade Ecosystems</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&family=Bubblegum+Sans&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4CAF50;
            --primary-light: #81C784;
            --primary-dark: #388E3C;
            --secondary: #2196F3;
            --secondary-light: #64B5F6;
            --accent: #FF9800;
            --accent-light: #FFB74D;
            --text-dark: #333333;
            --text-light: #FFFFFF;
            --background-light: #F5F9F5;
            --success: #66BB6A;
            --error: #F44336;
            --border-radius: 12px;
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background-color: var(--background-light);
            min-height: 100vh;
        }

        h1, h2, h3 {
            font-family: 'Bubblegum Sans', cursive;
            color: var(--primary-dark);
        }

        .container {
            display: grid;
            grid-template-columns: 250px 1fr;
            grid-template-rows: auto 1fr auto;
            grid-template-areas: 
                "header header"
                "sidebar main"
                "footer footer";
            min-height: 100vh;
        }

        /* Header */
        .header {
            grid-area: header;
            background-color: var(--primary);
            color: var(--text-light);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo h1 {
            color: var(--text-light);
            font-size: 1.8rem;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
        }

        /* Sidebar */
        .sidebar {
            grid-area: sidebar;
            background-color: white;
            box-shadow: var(--shadow);
            padding: 1.5rem 1rem;
            z-index: 100;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            border-radius: var(--border-radius);
            text-decoration: none;
            color: var(--text-dark);
            transition: var(--transition);
            font-weight: 600;
            gap: 0.5rem;
        }

        .nav-link:hover, .nav-link.active {
            background-color: var(--primary-light);
            color: var(--text-light);
        }

        .nav-link svg {
            width: 20px;
            height: 20px;
        }

        .progress-container {
            margin-top: 2rem;
            padding: 1rem;
            background-color: var(--background-light);
            border-radius: var(--border-radius);
        }

        .progress-title {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .progress-bar {
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-value {
            height: 100%;
            background-color: var(--primary);
            width: 25%;
            border-radius: 5px;
        }

        /* Main Content */
        .main {
            grid-area: main;
            padding: 2rem;
            overflow-y: auto;
        }

        .module-title {
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .module-title h2 {
            font-size: 2rem;
        }

        .module-intro {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .intro-text {
            background-color: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .intro-text p {
            margin-bottom: 1rem;
        }

        .intro-image {
            background-color: white;
            padding: 1rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .intro-image img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
        }

        .tool-section {
            margin-top: 2rem;
        }

        .tool-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .canvas-container {
            background-color: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        #food-web-canvas {
            width: 100%;
            height: 400px;
            border: 2px dashed var(--primary-light);
            border-radius: 8px;
            position: relative;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="50" height="50" x="0" y="0" fill="%23f9f9f9"/><rect width="50" height="50" x="50" y="50" fill="%23f9f9f9"/><rect width="50" height="50" x="50" y="0" fill="%23f5f5f5"/><rect width="50" height="50" x="0" y="50" fill="%23f5f5f5"/></svg>');
        }

        .organism-palette {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1rem;
            padding: 1rem;
            background-color: var(--background-light);
            border-radius: 8px;
        }

        .organism-card {
            width: 100px;
            height: 130px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: grab;
            transition: var(--transition);
            overflow: hidden;
        }

        .organism-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .organism-card img {
            width: 100%;
            height: 80px;
            object-fit: cover;
        }

        .organism-card .name {
            padding: 0.5rem;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .organism-clone {
            position: absolute;
            z-index: 1000;
            pointer-events: none;
        }

        .tools-container {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .tool-button {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            transition: var(--transition);
        }

        .tool-button:hover {
            background-color: var(--primary-dark);
        }

        .tool-button svg {
            width: 16px;
            height: 16px;
        }

        .tooltip {
            position: relative;
        }

        .tooltip-text {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            z-index: 1000;
        }

        .tooltip:hover .tooltip-text {
            opacity: 1;
            visibility: visible;
        }

        .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }

        .tts-button {
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-left: 0.5rem;
            transition: var(--transition);
        }

        .tts-button:hover {
            background-color: var(--secondary-light);
        }

        .tts-container {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .vocab-word {
            color: var(--secondary);
            font-weight: 600;
            position: relative;
            cursor: help;
            border-bottom: 1px dotted var(--secondary);
        }

        .vocab-tooltip {
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background-color: white;
            color: var(--text-dark);
            padding: 0.75rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            width: 200px;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            z-index: 1000;
        }

        .vocab-word:hover .vocab-tooltip {
            opacity: 1;
            visibility: visible;
        }

        .vocab-tooltip::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -8px;
            border-width: 8px;
            border-style: solid;
            border-color: white transparent transparent transparent;
        }

        .vocab-audio {
            background-color: var(--secondary-light);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-left: auto;
            font-size: 0.7rem;
        }

        /* Quiz Section */
        .quiz-container {
            background-color: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-top: 2rem;
        }

        .quiz-question {
            margin-bottom: 1.5rem;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }

        .quiz-option {
            background-color: var(--background-light);
            border: 2px solid transparent;
            border-radius: 8px;
            padding: 0.75rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .quiz-option:hover {
            border-color: var(--primary-light);
        }

        .quiz-option.selected {
            border-color: var(--primary);
            background-color: rgba(76, 175, 80, 0.1);
        }

        .quiz-option.correct {
            border-color: var(--success);
            background-color: rgba(102, 187, 106, 0.1);
        }

        .quiz-option.incorrect {
            border-color: var(--error);
            background-color: rgba(244, 67, 54, 0.1);
        }

        .quiz-feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 8px;
            display: none;
        }

        .quiz-feedback.correct {
            background-color: rgba(102, 187, 106, 0.1);
            color: var(--success);
            display: block;
        }

        .quiz-feedback.incorrect {
            background-color: rgba(244, 67, 54, 0.1);
            color: var(--error);
            display: block;
        }

        .check-answer {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            margin-top: 1rem;
        }

        .check-answer:hover {
            background-color: var(--primary-dark);
        }

        /* Footer */
        .footer {
            grid-area: footer;
            background-color: var(--primary-dark);
            color: var(--text-light);
            padding: 1rem 2rem;
            text-align: center;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 2rem;
            position: relative;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-dark);
        }

        .modal-title {
            margin-bottom: 1rem;
        }

        .modal-body {
            margin-bottom: 1.5rem;
        }

        .modal-image {
            width: 100%;
            max-height: 300px;
            object-fit: contain;
            margin-bottom: 1rem;
            border-radius: 8px;
        }

        /* Responsive */
        @media (max-width: 992px) {
            .container {
                grid-template-columns: 1fr;
                grid-template-areas: 
                    "header"
                    "main"
                    "footer";
            }

            .sidebar {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                height: 100%;
                width: 250px;
                z-index: 1000;
            }

            .sidebar.active {
                display: block;
            }

            .module-intro {
                grid-template-columns: 1fr;
            }

            .quiz-options {
                grid-template-columns: 1fr;
            }
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        @media (max-width: 992px) {
            .menu-toggle {
                display: block;
            }
        }

        /* Utility Classes */
        .flex {
            display: flex;
        }

        .align-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .gap-1 {
            gap: 1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <svg class="logo-icon" viewBox="0 0 24 24" fill="white">
                    <path d="M12,2L1,21H23L12,2M12,6L19.5,19H4.5L12,6Z"/>
                </svg>
                <h1>EcoExplorer</h1>
            </div>
            <button class="menu-toggle" id="menu-toggle">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="white">
                    <path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"/>
                </svg>
            </button>
        </header>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <nav>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#" class="nav-link active">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z"/>
                            </svg>
                            Food Webs
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M7,2V4H8V18H4V6H3V20H8V22H16V20H21V6H20V4H21V2H7M10,4H17V16H10V4M11,6V8H16V6H11M11,9V11H16V9H11M11,12V14H16V12H11Z"/>
                            </svg>
                            Energy Flow
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M14,6L10.25,11L13.1,14.8L11.5,16C9.81,13.75 7,10 7,10L1,18H23L14,6Z"/>
                            </svg>
                            Habitats
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M9,22A1,1 0 0,1 8,21V18H4A2,2 0 0,1 2,16V4C2,2.89 2.9,2 4,2H20A2,2 0 0,1 22,4V16A2,2 0 0,1 20,18H13.9L10.2,21.71C10,21.9 9.75,22 9.5,22V22H9M10,16V19.08L13.08,16H20V4H4V16H10M16.5,8L11,13.5L7.5,10L8.91,8.59L11,10.67L15.09,6.59L16.5,8Z"/>
                            </svg>
                            Quiz
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="progress-container">
                <div class="progress-title">Your Progress</div>
                <div class="progress-bar">
                    <div class="progress-value"></div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main">
            <div class="module-title">
                <svg viewBox="0 0 24 24" width="32" height="32" fill="#388E3C">
                    <path d="M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z"/>
                </svg>
                <h2>Food Webs</h2>
            </div>

            <div class="module-intro">
                <div class="intro-text">
                    <div class="tts-container">
                        <h3>What is a Food Web?</h3>
                        <button class="tts-button" aria-label="Listen to text" data-text="What is a Food Web? A food web shows how energy moves through an ecosystem. It connects different plants and animals based on what they eat. Unlike a simple food chain, a food web shows many connections between organisms.">
                            <svg viewBox="0 0 24 24" width="16" height="16" fill="white">
                                <path d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z"/>
                            </svg>
                        </button>
                    </div>
                    <p>A <span class="vocab-word">food web<span class="vocab-tooltip">A food web shows the complex feeding relationships in an ecosystem, displaying multiple interconnected food chains.<button class="vocab-audio">🔊</button></span></span> shows how energy moves through an <span class="vocab-word">ecosystem<span class="vocab-tooltip">An ecosystem is a community of living organisms together with the nonliving components of their environment.<button class="vocab-audio">🔊</button></span></span>. It connects different plants and animals based on what they eat. Unlike a simple <span class="vocab-word">food chain<span class="vocab-tooltip">A food chain is a linear sequence of organisms through which energy and nutrients pass as one organism eats another.<button class="vocab-audio">🔊</button></span></span>, a food web shows many connections between organisms.</p>
                    
                    <div class="tts-container">
                        <h3>Why are Food Webs Important?</h3>
                        <button class="tts-button" aria-label="Listen to text" data-text="Why are Food Webs Important? Food webs help us understand how all living things are connected. If one organism disappears, it affects many others in the web. Food webs also show how energy from the sun moves through different organisms.">
                            <svg viewBox="0 0 24 24" width="16" height="16" fill="white">
                                <path d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z"/>
                            </svg>
                        </button>
                    </div>
                    <p>Food webs help us understand how all living things are connected. If one organism disappears, it affects many others in the web. Food webs also show how energy from the sun moves through different organisms.</p>
                </div>
                <div class="intro-image">
                    <img src="https://placehold.co/600x400?text=Food+Web+Diagram" alt="Food Web Diagram">
                </div>
            </div>

            <div class="tool-section">
                <h3 class="tool-title">Build Your Own Food Web</h3>
                <div class="canvas-container">
                    <div id="food-web-canvas"></div>
                    <div class="organism-palette">
                        <div class="organism-card" draggable="true" data-type="producer">
                            <img src="https://placehold.co/100x80?text=Grass" alt="Grass">
                            <div class="name">Grass</div>
                        </div>
                        <div class="organism-card" draggable="true" data-type="producer">
                            <img src="https://placehold.co/100x80?text=Tree" alt="Tree">
                            <div class="name">Tree</div>
                        </div>
                        <div class="organism-card" draggable="true" data-type="primary-consumer">
                            <img src="https://placehold.co/100x80?text=Rabbit" alt="Rabbit">
                            <div class="name">Rabbit</div>
                        </div>
                        <div class="organism-card" draggable="true" data-type="primary-consumer">
                            <img src="https://placehold.co/100x80?text=Mouse" alt="Mouse">
                            <div class="name">Mouse</div>
                        </div>
                        <div class="organism-card" draggable="true" data-type="secondary-consumer">
                            <img src="https://placehold.co/100x80?text=Fox" alt="Fox">
                            <div class="name">Fox</div>
                        </div>
                        <div class="organism-card" draggable="true" data-type="secondary-consumer">
                            <img src="https://placehold.co/100x80?text=Snake" alt="Snake">
                            <div class="name">Snake</div>
                        </div>
                        <div class="organism-card" draggable="true" data-type="tertiary-consumer">
                            <img src="https://placehold.co/100x80?text=Eagle" alt="Eagle">
                            <div class="name">Eagle</div>
                        </div>
                        <div class="organism-card" draggable="true" data-type="decomposer">
                            <img src="https://placehold.co/100x80?text=Mushroom" alt="Mushroom">
                            <div class="name">Mushroom</div>
                        </div>
                    </div>
                    <div class="tools-container">
                        <button class="tool-button" id="connect-button">
                            <svg viewBox="0 0 24 24" fill="white">
                                <path d="M16,6L13,9L16,12L9,19L6,16L13,9L10,6L17,6H16M16,6"/>
                            </svg>
                            Connect Organisms
                        </button>
                        <div class="tooltip">
                            <button class="tool-button" id="reset-button">
                                <svg viewBox="0 0 24 24" fill="white">
                                    <path d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"/>
                                </svg>
                                Reset Canvas
                            </button>
                            <span class="tooltip-text">Clear all organisms</span>
                        </div>
                        <button class="tool-button" id="save-button">
                            <svg viewBox="0 0 24 24" fill="white">
                                <path d="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"/>
                            </svg>
                            Save Food Web
                        </button>
                    </div>
                </div>
            </div>

            <div class="quiz-container">
                <h3>Quick Check</h3>
                <div class="quiz-question">
                    <p>Which of the following best describes a food web?</p>
                    <div class="quiz-options">
                        <div class="quiz-option" data-correct="true">
                            A network showing feeding relationships among organisms in an ecosystem
                        </div>
                        <div class="quiz-option">
                            A simple line showing one animal eating another
                        </div>
                        <div class="quiz-option">
                            A list of all animals in a habitat
                        </div>
                        <div class="quiz-option">
                            A diagram showing only plant life
                        </div>
                    </div>
                    <div class="quiz-feedback"></div>
                    <button class="check-answer">Check Answer</button>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>EcoExplorer - Interactive Ecosystem Learning Tool for 4th Grade</p>
        </footer>
    </div>

    <!-- Modal -->
    <div class="modal" id="organism-modal">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">&times;</button>
            <h3 class="modal-title" id="modal-title">Organism Information</h3>
            <div class="modal-body">
                <img src="" id="modal-image" class="modal-image" alt="Organism Image">
                <p id="modal-description"></p>
                <p id="modal-role"></p>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const menuToggle = document.getElementById('menu-toggle');
        const sidebar = document.getElementById('sidebar');
        const foodWebCanvas = document.getElementById('food-web-canvas');
        const connectButton = document.getElementById('connect-button');
        const resetButton = document.getElementById('reset-button');
        const saveButton = document.getElementById('save-button');
        const organismCards = document.querySelectorAll('.organism-card');
        const quizOptions = document.querySelectorAll('.quiz-option');
        const checkAnswerButton = document.querySelector('.check-answer');
        const quizFeedback = document.querySelector('.quiz-feedback');
        const ttsButtons = document.querySelectorAll('.tts-button');
        const vocabAudioButtons = document.querySelectorAll('.vocab-audio');
        const modal = document.getElementById('organism-modal');
        const modalClose = document.getElementById('modal-close');
        const modalTitle = document.getElementById('modal-title');
        const modalImage = document.getElementById('modal-image');
        const modalDescription = document.getElementById('modal-description');
        const modalRole = document.getElementById('modal-role');

        // State variables
        let canvasOrganisms = [];
        let isConnecting = false;
        let selectedOrganism = null;
        let arrows = [];

        // Organism data
        const organismData = {
            'Grass': {
                type: 'producer',
                description: 'Grass is a producer that converts sunlight into energy through photosynthesis.',
                role: 'Producers form the base of the food web by creating their own food using sunlight.'
            },
            'Tree': {
                type: 'producer',
                description: 'Trees are producers that convert sunlight into energy and provide habitat for many animals.',
                role: 'Producers form the base of the food web by creating their own food using sunlight.'
            },
            'Rabbit': {
                type: 'primary-consumer',
                description: 'Rabbits are herbivores that eat plants like grass and leaves.',
                role: 'Primary consumers eat producers and are eaten by secondary consumers.'
            },
            'Mouse': {
                type: 'primary-consumer',
                description: 'Mice are omnivores that eat seeds, fruits, and sometimes insects.',
                role: 'Primary consumers eat producers and are eaten by secondary consumers.'
            },
            'Fox': {
                type: 'secondary-consumer',
                description: 'Foxes are carnivores that hunt and eat smaller animals like rabbits and mice.',
                role: 'Secondary consumers eat primary consumers and may be eaten by tertiary consumers.'
            },
            'Snake': {
                type: 'secondary-consumer',
                description: 'Snakes are carnivores that eat small mammals like mice.',
                role: 'Secondary consumers eat primary consumers and may be eaten by tertiary consumers.'
            },
            'Eagle': {
                type: 'tertiary-consumer',
                description: 'Eagles are top predators that hunt and eat other animals like snakes and rabbits.',
                role: 'Tertiary consumers are often top predators in a food web with few or no natural predators.'
            },
            'Mushroom': {
                type: 'decomposer',
                description: 'Mushrooms break down dead plants and animals, returning nutrients to the soil.',
                role: 'Decomposers recycle nutrients back into the ecosystem by breaking down dead organisms.'
            }
        };

        // Event Listeners
        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
        });

        // Drag and Drop for Organism Cards
        organismCards.forEach(card => {
            card.addEventListener('dragstart', handleDragStart);
        });

        foodWebCanvas.addEventListener('dragover', (e) => {
            e.preventDefault();
        });

        foodWebCanvas.addEventListener('drop', handleDrop);

        connectButton.addEventListener('click', () => {
            isConnecting = !isConnecting;
            connectButton.classList.toggle('active');
            
            if (isConnecting) {
                foodWebCanvas.style.cursor = 'crosshair';
                connectButton.textContent = 'Cancel Connecting';
            } else {
                foodWebCanvas.style.cursor = 'default';
                selectedOrganism = null;
                connectButton.textContent = 'Connect Organisms';
            }
        });

        resetButton.addEventListener('click', () => {
            // Clear the canvas
            while (foodWebCanvas.firstChild) {
                foodWebCanvas.removeChild(foodWebCanvas.firstChild);
            }
            canvasOrganisms = [];
            arrows = [];
        });

        saveButton.addEventListener('click', () => {
            alert('Your food web has been saved!');
        });

        // Quiz functionality
        quizOptions.forEach(option => {
            option.addEventListener('click', () => {
                // Clear previous selection
                quizOptions.forEach(opt => opt.classList.remove('selected'));
                // Mark this option as selected
                option.classList.add('selected');
            });
        });

        checkAnswerButton.addEventListener('click', () => {
            const selectedOption = document.querySelector('.quiz-option.selected');
            
            if (!selectedOption) {
                quizFeedback.textContent = 'Please select an answer.';
                quizFeedback.className = 'quiz-feedback';
                return;
            }
            
            if (selectedOption.dataset.correct === 'true') {
                quizFeedback.textContent = 'Correct! A food web shows how different organisms are connected through feeding relationships.';
                quizFeedback.className = 'quiz-feedback correct';
                selectedOption.classList.add('correct');
            } else {
                quizFeedback.textContent = 'Not quite. A food web shows the complex feeding relationships between different organisms in an ecosystem.';
                quizFeedback.className = 'quiz-feedback incorrect';
                selectedOption.classList.add('incorrect');
            }
        });

        // Text-to-Speech functionality
        if ('speechSynthesis' in window) {
            ttsButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const text = button.getAttribute('data-text');
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.rate = 0.9; // Slightly slower for better comprehension
                    speechSynthesis.speak(utterance);
                });
            });

            vocabAudioButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const vocabWord = button.closest('.vocab-tooltip').parentElement.textContent.split('\n')[0];
                    const utterance = new SpeechSynthesisUtterance(vocabWord);
                    speechSynthesis.speak(utterance);
                });
            });
        } else {
            ttsButtons.forEach(button => {
                button.style.display = 'none';
            });
            vocabAudioButtons.forEach(button => {
                button.style.display = 'none';
            });
        }

        // Modal functionality
        modalClose.addEventListener('click', () => {
            modal.classList.remove('active');
        });

        window.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.remove('active');
            }
        });

        // Functions
        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.querySelector('.name').textContent);
            
            // Create a visual clone for dragging
            const clone = e.target.cloneNode(true);
            clone.classList.add('organism-clone');
            clone.style.position = 'absolute';
            clone.style.zIndex = '1000';
            clone.style.opacity = '0.7';
            clone.style.pointerEvents = 'none';
            document.body.appendChild(clone);
            
            // Set the drag image offset
            e.dataTransfer.setDragImage(clone, 50, 65);
            
            // Remove clone after drag starts
            setTimeout(() => {
                document.body.removeChild(clone);
            }, 0);
        }

        function handleDrop(e) {
            e.preventDefault();
            const organismName = e.dataTransfer.getData('text/plain');
            
            // Create organism element
            const organism = document.createElement('div');
            organism.className = 'canvas-organism';
            organism.dataset.name = organismName;
            organism.dataset.type = organismData[organismName].type;
            
            // Style the organism
            organism.style.position = 'absolute';
            organism.style.left = `${e.offsetX - 50}px`;
            organism.style.top = `${e.offsetY - 65}px`;
            organism.style.width = '100px';
            organism.style.height = '130px';
            organism.style.backgroundColor = 'white';
            organism.style.borderRadius = '8px';
            organism.style.boxShadow = '0 2px 8px rgba(0, 0, 0, 0.2)';
            organism.style.display = 'flex';
            organism.style.flexDirection = 'column';
            organism.style.alignItems = 'center';
            organism.style.cursor = 'pointer';
            organism.style.zIndex = '1';
            
            // Add color border based on type
            switch (organismData[organismName].type) {
                case 'producer':
                    organism.style.borderTop = '4px solid #4CAF50';
                    break;
                case 'primary-consumer':
                    organism.style.borderTop = '4px solid #2196F3';
                    break;
                case 'secondary-consumer':
                    organism.style.borderTop = '4px solid #FF9800';
                    break;
                case 'tertiary-consumer':
                    organism.style.borderTop = '4px solid #F44336';
                    break;
                case 'decomposer':
                    organism.style.borderTop = '4px solid #9C27B0';
                    break;
            }
            
            // Add image
            const img = document.createElement('img');
            img.src = `https://placehold.co/100x80?text=${organismName}`;
            img.alt = organismName;
            img.style.width = '100%';
            img.style.height = '80px';
            img.style.objectFit = 'cover';
            organism.appendChild(img);
            
            // Add name
            const name = document.createElement('div');
            name.textContent = organismName;
            name.style.padding = '0.5rem';
            name.style.textAlign = 'center';
            name.style.fontWeight = 'bold';
            name.style.fontSize = '0.8rem';
            organism.appendChild(name);
            
            // Add to canvas
            foodWebCanvas.appendChild(organism);
            
            // Add to organisms array
            canvasOrganisms.push({
                element: organism,
                name: organismName,
                type: organismData[organismName].type,
                x: e.offsetX - 50,
                y: e.offsetY - 65
            });
            
            // Make draggable within canvas
            makeOrganismDraggable(organism);
            
            // Add click event for connecting
            organism.addEventListener('click', (event) => {
                if (isConnecting) {
                    if (!selectedOrganism) {
                        // First organism in connection
                        selectedOrganism = organism;
                        organism.style.boxShadow = '0 0 0 3px var(--primary)';
                    } else if (selectedOrganism !== organism) {
                        // Second organism - create connection
                        createArrow(selectedOrganism, organism);
                        // Reset
                        selectedOrganism.style.boxShadow = '0 2px 8px rgba(0, 0, 0, 0.2)';
                        selectedOrganism = null;
                    }
                } else {
                    // Show organism info
                    showOrganismModal(organismName);
                }
                event.stopPropagation();
            });
        }

        function makeOrganismDraggable(element) {
            let isDragging = false;
            let offsetX, offsetY;
            
            element.addEventListener('mousedown', (e) => {
                if (isConnecting) return; // Don't drag while connecting
                
                isDragging = true;
                offsetX = e.clientX - element.getBoundingClientRect().left;
                offsetY = e.clientY - element.getBoundingClientRect().top;
                element.style.zIndex = '2';
                e.preventDefault();
            });
            
            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                
                const canvasRect = foodWebCanvas.getBoundingClientRect();
                const x = e.clientX - canvasRect.left - offsetX;
                const y = e.clientY - canvasRect.top - offsetY;
                
                // Keep within canvas boundaries
                const maxX = canvasRect.width - element.offsetWidth;
                const maxY = canvasRect.height - element.offsetHeight;
                
                element.style.left = `${Math.max(0, Math.min(maxX, x))}px`;
                element.style.top = `${Math.max(0, Math.min(maxY, y))}px`;
                
                // Update position in organisms array
                const organism = canvasOrganisms.find(org => org.element === element);
                if (organism) {
                    organism.x = parseInt(element.style.left);
                    organism.y = parseInt(element.style.top);
                }
                
                // Update arrows
                updateArrows();
            });
            
            document.addEventListener('mouseup', () => {
                if (isDragging) {
                    isDragging = false;
                    element.style.zIndex = '1';
                }
            });
        }

        function createArrow(fromElement, toElement) {
            // Get organism centers
            const fromRect = fromElement.getBoundingClientRect();
            const toRect = toElement.getBoundingClientRect();
            const canvasRect = foodWebCanvas.getBoundingClientRect();
            
            const fromX = fromRect.left - canvasRect.left + fromRect.width / 2;
            const fromY = fromRect.top - canvasRect.top + fromRect.height / 2;
            const toX = toRect.left - canvasRect.left + toRect.width / 2;
            const toY = toRect.top - canvasRect.top + toRect.height / 2;
            
            // Create SVG arrow
            const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            svg.setAttribute("width", "100%");
            svg.setAttribute("height", "100%");
            svg.style.position = "absolute";
            svg.style.top = "0";
            svg.style.left = "0";
            svg.style.pointerEvents = "none";
            svg.style.zIndex = "0";
            
            // Draw arrow line
            const arrow = document.createElementNS("http://www.w3.org/2000/svg", "path");
            const dx = toX - fromX;
            const dy = toY - fromY;
            const angle = Math.atan2(dy, dx);
            
            // Adjust start and end points to be at edge of organisms
            const fromRadius = Math.min(fromRect.width, fromRect.height) / 2;
            const toRadius = Math.min(toRect.width, toRect.height) / 2;
            
            const startX = fromX + fromRadius * Math.cos(angle);
            const startY = fromY + fromRadius * Math.sin(angle);
            const endX = toX - toRadius * Math.cos(angle);
            const endY = toY - toRadius * Math.sin(angle);
            
            // Create arrowhead
            const arrowLength = 15;
            const arrowWidth = 8;
            
            // Arrow path
            arrow.setAttribute("d", `
                M ${startX} ${startY}
                L ${endX} ${endY}
                M ${endX} ${endY}
                L ${endX - arrowLength * Math.cos(angle) + arrowWidth * Math.sin(angle)} ${endY - arrowLength * Math.sin(angle) - arrowWidth * Math.cos(angle)}
                M ${endX} ${endY}
                L ${endX - arrowLength * Math.cos(angle) - arrowWidth * Math.sin(angle)} ${endY - arrowLength * Math.sin(angle) + arrowWidth * Math.cos(angle)}
            `);
            
            arrow.setAttribute("stroke", "#666");
            arrow.setAttribute("stroke-width", "2");
            arrow.setAttribute("fill", "none");
            
            svg.appendChild(arrow);
            foodWebCanvas.appendChild(svg);
            
            // Store arrow info
            arrows.push({
                svg: svg,
                from: fromElement,
                to: toElement,
                fromName: fromElement.dataset.name,
                toName: toElement.dataset.name
            });
            
            // Validate the connection
            validateConnection(fromElement.dataset.name, toElement.dataset.name);
        }

        function updateArrows() {
            arrows.forEach(arrow => {
                // Remove old SVG
                foodWebCanvas.removeChild(arrow.svg);
                
                // Create new arrow with updated positions
                createArrow(arrow.from, arrow.to);
                
                // Remove the duplicated arrow from the array
                arrows.pop();
            });
        }

        function validateConnection(fromName, toName) {
            const fromType = organismData[fromName].type;
            const toType = organismData[toName].type;
            
            let isValid = false;
            let message = '';
            
            // Check valid feeding relationships
            if (fromType === 'producer' && toType === 'primary-consumer') {
                isValid = true;
                message = `Good job! ${toName}s eat ${fromName}.`;
            } else if (fromType === 'primary-consumer' && toType === 'secondary-consumer') {
                isValid = true;
                message = `Correct! ${toName}s hunt and eat ${fromName}s.`;
            } else if (fromType === 'secondary-consumer' && toType === 'tertiary-consumer') {
                isValid = true;
                message = `That's right! ${toName}s are top predators that eat ${fromName}s.`;
            } else if ((fromType === 'producer' || fromType === 'primary-consumer' || fromType === 'secondary-consumer' || fromType === 'tertiary-consumer') && toType === 'decomposer') {
                isValid = true;
                message = `Good observation! ${toName}s break down dead ${fromName}s and recycle nutrients.`;
            } else {
                isValid = false;
                message = `This doesn't seem right. ${toName}s don't typically eat ${fromName}s in nature.`;
            }
            
            // Display feedback
            const feedback = document.createElement('div');
            feedback.textContent = message;
            feedback.style.position = 'fixed';
            feedback.style.bottom = '20px';
            feedback.style.left = '50%';
            feedback.style.transform = 'translateX(-50%)';
            feedback.style.backgroundColor = isValid ? 'rgba(76, 175, 80, 0.9)' : 'rgba(244, 67, 54, 0.9)';
            feedback.style.color = 'white';
            feedback.style.padding = '10px 20px';
            feedback.style.borderRadius = '8px';
            feedback.style.boxShadow = '0 2px 10px rgba(0, 0, 0, 0.2)';
            feedback.style.zIndex = '1000';
            document.body.appendChild(feedback);
            
            // Remove feedback after delay
            setTimeout(() => {
                document.body.removeChild(feedback);
            }, 3000);
        }

        function showOrganismModal(organismName) {
            modalTitle.textContent = organismName;
            modalImage.src = `https://placehold.co/400x200?text=${organismName}`;
            modalDescription.textContent = organismData[organismName].description;
            modalRole.textContent = organismData[organismName].role;
            modal.classList.add('active');
        }
    </script>
</body>
</html>