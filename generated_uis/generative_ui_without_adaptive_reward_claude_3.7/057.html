<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Environmental Data Analysis Platform</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        :root {
            --primary: #2196F3;
            --primary-light: #64B5F6;
            --primary-dark: #1976D2;
            --secondary: #4CAF50;
            --secondary-light: #81C784;
            --secondary-dark: #388E3C;
            --warning: #FFC107;
            --danger: #F44336;
            --gray-100: #f8f9fa;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-400: #ced4da;
            --gray-500: #adb5bd;
            --gray-600: #6c757d;
            --gray-700: #495057;
            --gray-800: #343a40;
            --gray-900: #212529;
            --font-family: 'Roboto', sans-serif;
            --border-radius: 4px;
            --box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            line-height: 1.5;
            color: var(--gray-800);
            background-color: var(--gray-100);
        }

        .container {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            background-color: white;
            border-right: 1px solid var(--gray-300);
            padding: 20px 0;
            overflow-y: auto;
            height: 100vh;
            position: sticky;
            top: 0;
        }

        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid var(--gray-300);
        }

        .sidebar-title {
            font-size: 1.5rem;
            font-weight: 500;
            color: var(--primary-dark);
            margin-bottom: 5px;
        }

        .sidebar-subtitle {
            font-size: 0.9rem;
            color: var(--gray-600);
        }

        .workflow-steps {
            list-style: none;
            padding: 20px;
        }

        .workflow-step {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

        .workflow-step:hover {
            background-color: var(--gray-200);
        }

        .workflow-step.active {
            background-color: var(--primary-light);
            color: white;
        }

        .workflow-step.completed {
            background-color: var(--gray-200);
        }

        .workflow-step.completed::after {
            content: "✓";
            position: absolute;
            right: 15px;
            color: var(--secondary);
            font-weight: bold;
        }

        .step-icon {
            margin-right: 12px;
            font-size: 20px;
        }

        .step-text {
            font-weight: 500;
        }

        /* Main Content */
        .main-content {
            padding: 30px;
            overflow-y: auto;
        }

        .panel {
            background-color: white;
            border-radius: 8px;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
            overflow: hidden;
        }

        .panel-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray-300);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-title {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--gray-800);
        }

        .panel-body {
            padding: 20px;
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 0.9rem;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background-color: var(--secondary-dark);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--gray-400);
            color: var(--gray-700);
        }

        .btn-outline:hover {
            background-color: var(--gray-200);
        }

        .btn-icon {
            margin-right: 8px;
            font-size: 18px;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--gray-700);
        }

        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--gray-400);
            border-radius: var(--border-radius);
            font-family: var(--font-family);
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .form-select {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--gray-400);
            border-radius: var(--border-radius);
            font-family: var(--font-family);
            font-size: 0.9rem;
            transition: var(--transition);
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23495057' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 20px;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        /* Upload Area */
        .upload-area {
            border: 2px dashed var(--gray-400);
            border-radius: var(--border-radius);
            padding: 40px;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: var(--primary);
        }

        .upload-icon {
            font-size: 48px;
            color: var(--gray-500);
            margin-bottom: 15px;
        }

        .upload-text {
            font-size: 1rem;
            color: var(--gray-700);
            margin-bottom: 10px;
        }

        .upload-subtext {
            font-size: 0.85rem;
            color: var(--gray-600);
        }

        /* Data Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--gray-300);
        }

        .data-table th {
            font-weight: 500;
            color: var(--gray-700);
            background-color: var(--gray-100);
        }

        .data-table tbody tr:hover {
            background-color: var(--gray-100);
        }

        /* Data Cleaning Panel */
        .cleaning-tools {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .tool-card {
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius);
            padding: 15px;
            transition: var(--transition);
        }

        .tool-card:hover {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .tool-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .tool-icon {
            margin-right: 10px;
            color: var(--primary);
            font-size: 24px;
        }

        .tool-title {
            font-weight: 500;
            color: var(--gray-800);
        }

        /* Chart Container */
        .chart-container {
            height: 400px;
            position: relative;
        }

        /* Card Grid */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
        }

        .card-header {
            padding: 15px;
            border-bottom: 1px solid var(--gray-300);
            font-weight: 500;
        }

        .card-body {
            padding: 15px;
        }

        /* Stats Card */
        .stats-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }

        .stats-label {
            font-size: 0.9rem;
            color: var(--gray-600);
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-300);
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: var(--transition);
            font-weight: 500;
        }

        .tab:hover {
            color: var(--primary);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            padding: 20px 0;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 240px 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }

            .sidebar {
                display: none;
            }

            .sidebar.active {
                display: block;
                position: fixed;
                z-index: 1000;
                width: 100%;
                height: 100%;
            }

            .cleaning-tools,
            .card-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Utility Classes */
        .d-flex {
            display: flex;
        }

        .align-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .mb-10 {
            margin-bottom: 10px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .text-center {
            text-align: center;
        }

        .text-danger {
            color: var(--danger);
        }

        .text-warning {
            color: var(--warning);
        }

        .text-success {
            color: var(--secondary);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar / Workflow Steps -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-title">EnviroAnalytics</h1>
                <p class="sidebar-subtitle">Environmental Data Analysis Platform</p>
            </div>
            <ul class="workflow-steps">
                <li class="workflow-step active" data-step="load">
                    <span class="material-icons step-icon">cloud_upload</span>
                    <span class="step-text">Load Data</span>
                </li>
                <li class="workflow-step" data-step="clean">
                    <span class="material-icons step-icon">cleaning_services</span>
                    <span class="step-text">Clean Data</span>
                </li>
                <li class="workflow-step" data-step="explore">
                    <span class="material-icons step-icon">explore</span>
                    <span class="step-text">Explore Data</span>
                </li>
                <li class="workflow-step" data-step="model">
                    <span class="material-icons step-icon">model_training</span>
                    <span class="step-text">Model & Analyze</span>
                </li>
                <li class="workflow-step" data-step="visualize">
                    <span class="material-icons step-icon">bar_chart</span>
                    <span class="step-text">Visualize Results</span>
                </li>
                <li class="workflow-step" data-step="report">
                    <span class="material-icons step-icon">description</span>
                    <span class="step-text">Generate Report</span>
                </li>
            </ul>
        </div>

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Load Data Panel -->
            <div class="panel" id="load-panel">
                <div class="panel-header">
                    <h2 class="panel-title">Load Environmental Monitoring Data</h2>
                    <button class="btn btn-outline">
                        <span class="material-icons btn-icon">help_outline</span>
                        Help
                    </button>
                </div>
                <div class="panel-body">
                    <p class="mb-20">Upload your environmental monitoring dataset to begin analysis. Supported formats include CSV, Excel, and JSON files.</p>
                    
                    <div class="upload-area" id="upload-area">
                        <span class="material-icons upload-icon">cloud_upload</span>
                        <p class="upload-text">Drag and drop files here or click to browse</p>
                        <p class="upload-subtext">Maximum file size: 100MB</p>
                        <input type="file" id="file-upload" style="display: none;">
                    </div>
                    
                    <div class="form-group mt-20">
                        <label class="form-label">Or import from a sample dataset:</label>
                        <select class="form-select" id="sample-dataset">
                            <option value="">Select a sample dataset</option>
                            <option value="urban-air-quality-2010-2020">Urban Air Quality Data (2010-2020)</option>
                            <option value="traffic-pollution-correlation">Traffic & Pollution Correlation Study</option>
                            <option value="construction-impact-analysis">Construction Impact Analysis</option>
                        </select>
                    </div>
                    
                    <div class="mt-20 d-flex justify-between">
                        <button class="btn btn-outline" id="reset-btn">
                            <span class="material-icons btn-icon">refresh</span>
                            Reset
                        </button>
                        <button class="btn btn-primary" id="load-data-btn">
                            <span class="material-icons btn-icon">play_arrow</span>
                            Load Data
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Data Preview Panel (Initially Hidden) -->
            <div class="panel" id="preview-panel" style="display: none;">
                <div class="panel-header">
                    <h2 class="panel-title">Data Preview</h2>
                    <div>
                        <button class="btn btn-outline mb-10">
                            <span class="material-icons btn-icon">filter_list</span>
                            Filter
                        </button>
                        <button class="btn btn-outline">
                            <span class="material-icons btn-icon">sort</span>
                            Sort
                        </button>
                    </div>
                </div>
                <div class="panel-body">
                    <div class="d-flex justify-between align-center mb-20">
                        <div>
                            <strong>Dataset:</strong> <span id="dataset-name">Urban Air Quality (2010-2020)</span>
                            <br>
                            <strong>Records:</strong> <span id="record-count">10,245</span> rows, <span id="column-count">24</span> columns
                        </div>
                        <button class="btn btn-primary" id="proceed-to-clean-btn">
                            <span class="material-icons btn-icon">arrow_forward</span>
                            Proceed to Cleaning
                        </button>
                    </div>
                    
                    <div style="overflow-x: auto;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Location</th>
                                    <th>PM2.5</th>
                                    <th>PM10</th>
                                    <th>O3</th>
                                    <th>NO2</th>
                                    <th>SO2</th>
                                    <th>CO</th>
                                    <th>Temperature</th>
                                    <th>Humidity</th>
                                    <th>Wind Speed</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>2020-01-01</td>
                                    <td>Downtown</td>
                                    <td>18.5</td>
                                    <td>42.3</td>
                                    <td>0.032</td>
                                    <td>0.028</td>
                                    <td>0.005</td>
                                    <td>0.8</td>
                                    <td>12.4</td>
                                    <td>65%</td>
                                    <td>3.2</td>
                                </tr>
                                <tr>
                                    <td>2020-01-01</td>
                                    <td>Suburban West</td>
                                    <td>12.1</td>
                                    <td>31.7</td>
                                    <td>0.041</td>
                                    <td>0.015</td>
                                    <td>0.003</td>
                                    <td>0.6</td>
                                    <td>11.8</td>
                                    <td>68%</td>
                                    <td>4.1</td>
                                </tr>
                                <tr>
                                    <td>2020-01-01</td>
                                    <td>Industrial Zone</td>
                                    <td>24.7</td>
                                    <td>56.2</td>
                                    <td>0.029</td>
                                    <td>0.035</td>
                                    <td>0.012</td>
                                    <td>1.2</td>
                                    <td>12.1</td>
                                    <td>62%</td>
                                    <td>2.8</td>
                                </tr>
                                <tr>
                                    <td>2020-01-01</td>
                                    <td>Residential East</td>
                                    <td>15.3</td>
                                    <td>38.9</td>
                                    <td>0.037</td>
                                    <td>0.021</td>
                                    <td>0.004</td>
                                    <td>0.7</td>
                                    <td>12.6</td>
                                    <td>64%</td>
                                    <td>3.5</td>
                                </tr>
                                <tr>
                                    <td>2020-01-02</td>
                                    <td>Downtown</td>
                                    <td>21.2</td>
                                    <td>45.8</td>
                                    <td>0.028</td>
                                    <td>0.031</td>
                                    <td>0.006</td>
                                    <td>0.9</td>
                                    <td>13.2</td>
                                    <td>61%</td>
                                    <td>2.9</td>
                                </tr>
                                <tr>
                                    <td>2020-01-02</td>
                                    <td>Suburban West</td>
                                    <td><span class="text-danger">N/A</span></td>
                                    <td>33.5</td>
                                    <td>0.039</td>
                                    <td>0.018</td>
                                    <td>0.003</td>
                                    <td>0.6</td>
                                    <td>12.9</td>
                                    <td>65%</td>
                                    <td>3.8</td>
                                </tr>
                                <tr>
                                    <td>2020-01-02</td>
                                    <td>Industrial Zone</td>
                                    <td>27.3</td>
                                    <td>59.1</td>
                                    <td>0.026</td>
                                    <td><span class="text-warning">0.152</span></td>
                                    <td>0.014</td>
                                    <td>1.3</td>
                                    <td>13.0</td>
                                    <td>59%</td>
                                    <td>2.5</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-20">
                        <p><span class="text-danger">■</span> Missing values &nbsp; <span class="text-warning">■</span> Potential outliers</p>
                    </div>
                </div>
            </div>

            <!-- Data Cleaning Panel (Initially Hidden) -->
            <div class="panel" id="clean-panel" style="display: none;">
                <div class="panel-header">
                    <h2 class="panel-title">Data Cleaning & Preparation</h2>
                    <button class="btn btn-outline">
                        <span class="material-icons btn-icon">help_outline</span>
                        Help
                    </button>
                </div>
                <div class="panel-body">
                    <div class="tabs mb-20">
                        <div class="tab active" data-tab="missing">Missing Values</div>
                        <div class="tab" data-tab="inconsistencies">Inconsistencies</div>
                        <div class="tab" data-tab="outliers">Outliers</div>
                        <div class="tab" data-tab="transform">Transformations</div>
                    </div>
                    
                    <div class="tab-content" id="missing-tab">
                        <div class="d-flex justify-between align-center mb-20">
                            <h3>Missing Value Detection & Handling</h3>
                            <button class="btn btn-primary" id="apply-missing-btn">
                                Apply Changes
                            </button>
                        </div>
                        
                        <div class="card-grid mb-20">
                            <div class="card">
                                <div class="card-header">Missing Value Summary</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="missing-chart"></canvas>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">Missing Value Patterns</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="pattern-chart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Select handling method:</label>
                            <select class="form-select" id="missing-method">
                                <option value="remove_rows">Remove rows with missing values</option>
                                <option value="remove_cols">Remove columns with >30% missing values</option>
                                <option value="mean">Replace with mean (numeric columns)</option>
                                <option value="median">Replace with median (numeric columns)</option>
                                <option value="mode">Replace with mode (categorical columns)</option>
                                <option value="interpolate">Linear interpolation (time series)</option>
                                <option value="knn">KNN imputation</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Apply to columns:</label>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                                <div>
                                    <input type="checkbox" id="col-pm25" checked>
                                    <label for="col-pm25">PM2.5</label>
                                </div>
                                <div>
                                    <input type="checkbox" id="col-pm10" checked>
                                    <label for="col-pm10">PM10</label>
                                </div>
                                <div>
                                    <input type="checkbox" id="col-o3" checked>
                                    <label for="col-o3">O3</label>
                                </div>
                                <div>
                                    <input type="checkbox" id="col-no2" checked>
                                    <label for="col-no2">NO2</label>
                                </div>
                                <div>
                                    <input type="checkbox" id="col-so2" checked>
                                    <label for="col-so2">SO2</label>
                                </div>
                                <div>
                                    <input type="checkbox" id="col-co" checked>
                                    <label for="col-co">CO</label>
                                </div>
                                <div>
                                    <input type="checkbox" id="col-temp" checked>
                                    <label for="col-temp">Temperature</label>
                                </div>
                                <div>
                                    <input type="checkbox" id="col-humidity" checked>
                                    <label for="col-humidity">Humidity</label>
                                </div>
                                <div>
                                    <input type="checkbox" id="col-wind" checked>
                                    <label for="col-wind">Wind Speed</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="inconsistencies-tab" style="display: none;">
                        <div class="d-flex justify-between align-center mb-20">
                            <h3>Data Inconsistency Detection & Resolution</h3>
                            <button class="btn btn-primary" id="apply-inconsistencies-btn">
                                Apply Changes
                            </button>
                        </div>
                        
                        <div class="card-grid mb-20">
                            <div class="card">
                                <div class="card-header">Detected Inconsistencies</div>
                                <div class="card-body">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Column</th>
                                                <th>Issue Type</th>
                                                <th>Examples</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Location</td>
                                                <td>Spelling variations</td>
                                                <td>"Downtown", "Down Town", "downtown"</td>
                                                <td>
                                                    <select class="form-select">
                                                        <option>Standardize to "Downtown"</option>
                                                        <option>Keep as is</option>
                                                        <option>Manual mapping</option>
                                                    </select>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>PM2.5</td>
                                                <td>Unit inconsistency</td>
                                                <td>Mix of µg/m³ and mg/m³</td>
                                                <td>
                                                    <select class="form-select">
                                                        <option>Convert all to µg/m³</option>
                                                        <option>Convert all to mg/m³</option>
                                                        <option>Flag for review</option>
                                                    </select>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Date</td>
                                                <td>Format variations</td>
                                                <td>"2020-01-01", "01/01/2020", "Jan 1, 2020"</td>
                                                <td>
                                                    <select class="form-select">
                                                        <option>Standardize to YYYY-MM-DD</option>
                                                        <option>Standardize to MM/DD/YYYY</option>
                                                        <option>Standardize to written format</option>
                                                    </select>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">Data Type Issues</div>
                                <div class="card-body">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Column</th>
                                                <th>Current Type</th>
                                                <th>Suggested Type</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Humidity</td>
                                                <td>String (with %)</td>
                                                <td>Numeric</td>
                                                <td>
                                                    <select class="form-select">
                                                        <option>Convert to numeric (remove %)</option>
                                                        <option>Keep as string</option>
                                                    </select>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Date</td>
                                                <td>String</td>
                                                <td>Date</td>
                                                <td>
                                                    <select class="form-select">
                                                        <option>Convert to date</option>
                                                        <option>Keep as string</option>
                                                    </select>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="outliers-tab" style="display: none;">
                        <div class="d-flex justify-between align-center mb-20">
                            <h3>Outlier Detection & Handling</h3>
                            <button class="btn btn-primary" id="apply-outliers-btn">
                                Apply Changes
                            </button>
                        </div>
                        
                        <div class="card-grid mb-20">
                            <div class="card">
                                <div class="card-header">Outlier Visualization</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="outlier-chart"></canvas>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">Detection Settings</div>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label class="form-label">Detection method:</label>
                                        <select class="form-select" id="outlier-method">
                                            <option value="iqr">IQR (Interquartile Range)</option>
                                            <option value="zscore">Z-Score</option>
                                            <option value="dbscan">DBSCAN Clustering</option>
                                            <option value="isolation">Isolation Forest</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Threshold (for IQR/Z-Score):</label>
                                        <input type="range" class="form-control" min="1.5" max="5" step="0.1" value="3" id="threshold-slider">
                                        <div class="d-flex justify-between">
                                            <span>1.5 (More strict)</span>
                                            <span id="threshold-value">3.0</span>
                                            <span>5.0 (Less strict)</span>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Apply to columns:</label>
                                        <select class="form-select" id="outlier-columns" multiple>
                                            <option value="pm25" selected>PM2.5</option>
                                            <option value="pm10" selected>PM10</option>
                                            <option value="o3" selected>O3</option>
                                            <option value="no2" selected>NO2</option>
                                            <option value="so2" selected>SO2</option>
                                            <option value="co" selected>CO</option>
                                            <option value="temp">Temperature</option>
                                            <option value="humidity">Humidity</option>
                                            <option value="wind">Wind Speed</option>
                                        </select>
                                    </div>
                                    
                                    <button class="btn btn-secondary" id="detect-outliers-btn">
                                        Detect Outliers
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card mb-20">
                            <div class="card-header">Outlier Handling</div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="form-label">Select handling method:</label>
                                    <select class="form-select" id="outlier-handling">
                                        <option value="remove">Remove outlier rows</option>
                                        <option value="cap">Cap at threshold (winsorization)</option>
                                        <option value="mean">Replace with mean</option>
                                        <option value="median">Replace with median</option>
                                        <option value="interpolate">Interpolate (for time series)</option>
                                        <option value="flag">Flag but keep (add outlier column)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="transform-tab" style="display: none;">
                        <div class="d-flex justify-between align-center mb-20">
                            <h3>Data Transformation & Feature Engineering</h3>
                            <button class="btn btn-primary" id="apply-transform-btn">
                                Apply Transformations
                            </button>
                        </div>
                        
                        <div class="card-grid mb-20">
                            <div class="card">
                                <div class="card-header">Scaling & Normalization</div>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label class="form-label">Scaling method:</label>
                                        <select class="form-select" id="scaling-method">
                                            <option value="none">No scaling</option>
                                            <option value="minmax">Min-Max Scaling (0-1)</option>
                                            <option value="standard">Standardization (Z-score)</option>
                                            <option value="robust">Robust Scaling (using IQR)</option>
                                            <option value="log">Log Transformation</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Apply to columns:</label>
                                        <select class="form-select" id="scaling-columns" multiple>
                                            <option value="pm25" selected>PM2.5</option>
                                            <option value="pm10" selected>PM10</option>
                                            <option value="o3" selected>O3</option>
                                            <option value="no2" selected>NO2</option>
                                            <option value="so2" selected>SO2</option>
                                            <option value="co" selected>CO</option>
                                            <option value="temp" selected>Temperature</option>
                                            <option value="humidity" selected>Humidity</option>
                                            <option value="wind" selected>Wind Speed</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">Feature Engineering</div>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label class="form-label">Create time-based features:</label>
                                        <div>
                                            <input type="checkbox" id="feature-month" checked>
                                            <label for="feature-month">Month</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="feature-day" checked>
                                            <label for="feature-day">Day of week</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="feature-hour">
                                            <label for="feature-hour">Hour of day</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="feature-season" checked>
                                            <label for="feature-season">Season</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="feature-holiday">
                                            <label for="feature-holiday">Is holiday</label>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Create derived metrics:</label>
                                        <div>
                                            <input type="checkbox" id="feature-aqi" checked>
                                            <label for="feature-aqi">Air Quality Index (AQI)</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="feature-pm-ratio">
                                            <label for="feature-pm-ratio">PM2.5/PM10 ratio</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="feature-no2-o3">
                                            <label for="feature-no2-o3">NO2/O3 ratio</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">Categorical Encoding</div>
                            <div class="card-body">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Column</th>
                                            <th>Type</th>
                                            <th>Unique Values</th>
                                            <th>Encoding Method</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Location</td>
                                            <td>Categorical</td>
                                            <td>8</td>
                                            <td>
                                                <select class="form-select">
                                                    <option>One-Hot Encoding</option>
                                                    <option>Label Encoding</option>
                                                    <option>Target Encoding</option>
                                                    <option>None (keep as is)</option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Season (new)</td>
                                            <td>Categorical</td>
                                            <td>4</td>
                                            <td>
                                                <select class="form-select">
                                                    <option>One-Hot Encoding</option>
                                                    <option>Label Encoding</option>
                                                    <option>Cyclical Encoding</option>
                                                    <option>None (keep as is)</option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Day of Week (new)</td>
                                            <td>Categorical</td>
                                            <td>7</td>
                                            <td>
                                                <select class="form-select">
                                                    <option>One-Hot Encoding</option>
                                                    <option>Label Encoding</option>
                                                    <option>Cyclical Encoding</option>
                                                    <option>None (keep as is)</option>
                                                </select>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-between mt-20">
                        <button class="btn btn-outline" id="back-to-load-btn">
                            <span class="material-icons btn-icon">arrow_back</span>
                            Back to Data Loading
                        </button>
                        <button class="btn btn-primary" id="proceed-to-explore-btn">
                            <span class="material-icons btn-icon">arrow_forward</span>
                            Proceed to Data Exploration
                        </button>
                    </div>
                </div>
            </div>

            <!-- Data Exploration Panel (Initially Hidden) -->
            <div class="panel" id="explore-panel" style="display: none;">
                <div class="panel-header">
                    <h2 class="panel-title">Data Exploration & Analysis</h2>
                    <button class="btn btn-outline">
                        <span class="material-icons btn-icon">help_outline</span>
                        Help
                    </button>
                </div>
                <div class="panel-body">
                    <div class="tabs mb-20">
                        <div class="tab active" data-tab="summary">Summary Statistics</div>
                        <div class="tab" data-tab="correlation">Correlation Analysis</div>
                        <div class="tab" data-tab="distribution">Distribution Analysis</div>
                        <div class="tab" data-tab="temporal">Temporal Patterns</div>
                    </div>
                    
                    <div class="tab-content" id="summary-tab">
                        <div class="d-flex justify-between align-center mb-20">
                            <h3>Summary Statistics</h3>
                            <div>
                                <button class="btn btn-outline">
                                    <span class="material-icons btn-icon">download</span>
                                    Export
                                </button>
                            </div>
                        </div>
                        
                        <div class="card mb-20">
                            <div class="card-header">Key Metrics Overview</div>
                            <div class="card-body">
                                <div style="overflow-x: auto;">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Metric</th>
                                                <th>PM2.5</th>
                                                <th>PM10</th>
                                                <th>O3</th>
                                                <th>NO2</th>
                                                <th>SO2</th>
                                                <th>CO</th>
                                                <th>Temperature</th>
                                                <th>Humidity</th>
                                                <th>Wind Speed</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Count</td>
                                                <td>9,842</td>
                                                <td>10,245</td>
                                                <td>10,123</td>
                                                <td>10,178</td>
                                                <td>10,201</td>
                                                <td>10,198</td>
                                                <td>10,245</td>
                                                <td>10,221</td>
                                                <td>10,189</td>
                                            </tr>
                                            <tr>
                                                <td>Mean</td>
                                                <td>18.72</td>
                                                <td>42.35</td>
                                                <td>0.031</td>
                                                <td>0.024</td>
                                                <td>0.007</td>
                                                <td>0.82</td>
                                                <td>15.46</td>
                                                <td>64.3%</td>
                                                <td>3.42</td>
                                            </tr>
                                            <tr>
                                                <td>Std Dev</td>
                                                <td>8.91</td>
                                                <td>15.23</td>
                                                <td>0.012</td>
                                                <td>0.011</td>
                                                <td>0.004</td>
                                                <td>0.31</td>
                                                <td>8.72</td>
                                                <td>12.8%</td>
                                                <td>1.89</td>
                                            </tr>
                                            <tr>
                                                <td>Min</td>
                                                <td>3.21</td>
                                                <td>8.76</td>
                                                <td>0.005</td>
                                                <td>0.002</td>
                                                <td>0.001</td>
                                                <td>0.2</td>
                                                <td>-5.4</td>
                                                <td>21.5%</td>
                                                <td>0.1</td>
                                            </tr>
                                            <tr>
                                                <td>25%</td>
                                                <td>12.35</td>
                                                <td>31.42</td>
                                                <td>0.021</td>
                                                <td>0.016</td>
                                                <td>0.004</td>
                                                <td>0.6</td>
                                                <td>8.9</td>
                                                <td>54.2%</td>
                                                <td>1.8</td>
                                            </tr>
                                            <tr>
                                                <td>Median</td>
                                                <td>17.65</td>
                                                <td>39.87</td>
                                                <td>0.029</td>
                                                <td>0.022</td>
                                                <td>0.006</td>
                                                <td>0.8</td>
                                                <td>16.2</td>
                                                <td>65.7%</td>
                                                <td>3.1</td>
                                            </tr>
                                            <tr>
                                                <td>75%</td>
                                                <td>23.41</td>
                                                <td>51.24</td>
                                                <td>0.039</td>
                                                <td>0.031</td>
                                                <td>0.009</td>
                                                <td>1.0</td>
                                                <td>22.8</td>
                                                <td>74.3%</td>
                                                <td>4.7</td>
                                            </tr>
                                            <tr>
                                                <td>Max</td>
                                                <td>89.23</td>
                                                <td>178.41</td>
                                                <td>0.124</td>
                                                <td>0.152</td>
                                                <td>0.048</td>
                                                <td>3.7</td>
                                                <td>35.6</td>
                                                <td>98.2%</td>
                                                <td>15.6</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-grid">
                            <div class="card">
                                <div class="card-header">Location Summary</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="location-summary-chart"></canvas>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">Time Period Coverage</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="time-coverage-chart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="correlation-tab" style="display: none;">
                        <div class="d-flex justify-between align-center mb-20">
                            <h3>Correlation Analysis</h3>
                            <div>
                                <button class="btn btn-outline">
                                    <span class="material-icons btn-icon">download</span>
                                    Export
                                </button>
                            </div>
                        </div>
                        
                        <div class="card mb-20">
                            <div class="card-header">Correlation Matrix</div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="correlation-matrix"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-grid">
                            <div class="card">
                                <div class="card-header">Top Positive Correlations</div>
                                <div class="card-body">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Variable 1</th>
                                                <th>Variable 2</th>
                                                <th>Correlation</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>PM2.5</td>
                                                <td>PM10</td>
                                                <td>0.91</td>
                                            </tr>
                                            <tr>
                                                <td>NO2</td>
                                                <td>CO</td>
                                                <td>0.83</td>
                                            </tr>
                                            <tr>
                                                <td>PM2.5</td>
                                                <td>NO2</td>
                                                <td>0.72</td>
                                            </tr>
                                            <tr>
                                                <td>SO2</td>
                                                <td>NO2</td>
                                                <td>0.68</td>
                                            </tr>
                                            <tr>
                                                <td>PM10</td>
                                                <td>NO2</td>
                                                <td>0.65</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">Top Negative Correlations</div>
                                <div class="card-body">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Variable 1</th>
                                                <th>Variable 2</th>
                                                <th>Correlation</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>O3</td>
                                                <td>NO2</td>
                                                <td>-0.58</td>
                                            </tr>
                                            <tr>
                                                <td>Wind Speed</td>
                                                <td>PM2.5</td>
                                                <td>-0.52</td>
                                            </tr>
                                            <tr>
                                                <td>Wind Speed</td>
                                                <td>PM10</td>
                                                <td>-0.49</td>
                                            </tr>
                                            <tr>
                                                <td>Wind Speed</td>
                                                <td>CO</td>
                                                <td>-0.43</td>
                                            </tr>
                                            <tr>
                                                <td>Temperature</td>
                                                <td>NO2</td>
                                                <td>-0.38</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="distribution-tab" style="display: none;">
                        <div class="d-flex justify-between align-center mb-20">
                            <h3>Distribution Analysis</h3>
                            <div>
                                <select class="form-select" id="distribution-variable">
                                    <option value="pm25">PM2.5</option>
                                    <option value="pm10">PM10</option>
                                    <option value="o3">O3</option>
                                    <option value="no2">NO2</option>
                                    <option value="so2">SO2</option>
                                    <option value="co">CO</option>
                                    <option value="temp">Temperature</option>
                                    <option value="humidity">Humidity</option>
                                    <option value="wind">Wind Speed</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="card-grid mb-20">
                            <div class="card">
                                <div class="card-header">Distribution Histogram</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="distribution-histogram"></canvas>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">Box Plot by Location</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="boxplot-location"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-grid">
                            <div class="card">
                                <div class="card-header">Q-Q Plot (Normality Check)</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="qqplot"></canvas>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">Distribution Statistics</div>
                                <div class="card-body">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Statistic</th>
                                                <th>Value</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Skewness</td>
                                                <td>1.82 (Right-skewed)</td>
                                            </tr>
                                            <tr>
                                                <td>Kurtosis</td>
                                                <td>5.43 (Leptokurtic)</td>
                                            </tr>
                                            <tr>
                                                <td>Shapiro-Wilk Test p-value</td>
                                                <td>0.0001 (Not normal)</td>
                                            </tr>
                                            <tr>
                                                <td>D'Agostino-Pearson Test p-value</td>
                                                <td>0.0001 (Not normal)</td>
                                            </tr>
                                            <tr>
                                                <td>5% Trimmed Mean</td>
                                                <td>17.23</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="temporal-tab" style="display: none;">
                        <div class="d-flex justify-between align-center mb-20">
                            <h3>Temporal Pattern Analysis</h3>
                            <div>
                                <select class="form-select" id="temporal-variable">
                                    <option value="pm25">PM2.5</option>
                                    <option value="pm10">PM10</option>
                                    <option value="o3">O3</option>
                                    <option value="no2">NO2</option>
                                    <option value="so2">SO2</option>
                                    <option value="co">CO</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="card mb-20">
                            <div class="card-header">Time Series Analysis</div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="time-series-chart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-grid">
                            <div class="card">
                                <div class="card-header">Seasonal Patterns</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="seasonal-patterns"></canvas>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">Weekly Patterns</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="weekly-patterns"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-between mt-20">
                        <button class="btn btn-outline" id="back-to-clean-btn">
                            <span class="material-icons btn-icon">arrow_back</span>
                            Back to Data Cleaning
                        </button>
                        <button class="btn btn-primary" id="proceed-to-model-btn">
                            <span class="material-icons btn-icon">arrow_forward</span>
                            Proceed to Modeling
                        </button>
                    </div>
                </div>
            </div>

            <!-- Modeling Panel (Initially Hidden) -->
            <div class="panel" id="model-panel" style="display: none;">
                <div class="panel-header">
                    <h2 class="panel-title">Modeling & Policy Analysis</h2>
                    <button class="btn btn-outline">
                        <span class="material-icons btn-icon">help_outline</span>
                        Help
                    </button>
                </div>
                <div class="panel-body">
                    <div class="tabs mb-20">
                        <div class="tab active" data-tab="contributors">Air Quality Contributors</div>
                        <div class="tab" data-tab="policy">Policy Simulation</div>
                        <div class="tab" data-tab="forecasting">Forecasting & Prediction</div>
                    </div>
                    
                    <div class="tab-content" id="contributors-tab">
                        <div class="d-flex justify-between align-center mb-20">
                            <h3>Identifying Key Contributors to Air Quality Degradation</h3>
                            <button class="btn btn-primary" id="run-analysis-btn">
                                <span class="material-icons btn-icon">play_arrow</span>
                                Run Analysis
                            </button>
                        </div>
                        
                        <div class="card mb-20">
                            <div class="card-header">Model Configuration</div>
                            <div class="card-body">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                    <div class="form-group">
                                        <label class="form-label">Target variable:</label>
                                        <select class="form-select" id="target-variable">
                                            <option value="pm25">PM2.5</option>
                                            <option value="pm10">PM10</option>
                                            <option value="o3">O3</option>
                                            <option value="no2">NO2</option>
                                            <option value="so2">SO2</option>
                                            <option value="co">CO</option>
                                            <option value="aqi">Air Quality Index (AQI)</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Analysis method:</label>
                                        <select class="form-select" id="analysis-method">
                                            <option value="linear">Multiple Linear Regression</option>
                                            <option value="random_forest">Random Forest</option>
                                            <option value="gradient_boosting">Gradient Boosting</option>
                                            <option value="elasticnet">Elastic Net Regression</option>
                                            <option value="xgboost">XGBoost</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Feature selection method:</label>
                                        <select class="form-select" id="feature-selection">
                                            <option value="none">Use all features</option>
                                            <option value="rfe">Recursive Feature Elimination</option>
                                            <option value="lasso">Lasso Regression</option>
                                            <option value="importance">Feature Importance</option>
                                            <option value="correlation">Correlation-based</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Cross-validation:</label>
                                        <select class="form-select" id="cross-validation">
                                            <option value="kfold">K-Fold (k=5)</option>
                                            <option value="timeseries">Time Series Split</option>
                                            <option value="stratified">Stratified K-Fold</option>
                                            <option value="none">None (single train/test split)</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group mt-20">
                                    <label class="form-label">Include variables:</label>
                                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
                                        <div>
                                            <input type="checkbox" id="include-weather" checked>
                                            <label for="include-weather">Weather conditions</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="include-traffic" checked>
                                            <label for="include-traffic">Traffic patterns</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="include-construction" checked>
                                            <label for="include-construction">Construction activity</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="include-temporal" checked>
                                            <label for="include-temporal">Temporal features</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="include-spatial" checked>
                                            <label for="include-spatial">Spatial features</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="include-industrial" checked>
                                            <label for="include-industrial">Industrial activity</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="include-population" checked>
                                            <label for="include-population">Population density</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="include-vegetation" checked>
                                            <label for="include-vegetation">Vegetation coverage</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-grid mb-20">
                            <div class="card">
                                <div class="card-header">Feature Importance</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="feature-importance-chart"></canvas>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">Model Performance</div>
                                <div class="card-body">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Metric</th>
                                                <th>Value</th>
                                                <th>Interpretation</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>R² (Coefficient of Determination)</td>
                                                <td>0.78</td>
                                                <td>Model explains 78% of variance</td>
                                            </tr>
                                            <tr>
                                                <td>Adjusted R²</td>
                                                <td>0.76</td>
                                                <td>Accounts for number of predictors</td>
                                            </tr>
                                            <tr>
                                                <td>Mean Absolute Error (MAE)</td>
                                                <td>3.21</td>
                                                <td>Average absolute prediction error</td>
                                            </tr>
                                            <tr>
                                                <td>Root Mean Square Error (RMSE)</td>
                                                <td>4.18</td>
                                                <td>Root of average squared errors</td>
                                            </tr>
                                            <tr>
                                                <td>Mean Absolute Percentage Error</td>
                                                <td>17.2%</td>
                                                <td>Average percentage error</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">Partial Dependence Plots</div>
                            <div class="card-body">
                                <div class="d-flex justify-between align-center mb-10">
                                    <h4>Effect of Individual Variables on Target</h4>
                                    <select class="form-select" style="width: 200px;" id="pdp-variable">
                                        <option value="traffic">Traffic Volume</option>
                                        <option value="construction">Construction Activity</option>
                                        <option value="industrial">Industrial Emissions</option>
                                        <option value="temperature">Temperature</option>
                                        <option value="wind">Wind Speed</option>
                                    </select>
                                </div>
                                <div class="chart-container">
                                    <canvas id="partial-dependence-plot"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="policy-tab" style="display: none;">
                        <div class="d-flex justify-between align-center mb-20">
                            <h3>Policy Intervention Simulation</h3>
                            <button class="btn btn-primary" id="run-simulation-btn">
                                <span class="material-icons btn-icon">play_arrow</span>
                                Run Simulation
                            </button>
                        </div>
                        
                        <div class="card mb-20">
                            <div class="card-header">Policy Scenario Configuration</div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="form-label">Select policy scenario:</label>
                                    <select class="form-select" id="policy-scenario">
                                        <option value="traffic_reduction">Traffic Reduction Measures</option>
                                        <option value="industrial_regulations">Industrial Emission Regulations</option>
                                        <option value="construction_limits">Construction Activity Limitations</option>
                                        <option value="green_infrastructure">Green Infrastructure Expansion</option>
                                        <option value="combined">Combined Policy Package</option>
                                        <option value="custom">Custom Scenario</option>
                                    </select>
                                </div>
                                
                                <div id="custom-policy-controls" class="mt-20">
                                    <h4 class="mb-10">Adjust Policy Parameters:</h4>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Traffic volume reduction:</label>
                                        <input type="range" class="form-control" min="0" max="50" value="20" id="traffic-reduction">
                                        <div class="d-flex justify-between">
                                            <span>0%</span>
                                            <span id="traffic-value">20%</span>
                                            <span>50%</span>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Industrial emissions reduction:</label>
                                        <input type="range" class="form-control" min="0" max="70" value="30" id="industrial-reduction">
                                        <div class="d-flex justify-between">
                                            <span>0%</span>
                                            <span id="industrial-value">30%</span>
                                            <span>70%</span>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Construction dust mitigation:</label>
                                        <input type="range" class="form-control" min="0" max="80" value="40" id="construction-mitigation">
                                        <div class="d-flex justify-between">
                                            <span>0%</span>
                                            <span id="construction-value">40%</span>
                                            <span>80%</span>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Green space increase:</label>
                                        <input type="range" class="form-control" min="0" max="30" value="15" id="green-increase">
                                        <div class="d-flex justify-between">
                                            <span>0%</span>
                                            <span id="green-value">15%</span>
                                            <span>30%</span>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Public transportation improvement:</label>
                                        <input type="range" class="form-control" min="0" max="100" value="25" id="public-transport">
                                        <div class="d-flex justify-between">
                                            <span>0%</span>
                                            <span id="transport-value">25%</span>
                                            <span>100%</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group mt-20">
                                    <label class="form-label">Implementation timeline:</label>
                                    <select class="form-select" id="implementation-timeline">
                                        <option value="immediate">Immediate (within 1 year)</option>
                                        <option value="short">Short-term (1-3 years)</option>
                                        <option value="medium" selected>Medium-term (3-5 years)</option>
                                        <option value="long">Long-term (5-10 years)</option>
                                        <option value="phased">Phased implementation</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-grid mb-20">
                            <div class="card">
                                <div class="card-header">Projected Air Quality Impact</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="policy-impact-chart"></canvas>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">Impact by Location</div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="location-impact-chart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">Cost-Benefit Analysis</div>
                            <div class="card-body">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Aspect</th>
                                            <th>Estimated Cost</th>
                                            <th>Estimated Benefit</th>
                                            <th>Benefit-Cost Ratio</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Implementation Cost</td>
                                            <td>$12.5M</td>
                                            <td>-</td>
                                            <td>-</td>
                                        </tr>
                                        <tr>
                                            <td>Health Benefits</td>
                                            <td>-</td>
                                            <td>$35.2M</td>
                                            <td>2.82</td>
                                        </tr>
                                        <tr>
                                            <td>Economic Productivity</td>
                                            <td>-</td>
                                            <td>$8.7M</td>
                                            <td>0.70</td>
                                        </tr>
                                        <tr>
                                            <td>Environmental Benefits</td>
                                            <td>-</td>
                                            <td>$6.3M</td>
                                            <td>0.50</td>
                                        </tr>
                                        <tr>
                                            <td>Total</td>
                                            <td>$12.5M</td>
                                            <td>$50.2M</td>
                                            <td>4.02</td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <div class="mt-20">
                                    <h4 class="mb-10">Key Findings:</h4>
                                    <ul>
                                        <li>The policy package shows a positive benefit-cost ratio of 4.02</li>
                                        <li>Health benefits account for the largest proportion of benefits</li>
                                        <li>Implementation costs are primarily associated with infrastructure changes</li>
                                        <li>Projected to reduce PM2.5 levels by 32% over 5 years</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="forecasting-tab" style="display: none;">
                        <div class="d-flex justify-between align-center mb-20">
                            <h3>Air Quality Forecasting</h3>
                            <button class="btn btn-primary" id="run-forecast-btn">
                                <span class="material-icons btn-icon">play_arrow</span>
                                Generate Forecast
                            </button>
                        </div>
                        
                        <div class="card mb-20">
                            <div class="card-header">Forecast Configuration</div>
                            <div class="card-body">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                    <div class="form-group">
                                        <label class="form-label">Target variable:</label>
                                        <select class="form-select" id="forecast-variable">
                                            <option value="pm25">PM2.5</option>
                                            <option value="pm10">PM10</option>
                                            <option value="o3">O3</option>
                                            <option value="no2">NO2</option>
                                            <option value="aqi">Air Quality Index (AQI)</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Forecast horizon:</label>
                                        <select class="form-select" id="forecast-horizon">
                                            <option value="1m">1 month</option>
                                            <option value="3m">3 months</option>
                                            <option value="6m">6 months</option>
                                            <option value="1y" selected>1 year</option>
                                            <option value="3y">3 years</option>
                                            <option value="5y">5 years</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Forecast method:</label>
                                        <select class="form-select" id="forecast-method">
                                            <option value="arima">ARIMA</option>
                                            <option value="sarima">Seasonal ARIMA</option>
                                            <option value="prophet">Prophet</option>
                                            <option value="lstm">LSTM Neural Network</option>
                                            <option value="ensemble" selected>Ensemble Forecast</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Include confidence intervals:</label>
                                        <select class="form-select" id="confidence-intervals">
                                            <option value="none">None</option>
                                            <option value="80">80% confidence</option>
                                            <option value="90">90% confidence</option>
                                            <option value="95" selected>95% confidence</option>
                                            <option value="99">99% confidence</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group mt-20">
                                    <label class="form-label">Include external factors:</label>
                                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                                        <div>
                                            <input type="checkbox" id="include-weather-forecast" checked>
                                            <label for="include-weather-forecast">Weather forecasts</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="include-events" checked>
                                            <label for="include-events">Planned events</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="include-construction-plans" checked>
                                            <label for="include-construction-plans">Construction plans</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="include-policy" checked>
                                            <label for="include-policy">Policy changes</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="include-trends" checked>
                                            <label for="include-trends">Seasonal trends</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="include-population" checked>
                                            <label for="include-population">Population changes</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card mb-20">
                            <div class="card-header">Forecast Results</div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="forecast-chart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-grid">
                            <div class="card">
                                <div class="card-header">Forecast Performance</div>
                                <div class="card-body">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Metric</th>
                                                <th>Value</th>
                                                <th>Interpretation</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Mean Absolute Error (MAE)</td>
                                                <td>3.47</td>
                                                <td>Average absolute forecast error</td>
                                            </tr>
                                            <tr>
                                                <td>Root Mean Square Error (RMSE)</td>
                                                <td>4.52</td>
                                                <td>Root of average squared errors</td>
                                            </tr>
                                            <tr>
                                                <td>Mean Absolute Percentage Error (MAPE)</td>
                                                <td>18.3%</td>
                                                <td>Average percentage error</td>
                                            </tr>
                                            <tr>
                                                <td>Theil's U</td>
                                                <td>0.72</td>
                                                <td>Comparison to naive forecast (< 1 is good)</td>
                                            </tr>
                                            <tr>
                                                <td>Forecast Bias</td>
                                                <td>-0.21</td>
                                                <td>Slight underestimation bias</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">Forecast Scenarios</div>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label class="form-label">Compare scenarios:</label>
                                        <select class="form-select" id="scenario-comparison">
                                            <option value="baseline">Baseline Forecast</option>
                                            <option value="best">Best Case Scenario</option>
                                            <option value="worst">Worst Case Scenario</option>
                                            <option value="policy">With Policy Implementation</option>
                                            <option value="all">Show All Scenarios</option>
                                        </select>
                                    </div>
                                    
                                    <div class="chart-container mt-20">
                                        <canvas id="scenario-chart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-between mt-20">
                        <button class="btn btn-outline" id="back-to-explore-btn">
                            <span class="material-icons btn-icon">arrow_back</span>
                            Back to Data Exploration
                        </button>
                        <button class="btn btn-primary" id="proceed-to-visualize-btn">
                            <span class="material-icons btn-icon">arrow_forward</span>
                            Proceed to Visualization
                        </button>
                    </div>
                </div>
            </div>

            <!-- Visualization Panel (Initially Hidden) -->
            <div class="panel" id="visualize-panel" style="display: none;">
                <div class="panel-header">
                    <h2 class="panel-title">Data Visualization Dashboard</h2>
                    <div>
                        <button class="btn btn-outline">
                            <span class="material-icons btn-icon">share</span>
                            Share
                        </button>
                        <button class="btn btn-outline">
                            <span class="material-icons btn-icon">download</span>
                            Export
                        </button>
                    </div>
                </div>
                <div class="panel-body">
                    <div class="d-flex justify-between align-center mb-20">
                        <div>
                            <h3>Interactive Air Quality Dashboard</h3>
                            <p>Visualize key findings and insights from your environmental data analysis</p>
                        </div>
                        <div>
                            <button class="btn btn-outline">
                                <span class="material-icons btn-icon">edit</span>
                                Customize Dashboard
                            </button>
                        </div>
                    </div>
                    
                    <div class="card-grid mb-20">
                        <div class="card">
                            <div class="card-header">Air Quality Trends</div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="air-quality-trend-chart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">Contributor Analysis</div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="contributor-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card mb-20">
                        <div class="card-header">Spatial Distribution of Air Quality</div>
                        <div class="card-body">
                            <div style="height: 400px; background-color: #f5f5f5; display: flex; justify-content: center; align-items: center;">
                                <div style="text-align: center;">
                                    <span class="material-icons" style="font-size: 48px; color: var(--gray-400);">map</span>
                                    <p>Interactive map will be displayed here</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card-grid mb-20">
                        <div class="card">
                            <div class="card-header">Policy Impact Comparison</div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="policy-comparison-chart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">Seasonal Variation</div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="seasonal-variation-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">Interactive Data Explorer</div>
                        <div class="card-body">
                            <div class="d-flex justify-between align-center mb-20">
                                <div>
                                    <label class="form-label">X-Axis:</label>
                                    <select class="form-select" style="width: 150px;" id="x-axis">
                                        <option value="date">Date</option>
                                        <option value="traffic">Traffic Volume</option>
                                        <option value="temperature">Temperature</option>
                                        <option value="construction">Construction Activity</option>
                                        <option value="industrial">Industrial Activity</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="form-label">Y-Axis:</label>
                                    <select class="form-select" style="width: 150px;" id="y-axis">
                                        <option value="pm25">PM2.5</option>
                                        <option value="pm10">PM10</option>
                                        <option value="o3">O3</option>
                                        <option value="no2">NO2</option>
                                        <option value="aqi">Air Quality Index</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="form-label">Color By:</label>
                                    <select class="form-select" style="width: 150px;" id="color-by">
                                        <option value="location">Location</option>
                                        <option value="season">Season</option>
                                        <option value="day">Day of Week</option>
                                        <option value="none">None</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="form-label">Chart Type:</label>
                                    <select class="form-select" style="width: 150px;" id="chart-type">
                                        <option value="scatter">Scatter Plot</option>
                                        <option value="line">Line Chart</option>
                                        <option value="bar">Bar Chart</option>
                                        <option value="bubble">Bubble Chart</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="chart-container">
                                <canvas id="explorer-chart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-between mt-20">
                        <button class="btn btn-outline" id="back-to-model-btn">
                            <span class="material-icons btn-icon">arrow_back</span>
                            Back to Modeling
                        </button>
                        <button class="btn btn-primary" id="proceed-to-report-btn">
                            <span class="material-icons btn-icon">arrow_forward</span>
                            Generate Report
                        </button>
                    </div>
                </div>
            </div>

            <!-- Report Generation Panel (Initially Hidden) -->
            <div class="panel" id="report-panel" style="display: none;">
                <div class="panel-header">
                    <h2 class="panel-title">Report Generation</h2>
                    <button class="btn btn-outline">
                        <span class="material-icons btn-icon">help_outline</span>
                        Help
                    </button>
                </div>
                <div class="panel-body">
                    <div class="d-flex justify-between align-center mb-20">
                        <h3>Generate Comprehensive Analysis Report</h3>
                        <button class="btn btn-primary" id="generate-report-btn">
                            <span class="material-icons btn-icon">description</span>
                            Generate Report
                        </button>
                    </div>
                    
                    <div class="card mb-20">
                        <div class="card-header">Report Configuration</div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Report title:</label>
                                <input type="text" class="form-control" value="Urban Air Quality Analysis: Factors & Policy Impacts" id="report-title">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Report format:</label>
                                <select class="form-select" id="report-format">
                                    <option value="pdf">PDF Document</option>
                                    <option value="html">Interactive HTML</option>
                                    <option value="ppt">PowerPoint Presentation</option>
                                    <option value="word">Word Document</option>
                                    <option value="excel">Excel Workbook</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Include sections:</label>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                                    <div>
                                        <input type="checkbox" id="include-executive" checked>
                                        <label for="include-executive">Executive Summary</label>
                                    </div>
                                    <div>
                                        <input type="checkbox" id="include-methodology" checked>
                                        <label for="include-methodology">Methodology</label>
                                    </div>
                                    <div>
                                        <input type="checkbox" id="include-data-quality" checked>
                                        <label for="include-data-quality">Data Quality Assessment</label>
                                    </div>
                                    <div>
                                        <input type="checkbox" id="include-exploratory" checked>
                                        <label for="include-exploratory">Exploratory Analysis</label>
                                    </div>
                                    <div>
                                        <input type="checkbox" id="include-contributor" checked>
                                        <label for="include-contributor">Air Quality Contributors</label>
                                    </div>
                                    <div>
                                        <input type="checkbox" id="include-policy-analysis" checked>
                                        <label for="include-policy-analysis">Policy Analysis</label>
                                    </div>
                                    <div>
                                        <input type="checkbox" id="include-forecast" checked>
                                        <label for="include-forecast">Future Projections</label>
                                    </div>
                                    <div>
                                        <input type="checkbox" id="include-recommendations" checked>
                                        <label for="include-recommendations">Recommendations</label>
                                    </div>
                                    <div>
                                        <input type="checkbox" id="include-appendix" checked>
                                        <label for="include-appendix">Technical Appendix</label>
                                    </div>
                                    <div>
                                        <input type="checkbox" id="include-raw-data">
                                        <label for="include-raw-data">Raw Data Tables</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Report detail level:</label>
                                <select class="form-select" id="report-detail">
                                    <option value="executive">Executive (brief overview)</option>
                                    <option value="standard" selected>Standard (balanced detail)</option>
                                    <option value="technical">Technical (comprehensive details)</option>
                                    <option value="custom">Custom</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card mb-20">
                        <div class="card-header">Data Export Options</div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Export cleaned dataset:</label>
                                <select class="form-select" id="export-data">
                                    <option value="none">Don't export</option>
                                    <option value="csv" selected>CSV format</option>
                                    <option value="excel">Excel format</option>
                                    <option value="json">JSON format</option>
                                    <option value="sql">SQL dump</option>
                                    <option value="all">All formats</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Export visualizations:</label>
                                <select class="form-select" id="export-visualizations">
                                    <option value="none">Don't export</option>
                                    <option value="png" selected>PNG format</option>
                                    <option value="svg">SVG format</option>
                                    <option value="pdf">PDF format</option>
                                    <option value="interactive">Interactive HTML</option>
                                    <option value="all">All formats</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Export models:</label>
                                <select class="form-select" id="export-models">
                                    <option value="none">Don't export</option>
                                    <option value="pickle" selected>Pickle format</option>
                                    <option value="pmml">PMML format</option>
                                    <option value="onnx">ONNX format</option>
                                    <option value="all">All formats</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">Report Preview</div>
                        <div class="card-body text-center">
                            <img src="https://placehold.co/600x400?text=Report+Preview" alt="Report Preview" style="max-width: 100%; border: 1px solid var(--gray-300); border-radius: var(--border-radius);">
                            
                            <div class="d-flex justify-between mt-20">
                                <button class="btn btn-outline">
                                    <span class="material-icons btn-icon">preview</span>
                                    Preview Full Report
                                </button>
                                <button class="btn btn-secondary">
                                    <span class="material-icons btn-icon">download</span>
                                    Download Report
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-between mt-20">
                        <button class="btn btn-outline" id="back-to-visualize-btn">
                            <span class="material-icons btn-icon">arrow_back</span>
                            Back to Visualization
                        </button>
                        <button class="btn btn-primary" id="start-new-analysis-btn">
                            <span class="material-icons btn-icon">refresh</span>
                            Start New Analysis
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { Chart } from "https://esm.sh/chart.js/auto";

        // DOM Elements
        const workflowSteps = document.querySelectorAll('.workflow-step');
        const panels = {
            load: document.getElementById('load-panel'),
            preview: document.getElementById('preview-panel'),
            clean: document.getElementById('clean-panel'),
            explore: document.getElementById('explore-panel'),
            model: document.getElementById('model-panel'),
            visualize: document.getElementById('visualize-panel'),
            report: document.getElementById('report-panel')
        };
        
        // Navigation Functions
        function showPanel(panelId) {
            // Hide all panels
            Object.values(panels).forEach(panel => {
                panel.style.display = 'none';
            });
            
            // Show selected panel
            panels[panelId].style.display = 'block';
            
            // Update workflow steps
            workflowSteps.forEach(step => {
                step.classList.remove('active');
                if (step.dataset.step === panelId) {
                    step.classList.add('active');
                }
            });
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
        
        // Initialize Tab System
        function initTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Get parent tab container
                    const tabContainer = tab.parentElement;
                    // Get associated content container
                    const contentContainer = tabContainer.nextElementSibling;
                    // Get all tab contents in this section
                    const tabContents = document.querySelectorAll(`#${contentContainer.parentElement.id} .tab-content`);
                    
                    // Remove active class from all tabs in this container
                    tabContainer.querySelectorAll('.tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    
                    // Add active class to clicked tab
                    tab.classList.add('active');
                    
                    // Hide all tab contents
                    tabContents.forEach(content => {
                        content.style.display = 'none';
                    });
                    
                    // Show selected tab content
                    const targetContent = document.getElementById(`${tab.dataset.tab}-tab`);
                    if (targetContent) {
                        targetContent.style.display = 'block';
                    }
                });
            });
        }
        
        // Event Listeners for Navigation
        function setupNavigation() {
            // Workflow step navigation
            workflowSteps.forEach(step => {
                step.addEventListener('click', () => {
                    showPanel(step.dataset.step);
                });
            });
            
            // Next/Previous buttons
            document.getElementById('load-data-btn').addEventListener('click', () => {
                showPanel('preview');
            });
            
            document.getElementById('proceed-to-clean-btn').addEventListener('click', () => {
                showPanel('clean');
            });
            
            document.getElementById('back-to-load-btn').addEventListener('click', () => {
                showPanel('preview');
            });
            
            document.getElementById('proceed-to-explore-btn').addEventListener('click', () => {
                showPanel('explore');
            });
            
            document.getElementById('back-to-clean-btn').addEventListener('click', () => {
                showPanel('clean');
            });
            
            document.getElementById('proceed-to-model-btn').addEventListener('click', () => {
                showPanel('model');
            });
            
            document.getElementById('back-to-explore-btn').addEventListener('click', () => {
                showPanel('explore');
            });
            
            document.getElementById('proceed-to-visualize-btn').addEventListener('click', () => {
                showPanel('visualize');
            });
            
            document.getElementById('back-to-model-btn').addEventListener('click', () => {
                showPanel('model');
            });
            
            document.getElementById('proceed-to-report-btn').addEventListener('click', () => {
                showPanel('report');
            });
            
            document.getElementById('back-to-visualize-btn').addEventListener('click', () => {
                showPanel('visualize');
            });
            
            document.getElementById('start-new-analysis-btn').addEventListener('click', () => {
                showPanel('load');
            });
        }
        
        // File Upload Functionality
        function setupFileUpload() {
            const uploadArea = document.getElementById('upload-area');
            const fileUpload = document.getElementById('file-upload');
            
            uploadArea.addEventListener('click', () => {
                fileUpload.click();
            });
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = 'var(--primary)';
                uploadArea.style.backgroundColor = 'rgba(33, 150, 243, 0.05)';
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.style.borderColor = 'var(--gray-400)';
                uploadArea.style.backgroundColor = 'transparent';
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = 'var(--gray-400)';
                uploadArea.style.backgroundColor = 'transparent';
                
                if (e.dataTransfer.files.length) {
                    fileUpload.files = e.dataTransfer.files;
                    // Trigger file upload logic
                    console.log('File dropped:', e.dataTransfer.files[0].name);
                }
            });
            
            fileUpload.addEventListener('change', () => {
                if (fileUpload.files.length) {
                    console.log('File selected:', fileUpload.files[0].name);
                }
            });
        }
        
        // Initialize Charts
        function initCharts() {
            // Only create charts for the active panel to improve performance
            const activePanel = document.querySelector('.panel[style="display: block;"]');
            if (!activePanel) return;
            
            const panelId = activePanel.id;
            
            // Missing Values Chart (Data Cleaning Panel)
            if (panelId === 'clean-panel' && document.getElementById('missing-chart')) {
                new Chart(document.getElementById('missing-chart'), {
                    type: 'bar',
                    data: {
                        labels: ['PM2.5', 'PM10', 'O3', 'NO2', 'SO2', 'CO', 'Temperature', 'Humidity', 'Wind Speed'],
                        datasets: [{
                            label: 'Missing Values (%)',
                            data: [3.9, 0, 1.2, 0.7, 0.4, 0.5, 0, 0.2, 0.5],
                            backgroundColor: 'rgba(255, 99, 132, 0.7)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Missing Values (%)'
                                },
                                max: 5
                            }
                        }
                    }
                });
            }
            
            // Correlation Matrix (Data Exploration Panel)
            if (panelId === 'explore-panel' && document.getElementById('correlation-matrix')) {
                const correlationData = [
                    [1.00, 0.91, -0.23, 0.72, 0.54, 0.62, -0.18, 0.29, -0.52],
                    [0.91, 1.00, -0.19, 0.65, 0.48, 0.57, -0.15, 0.25, -0.49],
                    [-0.23, -0.19, 1.00, -0.58, -0.31, -0.25, 0.42, -0.37, 0.12],
                    [0.72, 0.65, -0.58, 1.00, 0.68, 0.83, -0.38, 0.41, -0.36],
                    [0.54, 0.48, -0.31, 0.68, 1.00, 0.59, -0.22, 0.18, -0.28],
                    [0.62, 0.57, -0.25, 0.83, 0.59, 1.00, -0.27, 0.35, -0.43],
                    [-0.18, -0.15, 0.42, -0.38, -0.22, -0.27, 1.00, -0.45, 0.21],
                    [0.29, 0.25, -0.37, 0.41, 0.18, 0.35, -0.45, 1.00, -0.32],
                    [-0.52, -0.49, 0.12, -0.36, -0.28, -0.43, 0.21, -0.32, 1.00]
                ];
                
                const labels = ['PM2.5', 'PM10', 'O3', 'NO2', 'SO2', 'CO', 'Temp', 'Humidity', 'Wind'];
                
                new Chart(document.getElementById('correlation-matrix'), {
                    type: 'matrix',
                    data: {
                        datasets: [{
                            data: correlationData.flatMap((row, i) => 
                                row.map((value, j) => ({
                                    x: j,
                                    y: i,
                                    v: value
                                }))
                            ),
                            backgroundColor(context) {
                                const value = context.dataset.data[context.dataIndex].v;
                                const alpha = Math.abs(value);
                                return value > 0 
                                    ? `rgba(0, 123, 255, ${alpha})`
                                    : `rgba(255, 99, 132, ${alpha})`;
                            },
                            borderColor: 'white',
                            borderWidth: 1,
                            width: ({ chart }) => (chart.chartArea || {}).width / labels.length - 1,
                            height: ({ chart }) => (chart.chartArea || {}).height / labels.length - 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                type: 'category',
                                labels: labels,
                                offset: true,
                                ticks: {
                                    display: true
                                },
                                grid: {
                                    display: false
                                }
                            },
                            y: {
                                type: 'category',
                                labels: labels,
                                offset: true,
                                ticks: {
                                    display: true
                                },
                                grid: {
                                    display: false
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    title() {
                                        return '';
                                    },
                                    label(context) {
                                        const v = context.dataset.data[context.dataIndex];
                                        return [
                                            `${labels[v.y]} vs ${labels[v.x]}`,
                                            `Correlation: ${v.v.toFixed(2)}`
                                        ];
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            // Feature Importance Chart (Modeling Panel)
            if (panelId === 'model-panel' && document.getElementById('feature-importance-chart')) {
                new Chart(document.getElementById('feature-importance-chart'), {
                    type: 'bar',
                    data: {
                        labels: ['Traffic Volume', 'Industrial Emissions', 'Temperature', 'Wind Speed', 'Construction Activity', 'Season', 'Humidity', 'Population Density', 'Vegetation Coverage'],
                        datasets: [{
                            label: 'Feature Importance',
                            data: [0.28, 0.22, 0.15, 0.12, 0.09, 0.06, 0.04, 0.03, 0.01],
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.7)',
                                'rgba(54, 162, 235, 0.7)',
                                'rgba(255, 206, 86, 0.7)',
                                'rgba(75, 192, 192, 0.7)',
                                'rgba(153, 102, 255, 0.7)',
                                'rgba(255, 159, 64, 0.7)',
                                'rgba(199, 199, 199, 0.7)',
                                'rgba(83, 102, 255, 0.7)',
                                'rgba(40, 159, 64, 0.7)'
                            ],
                            borderColor: [
                                'rgba(255, 99, 132, 1)',
                                'rgba(54, 162, 235, 1)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)',
                                'rgba(199, 199, 199, 1)',
                                'rgba(83, 102, 255, 1)',
                                'rgba(40, 159, 64, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Importance Score'
                                }
                            }
                        }
                    }
                });
            }
            
            // Policy Impact Chart (Visualization Panel)
            if (panelId === 'visualize-panel' && document.getElementById('policy-comparison-chart')) {
                new Chart(document.getElementById('policy-comparison-chart'), {
                    type: 'bar',
                    data: {
                        labels: ['No Intervention', 'Traffic Reduction', 'Industrial Regulations', 'Construction Limits', 'Green Infrastructure', 'Combined Package'],
                        datasets: [{
                            label: 'Projected PM2.5 Levels (μg/m³)',
                            data: [18.7, 15.2, 14.8, 17.1, 16.9, 12.7],
                            backgroundColor: 'rgba(75, 192, 192, 0.7)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'PM2.5 Concentration (μg/m³)'
                                }
                            }
                        }
                    }
                });
            }
        }
        
        // Initialize Range Slider Values
        function initRangeSliders() {
            const sliders = [
                { slider: 'threshold-slider', value: 'threshold-value' },
                { slider: 'traffic-reduction', value: 'traffic-value' },
                { slider: 'industrial-reduction', value: 'industrial-value' },
                { slider: 'construction-mitigation', value: 'construction-value' },
                { slider: 'green-increase', value: 'green-value' },
                { slider: 'public-transport', value: 'transport-value' }
            ];
            
            sliders.forEach(item => {
                const slider = document.getElementById(item.slider);
                const value = document.getElementById(item.value);
                
                if (slider && value) {
                    // Set initial value
                    value.textContent = slider.value + (item.slider !== 'threshold-slider' ? '%' : '');
                    
                    // Update value on slider change
                    slider.addEventListener('input', () => {
                        value.textContent = slider.value + (item.slider !== 'threshold-slider' ? '%' : '');
                    });
                }
            });
        }
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            // Setup navigation
            setupNavigation();
            
            // Setup file upload
            setupFileUpload();
            
            // Initialize tabs
            initTabs();
            
            // Initialize range sliders
            initRangeSliders();
            
            // Initialize charts
            initCharts();
            
            // Show initial panel
            showPanel('load');
        });
    </script>
</body>
</html>